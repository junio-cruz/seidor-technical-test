var Zq=Object.create;var Kd=Object.defineProperty;var Nq=Object.getOwnPropertyDescriptor;var Vq=Object.getOwnPropertyNames;var Hq=Object.getPrototypeOf,Wq=Object.prototype.hasOwnProperty;var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Oq=(t,e)=>{for(var r in e)Kd(t,r,{get:e[r],enumerable:!0})},zw=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Vq(e))!Wq.call(t,s)&&s!==r&&Kd(t,s,{get:()=>e[s],enumerable:!(n=Nq(e,s))||n.enumerable});return t};var $s=(t,e,r)=>(r=t!=null?Zq(Hq(t)):{},zw(e||!t||!t.__esModule?Kd(r,"default",{value:t,enumerable:!0}):r,t)),Pq=t=>zw(Kd({},"__esModule",{value:!0}),t);var Jw=h((gBe,qo)=>{"use strict";var kq=t=>{let e=t.headers["content-encoding"]||t.headers["Content-Encoding"];return e&&e!=="identity"},Fq=(t,e)=>(typeof t.enforceBase64=="function"?t.enforceBase64:kq)(e)===!0;qo.exports=(t,e)=>{e=e||{},e.binaryMimeTypes=e.binaryMimeTypes||[],e.serializeLambdaArguments=e.serializeLambdaArguments!==void 0?e.serializeLambdaArguments:!1,e.decorateRequest=e.decorateRequest!==void 0?e.decorateRequest:!0,e.retainStage=e.retainStage!==void 0?e.retainStage:!1,e.pathParameterUsedAsPath=e.pathParameterUsedAsPath!==void 0?e.pathParameterUsedAsPath:!1;let r={};return e.decorateRequest&&(e.decorationPropertyName=e.decorationPropertyName||"awsLambda",t.decorateRequest(e.decorationPropertyName,{getter:()=>({get event(){return r.event},get context(){return r.context}})})),(n,s,i)=>{r.event=n,r.context=s,e.callbackWaitsForEmptyEventLoop!==void 0&&(s.callbackWaitsForEmptyEventLoop=e.callbackWaitsForEmptyEventLoop),n.body=n.body||"";let o=n.httpMethod||(n.requestContext&&n.requestContext.http?n.requestContext.http.method:void 0),a=e.pathParameterUsedAsPath&&n.pathParameters&&n.pathParameters[e.pathParameterUsedAsPath]&&`/${n.pathParameters[e.pathParameterUsedAsPath]}`||n.path||n.rawPath||"/";!e.retainStage&&n.requestContext&&n.requestContext.stage&&n.requestContext.resourcePath&&a.indexOf(`/${n.requestContext.stage}/`)===0&&n.requestContext.resourcePath.indexOf(`/${n.requestContext.stage}/`)!==0&&(a=a.substring(n.requestContext.stage.length+1));let c={};n.requestContext&&n.requestContext.elb?n.multiValueQueryStringParameters?Object.keys(n.multiValueQueryStringParameters).forEach(g=>{c[decodeURIComponent(g)]=n.multiValueQueryStringParameters[g].map(p=>decodeURIComponent(p))}):n.queryStringParameters&&Object.keys(n.queryStringParameters).forEach(g=>{c[decodeURIComponent(g)]=decodeURIComponent(n.queryStringParameters[g]),n.version==="2.0"&&typeof c[decodeURIComponent(g)]=="string"&&c[decodeURIComponent(g)].indexOf(",")>0&&(c[decodeURIComponent(g)]=c[decodeURIComponent(g)].split(","))}):(n.queryStringParameters&&n.version==="2.0"&&Object.keys(n.queryStringParameters).forEach(g=>{typeof n.queryStringParameters[g]=="string"&&n.queryStringParameters[g].indexOf(",")>0&&(n.queryStringParameters[g]=n.queryStringParameters[g].split(","))}),Object.assign(c,n.multiValueQueryStringParameters||n.queryStringParameters));let l=Object.assign({},n.headers);n.multiValueHeaders&&Object.keys(n.multiValueHeaders).forEach(g=>{n.multiValueHeaders[g].length>1&&(l[g]=n.multiValueHeaders[g])});let u=Buffer.from(n.body,n.isBase64Encoded?"base64":"utf8");n.body&&!l["Content-Length"]&&!l["content-length"]&&(l["content-length"]=Buffer.byteLength(u)),e.serializeLambdaArguments&&(n.body=void 0,l["x-apigateway-event"]=encodeURIComponent(JSON.stringify(n)),s&&(l["x-apigateway-context"]=encodeURIComponent(JSON.stringify(s)))),n.requestContext&&n.requestContext.requestId&&(l["x-request-id"]=l["x-request-id"]||n.requestContext.requestId),n.cookies&&n.cookies.length&&(l.cookie=n.cookies.join(";"));let d;n.requestContext&&(n.requestContext.http&&n.requestContext.http.sourceIp?d=n.requestContext.http.sourceIp:n.requestContext.identity&&n.requestContext.identity.sourceIp&&(d=n.requestContext.identity.sourceIp));let f=new Promise(g=>{t.inject({method:o,url:a,query:c,payload:u,headers:l,remoteAddress:d},(p,m)=>{if(r={},p)return console.error(p),g({statusCode:500,body:"",headers:{}});l["transfer-encoding"]==="chunked"&&delete l["transfer-encoding"],l["Transfer-Encoding"]==="chunked"&&delete l["Transfer-Encoding"];let I,C;Object.keys(m.headers).forEach(A=>{let E=A.toLowerCase()==="set-cookie",v=Array.isArray(m.headers[A]);v?E?(I=I||{},I[A]=m.headers[A]):m.headers[A]=m.headers[A].join(","):typeof m.headers[A]<"u"&&typeof m.headers[A]!="string"&&(m.headers[A]=m.headers[A].toString()),E&&(C=v?m.headers[A]:[m.headers[A]],(n.version==="2.0"||v)&&delete m.headers[A])});let S=(m.headers["content-type"]||m.headers["Content-Type"]||"").split(";",1)[0],b=e.binaryMimeTypes.indexOf(S)>-1||Fq(e,m),y={statusCode:m.statusCode,body:b?m.rawPayload.toString("base64"):m.payload,headers:m.headers,isBase64Encoded:b};C&&n.version==="2.0"&&(y.cookies=C),I&&(!n.version||n.version==="1.0")&&(y.multiValueHeaders=I),g(y)})});return i&&f.then(g=>i(null,g)).catch(i),f}};qo.exports.default=qo.exports;qo.exports.awsLambdaFastify=qo.exports});var eB=h((pBe,Iy)=>{"use strict";var xq=/at\s{1}(?:.*\.)?plugin\s{1}.*\n\s*(.*)/,Lq=/(\w*(\.\w*)*)\..*/;Iy.exports=function(e){if(e.name.length>0)return e.name;let r=Error.stackTraceLimit;Error.stackTraceLimit=10;try{throw new Error("anonymous function")}catch(n){return Error.stackTraceLimit=r,Qw(n.stack)}};function Qw(t){let e=t.match(xq);return e?e[1].split(/[/\\]/).slice(-1)[0].match(Lq)[1]:"anonymous"}Iy.exports.extractPluginName=Qw});var rB=h((hBe,tB)=>{"use strict";tB.exports=function(e){return e[0]==="@"&&(e=e.slice(1).replace("/","-")),e.replace(/-(.)/g,function(n,s){return s.toUpperCase()})}});var nB=h((mBe,zd)=>{"use strict";var Uq=eB(),Yq=rB(),Dq=0;function by(t,e={}){let r=!1;if(typeof t.default<"u"&&(t=t.default),typeof t!="function")throw new TypeError(`fastify-plugin expects a function, instead got a '${typeof t}'`);if(typeof e=="string"&&(e={fastify:e}),typeof e!="object"||Array.isArray(e)||e===null)throw new TypeError("The options object should be an object");if(e.fastify!==void 0&&typeof e.fastify!="string")throw new TypeError(`fastify-plugin expects a version string, instead got '${typeof e.fastify}'`);e.name||(r=!0,e.name=Uq(t)+"-auto-"+Dq++),t[Symbol.for("skip-override")]=e.encapsulate!==!0,t[Symbol.for("fastify.display-name")]=e.name,t[Symbol.for("plugin-meta")]=e,t.default||(t.default=t);let n=Yq(e.name);return!r&&!t[n]&&(t[n]=t),t}zd.exports=by;zd.exports.default=by;zd.exports.fastifyPlugin=by});var iB=h((yBe,sB)=>{function Cn(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Cn.prototype[Symbol.iterator]=function(){return this});Cn.of=function(){var t=arguments,e=t.length,r=0;return new Cn(function(){return r>=e?{done:!0}:{done:!1,value:t[r++]}})};Cn.empty=function(){var t=new Cn(function(){return{done:!0}});return t};Cn.fromSequence=function(t){var e=0,r=t.length;return new Cn(function(){return e>=r?{done:!0}:{done:!1,value:t[e++]}})};Cn.is=function(t){return t instanceof Cn?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};sB.exports=Cn});var oB=h(Cy=>{Cy.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Cy.SYMBOL_SUPPORT=typeof Symbol<"u"});var Sy=h((bBe,cB)=>{var aB=oB(),Xq=aB.ARRAY_BUFFER_SUPPORT,$q=aB.SYMBOL_SUPPORT;cB.exports=function(e,r){var n,s,i,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof r!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||Xq&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(i=0,o=e.length;i<o;i++)r(e[i],i);return}if(typeof e.forEach=="function"){e.forEach(r);return}if($q&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(n=e,i=0;a=n.next(),a.done!==!0;)r(a.value,i),i++;return}for(s in e)e.hasOwnProperty(s)&&r(e[s],s)}});var vy=h(Sn=>{var jq=Math.pow(2,8)-1,qq=Math.pow(2,16)-1,Mq=Math.pow(2,32)-1,Kq=Math.pow(2,7)-1,zq=Math.pow(2,15)-1,Jq=Math.pow(2,31)-1;Sn.getPointerArray=function(t){var e=t-1;if(e<=jq)return Uint8Array;if(e<=qq)return Uint16Array;if(e<=Mq)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")};Sn.getSignedPointerArray=function(t){var e=t-1;return e<=Kq?Int8Array:e<=zq?Int16Array:e<=Jq?Int32Array:Float64Array};Sn.getNumberType=function(t){return t===(t|0)?Math.sign(t)===-1?t<=127&&t>=-128?Int8Array:t<=32767&&t>=-32768?Int16Array:Int32Array:t<=255?Uint8Array:t<=65535?Uint16Array:Uint32Array:Float64Array};var Qq={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};Sn.getMinimalRepresentation=function(t,e){var r=null,n=0,s,i,o,a,c;for(a=0,c=t.length;a<c;a++)o=e?e(t[a]):t[a],i=Sn.getNumberType(o),s=Qq[i.name],s>n&&(n=s,r=i);return r};Sn.isTypedArray=function(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(t)};Sn.concat=function(){var t=0,e,r,n;for(e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=new arguments[0].constructor(t);for(e=0,r=0;e<n;e++)s.set(arguments[e],r),r+=arguments[e].length;return s};Sn.indices=function(t){for(var e=Sn.getPointerArray(t),r=new e(t),n=0;n<t;n++)r[n]=n;return r}});var dB=h(Xc=>{var lB=Sy(),uB=vy();function e9(t){return Array.isArray(t)||uB.isTypedArray(t)}function _y(t){if(typeof t.length=="number")return t.length;if(typeof t.size=="number")return t.size}function t9(t){var e=_y(t),r=typeof e=="number"?new Array(e):[],n=0;return lB(t,function(s){r[n++]=s}),r}function r9(t){var e=_y(t),r=typeof e=="number"?uB.getPointerArray(e):Array,n=typeof e=="number"?new Array(e):[],s=typeof e=="number"?new r(e):[],i=0;return lB(t,function(o){n[i]=o,s[i]=i++}),[n,s]}Xc.isArrayLike=e9;Xc.guessLength=_y;Xc.toArray=t9;Xc.toArrayWithIndices=r9});var gB=h((vBe,fB)=>{var Ay=iB(),n9=Sy(),s9=vy(),i9=dB();function Ct(t,e,r){if(arguments.length<2&&(r=t,t=null,e=null),this.capacity=r,typeof this.capacity!="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-cache: capacity should be a finite positive integer.");var n=s9.getPointerArray(r);this.forward=new n(r),this.backward=new n(r),this.K=typeof t=="function"?new t(r):new Array(r),this.V=typeof e=="function"?new e(r):new Array(r),this.size=0,this.head=0,this.tail=0,this.items={}}Ct.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};Ct.prototype.splayOnTop=function(t){var e=this.head;if(this.head===t)return this;var r=this.backward[t],n=this.forward[t];return this.tail===t?this.tail=r:this.backward[n]=r,this.forward[r]=n,this.backward[e]=t,this.head=t,this.forward[t]=e,this};Ct.prototype.set=function(t,e){var r=this.items[t];if(typeof r<"u"){this.splayOnTop(r),this.V[r]=e;return}this.size<this.capacity?r=this.size++:(r=this.tail,this.tail=this.backward[r],delete this.items[this.K[r]]),this.items[t]=r,this.K[r]=t,this.V[r]=e,this.forward[r]=this.head,this.backward[this.head]=r,this.head=r};Ct.prototype.setpop=function(t,e){var r=null,n=null,s=this.items[t];return typeof s<"u"?(this.splayOnTop(s),r=this.V[s],this.V[s]=e,{evicted:!1,key:t,value:r}):(this.size<this.capacity?s=this.size++:(s=this.tail,this.tail=this.backward[s],r=this.V[s],n=this.K[s],delete this.items[this.K[s]]),this.items[t]=s,this.K[s]=t,this.V[s]=e,this.forward[s]=this.head,this.backward[this.head]=s,this.head=s,n?{evicted:!0,key:n,value:r}:null)};Ct.prototype.has=function(t){return t in this.items};Ct.prototype.get=function(t){var e=this.items[t];if(!(typeof e>"u"))return this.splayOnTop(e),this.V[e]};Ct.prototype.peek=function(t){var e=this.items[t];if(!(typeof e>"u"))return this.V[e]};Ct.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var r=0,n=this.size,s=this.head,i=this.K,o=this.V,a=this.forward;r<n;)t.call(e,o[s],i[s],this),s=a[s],r++};Ct.prototype.keys=function(){var t=0,e=this.size,r=this.head,n=this.K,s=this.forward;return new Ay(function(){if(t>=e)return{done:!0};var i=n[r];return t++,t<e&&(r=s[r]),{done:!1,value:i}})};Ct.prototype.values=function(){var t=0,e=this.size,r=this.head,n=this.V,s=this.forward;return new Ay(function(){if(t>=e)return{done:!0};var i=n[r];return t++,t<e&&(r=s[r]),{done:!1,value:i}})};Ct.prototype.entries=function(){var t=0,e=this.size,r=this.head,n=this.K,s=this.V,i=this.forward;return new Ay(function(){if(t>=e)return{done:!0};var o=n[r],a=s[r];return t++,t<e&&(r=i[r]),{done:!1,value:[o,a]}})};typeof Symbol<"u"&&(Ct.prototype[Symbol.iterator]=Ct.prototype.entries);Ct.prototype.inspect=function(){for(var t=new Map,e=this.entries(),r;r=e.next(),!r.done;)t.set(r.value[0],r.value[1]);return Object.defineProperty(t,"constructor",{value:Ct,enumerable:!1}),t};typeof Symbol<"u"&&(Ct.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ct.prototype.inspect);Ct.from=function(t,e,r,n){if(arguments.length<2){if(n=i9.guessLength(t),typeof n!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(n=e,e=null,r=null);var s=new Ct(e,r,n);return n9(t,function(i,o){s.set(o,i)}),s};fB.exports=Ct});var hB=h((_Be,$c)=>{"use strict";var o9=gB(),a9=/^[!#$%&'*+\-.^\w`|~]+$/u;function c9(t){if(a9.test(t)===!1)throw new TypeError("Fieldname contains invalid characters.")}function pB(t){t=t.trim().toLowerCase();let e=[];if(t.length!==0)if(t.indexOf(",")===-1)e.push(t);else{let r=t.length,n=0,s=0,i;for(n=0;n<r;++n)i=t[n],i===" "?s=n+1:i===","&&(s!==n&&e.push(t.slice(s,n)),s=n+1);s!==n&&e.push(t.slice(s,n))}return e}function Ry(t){let e=new o9(1e3);return c9(t),function(r){let n=r.getHeader("Vary");if(!n){r.header("Vary",t);return}if(n==="*")return;if(t==="*"){r.header("Vary","*");return}if(Array.isArray(n)&&(n=n.join(", ")),!e.has(n)){let i=pB(n);i.indexOf("*")!==-1?e.set(n,"*"):i.indexOf(t.toLowerCase())===-1?e.set(n,n+", "+t):e.set(n,null)}let s=e.get(n);s!==null&&r.header("Vary",s)}}$c.exports.createAddFieldnameToVary=Ry;$c.exports.addOriginToVaryHeader=Ry("Origin");$c.exports.addAccessControlRequestHeadersToVaryHeader=Ry("Access-Control-Request-Headers");$c.exports.parse=pB});var CB=h((ABe,Qd)=>{"use strict";var l9=nB(),{addAccessControlRequestHeadersToVaryHeader:u9,addOriginToVaryHeader:d9}=hB(),wy={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",hook:"onRequest",preflightContinue:!1,optionsSuccessStatus:204,credentials:!1,exposedHeaders:null,allowedHeaders:null,maxAge:null,preflight:!0,strictPreflight:!0},f9=["onRequest","preParsing","preValidation","preHandler","preSerialization","onSend"],Ey=["preSerialization","preParsing","onSend"];function IB(t,e){f9.indexOf(t)===-1&&e(new TypeError("@fastify/cors: Invalid hook option provided."))}function g9(t,e,r){t.decorateRequest("corsPreflightEnabled",!1);let n=!0;if(typeof e=="function")mB(e,t,{hook:wy.hook},r);else if(e.delegator){let{delegator:s,...i}=e;mB(s,t,i,r)}else{e.hideOptionsRoute!==void 0&&(n=e.hideOptionsRoute);let s=Jd(e);IB(s.hook,r),Ey.indexOf(s.hook)!==-1?t.addHook(s.hook,function(o,a,c,l){jc(t,s,o,a,l)}):t.addHook(s.hook,function(o,a,c){jc(t,s,o,a,c)})}t.options("*",{schema:{hide:n}},(s,i)=>{if(!s.corsPreflightEnabled){i.callNotFound();return}i.send()}),r()}function mB(t,e,r,n){let s=r&&r.hook||wy.hook;IB(s,n),t.length===2?Ey.indexOf(s)!==-1?e.addHook(s,function(o,a,c,l){yB(t,e,o,a,l)}):e.addHook(s,function(o,a,c){yB(t,e,o,a,c)}):Ey.indexOf(s)!==-1?e.addHook(s,function(o,a,c,l){let u=t(o);if(u&&typeof u.then=="function"){u.then(d=>jc(e,Jd(d),o,a,l)).catch(l);return}l(new Error("Invalid CORS origin option"))}):e.addHook(s,function(o,a,c){let l=t(o);if(l&&typeof l.then=="function"){l.then(u=>jc(e,Jd(u),o,a,c)).catch(c);return}c(new Error("Invalid CORS origin option"))})}function yB(t,e,r,n,s){t(r,(i,o)=>{i?s(i):jc(e,Jd(o),r,n,s)})}function Jd(t){let e={...wy,...t};return Array.isArray(t.origin)&&t.origin.indexOf("*")!==-1&&(e.origin="*"),Number.isInteger(e.cacheControl)?e.cacheControl=`max-age=${e.cacheControl}`:typeof e.cacheControl!="string"&&(e.cacheControl=null),e}function jc(t,e,r,n,s){d9(n),(typeof e.origin=="function"?m9(t,e.origin):(o,a)=>a(null,e.origin))(r,(o,a)=>{if(o!==null)return s(o);if(a===!1)return s();if(!a)return s(new Error("Invalid CORS origin option"));if(p9(r,n,a,e),r.raw.method==="OPTIONS"&&e.preflight===!0){if(e.strictPreflight===!0&&(!r.headers.origin||!r.headers["access-control-request-method"])){n.status(400).type("text/plain").send("Invalid Preflight Request");return}if(r.corsPreflightEnabled=!0,h9(r,n,e),!e.preflightContinue){n.code(e.optionsSuccessStatus).header("Content-Length","0").send();return}}return s()})}function p9(t,e,r,n){let s=y9(t.headers.origin,r);s&&e.header("Access-Control-Allow-Origin",s),n.credentials&&e.header("Access-Control-Allow-Credentials","true"),n.exposedHeaders!==null&&e.header("Access-Control-Expose-Headers",Array.isArray(n.exposedHeaders)?n.exposedHeaders.join(", "):n.exposedHeaders)}function h9(t,e,r){if(e.header("Access-Control-Allow-Methods",Array.isArray(r.methods)?r.methods.join(", "):r.methods),r.allowedHeaders===null){u9(e);let n=t.headers["access-control-request-headers"];n!==void 0&&e.header("Access-Control-Allow-Headers",n)}else e.header("Access-Control-Allow-Headers",Array.isArray(r.allowedHeaders)?r.allowedHeaders.join(", "):r.allowedHeaders);r.maxAge!==null&&e.header("Access-Control-Max-Age",String(r.maxAge)),r.cacheControl&&e.header("Cache-Control",r.cacheControl)}function m9(t,e){return function(r,n){let s=e.call(t,r.headers.origin,n);s&&typeof s.then=="function"&&s.then(i=>n(null,i),n)}}function y9(t,e){return e==="*"?"*":typeof e=="string"?e:bB(t,e)?t:!1}function bB(t,e){if(Array.isArray(e)){for(let r=0;r<e.length;++r)if(bB(t,e[r]))return!0;return!1}else return typeof e=="string"?t===e:e instanceof RegExp?(e.lastIndex=0,e.test(t)):!!e}var By=l9(g9,{fastify:"4.x",name:"@fastify/cors"});Qd.exports=By;Qd.exports.fastifyCors=By;Qd.exports.default=By});var vB=h((RBe,SB)=>{"use strict";function I9(t){var e=new t,r=e;function n(){var i=e;return i.next?e=i.next:(e=new t,r=e),i.next=null,i}function s(i){r.next=i,r=i}return{get:n,release:s}}SB.exports=I9});var Gy=h((EBe,Ty)=>{"use strict";var b9=vB();function _B(t,e,r){if(typeof t=="function"&&(r=e,e=t,t=null),r<1)throw new Error("fastqueue concurrency must be greater than 1");var n=b9(C9),s=null,i=null,o=0,a=null,c={push:m,drain:Vr,saturated:Vr,pause:u,paused:!1,concurrency:r,running:l,resume:g,idle:p,length:d,getQueue:f,unshift:I,empty:Vr,kill:S,killAndDrain:b,error:y};return c;function l(){return o}function u(){c.paused=!0}function d(){for(var A=s,E=0;A;)A=A.next,E++;return E}function f(){for(var A=s,E=[];A;)E.push(A.value),A=A.next;return E}function g(){if(c.paused){c.paused=!1;for(var A=0;A<c.concurrency;A++)o++,C()}}function p(){return o===0&&c.length()===0}function m(A,E){var v=n.get();v.context=t,v.release=C,v.value=A,v.callback=E||Vr,v.errorHandler=a,o===c.concurrency||c.paused?i?(i.next=v,i=v):(s=v,i=v,c.saturated()):(o++,e.call(t,v.value,v.worked))}function I(A,E){var v=n.get();v.context=t,v.release=C,v.value=A,v.callback=E||Vr,o===c.concurrency||c.paused?s?(v.next=s,s=v):(s=v,i=v,c.saturated()):(o++,e.call(t,v.value,v.worked))}function C(A){A&&n.release(A);var E=s;E?c.paused?o--:(i===s&&(i=null),s=E.next,E.next=null,e.call(t,E.value,E.worked),i===null&&c.empty()):--o===0&&c.drain()}function S(){s=null,i=null,c.drain=Vr}function b(){s=null,i=null,c.drain(),c.drain=Vr}function y(A){a=A}}function Vr(){}function C9(){this.value=null,this.callback=Vr,this.next=null,this.release=Vr,this.context=null,this.errorHandler=null;var t=this;this.worked=function(r,n){var s=t.callback,i=t.errorHandler,o=t.value;t.value=null,t.callback=Vr,t.errorHandler&&i(r,o),s.call(t.context,r,n),t.release(t)}}function S9(t,e,r){typeof t=="function"&&(r=e,e=t,t=null);function n(u,d){e.call(this,u).then(function(f){d(null,f)},d)}var s=_B(t,n,r),i=s.push,o=s.unshift;return s.push=a,s.unshift=c,s.drained=l,s;function a(u){var d=new Promise(function(f,g){i(u,function(p,m){if(p){g(p);return}f(m)})});return d.catch(Vr),d}function c(u){var d=new Promise(function(f,g){o(u,function(p,m){if(p){g(p);return}f(m)})});return d.catch(Vr),d}function l(){if(s.idle())return new Promise(function(f){f()});var u=s.drain,d=new Promise(function(f){s.drain=function(){u(),f()}});return d}}Ty.exports=_B;Ty.exports.promise=S9});var Ny=h((wBe,AB)=>{"use strict";var{inherits:v9,format:Zy}=require("util");function Xi(t,e,r=Error){if(!t)throw new Error("Avvio error code must not be empty");if(!e)throw new Error("Avvio base error message must not be empty");function n(s,i,o){if(!new.target)return new n(s,i,o);Error.captureStackTrace(this,n),this.code=t,this.message=e,this.name="AvvioError",s&&i&&o?this.message=Zy(e,s,i,o):s&&i?this.message=Zy(e,s,i):s?this.message=Zy(e,s):this.message=e}return n.prototype[Symbol.toStringTag]="Error",n.prototype.toString=function(){return`${this.name} [${this.code}]: ${this.message}`},v9(n,r),n}AB.exports={createError:Xi,AVV_ERR_EXPOSE_ALREADY_DEFINED:Xi("AVV_ERR_EXPOSE_ALREADY_DEFINED","'%s' () is already defined, specify an expose option"),AVV_ERR_CALLBACK_NOT_FN:Xi("AVV_ERR_CALLBACK_NOT_FN","Callback for '%s' hook is not a function. Received: '%s'"),AVV_ERR_PLUGIN_NOT_VALID:Xi("AVV_ERR_PLUGIN_NOT_VALID","Plugin must be a function or a promise. Received: '%s'"),AVV_ERR_ROOT_PLG_BOOTED:Xi("AVV_ERR_PLUGIN_NOT_VALID","Root plugin has already booted"),AVV_ERR_PARENT_PLG_LOADED:Xi("AVV_ERR_PARENT_PLG_LOADED","Impossible to load '%s' plugin because the parent '%s' was already loaded"),AVV_ERR_READY_TIMEOUT:Xi("AVV_ERR_READY_TIMEOUT","Plugin did not start in time: '%s'. You may have forgotten to call 'done' function or to resolve a Promise")}});var EB=h((BBe,RB)=>{RB.exports=function t(e,r,n){r===void 0&&(r=""),n||(n={});var s=function(c){var l={"\u2502":"|","\u2514":"`","\u251C":"+","\u2500":"-","\u252C":"-"};return n.unicode===!1?l[c]:c};typeof e=="string"&&(e={label:e});var i=e.nodes||[],o=(e.label||"").split(`
`),a=`
`+r+(i.length?s("\u2502"):" ")+" ";return r+o.join(a)+`
`+i.map(function(c,l){var u=l===i.length-1,d=c.nodes&&c.nodes.length,f=r+(u?" ":s("\u2502"))+" ";return r+s(u?"\u2514":"\u251C")+s("\u2500")+s(d?"\u252C":"\u2500")+" "+t(c,f,n).slice(r.length+2)}).join("")}});var NB=h((TBe,ZB)=>{"use strict";var _9=EB(),wB=Symbol("avvio.TimeTree.untrackNode"),Vy=Symbol("avvio.TimeTree.trackNode"),BB=Symbol("avvio.TimeTree.getParent"),TB=Symbol("avvio.TimeTree.getNode"),GB=Symbol("avvio.TimeTree.addNode"),Hy=class{constructor(){this.root=null,this.tableId=new Map,this.tableLabel=new Map}[Vy](e){this.tableId.set(e.id,e),this.tableLabel.has(e.label)?this.tableLabel.get(e.label).push(e):this.tableLabel.set(e.label,[e])}[wB](e){this.tableId.delete(e.id);let r=this.tableLabel.get(e.label);if(r.id){this.tableLabel.delete(e.label);return}r.pop(),r.length===0&&this.tableLabel.delete(e.label)}[BB](e){if(e===null)return this.root;let r=this.tableLabel.get(e);return r.id?r:r[r.length-1]}[TB](e){return this.tableId.get(e)}[GB](e,r,n){if(e===null)return this.root={id:"root",label:r,start:n,nodes:[]},this[Vy](this.root),this.root.id;let i=this[BB](e),o=`${r}-${Math.random()}`,a={id:o,parent:e,start:n,label:r,nodes:[]};return i.nodes.push(a),this[Vy](a),o}start(e,r,n=Date.now()){return this[GB](e,r,n)}stop(e,r=Date.now()){let n=this[TB](e);n&&(n.stop=r,n.diff=n.stop-n.start||0,this[wB](n))}toJSON(){return Object.assign({},this.root)}prittyPrint(){let e=n=>(n.label=`${n.label} ${n.diff} ms`,n.nodes.length>0&&(n.nodes=n.nodes.map(s=>e(s))),n),r=e(this.toJSON());return _9(r)}};ZB.exports=Hy});var HB=h((GBe,VB)=>{var Mo=1e3,Ko=Mo*60,zo=Ko*60,$i=zo*24,A9=$i*7,R9=$i*365.25;VB.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return E9(t);if(r==="number"&&isFinite(t))return e.long?B9(t):w9(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function E9(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*R9;case"weeks":case"week":case"w":return r*A9;case"days":case"day":case"d":return r*$i;case"hours":case"hour":case"hrs":case"hr":case"h":return r*zo;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ko;case"seconds":case"second":case"secs":case"sec":case"s":return r*Mo;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function w9(t){var e=Math.abs(t);return e>=$i?Math.round(t/$i)+"d":e>=zo?Math.round(t/zo)+"h":e>=Ko?Math.round(t/Ko)+"m":e>=Mo?Math.round(t/Mo)+"s":t+"ms"}function B9(t){var e=Math.abs(t);return e>=$i?ef(t,e,$i,"day"):e>=zo?ef(t,e,zo,"hour"):e>=Ko?ef(t,e,Ko,"minute"):e>=Mo?ef(t,e,Mo,"second"):t+" ms"}function ef(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}});var Wy=h((ZBe,WB)=>{function T9(t){r.debug=r,r.default=r,r.coerce=c,r.disable=i,r.enable=s,r.enabled=o,r.humanize=HB(),r.destroy=l,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let d=0;for(let f=0;f<u.length;f++)d=(d<<5)-d+u.charCodeAt(f),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=e;function r(u){let d,f=null,g,p;function m(...I){if(!m.enabled)return;let C=m,S=Number(new Date),b=S-(d||S);C.diff=b,C.prev=d,C.curr=S,d=S,I[0]=r.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let y=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(E,v)=>{if(E==="%%")return"%";y++;let B=r.formatters[v];if(typeof B=="function"){let H=I[y];E=B.call(C,H),I.splice(y,1),y--}return E}),r.formatArgs.call(C,I),(C.log||r.log).apply(C,I)}return m.namespace=u,m.useColors=r.useColors(),m.color=r.selectColor(u),m.extend=n,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(g!==r.namespaces&&(g=r.namespaces,p=r.enabled(u)),p),set:I=>{f=I}}),typeof r.init=="function"&&r.init(m),m}function n(u,d){let f=r(this.namespace+(typeof d>"u"?":":d)+u);return f.log=this.log,f}function s(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let d,f=(typeof u=="string"?u:"").split(/[\s,]+/),g=f.length;for(d=0;d<g;d++)f[d]&&(u=f[d].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function i(){let u=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let d,f;for(d=0,f=r.skips.length;d<f;d++)if(r.skips[d].test(u))return!1;for(d=0,f=r.names.length;d<f;d++)if(r.names[d].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}WB.exports=T9});var OB=h((Ar,tf)=>{Ar.formatArgs=Z9;Ar.save=N9;Ar.load=V9;Ar.useColors=G9;Ar.storage=H9();Ar.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ar.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function G9(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Z9(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+tf.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),t.splice(n,0,e)}Ar.log=console.debug||console.log||(()=>{});function N9(t){try{t?Ar.storage.setItem("debug",t):Ar.storage.removeItem("debug")}catch{}}function V9(){let t;try{t=Ar.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function H9(){try{return localStorage}catch{}}tf.exports=Wy()(Ar);var{formatters:W9}=tf.exports;W9.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var kB=h((NBe,PB)=>{"use strict";PB.exports=(t,e)=>{e=e||process.argv;let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),s=e.indexOf("--");return n!==-1&&(s===-1?!0:n<s)}});var xB=h((VBe,FB)=>{"use strict";var O9=require("os"),en=kB(),Ut=process.env,Jo;en("no-color")||en("no-colors")||en("color=false")?Jo=!1:(en("color")||en("colors")||en("color=true")||en("color=always"))&&(Jo=!0);"FORCE_COLOR"in Ut&&(Jo=Ut.FORCE_COLOR.length===0||parseInt(Ut.FORCE_COLOR,10)!==0);function P9(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function k9(t){if(Jo===!1)return 0;if(en("color=16m")||en("color=full")||en("color=truecolor"))return 3;if(en("color=256"))return 2;if(t&&!t.isTTY&&Jo!==!0)return 0;let e=Jo?1:0;if(process.platform==="win32"){let r=O9.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in Ut)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in Ut)||Ut.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in Ut)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Ut.TEAMCITY_VERSION)?1:0;if(Ut.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Ut){let r=parseInt((Ut.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Ut.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Ut.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Ut.TERM)||"COLORTERM"in Ut?1:(Ut.TERM==="dumb",e)}function Oy(t){let e=k9(t);return P9(e)}FB.exports={supportsColor:Oy,stdout:Oy(process.stdout),stderr:Oy(process.stderr)}});var UB=h((Wt,nf)=>{var F9=require("tty"),rf=require("util");Wt.init=$9;Wt.log=Y9;Wt.formatArgs=L9;Wt.save=D9;Wt.load=X9;Wt.useColors=x9;Wt.destroy=rf.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Wt.colors=[6,2,3,4,5,1];try{let t=xB();t&&(t.stderr||t).level>=2&&(Wt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Wt.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(s,i)=>i.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function x9(){return"colors"in Wt.inspectOpts?!!Wt.inspectOpts.colors:F9.isatty(process.stderr.fd)}function L9(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,s="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${s};1m${e} \x1B[0m`;t[0]=i+t[0].split(`
`).join(`
`+i),t.push(s+"m+"+nf.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=U9()+e+" "+t[0]}function U9(){return Wt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Y9(...t){return process.stderr.write(rf.format(...t)+`
`)}function D9(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function X9(){return process.env.DEBUG}function $9(t){t.inspectOpts={};let e=Object.keys(Wt.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Wt.inspectOpts[e[r]]}nf.exports=Wy()(Wt);var{formatters:LB}=nf.exports;LB.o=function(t){return this.inspectOpts.colors=this.useColors,rf.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};LB.O=function(t){return this.inspectOpts.colors=this.useColors,rf.inspect(t,this.inspectOpts)}});var ky=h((HBe,Py)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Py.exports=OB():Py.exports=UB()});var YB=h((WBe,Ly)=>{"use strict";var j9=Gy(),q9=require("events").EventEmitter,M9=require("util").inherits,wt=ky()("avvio"),{AVV_ERR_READY_TIMEOUT:K9}=Ny(),Fy=Symbol.for("plugin-meta");function z9(t,e){return t[Fy]&&t[Fy].name?t[Fy].name:typeof e<"u"&&typeof e!="function"&&e.name?e.name:t.name?t.name:t.toString().split(`
`).slice(0,2).map(r=>r.trim()).join(" -- ")}function J9(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}function Qo(t,e,r,n,s){this.started=!1,this.func=e,this.opts=r,this.onFinish=null,this.parent=t,this.timeout=s===void 0?t._timeout:s,this.name=z9(e,r),this.isAfter=n,this.q=j9(t,Q9,1),this.q.pause(),this._error=null,this.loaded=!1,this._promise=null}M9(Qo,q9);Qo.prototype.exec=function(t,e){let r=this.func,n=!1,s=this.name;if(this.parent._error&&!this.isAfter){wt("skipping loading of plugin as parent errored and it is not an after",s),process.nextTick(e);return}if(this.isAfter)this.server=t;else try{this.server=this.parent.override(t,r,this.opts)}catch(c){return wt("override errored",s),e(c)}this.opts=typeof this.opts=="function"?this.opts(this.server):this.opts,wt("exec",s);let i,o=c=>{if(n){wt("loading complete",s);return}this._error=c,wt(c?"exec errored":"exec completed",s),n=!0,i&&clearTimeout(i),e(c)};this.timeout>0&&(wt("setting up timeout",s,this.timeout),i=setTimeout(function(){wt("timed out",s),i=null;let c=new K9(s);c.fn=r,o(c)},this.timeout)),this.started=!0,this.emit("start",this.server?this.server.name:null,this.name,Date.now());let a=r(this.server,this.opts,o);a&&typeof a.then=="function"&&(wt("exec: resolving promise",s),a.then(()=>process.nextTick(o),c=>process.nextTick(o,c)))};Qo.prototype.loadedSoFar=function(){if(this.loaded)return Promise.resolve();let t=()=>{this.server.after((r,n)=>{this._error=r,this.q.pause(),r?(wt("rejecting promise",this.name,r),this._promise.reject(r)):(wt("resolving promise",this.name),this._promise.resolve()),this._promise=null,process.nextTick(n,r)}),this.q.resume()},e;return this._promise?e=Promise.resolve():(this._promise=J9(),e=this._promise.promise,this.server?t():this.on("start",t)),e};Qo.prototype.enqueue=function(t,e){wt("enqueue",this.name,t.name),this.emit("enqueue",this.server?this.server.name:null,this.name,Date.now()),this.q.push(t,e)};Qo.prototype.finish=function(t,e){wt("finish",this.name,t);let r=()=>{this.loaded||(wt("loaded",this.name),this.emit("loaded",this.server?this.server.name:null,this.name,Date.now()),this.loaded=!0,e(t))};if(t){this._promise&&(this._promise.reject(t),this._promise=null),r();return}let n=()=>{if(wt("check",this.name,this.q.length(),this.q.running(),this._promise),this.q.length()===0&&this.q.running()===0)if(this._promise){let s=()=>{wt("wrap"),queueMicrotask(n)};this._promise.resolve(),this._promise.promise.then(s,s),this._promise=null}else r();else wt("delayed",this.name),this.q.drain=()=>{wt("drain",this.name),this.q.drain=eM,queueMicrotask(n)}};queueMicrotask(n),this.q.resume()};function Q9(t,e){let r=this;process.nextTick(xy.bind(r),t,e)}function xy(t,e){if(typeof t.func.then=="function"){t.func.then(n=>{typeof n.default=="function"&&(n=n.default),t.func=n,xy.call(this,t,e)},e);return}let r=this._current[0];this._current.unshift(t),t.exec(r&&r.server||this._server,n=>{t.finish(n,s=>{this._current.shift(),e(s)})})}function eM(){}Ly.exports=Qo;Ly.exports.loadPlugin=xy});var qB=h((OBe,$y)=>{"use strict";var DB=Gy(),tM=require("events").EventEmitter,rM=require("util").inherits,{AVV_ERR_EXPOSE_ALREADY_DEFINED:Uy,AVV_ERR_CALLBACK_NOT_FN:qc,AVV_ERR_PLUGIN_NOT_VALID:nM,AVV_ERR_ROOT_PLG_BOOTED:sM,AVV_ERR_READY_TIMEOUT:iM}=Ny(),oM=NB(),Xy=YB(),ea=ky()("avvio"),sf=Symbol("kAvvio"),Yy=Symbol("kThenifyDoNotWrap");function aM(t,e,r){let n=e.expose||{},s=n.use||"use",i=n.after||"after",o=n.ready||"ready",a=n.onClose||"onClose",c=n.close||"close";if(t[s])throw new Uy(s);if(t[i])throw new Uy(i);if(t[o])throw new Uy(o);t[s]=function(l,u){return r.use(l,u),this},Object.defineProperty(t,"then",{get:$B.bind(r)}),t[sf]=!0,t[i]=function(l){return typeof l!="function"?r._loadRegistered():(r.after(Dy(l,this)),this)},t[o]=function(l){if(l&&typeof l!="function")throw new qc(o,typeof l);return r.ready(l?Dy(l,this):void 0)},t[a]=function(l){if(typeof l!="function")throw new qc(a,typeof l);return r.onClose(fM(l,this)),this},t[c]=function(l){if(l&&typeof l!="function")throw new qc(c,typeof l);return l?(r.close(Dy(l,this)),this):r.close()}}function Bt(t,e,r){if(typeof t=="function"&&arguments.length===1&&(r=t,e={},t=null),typeof e=="function"&&(r=e,e={}),e=e||{},!(this instanceof Bt)){let n=new Bt(t,e,r);return t&&aM(t,e,n),n}e.autostart!==!1&&(e.autostart=!0),t=t||this,this._timeout=Number(e.timeout)||0,this._server=t,this._current=[],this._error=null,this._isOnCloseHandlerKey=Symbol("isOnCloseHandler"),this._lastUsed=null,this.setMaxListeners(0),r&&this.once("start",r),this.started=!1,this.booted=!1,this.pluginTree=new oM,this._readyQ=DB(this,jB,1),this._readyQ.pause(),this._readyQ.drain=()=>{this.emit("start"),this._readyQ.drain=XB},this._closeQ=DB(this,dM,1),this._closeQ.pause(),this._closeQ.drain=()=>{this.emit("close"),this._closeQ.drain=XB},this._doStart=null,this._root=new Xy(this,cM.bind(this),e,!1,0),this._root.once("start",(n,s,i)=>{let o=this.pluginTree.start(null,s,i);this._root.once("loaded",(a,c,l)=>{this.pluginTree.stop(o,l)})}),Xy.loadPlugin.call(this,this._root,n=>{ea("root plugin ready");try{this.emit("preReady"),this._root=null}catch(s){n=n||this._error||s}if(n){if(this._error=n,this._readyQ.length()===0)throw n}else this.booted=!0;this._readyQ.resume()})}function cM(t,e,r){this._doStart=r,e.autostart&&this.start()}rM(Bt,tM);Bt.prototype.start=function(){return this.started=!0,process.nextTick(this._doStart),this};Bt.prototype.override=function(t,e,r){return t};function lM(t){if(t&&typeof t=="object"&&typeof t.default=="function"&&(t=t.default),!(t&&(typeof t=="function"||typeof t.then=="function")))throw new nM(typeof t);return t}Bt.prototype[sf]=!0;Bt.prototype.use=function(t,e){return this._lastUsed=this._addPlugin(t,e,!1),this};Bt.prototype._loadRegistered=function(){let t=this._current[0];return!this.started&&!this.booted&&process.nextTick(()=>this._root.q.resume()),t?t.loadedSoFar():Promise.resolve()};Object.defineProperty(Bt.prototype,"then",{get:$B});Bt.prototype._addPlugin=function(t,e,r){if(t=lM(t),e=e||{},this.booted)throw new sM;let n=this._current[0],s=new Xy(this,t,e,r);if(s.once("start",(i,o,a)=>{let c=this.pluginTree.start(n.name,o,a);s.once("loaded",(l,u,d)=>{this.pluginTree.stop(c,d)})}),n.loaded)throw new Error(s.name,n.name);return n.enqueue(s,i=>{i&&(this._error=i)}),s};Bt.prototype.after=function(t){if(!t)return this._loadRegistered();this._addPlugin(e.bind(this),{},!0);function e(r,n,s){jB.call(this,t,s)}return this};Bt.prototype.onClose=function(t){if(typeof t!="function")throw new Error("not a function");t[this._isOnCloseHandlerKey]=!0,this._closeQ.unshift(t,e.bind(this));function e(r){r&&(this._error=r)}return this};Bt.prototype.close=function(t){let e;if(t){if(typeof t!="function")throw new qc("close",typeof t)}else e=new Promise(function(r,n){t=function(s){if(s)return n(s);r()}});return this.ready(()=>{this._error=null,this._closeQ.push(t),process.nextTick(this._closeQ.resume.bind(this._closeQ))}),e};Bt.prototype.ready=function(t){if(t){if(typeof t!="function")throw new qc("ready",typeof t);this._readyQ.push(t),queueMicrotask(this.start.bind(this));return}return new Promise((e,r)=>{this._readyQ.push(s),this.start();let n=this._current[0].server;function s(i,o,a){i?r(i):e(n),process.nextTick(a)}})};Bt.prototype.prettyPrint=function(){return this.pluginTree.prittyPrint()};Bt.prototype.toJSON=function(){return this.pluginTree.toJSON()};function XB(){}function $B(){if(this.booted){ea("thenify returning null because we are already booted");return}if(this[Yy]){this[Yy]=!1;return}return ea("thenify"),(t,e)=>this._loadRegistered().then(()=>(this[Yy]=!0,t(this._server)),e)}function jB(t,e){let r=this._server,n=this._error,s;if(this._error=null,t.length===0)this._error=n,s=t(),s&&!s[sf]&&typeof s.then=="function"?s.then(()=>process.nextTick(e),i=>process.nextTick(e,i)):process.nextTick(e);else if(t.length===1)s=t(n),s&&!s[sf]&&typeof s.then=="function"?s.then(()=>process.nextTick(e),i=>process.nextTick(e,i)):process.nextTick(e);else if(this._timeout===0){let i=o=>{this._error=o,e(this._error)};t.length===2?t(n,i):t(n,r,i)}else uM.call(this,t,n,r,e)}function uM(t,e,r,n){let s=t.name;ea("setting up ready timeout",s,this._timeout);let i=setTimeout(()=>{ea("timed out",s),i=null;let a=new iM(s);a.fn=t,this._error=a,n(a)},this._timeout);t.length===2?t(e,o.bind(this)):t(e,r,o.bind(this));function o(a){i&&(clearTimeout(i),this._error=a,n(this._error))}}function dM(t,e){let r=this._server,n=t[this._isOnCloseHandlerKey];if(t.length===0||t.length===1){let s;n?s=t(r):s=t(this._error),s&&typeof s.then=="function"?(ea("resolving close/onClose promise"),s.then(()=>process.nextTick(e),i=>process.nextTick(e,i))):process.nextTick(e)}else t.length===2?t(n?r:this._error,e):n?t(r,e):t(this._error,r,e)}function fM(t,e){return r.bind(e);function r(n,s){let i;t.length===0?(i=t(),i&&i.then?i.then(function(){process.nextTick(s)},s):process.nextTick(s)):t.length===1?(i=t(this),i&&i.then?i.then(function(){process.nextTick(s)},s):process.nextTick(s)):t(this,s)}}function Dy(t,e){return r.bind(e);function r(n,s){let i;t?t.length===0?(i=t(),i&&i.then?i.then(function(){process.nextTick(s,n)},s):process.nextTick(s,n)):t.length===1?(i=t(n),i&&i.then?i.then(function(){process.nextTick(s)},s):process.nextTick(s)):t.length===2?t(n,s):t(n,this,s):process.nextTick(s)}}$y.exports=Bt;$y.exports.express=function(t){return Bt(t,{expose:{use:"load"}})}});var Tt=h((PBe,MB)=>{"use strict";var gM={kAvvioBoot:Symbol("fastify.avvioBoot"),kChildren:Symbol("fastify.children"),kServerBindings:Symbol("fastify.serverBindings"),kBodyLimit:Symbol("fastify.bodyLimit"),kRoutePrefix:Symbol("fastify.routePrefix"),kLogLevel:Symbol("fastify.logLevel"),kLogSerializers:Symbol("fastify.logSerializers"),kHooks:Symbol("fastify.hooks"),kContentTypeParser:Symbol("fastify.contentTypeParser"),kState:Symbol("fastify.state"),kOptions:Symbol("fastify.options"),kDisableRequestLogging:Symbol("fastify.disableRequestLogging"),kPluginNameChain:Symbol("fastify.pluginNameChain"),kRouteContext:Symbol("fastify.context"),kPublicRouteContext:Symbol("fastify.routeOptions"),kSchemaController:Symbol("fastify.schemaController"),kSchemaHeaders:Symbol("headers-schema"),kSchemaParams:Symbol("params-schema"),kSchemaQuerystring:Symbol("querystring-schema"),kSchemaBody:Symbol("body-schema"),kSchemaResponse:Symbol("response-schema"),kSchemaErrorFormatter:Symbol("fastify.schemaErrorFormatter"),kSchemaVisited:Symbol("fastify.schemas.visited"),kRequest:Symbol("fastify.Request"),kRequestPayloadStream:Symbol("fastify.RequestPayloadStream"),kRequestAcceptVersion:Symbol("fastify.RequestAcceptVersion"),kRequestCacheValidateFns:Symbol("fastify.request.cache.validateFns"),kRequestOriginalUrl:Symbol("fastify.request.originalUrl"),kFourOhFour:Symbol("fastify.404"),kCanSetNotFoundHandler:Symbol("fastify.canSetNotFoundHandler"),kFourOhFourLevelInstance:Symbol("fastify.404LogLevelInstance"),kFourOhFourContext:Symbol("fastify.404ContextKey"),kDefaultJsonParse:Symbol("fastify.defaultJSONParse"),kReply:Symbol("fastify.Reply"),kReplySerializer:Symbol("fastify.reply.serializer"),kReplyIsError:Symbol("fastify.reply.isError"),kReplyHeaders:Symbol("fastify.reply.headers"),kReplyTrailers:Symbol("fastify.reply.trailers"),kReplyHasStatusCode:Symbol("fastify.reply.hasStatusCode"),kReplyHijacked:Symbol("fastify.reply.hijacked"),kReplyStartTime:Symbol("fastify.reply.startTime"),kReplyNextErrorHandler:Symbol("fastify.reply.nextErrorHandler"),kReplyEndTime:Symbol("fastify.reply.endTime"),kReplyErrorHandlerCalled:Symbol("fastify.reply.errorHandlerCalled"),kReplyIsRunningOnErrorHook:Symbol("fastify.reply.isRunningOnErrorHook"),kReplySerializerDefault:Symbol("fastify.replySerializerDefault"),kReplyCacheSerializeFns:Symbol("fastify.reply.cache.serializeFns"),kTestInternals:Symbol("fastify.testInternals"),kErrorHandler:Symbol("fastify.errorHandler"),kChildLoggerFactory:Symbol("fastify.childLoggerFactory"),kHasBeenDecorated:Symbol("fastify.hasBeenDecorated"),kKeepAliveConnections:Symbol("fastify.keepAliveConnections"),kRouteByFastify:Symbol("fastify.routeByFastify")};MB.exports=gM});var zB=h((kBe,of)=>{"use strict";var{format:jy}=require("node:util");function pM(t){return KB({...t,name:"DeprecationWarning"})}function KB({name:t,code:e,message:r,unlimited:n=!1}={}){if(!t)throw new Error("Warning name must not be empty");if(!e)throw new Error("Warning code must not be empty");if(!r)throw new Error("Warning message must not be empty");if(typeof n!="boolean")throw new Error("Warning opts.unlimited must be a boolean");e=e.toUpperCase();let s={[t]:function(o,a,c){i.emitted===!0&&i.unlimited!==!0||(i.emitted=!0,process.emitWarning(i.format(o,a,c),i.name,i.code))}};n&&(s={[t]:function(o,a,c){i.emitted=!0,process.emitWarning(i.format(o,a,c),i.name,i.code)}});let i=s[t];return i.emitted=!1,i.message=r,i.unlimited=n,i.code=e,i.format=function(o,a,c){let l;return o&&a&&c?l=jy(r,o,a,c):o&&a?l=jy(r,o,a):o?l=jy(r,o):l=r,l},i}var qy={createWarning:KB,createDeprecation:pM};of.exports=qy;of.exports.default=qy;of.exports.processWarning=qy});var is=h((FBe,QB)=>{"use strict";var{createDeprecation:er,createWarning:JB}=zB(),hM=er({code:"FSTDEP005",message:'You are accessing the deprecated "request.connection" property. Use "request.socket" instead.'}),mM=er({code:"FSTDEP006",message:"You are decorating Request/Reply with a reference type. This reference is shared amongst all requests. Use onRequest hook instead. Property: %s"}),yM=er({code:"FSTDEP007",message:'You are trying to set a HEAD route using "exposeHeadRoute" route flag when a sibling route is already set. See documentation for more info.'}),IM=er({code:"FSTDEP008",message:'You are using route constraints via the route { version: "..." } option, use { constraints: { version: "..." } } option instead.'}),bM=er({code:"FSTDEP009",message:'You are using a custom route versioning strategy via the server { versioning: "..." } option, use { constraints: { version: "..." } } option instead.'}),CM=er({code:"FSTDEP010",message:'Modifying the "reply.sent" property is deprecated. Use the "reply.hijack()" method instead.'}),SM=er({code:"FSTDEP011",message:'Variadic listen method is deprecated. Please use ".listen(optionsObject)" instead. The variadic signature will be removed in `fastify@5`.'}),vM=er({code:"FSTDEP012",message:'request.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "request.context" will be removed in `fastify@5`.'}),_M=er({code:"FSTDEP013",message:'Direct return of "trailers" function is deprecated. Please use "callback" or "async-await" for return value. The support of direct return will removed in `fastify@5`.'}),AM=er({code:"FSTDEP014",message:"You are trying to set/access the default route. This property is deprecated. Please, use setNotFoundHandler if you want to custom a 404 handler or the wildcard (*) to match all routes."}),RM=er({code:"FSTDEP015",message:'You are accessing the deprecated "request.routeSchema" property. Use "request.routeOptions.schema" instead. Property "req.routeSchema" will be removed in `fastify@5`.'}),EM=er({code:"FSTDEP016",message:'You are accessing the deprecated "request.routeConfig" property. Use "request.routeOptions.config" instead. Property "req.routeConfig" will be removed in `fastify@5`.'}),wM=er({code:"FSTDEP017",message:'You are accessing the deprecated "request.routerPath" property. Use "request.routeOptions.url" instead. Property "req.routerPath" will be removed in `fastify@5`.'}),BM=er({code:"FSTDEP018",message:'You are accessing the deprecated "request.routerMethod" property. Use "request.routeOptions.method" instead. Property "req.routerMethod" will be removed in `fastify@5`.'}),TM=er({code:"FSTDEP019",message:'reply.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "reply.context" will be removed in `fastify@5`.'}),GM=JB({name:"FastifyWarning",code:"FSTWRN001",message:"The %s schema for %s: %s is missing. This may indicate the schema is not well specified.",unlimited:!0}),ZM=JB({name:"FastifyWarning",code:"FSTWRN002",message:"The %s plugin being registered mixes async and callback styles, which will result in an error in `fastify@5`",unlimited:!0});QB.exports={FSTDEP005:hM,FSTDEP006:mM,FSTDEP007:yM,FSTDEP008:IM,FSTDEP009:bM,FSTDEP010:CM,FSTDEP011:SM,FSTDEP012:vM,FSTDEP013:_M,FSTDEP014:AM,FSTDEP015:RM,FSTDEP016:EM,FSTDEP017:wM,FSTDEP018:BM,FSTDEP019:TM,FSTWRN001:GM,FSTWRN002:ZM}});var eT=h((xBe,af)=>{"use strict";var{format:NM}=require("node:util");function VM(){return`${this.name} [${this.code}]: ${this.message}`}function My(t,e,r=500,n=Error){if(!t)throw new Error("Fastify error code must not be empty");if(!e)throw new Error("Fastify error message must not be empty");t=t.toUpperCase(),!r&&(r=void 0);function s(...i){if(!new.target)return new s(...i);this.code=t,this.name="FastifyError",this.statusCode=r;let o=i.length-1;o!==-1&&i[o]&&typeof i[o]=="object"&&"cause"in i[o]&&(this.cause=i.pop().cause),this.message=NM(e,...i),Error.stackTraceLimit!==0&&Error.captureStackTrace(this,s)}return s.prototype=Object.create(n.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),s.prototype[Symbol.toStringTag]="Error",s.prototype.toString=VM,s}af.exports=My;af.exports.default=My;af.exports.createError=My});var Yt=h((LBe,cf)=>{"use strict";var Y=eT(),ta={FST_ERR_NOT_FOUND:Y("FST_ERR_NOT_FOUND","Not Found",404),FST_ERR_OPTIONS_NOT_OBJ:Y("FST_ERR_OPTIONS_NOT_OBJ","Options must be an object",500,TypeError),FST_ERR_QSP_NOT_FN:Y("FST_ERR_QSP_NOT_FN","querystringParser option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:Y("FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN","schemaController.bucket option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:Y("FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN","schemaErrorFormatter option should be a non async function. Instead got '%s'.",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:Y("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ","ajv.customOptions option should be an object, instead got '%s'",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:Y("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR","ajv.plugins option should be an array, instead got '%s'",500,TypeError),FST_ERR_VERSION_CONSTRAINT_NOT_STR:Y("FST_ERR_VERSION_CONSTRAINT_NOT_STR","Version constraint should be a string.",500,TypeError),FST_ERR_VALIDATION:Y("FST_ERR_VALIDATION","%s",400),FST_ERR_LISTEN_OPTIONS_INVALID:Y("FST_ERR_LISTEN_OPTIONS_INVALID","Invalid listen options: '%s'",500,TypeError),FST_ERR_CTP_ALREADY_PRESENT:Y("FST_ERR_CTP_ALREADY_PRESENT","Content type parser '%s' already present."),FST_ERR_CTP_INVALID_TYPE:Y("FST_ERR_CTP_INVALID_TYPE","The content type should be a string or a RegExp",500,TypeError),FST_ERR_CTP_EMPTY_TYPE:Y("FST_ERR_CTP_EMPTY_TYPE","The content type cannot be an empty string",500,TypeError),FST_ERR_CTP_INVALID_HANDLER:Y("FST_ERR_CTP_INVALID_HANDLER","The content type handler should be a function",500,TypeError),FST_ERR_CTP_INVALID_PARSE_TYPE:Y("FST_ERR_CTP_INVALID_PARSE_TYPE","The body parser can only parse your data as 'string' or 'buffer', you asked '%s' which is not supported.",500,TypeError),FST_ERR_CTP_BODY_TOO_LARGE:Y("FST_ERR_CTP_BODY_TOO_LARGE","Request body is too large",413,RangeError),FST_ERR_CTP_INVALID_MEDIA_TYPE:Y("FST_ERR_CTP_INVALID_MEDIA_TYPE","Unsupported Media Type: %s",415),FST_ERR_CTP_INVALID_CONTENT_LENGTH:Y("FST_ERR_CTP_INVALID_CONTENT_LENGTH","Request body size did not match Content-Length",400,RangeError),FST_ERR_CTP_EMPTY_JSON_BODY:Y("FST_ERR_CTP_EMPTY_JSON_BODY","Body cannot be empty when content-type is set to 'application/json'",400),FST_ERR_CTP_INSTANCE_ALREADY_STARTED:Y("FST_ERR_CTP_INSTANCE_ALREADY_STARTED",'Cannot call "%s" when fastify instance is already started!',400),FST_ERR_DEC_ALREADY_PRESENT:Y("FST_ERR_DEC_ALREADY_PRESENT","The decorator '%s' has already been added!"),FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:Y("FST_ERR_DEC_DEPENDENCY_INVALID_TYPE","The dependencies of decorator '%s' must be of type Array.",500,TypeError),FST_ERR_DEC_MISSING_DEPENDENCY:Y("FST_ERR_DEC_MISSING_DEPENDENCY","The decorator is missing dependency '%s'."),FST_ERR_DEC_AFTER_START:Y("FST_ERR_DEC_AFTER_START","The decorator '%s' has been added after start!"),FST_ERR_HOOK_INVALID_TYPE:Y("FST_ERR_HOOK_INVALID_TYPE","The hook name must be a string",500,TypeError),FST_ERR_HOOK_INVALID_HANDLER:Y("FST_ERR_HOOK_INVALID_HANDLER","%s hook should be a function, instead got %s",500,TypeError),FST_ERR_HOOK_INVALID_ASYNC_HANDLER:Y("FST_ERR_HOOK_INVALID_ASYNC_HANDLER","Async function has too many arguments. Async hooks should not use the 'done' argument.",500,TypeError),FST_ERR_HOOK_NOT_SUPPORTED:Y("FST_ERR_HOOK_NOT_SUPPORTED","%s hook not supported!",500,TypeError),FST_ERR_MISSING_MIDDLEWARE:Y("FST_ERR_MISSING_MIDDLEWARE","You must register a plugin for handling middlewares, visit fastify.dev/docs/latest/Reference/Middleware/ for more info.",500),FST_ERR_HOOK_TIMEOUT:Y("FST_ERR_HOOK_TIMEOUT","A callback for '%s' hook timed out. You may have forgotten to call 'done' function or to resolve a Promise"),FST_ERR_LOG_INVALID_DESTINATION:Y("FST_ERR_LOG_INVALID_DESTINATION","Cannot specify both logger.stream and logger.file options"),FST_ERR_LOG_INVALID_LOGGER:Y("FST_ERR_LOG_INVALID_LOGGER","Invalid logger object provided. The logger instance should have these functions(s): '%s'.",500,TypeError),FST_ERR_REP_INVALID_PAYLOAD_TYPE:Y("FST_ERR_REP_INVALID_PAYLOAD_TYPE","Attempted to send payload of invalid type '%s'. Expected a string or Buffer.",500,TypeError),FST_ERR_REP_ALREADY_SENT:Y("FST_ERR_REP_ALREADY_SENT",'Reply was already sent, did you forget to "return reply" in "%s" (%s)?'),FST_ERR_REP_SENT_VALUE:Y("FST_ERR_REP_SENT_VALUE","The only possible value for reply.sent is true.",500,TypeError),FST_ERR_SEND_INSIDE_ONERR:Y("FST_ERR_SEND_INSIDE_ONERR","You cannot use `send` inside the `onError` hook"),FST_ERR_SEND_UNDEFINED_ERR:Y("FST_ERR_SEND_UNDEFINED_ERR","Undefined error has occurred"),FST_ERR_BAD_STATUS_CODE:Y("FST_ERR_BAD_STATUS_CODE","Called reply with an invalid status code: %s"),FST_ERR_BAD_TRAILER_NAME:Y("FST_ERR_BAD_TRAILER_NAME","Called reply.trailer with an invalid header name: %s"),FST_ERR_BAD_TRAILER_VALUE:Y("FST_ERR_BAD_TRAILER_VALUE","Called reply.trailer('%s', fn) with an invalid type: %s. Expected a function."),FST_ERR_FAILED_ERROR_SERIALIZATION:Y("FST_ERR_FAILED_ERROR_SERIALIZATION","Failed to serialize an error. Error: %s. Original error: %s"),FST_ERR_MISSING_SERIALIZATION_FN:Y("FST_ERR_MISSING_SERIALIZATION_FN",'Missing serialization function. Key "%s"'),FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:Y("FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN",'Missing serialization function. Key "%s:%s"'),FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:Y("FST_ERR_REQ_INVALID_VALIDATION_INVOCATION",'Invalid validation invocation. Missing validation function for HTTP part "%s" nor schema provided.'),FST_ERR_SCH_MISSING_ID:Y("FST_ERR_SCH_MISSING_ID","Missing schema $id property"),FST_ERR_SCH_ALREADY_PRESENT:Y("FST_ERR_SCH_ALREADY_PRESENT","Schema with id '%s' already declared!"),FST_ERR_SCH_CONTENT_MISSING_SCHEMA:Y("FST_ERR_SCH_CONTENT_MISSING_SCHEMA","Schema is missing for the content type '%s'"),FST_ERR_SCH_DUPLICATE:Y("FST_ERR_SCH_DUPLICATE","Schema with '%s' already present!"),FST_ERR_SCH_VALIDATION_BUILD:Y("FST_ERR_SCH_VALIDATION_BUILD","Failed building the validation schema for %s: %s, due to error %s"),FST_ERR_SCH_SERIALIZATION_BUILD:Y("FST_ERR_SCH_SERIALIZATION_BUILD","Failed building the serialization schema for %s: %s, due to error %s"),FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:Y("FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX",'response schemas should be nested under a valid status code, e.g { 2xx: { type: "object" } }'),FST_ERR_HTTP2_INVALID_VERSION:Y("FST_ERR_HTTP2_INVALID_VERSION","HTTP2 is available only from node >= 8.8.1"),FST_ERR_INIT_OPTS_INVALID:Y("FST_ERR_INIT_OPTS_INVALID","Invalid initialization options: '%s'"),FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:Y("FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE","Cannot set forceCloseConnections to 'idle' as your HTTP server does not support closeIdleConnections method"),FST_ERR_DUPLICATED_ROUTE:Y("FST_ERR_DUPLICATED_ROUTE","Method '%s' already declared for route '%s'"),FST_ERR_BAD_URL:Y("FST_ERR_BAD_URL","'%s' is not a valid url component",400,URIError),FST_ERR_ASYNC_CONSTRAINT:Y("FST_ERR_ASYNC_CONSTRAINT","Unexpected error from async constraint",500),FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:Y("FST_ERR_DEFAULT_ROUTE_INVALID_TYPE","The defaultRoute type should be a function",500,TypeError),FST_ERR_INVALID_URL:Y("FST_ERR_INVALID_URL","URL must be a string. Received '%s'",400,TypeError),FST_ERR_ROUTE_OPTIONS_NOT_OBJ:Y("FST_ERR_ROUTE_OPTIONS_NOT_OBJ",'Options for "%s:%s" route must be an object',500,TypeError),FST_ERR_ROUTE_DUPLICATED_HANDLER:Y("FST_ERR_ROUTE_DUPLICATED_HANDLER",'Duplicate handler for "%s:%s" route is not allowed!',500),FST_ERR_ROUTE_HANDLER_NOT_FN:Y("FST_ERR_ROUTE_HANDLER_NOT_FN","Error Handler for %s:%s route, if defined, must be a function",500,TypeError),FST_ERR_ROUTE_MISSING_HANDLER:Y("FST_ERR_ROUTE_MISSING_HANDLER",'Missing handler function for "%s:%s" route.',500),FST_ERR_ROUTE_METHOD_INVALID:Y("FST_ERR_ROUTE_METHOD_INVALID","Provided method is invalid!",500,TypeError),FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:Y("FST_ERR_ROUTE_METHOD_NOT_SUPPORTED","%s method is not supported.",500),FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:Y("FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED","Body validation schema for %s:%s route is not supported!",500),FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:Y("FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT","'bodyLimit' option must be an integer > 0. Got '%s'",500,TypeError),FST_ERR_ROUTE_REWRITE_NOT_STR:Y("FST_ERR_ROUTE_REWRITE_NOT_STR",'Rewrite url for "%s" needs to be of type "string" but received "%s"',500,TypeError),FST_ERR_REOPENED_CLOSE_SERVER:Y("FST_ERR_REOPENED_CLOSE_SERVER","Fastify has already been closed and cannot be reopened"),FST_ERR_REOPENED_SERVER:Y("FST_ERR_REOPENED_SERVER","Fastify is already listening"),FST_ERR_INSTANCE_ALREADY_LISTENING:Y("FST_ERR_INSTANCE_ALREADY_LISTENING","Fastify instance is already listening. %s"),FST_ERR_PLUGIN_VERSION_MISMATCH:Y("FST_ERR_PLUGIN_VERSION_MISMATCH","fastify-plugin: %s - expected '%s' fastify version, '%s' is installed"),FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:Y("FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE","The decorator '%s'%s is not present in %s"),FST_ERR_PLUGIN_CALLBACK_NOT_FN:Y("FST_ERR_PLUGIN_CALLBACK_NOT_FN","fastify-plugin: %s",500,TypeError),FST_ERR_PLUGIN_NOT_VALID:Y("FST_ERR_PLUGIN_NOT_VALID","fastify-plugin: %s"),FST_ERR_ROOT_PLG_BOOTED:Y("FST_ERR_ROOT_PLG_BOOTED","fastify-plugin: %s"),FST_ERR_PARENT_PLUGIN_BOOTED:Y("FST_ERR_PARENT_PLUGIN_BOOTED","fastify-plugin: %s"),FST_ERR_PLUGIN_TIMEOUT:Y("FST_ERR_PLUGIN_TIMEOUT","fastify-plugin: %s")};function HM(t,e){return e.cause=t,e}cf.exports=ta;cf.exports.appendStackTrace=HM;cf.exports.AVVIO_ERRORS_MAP={AVV_ERR_CALLBACK_NOT_FN:ta.FST_ERR_PLUGIN_CALLBACK_NOT_FN,AVV_ERR_PLUGIN_NOT_VALID:ta.FST_ERR_PLUGIN_NOT_VALID,AVV_ERR_ROOT_PLG_BOOTED:ta.FST_ERR_ROOT_PLG_BOOTED,AVV_ERR_PARENT_PLG_LOADED:ta.FST_ERR_PARENT_PLUGIN_BOOTED,AVV_ERR_READY_TIMEOUT:ta.FST_ERR_PLUGIN_TIMEOUT}});var js=h((UBe,lT)=>{"use strict";var WM=["onRoute","onRegister","onReady","onListen","preClose","onClose"],sT=["onTimeout","onRequest","preParsing","preValidation","preSerialization","preHandler","onSend","onResponse","onError","onRequestAbort"],OM=sT.concat(WM),{FST_ERR_HOOK_INVALID_TYPE:PM,FST_ERR_HOOK_INVALID_HANDLER:kM,FST_ERR_SEND_UNDEFINED_ERR:lf,FST_ERR_HOOK_TIMEOUT:FM,FST_ERR_HOOK_NOT_SUPPORTED:xM,AVVIO_ERRORS_MAP:tT,appendStackTrace:rT}=Yt(),{kChildren:Mc,kHooks:iT,kRequestPayloadStream:nT}=Tt();function Kc(){this.onRequest=[],this.preParsing=[],this.preValidation=[],this.preSerialization=[],this.preHandler=[],this.onResponse=[],this.onSend=[],this.onError=[],this.onRoute=[],this.onRegister=[],this.onReady=[],this.onListen=[],this.onTimeout=[],this.onRequestAbort=[],this.preClose=[]}Kc.prototype=Object.create(null);Kc.prototype.validate=function(t,e){if(typeof t!="string")throw new PM;if(Array.isArray(this[t])===!1)throw new xM(t);if(typeof e!="function")throw new kM(t,Object.prototype.toString.call(e))};Kc.prototype.add=function(t,e){this.validate(t,e),this[t].push(e)};function LM(t){let e=new Kc;return e.onRequest=t.onRequest.slice(),e.preParsing=t.preParsing.slice(),e.preValidation=t.preValidation.slice(),e.preSerialization=t.preSerialization.slice(),e.preHandler=t.preHandler.slice(),e.onSend=t.onSend.slice(),e.onResponse=t.onResponse.slice(),e.onError=t.onError.slice(),e.onRoute=t.onRoute.slice(),e.onRegister=t.onRegister.slice(),e.onTimeout=t.onTimeout.slice(),e.onRequestAbort=t.onRequestAbort.slice(),e.onReady=[],e.onListen=[],e.preClose=[],e}function oT(t,e,r,n){let s=r[iT][t],i=0,o=0;c();function a(u){if(u){u.code==="AVV_ERR_READY_TIMEOUT"?u=rT(u,new FM(t)):u=tT[u.code]!=null?rT(u,new tT[u.code](u.message)):u,n(u);return}n()}function c(u){if(u){a(u);return}if(i===s.length&&o===r[Mc].length){i===0&&o===0?a():e(function(f,g){a(f),g(f)});return}if(i===s.length&&o<r[Mc].length){let d=r[Mc][o++];oT(t,e,d,c);return}e(l(s[i++],r)),c()}function l(u,d){return function(f,g){if(f){g(f);return}if(u.length===1){try{u.call(d,g)}catch(p){g(p)}return}try{let p=u.call(d);if(p&&typeof p.then=="function"){p.then(g,g);return}}catch(p){f=p}g(f)}}}function aT(t){let e=t[iT].onListen,r=e.length;if(r===0)return;let n=0,s=0;i();function i(a){if(a&&t.log.error(a),n===r){if(s<t[Mc].length){let c=t[Mc][s++];aT(c)}return}o(e[n++],t,i)}async function o(a,c,l){if(a.length===1){try{a.call(c,l)}catch(u){l(u)}return}try{let u=a.call(c);if(u&&typeof u.then=="function"){u.then(l,l);return}l()}catch(u){l(u)}}}function ra(t){return function(r,n,s,i){let o=0;function a(u){if(u||o===r.length){i(u,n,s);return}let d;try{d=t(r[o++],n,s,a)}catch(f){i(f,n,s);return}d&&typeof d.then=="function"&&d.then(c,l)}function c(){a()}function l(u){u||(u=new lf),i(u,n,s)}a()}}function UM(t,e,r,n){return t(e,r,n)}var YM=ra(UM),DM=ra(zc),XM=ra(zc),$M=ra(zc),jM=ra(zc);function cT(t,e,r,n,s){let i=0;function o(l,u){if(l){s(l,e,r,n);return}if(u!==void 0&&(n=u),i===t.length){s(null,e,r,n);return}let d;try{d=t[i++](e,r,n,o)}catch(f){s(f,e,r);return}d&&typeof d.then=="function"&&d.then(a,c)}function a(l){o(null,l)}function c(l){l||(l=new lf),s(l,e,r,n)}o()}var qM=cT;function MM(t,e,r,n){let s=0;function i(c,l){if(r.sent)return;if(l!==void 0&&(e[nT]=l),c||s===t.length){n(c,e,r);return}let u;try{u=t[s++](e,r,e[nT],i)}catch(d){n(d,e,r);return}u&&typeof u.then=="function"&&u.then(o,a)}function o(c){i(null,c)}function a(c){c||(c=new lf),n(c,e,r)}i()}function KM(t,e,r){let n=0;function s(a){if(a||n===t.length){r(a,e);return}let c;try{c=t[n++](e,s)}catch(l){r(l,e);return}c&&typeof c.then=="function"&&c.then(i,o)}function i(){s()}function o(a){a||(a=new lf),r(a,e)}s()}function zc(t,e,r,n){if(r.sent!==!0)return t(e,r,n)}lT.exports={Hooks:Kc,buildHooks:LM,hookRunnerGenerator:ra,preParsingHookRunner:MM,onResponseHookRunner:YM,onSendHookRunner:cT,preSerializationHookRunner:qM,onRequestAbortHookRunner:KM,hookIterator:zc,hookRunnerApplication:oT,onListenHookRunner:aT,preHandlerHookRunner:XM,preValidationHookRunner:DM,onRequestHookRunner:jM,onTimeoutHookRunner:$M,lifecycleHooks:sT,supportedHooks:OM}});var bT=h((YBe,zy)=>{"use strict";var zM=require("node:http"),JM=require("node:https"),QM=require("node:dns"),{FSTDEP011:uT}=is(),{kState:Dt,kOptions:eK,kServerBindings:tK}=Tt(),{onListenHookRunner:uf}=js(),{FST_ERR_HTTP2_INVALID_VERSION:rK,FST_ERR_REOPENED_CLOSE_SERVER:gT,FST_ERR_REOPENED_SERVER:pT,FST_ERR_LISTEN_OPTIONS_INVALID:nK}=Yt();zy.exports.createServer=sK;zy.exports.compileValidateHTTPVersion=oK;function hT(t){return`Server listening at ${t}`}function sK(t,e){let r=yT(t,e);function n(s,...i){let o=i.slice(-1).pop(),a=Object.prototype.toString.call(arguments[0]);if(arguments.length===0)s=Ky([]);else if(arguments.length>0&&a!=="[object Object]"&&a!=="[object Function]")uT(),s=Ky(Array.from(arguments)),o=s.cb;else if(i.length>1){uT();let l=s.path?[s.path]:[s.port??0,s.host??"localhost"];Object.assign(s,Ky([...l,...i]))}else s.cb=o;if(s.signal){if(typeof s.signal.on!="function"&&typeof s.signal.addEventListener!="function")throw new nK("Invalid options.signal");if(s.signal.aborted)this.close();else{let l=()=>{this.close()};s.signal.addEventListener("abort",l,{once:!0})}}let c;if(s.path==null?c=s.host??"localhost":c=s.host,Object.prototype.hasOwnProperty.call(s,"host")===!1&&(s.host=c),c==="localhost"?s.cb=(l,u)=>{if(l){o(l,u);return}dT.call(this,r,e,t,s,()=>{this[Dt].listening=!0,o(null,u),uf(this)})}:s.cb=(l,u)=>{if(l){o(l,u);return}this[Dt].listening=!0,o(null,u),uf(this)},o===void 0)return iK.call(this,r,s).then(u=>new Promise((d,f)=>{c==="localhost"?dT.call(this,r,e,t,s,()=>{this[Dt].listening=!0,d(u),uf(this)}):(d(u),uf(this))}));this.ready(mT.call(this,r,s))}return{server:r,listen:n}}function dT(t,e,r,n,s){this[Dt].listening=!1,QM.lookup(n.host,{all:!0},(i,o)=>{if(i){s();return}let a=t.listening&&r.serverFactory,c=0,l=0;if(!a){let d=t.address();for(let f of o)if(f.address!==d.address){c++;let g=Object.assign({},n,{host:f.address,port:d.port,cb:I=>{l++,I||this[tK].push(p),l===c&&s()}}),p=yT(r,e),m=()=>{p.close(()=>{}),r.forceCloseConnections==="idle"?p.closeIdleConnections():typeof p.closeAllConnections=="function"&&r.forceCloseConnections&&p.closeAllConnections()};p.on("upgrade",t.emit.bind(t,"upgrade")),t.on("unref",m),t.on("close",m),t.on("error",m),this[Dt].listening=!1,mT.call(this,p,g)()}}if(c===0){s();return}let u=t.unref;t.unref=function(){u.call(t),t.emit("unref")}})}function mT(t,e){let r=n=>{if(t.removeListener("error",r),n)this[Dt].listening=!1,e.cb(n,null);else{let s=IT.call(this,t,e.listenTextResolver||hT);e.cb(null,s)}};return n=>{if(n!=null)return e.cb(n);if(this[Dt].listening&&this[Dt].closing)return e.cb(new gT,null);if(this[Dt].listening)return e.cb(new pT,null);t.once("error",r),this[Dt].closing||(t.listen(e,r),this[Dt].listening=!0)}}function iK(t,e){return this[Dt].listening&&this[Dt].closing?Promise.reject(new gT):this[Dt].listening?Promise.reject(new pT):this.ready().then(()=>{let r,n=new Promise((i,o)=>{r=a=>{this[Dt].listening=!1,o(a)},t.once("error",r)}),s=new Promise((i,o)=>{t.listen(e,()=>{t.removeListener("error",r),i(IT.call(this,t,e.listenTextResolver||hT))}),this[Dt].listening=!0});return Promise.race([n,s])})}function oK(t){let e=!1,r=new Map;return t.serverFactory&&(e=!0),t.http2?(r.set("2.0",!0),t.https&&t.https.allowHTTP1===!0&&(r.set("1.1",!0),r.set("1.0",!0))):(r.set("1.1",!0),r.set("1.0",!0)),function(s){return e||r.has(s)}}function yT(t,e){let r=null,n=t.https===!0?{}:t.https;return t.serverFactory?r=t.serverFactory(e,t):t.http2?(typeof n=="object"?r=fT().createSecureServer(n,e):r=fT().createServer(e),r.on("session",cK(t.http2SessionTimeout))):(n?r=JM.createServer(n,e):r=zM.createServer(t.http,e),r.keepAliveTimeout=t.keepAliveTimeout,r.requestTimeout=t.requestTimeout,t.maxRequestsPerSocket>0&&(r.maxRequestsPerSocket=t.maxRequestsPerSocket)),t.serverFactory||r.setTimeout(t.connectionTimeout),r}function Ky(t){if(t.length===0)return{port:0,host:"localhost"};let r={cb:typeof t[t.length-1]=="function"?t.pop():void 0},n=t[0],s=t.length,i=t[s-1];return typeof n=="string"&&isNaN(n)?(r.path=n,r.backlog=s>1?i:void 0):(r.port=s>=1&&Number.isInteger(n)?n:aK(n),r.host=s>=2&&t[1]?t[1]:"localhost",r.backlog=s>=3?t[2]:void 0),r}function aK(t){let e=Number(t);return e>=0&&!Number.isNaN(e)&&Number.isInteger(e)?e:0}function IT(t,e){let r=t.address(),n=typeof r=="string";n||(r.address.indexOf(":")===-1?r=r.address+":"+r.port:r="["+r.address+"]:"+r.port),r=(n?"":"http"+(this[eK].https?"s":"")+"://")+r;let s=e(r);return this.log.info(s),r}function fT(){try{return require("node:http2")}catch{throw new rK}}function cK(t){return function(e){e.setTimeout(t,lK)}}function lK(){this.close()}});var tI=h((DBe,ST)=>{"use strict";var{kSchemaHeaders:gf,kSchemaParams:Jy,kSchemaQuerystring:Qy,kSchemaBody:eI,kSchemaResponse:CT}=Tt(),uK=/^[1-5]{1}[0-9]{2}$|^[1-5]xx$|^default$/,{FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:dK}=Yt(),{FSTWRN001:df}=is();function fK(t,e){if(!t.schema||!t.schema.response)return;let{method:r,url:n}=t.config||{};t[CT]=Object.keys(t.schema.response).reduce(function(s,i){let o=t.schema.response[i];if(i=i.toLowerCase(),!uK.exec(i))throw new dK;if(o.content){let a={};for(let c of Object.keys(o.content)){let l=o.content[c].schema;a[c]=e({schema:l,url:n,method:r,httpStatus:i,contentType:c})}s[i]=a}else s[i]=e({schema:o,url:n,method:r,httpStatus:i});return s},{})}function gK(t,e,r){let{schema:n}=t;if(!n)return;let{method:s,url:i}=t.config||{},o=n.headers;if(o&&(r||Object.getPrototypeOf(o)!==Object.prototype))t[gf]=e({schema:o,method:s,url:i,httpPart:"headers"});else if(o){let a={};Object.keys(o).forEach(c=>{a[c]=o[c]}),a.required instanceof Array&&(a.required=a.required.map(c=>c.toLowerCase())),o.properties&&(a.properties={},Object.keys(o.properties).forEach(c=>{a.properties[c.toLowerCase()]=o.properties[c]})),t[gf]=e({schema:a,method:s,url:i,httpPart:"headers"})}else Object.prototype.hasOwnProperty.call(n,"headers")&&df("headers",s,i);n.body?t[eI]=e({schema:n.body,method:s,url:i,httpPart:"body"}):Object.prototype.hasOwnProperty.call(n,"body")&&df("body",s,i),n.querystring?t[Qy]=e({schema:n.querystring,method:s,url:i,httpPart:"querystring"}):Object.prototype.hasOwnProperty.call(n,"querystring")&&df("querystring",s,i),n.params?t[Jy]=e({schema:n.params,method:s,url:i,httpPart:"params"}):Object.prototype.hasOwnProperty.call(n,"params")&&df("params",s,i)}function ff(t,e,r){let n=e[r]===void 0,s=t&&t(n?null:e[r]);if(s?.then)return s.then(o=>i(o)).catch(o=>o);return i(s);function i(o){return o===!1?t.errors:o&&o.error?o.error:(o&&o.value&&(e[r]=o.value),!1)}}function pf(t,e,r){let n=r===void 0;if(n||!r.skipParams){let i=ff(t[Jy],e,"params");if(i)return typeof i.then!="function"?qs(i,"params",t.schemaErrorFormatter):pK(i,t,e)}if(n||!r.skipBody){let i=ff(t[eI],e,"body");if(i)return typeof i.then!="function"?qs(i,"body",t.schemaErrorFormatter):hK(i,t,e)}if(n||!r.skipQuery){let i=ff(t[Qy],e,"query");if(i)return typeof i.then!="function"?qs(i,"querystring",t.schemaErrorFormatter):mK(i,t,e)}let s=ff(t[gf],e,"headers");return s?typeof s.then!="function"?qs(s,"headers",t.schemaErrorFormatter):yK(s,t,e):!1}function pK(t,e,r){return t.then(n=>n?qs(n,"params",e.schemaErrorFormatter):pf(e,r,{skipParams:!0}))}function hK(t,e,r){return t.then(n=>n?qs(n,"body",e.schemaErrorFormatter):pf(e,r,{skipParams:!0,skipBody:!0}))}function mK(t,e,r){return t.then(n=>n?qs(n,"querystring",e.schemaErrorFormatter):pf(e,r,{skipParams:!0,skipBody:!0,skipQuery:!0}))}function yK(t,e,r){return t.then(n=>n?qs(n,"headers",e.schemaErrorFormatter):!1)}function qs(t,e,r){if(t instanceof Error)return t.statusCode=t.statusCode||400,t.code=t.code||"FST_ERR_VALIDATION",t.validationContext=t.validationContext||e,t;let n=r(t,e);return n.statusCode=n.statusCode||400,n.code=n.code||"FST_ERR_VALIDATION",n.validation=t,n.validationContext=e,n}ST.exports={symbols:{bodySchema:eI,querystringSchema:Qy,responseSchema:CT,paramsSchema:Jy,headersSchema:gf},compileSchemasForValidation:gK,compileSchemasForSerialization:fK,validate:pf}});var rI=h((XBe,_T)=>{"use strict";var{kReplyIsError:vT,kReplyHijacked:IK}=Tt();function bK(t,e){t.then(function(r){if(e[IK]!==!0&&(r!==void 0||e.sent===!1&&e.raw.headersSent===!1&&e.request.raw.aborted===!1))try{e.send(r)}catch(n){e[vT]=!0,e.send(n)}},function(r){if(e.sent===!0){e.log.error({err:r},"Promise errored, but reply.sent = true was set");return}e[vT]=!0;try{e.send(r)}catch(n){e.send(n)}})}_T.exports=bK});var oI=h(($Be,iI)=>{"use strict";var{validate:CK}=tI(),{preValidationHookRunner:SK,preHandlerHookRunner:vK}=js(),_K=rI(),{kReplyIsError:hf,kRouteContext:Ks}=Tt();function AK(t,e,r){if(r.sent===!0)return;if(t!=null){r[hf]=!0,r.send(t);return}let n=e.raw.method,s=e.headers,i=e[Ks];if(n==="GET"||n==="HEAD"){Ms(e,r);return}let o=s["content-type"];if(n==="POST"||n==="PUT"||n==="PATCH"||n==="TRACE"||n==="SEARCH"){o===void 0?s["transfer-encoding"]===void 0&&(s["content-length"]==="0"||s["content-length"]===void 0)?Ms(e,r):i.contentTypeParser.run("",Ms,e,r):i.contentTypeParser.run(o,Ms,e,r);return}if(n==="OPTIONS"||n==="DELETE"){o!==void 0&&(s["transfer-encoding"]!==void 0||s["content-length"]!==void 0)?i.contentTypeParser.run(o,Ms,e,r):Ms(e,r);return}Ms(e,r)}function Ms(t,e){try{t[Ks].preValidation!==null?SK(t[Ks].preValidation,t,e,nI):nI(null,t,e)}catch(r){nI(r,t,e)}}function nI(t,e,r){if(r.sent===!0)return;if(t!=null){r[hf]=!0,r.send(t);return}let n=CK(r[Ks],e);if(n&&typeof n.then=="function"||!1){let i=AT.bind(null,e,r);n.then(i,i)}else AT(e,r,n)}function AT(t,e,r){if(r){if(e[Ks].attachValidation===!1){e.send(r);return}e.request.validationError=r}t[Ks].preHandler!==null?vK(t[Ks].preHandler,t,e,sI):sI(null,t,e)}function sI(t,e,r){if(r.sent)return;if(t!=null){r[hf]=!0,r.send(t);return}let n;try{n=e[Ks].handler(e,r)}catch(s){r[hf]=!0,r.send(s);return}n!==void 0&&(n!==null&&typeof n.then=="function"?_K(n,r):r.send(n))}iI.exports=AK;iI.exports[Symbol.for("internals")]={handler:Ms,preHandlerCallback:sI}});var ET=h((jBe,RT)=>{"use strict";function na(){}var RK={fatal:na,error:na,warn:na,info:na,debug:na,trace:na};Object.defineProperty(RT,"exports",{get(){return Object.create(RK)}})});var cI=h((qBe,TT)=>{"use strict";var Jc=t=>t&&typeof t.message=="string",aI=t=>{if(!t)return;let e=t.cause;if(typeof e=="function"){let r=t.cause();return Jc(r)?r:void 0}else return Jc(e)?e:void 0},wT=(t,e)=>{if(!Jc(t))return"";let r=t.stack||"";if(e.has(t))return r+`
causes have become circular...`;let n=aI(t);return n?(e.add(t),r+`
caused by: `+wT(n,e)):r},EK=t=>wT(t,new Set),BT=(t,e,r)=>{if(!Jc(t))return"";let n=r?"":t.message||"";if(e.has(t))return n+": ...";let s=aI(t);if(s){e.add(t);let i=typeof t.cause=="function";return n+(i?"":": ")+BT(s,e,i)}else return n},wK=t=>BT(t,new Set);TT.exports={isErrorLike:Jc,getErrorCause:aI,stackWithCauses:EK,messageWithCauses:wK}});var lI=h((MBe,ZT)=>{"use strict";var BK=Symbol("circular-ref-tag"),mf=Symbol("pino-raw-err-ref"),GT=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[mf]},set:function(t){this[mf]=t}}});Object.defineProperty(GT,mf,{writable:!0,value:{}});ZT.exports={pinoErrProto:GT,pinoErrorSymbols:{seen:BK,rawSymbol:mf}}});var HT=h((KBe,VT)=>{"use strict";VT.exports=dI;var{messageWithCauses:TK,stackWithCauses:GK,isErrorLike:NT}=cI(),{pinoErrProto:ZK,pinoErrorSymbols:NK}=lI(),{seen:uI}=NK,{toString:VK}=Object.prototype;function dI(t){if(!NT(t))return t;t[uI]=void 0;let e=Object.create(ZK);e.type=VK.call(t.constructor)==="[object Function]"?t.constructor.name:t.name,e.message=TK(t),e.stack=GK(t),Array.isArray(t.errors)&&(e.aggregateErrors=t.errors.map(r=>dI(r)));for(let r in t)if(e[r]===void 0){let n=t[r];NT(n)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(n,uI)&&(e[r]=dI(n)):e[r]=n}return delete t[uI],e.raw=t,e}});var OT=h((zBe,WT)=>{"use strict";WT.exports=If;var{isErrorLike:fI}=cI(),{pinoErrProto:HK,pinoErrorSymbols:WK}=lI(),{seen:yf}=WK,{toString:OK}=Object.prototype;function If(t){if(!fI(t))return t;t[yf]=void 0;let e=Object.create(HK);e.type=OK.call(t.constructor)==="[object Function]"?t.constructor.name:t.name,e.message=t.message,e.stack=t.stack,Array.isArray(t.errors)&&(e.aggregateErrors=t.errors.map(r=>If(r))),fI(t.cause)&&!Object.prototype.hasOwnProperty.call(t.cause,yf)&&(e.cause=If(t.cause));for(let r in t)if(e[r]===void 0){let n=t[r];fI(n)?Object.prototype.hasOwnProperty.call(n,yf)||(e[r]=If(n)):e[r]=n}return delete t[yf],e.raw=t,e}});var xT=h((JBe,FT)=>{"use strict";FT.exports={mapHttpRequest:PK,reqSerializer:kT};var gI=Symbol("pino-raw-req-ref"),PT=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[gI]},set:function(t){this[gI]=t}}});Object.defineProperty(PT,gI,{writable:!0,value:{}});function kT(t){let e=t.info||t.socket,r=Object.create(PT);if(r.id=typeof t.id=="function"?t.id():t.id||(t.info?t.info.id:void 0),r.method=t.method,t.originalUrl)r.url=t.originalUrl;else{let n=t.path;r.url=typeof n=="string"?n:t.url?t.url.path||t.url:void 0}return t.query&&(r.query=t.query),t.params&&(r.params=t.params),r.headers=t.headers,r.remoteAddress=e&&e.remoteAddress,r.remotePort=e&&e.remotePort,r.raw=t.raw||t,r}function PK(t){return{req:kT(t)}}});var DT=h((QBe,YT)=>{"use strict";YT.exports={mapHttpResponse:kK,resSerializer:UT};var pI=Symbol("pino-raw-res-ref"),LT=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[pI]},set:function(t){this[pI]=t}}});Object.defineProperty(LT,pI,{writable:!0,value:{}});function UT(t){let e=Object.create(LT);return e.statusCode=t.headersSent?t.statusCode:null,e.headers=t.getHeaders?t.getHeaders():t._headers,e.raw=t,e}function kK(t){return{res:UT(t)}}});var mI=h((eTe,XT)=>{"use strict";var hI=HT(),FK=OT(),bf=xT(),Cf=DT();XT.exports={err:hI,errWithCause:FK,mapHttpRequest:bf.mapHttpRequest,mapHttpResponse:Cf.mapHttpResponse,req:bf.reqSerializer,res:Cf.resSerializer,wrapErrorSerializer:function(e){return e===hI?e:function(n){return e(hI(n))}},wrapRequestSerializer:function(e){return e===bf.reqSerializer?e:function(n){return e(bf.reqSerializer(n))}},wrapResponseSerializer:function(e){return e===Cf.resSerializer?e:function(n){return e(Cf.resSerializer(n))}}}});var yI=h((tTe,$T)=>{"use strict";function xK(t,e){return e}$T.exports=function(){let e=Error.prepareStackTrace;Error.prepareStackTrace=xK;let r=new Error().stack;if(Error.prepareStackTrace=e,!Array.isArray(r))return;let n=r.slice(2),s=[];for(let i of n)i&&s.push(i.getFileName());return s}});var qT=h((rTe,jT)=>{"use strict";jT.exports=LK;function LK(t={}){let{ERR_PATHS_MUST_BE_STRINGS:e=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:r=n=>`fast-redact \u2013 Invalid path (${n})`}=t;return function({paths:s}){s.forEach(i=>{if(typeof i!="string")throw Error(e());try{if(/〇/.test(i))throw Error();let o=(i[0]==="["?"":".")+i.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(o)||/\/\*/.test(o))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${o}
            if ([o${o}].length !== 1) throw Error()`)()}catch{throw Error(r(i))}})}}});var Sf=h((nTe,MT)=>{"use strict";MT.exports=/[^.[\]]+|\[((?:.)*?)\]/g});var zT=h((sTe,KT)=>{"use strict";var UK=Sf();KT.exports=YK;function YK({paths:t}){let e=[];var r=0;let n=t.reduce(function(s,i,o){var a=i.match(UK).map(u=>u.replace(/'|"|`/g,""));let c=i[0]==="[";a=a.map(u=>u[0]==="["?u.substr(1,u.length-2):u);let l=a.indexOf("*");if(l>-1){let u=a.slice(0,l),d=u.join("."),f=a.slice(l+1,a.length),g=f.length>0;r++,e.push({before:u,beforeStr:d,after:f,nested:g})}else s[i]={path:a,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(i),leadingBracket:c};return s},{});return{wildcards:e,wcLen:r,secret:n}}});var QT=h((iTe,JT)=>{"use strict";var DK=Sf();JT.exports=XK;function XK({secret:t,serialize:e,wcLen:r,strict:n,isCensorFct:s,censorFctTakesPath:i},o){let a=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${MK(n,e)}
    }
    const { censor, secret } = this
    ${$K(t,s,i)}
    this.compileRestore()
    ${jK(r>0,s,i)}
    ${qK(e)}
  `).bind(o);return e===!1&&(a.restore=c=>o.restore(c)),a}function $K(t,e,r){return Object.keys(t).map(n=>{let{escPath:s,leadingBracket:i,path:o}=t[n],a=i?1:0,c=i?"":".",l=[];for(var u;(u=DK.exec(n))!==null;){let[,p]=u,{index:m,input:I}=u;m>a&&l.push(I.substring(0,m-(p?0:1)))}var d=l.map(p=>`o${c}${p}`).join(" && ");d.length===0?d+=`o${c}${n} != null`:d+=` && o${c}${n} != null`;let f=`
      switch (true) {
        ${l.reverse().map(p=>`
          case o${c}${p} === censor:
            secret[${s}].circle = ${JSON.stringify(p)}
            break
        `).join(`
`)}
      }
    `,g=r?`val, ${JSON.stringify(o)}`:"val";return`
      if (${d}) {
        const val = o${c}${n}
        if (val === censor) {
          secret[${s}].precensored = true
        } else {
          secret[${s}].val = val
          o${c}${n} = ${e?`censor(${g})`:"censor"}
          ${f}
        }
      }
    `}).join(`
`)}function jK(t,e,r){return t===!0?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${e}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${e}, ${r})
      }
    }
  `:""}function qK(t){return t===!1?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}function MK(t,e){return t===!0?"throw Error('fast-redact: primitives cannot be redacted')":e===!1?"return o":"return this.serialize(o)"}});var bI=h((oTe,rG)=>{"use strict";rG.exports={groupRedact:zK,groupRestore:KK,nestedRedact:QK,nestedRestore:JK};function KK({keys:t,values:e,target:r}){if(r==null)return;let n=t.length;for(var s=0;s<n;s++){let i=t[s];r[i]=e[s]}}function zK(t,e,r,n,s){let i=eG(t,e);if(i==null)return{keys:null,values:null,target:null,flat:!0};let o=Object.keys(i),a=o.length,c=e.length,l=s?[...e]:void 0,u=new Array(a);for(var d=0;d<a;d++){let f=o[d];u[d]=i[f],s?(l[c]=f,i[f]=r(i[f],l)):n?i[f]=r(i[f]):i[f]=r}return{keys:o,values:u,target:i,flat:!0}}function JK(t){for(let e=0;e<t.length;e++){let{target:r,path:n,value:s}=t[e],i=r;for(let o=n.length-1;o>0;o--)i=i[n[o]];i[n[0]]=s}}function QK(t,e,r,n,s,i,o){let a=eG(e,r);if(a==null)return;let c=Object.keys(a),l=c.length;for(var u=0;u<l;u++){let d=c[u];ez(t,a,d,r,n,s,i,o)}return t}function II(t,e){return t!=null?"hasOwn"in Object?Object.hasOwn(t,e):Object.prototype.hasOwnProperty.call(t,e):!1}function ez(t,e,r,n,s,i,o,a){let c=s.length,l=c-1,u=r;var d=-1,f,g,p,m=null,I=null,C,S,b=!1,y=0,A=0,E=tz();if(p=f=e[r],typeof f=="object"){for(;f!=null&&++d<c&&(A+=1,r=s[d],m=p,!(r!=="*"&&!I&&!(typeof f=="object"&&r in f)));)if(!(r==="*"&&(I==="*"&&(b=!0),I=r,d!==l))){if(I){let B=Object.keys(f);for(var v=0;v<B.length;v++){let H=B[v];if(S=f[H],C=r==="*",b)E=os(E,H,A),y=d,p=tG(S,y-1,r,n,s,i,o,a,u,f,g,p,C,H,d,l,E,t,e[u],A+1);else if(C||typeof S=="object"&&S!==null&&r in S){if(C?p=S:p=S[r],g=d!==l?p:o?a?i(p,[...n,u,...s]):i(p):i,C){let R=Qc(os(E,H,A),p,e[u]);t.push(R),f[H]=g}else if(S[r]!==g)if(g===void 0&&i!==void 0||II(S,r)&&g===p)E=os(E,H,A);else{E=os(E,H,A);let R=Qc(os(E,r,A+1),p,e[u]);t.push(R),S[r]=g}}}I=null}else{if(p=f[r],E=os(E,r,A),g=d!==l?p:o?a?i(p,[...n,u,...s]):i(p):i,!(II(f,r)&&g===p||g===void 0&&i!==void 0)){let B=Qc(E,p,e[u]);t.push(B),f[r]=g}f=f[r]}if(typeof f!="object")break}}}function eG(t,e){for(var r=-1,n=e.length,s=t;s!=null&&++r<n;)s=s[e[r]];return s}function tG(t,e,r,n,s,i,o,a,c,l,u,d,f,g,p,m,I,C,S,b){if(e===0&&(f||typeof t=="object"&&t!==null&&r in t)){if(f?d=t:d=t[r],u=p!==m?d:o?a?i(d,[...n,c,...s]):i(d):i,f){let y=Qc(I,d,S);C.push(y),l[g]=u}else if(t[r]!==u){if(!(u===void 0&&i!==void 0||II(t,r)&&u===d)){let y=Qc(os(I,r,b+1),d,S);C.push(y),t[r]=u}}}for(let y in t)typeof t[y]=="object"&&(I=os(I,y,b),tG(t[y],e-1,r,n,s,i,o,a,c,l,u,d,f,g,p,m,I,C,S,b+1))}function tz(){return{parent:null,key:null,children:[],depth:0}}function os(t,e,r){if(t.depth===r)return os(t.parent,e,r);var n={parent:t,key:e,depth:r,children:[]};return t.children.push(n),n}function Qc(t,e,r){let n=t,s=[];do s.push(n.key),n=n.parent;while(n.parent!=null);return{path:s,value:e,target:r}}});var sG=h((aTe,nG)=>{"use strict";var{groupRestore:rz,nestedRestore:nz}=bI();nG.exports=sz;function sz({secret:t,wcLen:e}){return function(){if(this.restore)return;let n=Object.keys(t),s=iz(t,n),i=e>0,o=i?{secret:t,groupRestore:rz,nestedRestore:nz}:{secret:t};this.restore=Function("o",oz(s,n,i)).bind(o)}}function iz(t,e){return e.map(r=>{let{circle:n,escPath:s,leadingBracket:i}=t[r],a=n?`o.${n} = secret[${s}].val`:`o${i?"":"."}${r} = secret[${s}].val`,c=`secret[${s}].val = undefined`;return`
      if (secret[${s}].val !== undefined) {
        try { ${a} } catch (e) {}
        ${c}
      }
    `}).join("")}function oz(t,e,r){return`
    const secret = this.secret
    ${r===!0?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${e.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o.flat === true) this.groupRestore(o)
      else this.nestedRestore(o)
      secret[k] = null
    }
  `:""}
    ${t}
    return o
  `}});var oG=h((cTe,iG)=>{"use strict";iG.exports=az;function az(t){let{secret:e,censor:r,compileRestore:n,serialize:s,groupRedact:i,nestedRedact:o,wildcards:a,wcLen:c}=t,l=[{secret:e,censor:r,compileRestore:n}];return s!==!1&&l.push({serialize:s}),c>0&&l.push({groupRedact:i,nestedRedact:o,wildcards:a,wcLen:c}),Object.assign(...l)}});var lG=h((lTe,cG)=>{"use strict";var aG=qT(),cz=zT(),lz=QT(),uz=sG(),{groupRedact:dz,nestedRedact:fz}=bI(),gz=oG(),pz=Sf(),hz=aG(),CI=t=>t;CI.restore=CI;var mz="[REDACTED]";SI.rx=pz;SI.validator=aG;cG.exports=SI;function SI(t={}){let e=Array.from(new Set(t.paths||[])),r="serialize"in t&&(t.serialize===!1||typeof t.serialize=="function")?t.serialize:JSON.stringify,n=t.remove;if(n===!0&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let s=n===!0?void 0:"censor"in t?t.censor:mz,i=typeof s=="function",o=i&&s.length>1;if(e.length===0)return r||CI;hz({paths:e,serialize:r,censor:s});let{wildcards:a,wcLen:c,secret:l}=cz({paths:e,censor:s}),u=uz({secret:l,wcLen:c}),d="strict"in t?t.strict:!0;return lz({secret:l,wcLen:c,serialize:r,strict:d,isCensorFct:i,censorFctTakesPath:o},gz({secret:l,censor:s,compileRestore:u,serialize:r,groupRedact:dz,nestedRedact:fz,wildcards:a,wcLen:c}))}});var sa=h((uTe,uG)=>{"use strict";var yz=Symbol("pino.setLevel"),Iz=Symbol("pino.getLevel"),bz=Symbol("pino.levelVal"),Cz=Symbol("pino.useLevelLabels"),Sz=Symbol("pino.useOnlyCustomLevels"),vz=Symbol("pino.mixin"),_z=Symbol("pino.lsCache"),Az=Symbol("pino.chindings"),Rz=Symbol("pino.asJson"),Ez=Symbol("pino.write"),wz=Symbol("pino.redactFmt"),Bz=Symbol("pino.time"),Tz=Symbol("pino.timeSliceIndex"),Gz=Symbol("pino.stream"),Zz=Symbol("pino.stringify"),Nz=Symbol("pino.stringifySafe"),Vz=Symbol("pino.stringifiers"),Hz=Symbol("pino.end"),Wz=Symbol("pino.formatOpts"),Oz=Symbol("pino.messageKey"),Pz=Symbol("pino.errorKey"),kz=Symbol("pino.nestedKey"),Fz=Symbol("pino.nestedKeyStr"),xz=Symbol("pino.mixinMergeStrategy"),Lz=Symbol("pino.msgPrefix"),Uz=Symbol("pino.wildcardFirst"),Yz=Symbol.for("pino.serializers"),Dz=Symbol.for("pino.formatters"),Xz=Symbol.for("pino.hooks"),$z=Symbol.for("pino.metadata");uG.exports={setLevelSym:yz,getLevelSym:Iz,levelValSym:bz,useLevelLabelsSym:Cz,mixinSym:vz,lsCacheSym:_z,chindingsSym:Az,asJsonSym:Rz,writeSym:Ez,serializersSym:Yz,redactFmtSym:wz,timeSym:Bz,timeSliceIndexSym:Tz,streamSym:Gz,stringifySym:Zz,stringifySafeSym:Nz,stringifiersSym:Vz,endSym:Hz,formatOptsSym:Wz,messageKeySym:Oz,errorKeySym:Pz,nestedKeySym:kz,wildcardFirstSym:Uz,needsMetadataGsym:$z,useOnlyCustomLevelsSym:Sz,formattersSym:Dz,hooksSym:Xz,nestedKeyStrSym:Fz,mixinMergeStrategySym:xz,msgPrefixSym:Lz}});var AI=h((dTe,pG)=>{"use strict";var _I=lG(),{redactFmtSym:jz,wildcardFirstSym:vf}=sa(),{rx:vI,validator:qz}=_I,dG=qz({ERR_PATHS_MUST_BE_STRINGS:()=>"pino \u2013 redacted paths must be strings",ERR_INVALID_PATH:t=>`pino \u2013 redact paths array contains an invalid path (${t})`}),fG="[Redacted]",gG=!1;function Mz(t,e){let{paths:r,censor:n}=Kz(t),s=r.reduce((a,c)=>{vI.lastIndex=0;let l=vI.exec(c),u=vI.exec(c),d=l[1]!==void 0?l[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):l[0];if(d==="*"&&(d=vf),u===null)return a[d]=null,a;if(a[d]===null)return a;let{index:f}=u,g=`${c.substr(f,c.length-1)}`;return a[d]=a[d]||[],d!==vf&&a[d].length===0&&a[d].push(...a[vf]||[]),d===vf&&Object.keys(a).forEach(function(p){a[p]&&a[p].push(g)}),a[d].push(g),a},{}),i={[jz]:_I({paths:r,censor:n,serialize:e,strict:gG})},o=(...a)=>e(typeof n=="function"?n(...a):n);return[...Object.keys(s),...Object.getOwnPropertySymbols(s)].reduce((a,c)=>{if(s[c]===null)a[c]=l=>o(l,[c]);else{let l=typeof n=="function"?(u,d)=>n(u,[c,...d]):n;a[c]=_I({paths:s[c],censor:l,serialize:e,strict:gG})}return a},i)}function Kz(t){if(Array.isArray(t))return t={paths:t,censor:fG},dG(t),t;let{paths:e,censor:r=fG,remove:n}=t;if(Array.isArray(e)===!1)throw Error("pino \u2013 redact must contain an array of strings");return n===!0&&(r=void 0),dG({paths:e,censor:r}),{paths:e,censor:r}}pG.exports=Mz});var mG=h((fTe,hG)=>{"use strict";var zz=()=>"",Jz=()=>`,"time":${Date.now()}`,Qz=()=>`,"time":${Math.round(Date.now()/1e3)}`,e5=()=>`,"time":"${new Date(Date.now()).toISOString()}"`;hG.exports={nullTime:zz,epochTime:Jz,unixTime:Qz,isoTime:e5}});var IG=h((gTe,yG)=>{"use strict";function t5(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}yG.exports=r5;function r5(t,e,r){var n=r&&r.stringify||t5,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=n(t);for(var a=1;a<i;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-s,d=-1,f=t&&t.length||0,g=0;g<f;){if(t.charCodeAt(g)===37&&g+1<f){switch(d=d>-1?d:0,t.charCodeAt(g+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<g&&(l+=t.slice(d,g)),l+=Number(e[u]),d=g+2,g++;break;case 105:if(u>=c||e[u]==null)break;d<g&&(l+=t.slice(d,g)),l+=Math.floor(Number(e[u])),d=g+2,g++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<g&&(l+=t.slice(d,g));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",d=g+2,g++;break}if(p==="function"){l+=e[u].name||"<anonymous>",d=g+2,g++;break}l+=n(e[u]),d=g+2,g++;break;case 115:if(u>=c)break;d<g&&(l+=t.slice(d,g)),l+=String(e[u]),d=g+2,g++;break;case 37:d<g&&(l+=t.slice(d,g)),l+="%",d=g+2,g++,u--;break}++u}++g}return d===-1?t:(d<f&&(l+=t.slice(d)),l)}});var EI=h((pTe,RI)=>{"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let e=function(r){if((r>0&&r<1/0)===!1)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(t,0,0,Number(r))},t=new Int32Array(new SharedArrayBuffer(4));RI.exports=e}else{let t=function(e){if((e>0&&e<1/0)===!1)throw typeof e!="number"&&typeof e!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let n=Date.now()+Number(e);for(;n>Date.now(););};RI.exports=t}});var EG=h((hTe,RG)=>{"use strict";var ct=require("fs"),n5=require("events"),s5=require("util").inherits,bG=require("path"),wI=EI(),_f=100,Af=Buffer.allocUnsafe(0),i5=16*1024,CG="buffer",SG="utf8";function vG(t,e){e._opening=!0,e._writing=!0,e._asyncDrainScheduled=!1;function r(i,o){if(i){e._reopening=!1,e._writing=!1,e._opening=!1,e.sync?process.nextTick(()=>{e.listenerCount("error")>0&&e.emit("error",i)}):e.emit("error",i);return}e.fd=o,e.file=t,e._reopening=!1,e._opening=!1,e._writing=!1,e.sync?process.nextTick(()=>e.emit("ready")):e.emit("ready"),!(e._reopening||e.destroyed)&&(!e._writing&&e._len>e.minLength||e._flushPending)&&e._actualWrite()}let n=e.append?"a":"w",s=e.mode;if(e.sync)try{e.mkdir&&ct.mkdirSync(bG.dirname(t),{recursive:!0});let i=ct.openSync(t,n,s);r(null,i)}catch(i){throw r(i),i}else e.mkdir?ct.mkdir(bG.dirname(t),{recursive:!0},i=>{if(i)return r(i);ct.open(t,n,s,r)}):ct.open(t,n,s,r)}function tn(t){if(!(this instanceof tn))return new tn(t);let{fd:e,dest:r,minLength:n,maxLength:s,maxWrite:i,sync:o,append:a=!0,mkdir:c,retryEAGAIN:l,fsync:u,contentMode:d,mode:f}=t||{};e=e||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(n||0,16387),this.file=null,this.destroyed=!1,this.minLength=n||0,this.maxLength=s||0,this.maxWrite=i||i5,this.sync=o||!1,this.writable=!0,this._fsync=u||!1,this.append=a||!1,this.mode=f,this.retryEAGAIN=l||(()=>!0),this.mkdir=c||!1;let g,p;if(d===CG)this._writingBuf=Af,this.write=c5,this.flush=u5,this.flushSync=f5,this._actualWrite=p5,g=()=>ct.writeSync(this.fd,this._writingBuf),p=()=>ct.write(this.fd,this._writingBuf,this.release);else if(d===void 0||d===SG)this._writingBuf="",this.write=a5,this.flush=l5,this.flushSync=d5,this._actualWrite=g5,g=()=>ct.writeSync(this.fd,this._writingBuf,"utf8"),p=()=>ct.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${SG}" and "${CG}", but passed ${d}`);if(typeof e=="number")this.fd=e,process.nextTick(()=>this.emit("ready"));else if(typeof e=="string")vG(e,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(m,I)=>{if(m){if((m.code==="EAGAIN"||m.code==="EBUSY")&&this.retryEAGAIN(m,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{wI(_f),this.release(void 0,0)}catch(S){this.release(S)}else setTimeout(p,_f);else this._writing=!1,this.emit("error",m);return}if(this.emit("write",I),this._len-=I,this._len<0&&(this._len=0),this._writingBuf=this._writingBuf.slice(I),this._writingBuf.length){if(!this.sync){p();return}try{do{let S=g();this._len-=S,this._writingBuf=this._writingBuf.slice(S)}while(this._writingBuf.length)}catch(S){this.release(S);return}}this._fsync&&ct.fsyncSync(this.fd);let C=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):C>this.minLength?this._actualWrite():this._ending?C>0?this._actualWrite():(this._writing=!1,Rf(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(o5,this)):this.emit("drain"))},this.on("newListener",function(m){m==="drain"&&(this._asyncDrainScheduled=!1)})}function o5(t){t.listenerCount("drain")>0&&(t._asyncDrainScheduled=!1,t.emit("drain"))}s5(tn,n5);function _G(t,e){return t.length===0?Af:t.length===1?t[0]:Buffer.concat(t,e)}function a5(t){if(this.destroyed)throw new Error("SonicBoom destroyed");let e=this._len+t.length,r=this._bufs;return this.maxLength&&e>this.maxLength?(this.emit("drop",t),this._len<this._hwm):(r.length===0||r[r.length-1].length+t.length>this.maxWrite?r.push(""+t):r[r.length-1]+=t,this._len=e,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function c5(t){if(this.destroyed)throw new Error("SonicBoom destroyed");let e=this._len+t.length,r=this._bufs,n=this._lens;return this.maxLength&&e>this.maxLength?(this.emit("drop",t),this._len<this._hwm):(r.length===0||n[n.length-1]+t.length>this.maxWrite?(r.push([t]),n.push(t.length)):(r[r.length-1].push(t),n[n.length-1]+=t.length),this._len=e,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function AG(t){this._flushPending=!0;let e=()=>{this._fsync?(this._flushPending=!1,t()):ct.fsync(this.fd,n=>{this._flushPending=!1,t(n)}),this.off("error",r)},r=n=>{this._flushPending=!1,t(n),this.off("drain",e)};this.once("drain",e),this.once("error",r)}function l5(t){if(t!=null&&typeof t!="function")throw new Error("flush cb must be a function");if(this.destroyed){let e=new Error("SonicBoom destroyed");if(t){t(e);return}throw e}if(this.minLength<=0){t?.();return}t&&AG.call(this,t),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function u5(t){if(t!=null&&typeof t!="function")throw new Error("flush cb must be a function");if(this.destroyed){let e=new Error("SonicBoom destroyed");if(t){t(e);return}throw e}if(this.minLength<=0){t?.();return}t&&AG.call(this,t),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}tn.prototype.reopen=function(t){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(t)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(this._reopening=!0,this._writing)return;let e=this.fd;this.once("ready",()=>{e!==this.fd&&ct.close(e,r=>{if(r)return this.emit("error",r)})}),vG(t||this.file,this)};tn.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():Rf(this)))};function d5(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let t="";for(;this._bufs.length||t;){t.length<=0&&(t=this._bufs[0]);try{let e=ct.writeSync(this.fd,t,"utf8");t=t.slice(e),this._len=Math.max(this._len-e,0),t.length<=0&&this._bufs.shift()}catch(e){if((e.code==="EAGAIN"||e.code==="EBUSY")&&!this.retryEAGAIN(e,t.length,this._len-t.length))throw e;wI(_f)}}try{ct.fsyncSync(this.fd)}catch{}}function f5(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=Af);let t=Af;for(;this._bufs.length||t.length;){t.length<=0&&(t=_G(this._bufs[0],this._lens[0]));try{let e=ct.writeSync(this.fd,t);t=t.subarray(e),this._len=Math.max(this._len-e,0),t.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(e){if((e.code==="EAGAIN"||e.code==="EBUSY")&&!this.retryEAGAIN(e,t.length,this._len-t.length))throw e;wI(_f)}}}tn.prototype.destroy=function(){this.destroyed||Rf(this)};function g5(){let t=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let e=ct.writeSync(this.fd,this._writingBuf,"utf8");t(null,e)}catch(e){t(e)}else ct.write(this.fd,this._writingBuf,"utf8",t)}function p5(){let t=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:_G(this._bufs.shift(),this._lens.shift()),this.sync)try{let e=ct.writeSync(this.fd,this._writingBuf);t(null,e)}catch(e){t(e)}else ct.write(this.fd,this._writingBuf,t)}function Rf(t){if(t.fd===-1){t.once("ready",Rf.bind(null,t));return}t.destroyed=!0,t._bufs=[],t._lens=[],ct.fsync(t.fd,e);function e(){t.fd!==1&&t.fd!==2?ct.close(t.fd,r):r()}function r(n){if(n){t.emit("error",n);return}t._ending&&!t._writing&&t.emit("finish"),t.emit("close")}}tn.SonicBoom=tn;tn.default=tn;RG.exports=tn});var BI=h((mTe,ZG)=>{"use strict";var rn={exit:[],beforeExit:[]},wG={exit:y5,beforeExit:I5},ia;function h5(){ia===void 0&&(ia=new FinalizationRegistry(b5))}function m5(t){rn[t].length>0||process.on(t,wG[t])}function BG(t){rn[t].length>0||(process.removeListener(t,wG[t]),rn.exit.length===0&&rn.beforeExit.length===0&&(ia=void 0))}function y5(){TG("exit")}function I5(){TG("beforeExit")}function TG(t){for(let e of rn[t]){let r=e.deref(),n=e.fn;r!==void 0&&n(r,t)}rn[t]=[]}function b5(t){for(let e of["exit","beforeExit"]){let r=rn[e].indexOf(t);rn[e].splice(r,r+1),BG(e)}}function GG(t,e,r){if(e===void 0)throw new Error("the object can't be undefined");m5(t);let n=new WeakRef(e);n.fn=r,h5(),ia.register(e,n),rn[t].push(n)}function C5(t,e){GG("exit",t,e)}function S5(t,e){GG("beforeExit",t,e)}function v5(t){if(ia!==void 0){ia.unregister(t);for(let e of["exit","beforeExit"])rn[e]=rn[e].filter(r=>{let n=r.deref();return n&&n!==t}),BG(e)}}ZG.exports={register:C5,registerBeforeExit:S5,unregister:v5}});var NG=h((yTe,_5)=>{_5.exports={name:"thread-stream",version:"2.4.1",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^8.0.1","pino-elasticsearch":"^6.0.0","sonic-boom":"^3.0.0",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^4.7.2","why-is-node-running":"^2.2.2"},scripts:{test:"standard && npm run transpile && tap test/*.test.*js && tap --ts test/*.test.*ts","test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}});var HG=h((ITe,VG)=>{"use strict";function A5(t,e,r,n,s){let i=Date.now()+n,o=Atomics.load(t,e);if(o===r){s(null,"ok");return}let a=o,c=l=>{Date.now()>i?s(null,"timed-out"):setTimeout(()=>{a=o,o=Atomics.load(t,e),o===a?c(l>=1e3?1e3:l*2):o===r?s(null,"ok"):s(null,"not-equal")},l)};c(1)}function R5(t,e,r,n,s){let i=Date.now()+n,o=Atomics.load(t,e);if(o!==r){s(null,"ok");return}let a=c=>{Date.now()>i?s(null,"timed-out"):setTimeout(()=>{o=Atomics.load(t,e),o!==r?s(null,"ok"):a(c>=1e3?1e3:c*2)},c)};a(1)}VG.exports={wait:A5,waitDiff:R5}});var OG=h((bTe,WG)=>{"use strict";WG.exports={WRITE_INDEX:4,READ_INDEX:8}});var LG=h((CTe,xG)=>{"use strict";var{version:E5}=NG(),{EventEmitter:w5}=require("events"),{Worker:B5}=require("worker_threads"),{join:T5}=require("path"),{pathToFileURL:G5}=require("url"),{wait:Z5}=HG(),{WRITE_INDEX:lr,READ_INDEX:vn}=OG(),N5=require("buffer"),V5=require("assert"),P=Symbol("kImpl"),H5=N5.constants.MAX_STRING_LENGTH,el=class{constructor(e){this._value=e}deref(){return this._value}},wf=class{register(){}unregister(){}},W5=process.env.NODE_V8_COVERAGE?wf:global.FinalizationRegistry||wf,O5=process.env.NODE_V8_COVERAGE?el:global.WeakRef||el,PG=new W5(t=>{t.exited||t.terminate()});function P5(t,e){let{filename:r,workerData:n}=e,i=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||T5(__dirname,"lib","worker.js"),o=new B5(i,{...e.workerOpts,trackUnmanagedFds:!1,workerData:{filename:r.indexOf("file://")===0?r:G5(r).href,dataBuf:t[P].dataBuf,stateBuf:t[P].stateBuf,workerData:{$context:{threadStreamVersion:E5},...n}}});return o.stream=new el(t),o.on("message",k5),o.on("exit",FG),PG.register(t,o),o}function kG(t){V5(!t[P].sync),t[P].needDrain&&(t[P].needDrain=!1,t.emit("drain"))}function Ef(t){let e=Atomics.load(t[P].state,lr),r=t[P].data.length-e;if(r>0){if(t[P].buf.length===0){t[P].flushing=!1,t[P].ending?VI(t):t[P].needDrain&&process.nextTick(kG,t);return}let n=t[P].buf.slice(0,r),s=Buffer.byteLength(n);s<=r?(t[P].buf=t[P].buf.slice(r),Bf(t,n,Ef.bind(null,t))):t.flush(()=>{if(!t.destroyed){for(Atomics.store(t[P].state,vn,0),Atomics.store(t[P].state,lr,0);s>t[P].data.length;)r=r/2,n=t[P].buf.slice(0,r),s=Buffer.byteLength(n);t[P].buf=t[P].buf.slice(r),Bf(t,n,Ef.bind(null,t))}})}else if(r===0){if(e===0&&t[P].buf.length===0)return;t.flush(()=>{Atomics.store(t[P].state,vn,0),Atomics.store(t[P].state,lr,0),Ef(t)})}else _n(t,new Error("overwritten"))}function k5(t){let e=this.stream.deref();if(e===void 0){this.exited=!0,this.terminate();return}switch(t.code){case"READY":this.stream=new O5(e),e.flush(()=>{e[P].ready=!0,e.emit("ready")});break;case"ERROR":_n(e,t.err);break;case"EVENT":Array.isArray(t.args)?e.emit(t.name,...t.args):e.emit(t.name,t.args);break;case"WARNING":process.emitWarning(t.err);break;default:_n(e,new Error("this should not happen: "+t.code))}}function FG(t){let e=this.stream.deref();e!==void 0&&(PG.unregister(e),e.worker.exited=!0,e.worker.off("exit",FG),_n(e,t!==0?new Error("the worker thread exited"):null))}var GI=class extends w5{constructor(e={}){if(super(),e.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[P]={},this[P].stateBuf=new SharedArrayBuffer(128),this[P].state=new Int32Array(this[P].stateBuf),this[P].dataBuf=new SharedArrayBuffer(e.bufferSize||4*1024*1024),this[P].data=Buffer.from(this[P].dataBuf),this[P].sync=e.sync||!1,this[P].ending=!1,this[P].ended=!1,this[P].needDrain=!1,this[P].destroyed=!1,this[P].flushing=!1,this[P].ready=!1,this[P].finished=!1,this[P].errored=null,this[P].closed=!1,this[P].buf="",this.worker=P5(this,e)}write(e){if(this[P].destroyed)return ZI(this,new Error("the worker has exited")),!1;if(this[P].ending)return ZI(this,new Error("the worker is ending")),!1;if(this[P].flushing&&this[P].buf.length+e.length>=H5)try{TI(this),this[P].flushing=!0}catch(r){return _n(this,r),!1}if(this[P].buf+=e,this[P].sync)try{return TI(this),!0}catch(r){return _n(this,r),!1}return this[P].flushing||(this[P].flushing=!0,setImmediate(Ef,this)),this[P].needDrain=this[P].data.length-this[P].buf.length-Atomics.load(this[P].state,lr)<=0,!this[P].needDrain}end(){this[P].destroyed||(this[P].ending=!0,VI(this))}flush(e){if(this[P].destroyed){typeof e=="function"&&process.nextTick(e,new Error("the worker has exited"));return}let r=Atomics.load(this[P].state,lr);Z5(this[P].state,vn,r,1/0,(n,s)=>{if(n){_n(this,n),process.nextTick(e,n);return}if(s==="not-equal"){this.flush(e);return}process.nextTick(e)})}flushSync(){this[P].destroyed||(TI(this),NI(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[P].ready}get destroyed(){return this[P].destroyed}get closed(){return this[P].closed}get writable(){return!this[P].destroyed&&!this[P].ending}get writableEnded(){return this[P].ending}get writableFinished(){return this[P].finished}get writableNeedDrain(){return this[P].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[P].errored}};function ZI(t,e){setImmediate(()=>{t.emit("error",e)})}function _n(t,e){t[P].destroyed||(t[P].destroyed=!0,e&&(t[P].errored=e,ZI(t,e)),t.worker.exited?setImmediate(()=>{t[P].closed=!0,t.emit("close")}):t.worker.terminate().catch(()=>{}).then(()=>{t[P].closed=!0,t.emit("close")}))}function Bf(t,e,r){let n=Atomics.load(t[P].state,lr),s=Buffer.byteLength(e);return t[P].data.write(e,n),Atomics.store(t[P].state,lr,n+s),Atomics.notify(t[P].state,lr),r(),!0}function VI(t){if(!(t[P].ended||!t[P].ending||t[P].flushing)){t[P].ended=!0;try{t.flushSync();let e=Atomics.load(t[P].state,vn);Atomics.store(t[P].state,lr,-1),Atomics.notify(t[P].state,lr);let r=0;for(;e!==-1;){if(Atomics.wait(t[P].state,vn,e,1e3),e=Atomics.load(t[P].state,vn),e===-2){_n(t,new Error("end() failed"));return}if(++r===10){_n(t,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{t[P].finished=!0,t.emit("finish")})}catch(e){_n(t,e)}}}function TI(t){let e=()=>{t[P].ending?VI(t):t[P].needDrain&&process.nextTick(kG,t)};for(t[P].flushing=!1;t[P].buf.length!==0;){let r=Atomics.load(t[P].state,lr),n=t[P].data.length-r;if(n===0){NI(t),Atomics.store(t[P].state,vn,0),Atomics.store(t[P].state,lr,0);continue}else if(n<0)throw new Error("overwritten");let s=t[P].buf.slice(0,n),i=Buffer.byteLength(s);if(i<=n)t[P].buf=t[P].buf.slice(n),Bf(t,s,e);else{for(NI(t),Atomics.store(t[P].state,vn,0),Atomics.store(t[P].state,lr,0);i>t[P].buf.length;)n=n/2,s=t[P].buf.slice(0,n),i=Buffer.byteLength(s);t[P].buf=t[P].buf.slice(n),Bf(t,s,e)}}}function NI(t){if(t[P].flushing)throw new Error("unable to flush while flushing");let e=Atomics.load(t[P].state,lr),r=0;for(;;){let n=Atomics.load(t[P].state,vn);if(n===-2)throw Error("_flushSync failed");if(n!==e)Atomics.wait(t[P].state,vn,n,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}xG.exports=GI});var OI=h((STe,UG)=>{"use strict";var{createRequire:F5}=require("module"),x5=yI(),{join:HI,isAbsolute:L5,sep:U5}=require("path"),Y5=EI(),WI=BI(),D5=LG();function X5(t){WI.register(t,j5),WI.registerBeforeExit(t,q5),t.on("close",function(){WI.unregister(t)})}function $5(t,e,r){let n=new D5({filename:t,workerData:e,workerOpts:r});n.on("ready",s),n.on("close",function(){process.removeListener("exit",i)}),process.on("exit",i);function s(){process.removeListener("exit",i),n.unref(),r.autoEnd!==!1&&X5(n)}function i(){n.closed||(n.flushSync(),Y5(100),n.end())}return n}function j5(t){t.ref(),t.flushSync(),t.end(),t.once("close",function(){t.unref()})}function q5(t){t.flushSync()}function M5(t){let{pipeline:e,targets:r,levels:n,dedupe:s,options:i={},worker:o={},caller:a=x5()}=t,c=typeof a=="string"?[a]:a,l="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},u=t.target;if(u&&r)throw new Error("only one of target or targets can be specified");return r?(u=l["pino-worker"]||HI(__dirname,"worker.js"),i.targets=r.map(f=>({...f,target:d(f.target)}))):e&&(u=l["pino-pipeline-worker"]||HI(__dirname,"worker-pipeline.js"),i.targets=e.map(f=>({...f,target:d(f.target)}))),n&&(i.levels=n),s&&(i.dedupe=s),$5(d(u),i,o);function d(f){if(f=l[f]||f,L5(f)||f.indexOf("file://")===0)return f;if(f==="pino/file")return HI(__dirname,"..","file.js");let g;for(let p of c)try{let m=p==="node:repl"?process.cwd()+U5:p;g=F5(m).resolve(f);break}catch{continue}if(!g)throw new Error(`unable to determine transport target for "${f}"`);return g}}UG.exports=M5});var Zf=h((vTe,QG)=>{"use strict";var YG=IG(),{mapHttpRequest:K5,mapHttpResponse:z5}=mI(),kI=EG(),DG=BI(),{lsCacheSym:J5,chindingsSym:jG,writeSym:XG,serializersSym:qG,formatOptsSym:$G,endSym:Q5,stringifiersSym:MG,stringifySym:KG,stringifySafeSym:FI,wildcardFirstSym:zG,nestedKeySym:eJ,formattersSym:JG,messageKeySym:tJ,errorKeySym:rJ,nestedKeyStrSym:nJ,msgPrefixSym:Tf}=sa(),{isMainThread:sJ}=require("worker_threads"),iJ=OI();function oa(){}function oJ(t,e){if(!e)return r;return function(...s){e.call(this,s,r,t)};function r(n,...s){if(typeof n=="object"){let i=n;n!==null&&(n.method&&n.headers&&n.socket?n=K5(n):typeof n.setHeader=="function"&&(n=z5(n)));let o;i===null&&s.length===0?o=[null]:(i=s.shift(),o=s),typeof this[Tf]=="string"&&i!==void 0&&i!==null&&(i=this[Tf]+i),this[XG](n,YG(i,o,this[$G]),t)}else{let i=n===void 0?s.shift():n;typeof this[Tf]=="string"&&i!==void 0&&i!==null&&(i=this[Tf]+i),this[XG](null,YG(i,s,this[$G]),t)}}}function PI(t){let e="",r=0,n=!1,s=255,i=t.length;if(i>100)return JSON.stringify(t);for(var o=0;o<i&&s>=32;o++)s=t.charCodeAt(o),(s===34||s===92)&&(e+=t.slice(r,o)+"\\",r=o,n=!0);return n?e+=t.slice(r):e=t,s<32?JSON.stringify(t):'"'+e+'"'}function aJ(t,e,r,n){let s=this[KG],i=this[FI],o=this[MG],a=this[Q5],c=this[jG],l=this[qG],u=this[JG],d=this[tJ],f=this[rJ],g=this[J5][r]+n;g=g+c;let p;u.log&&(t=u.log(t));let m=o[zG],I="";for(let S in t)if(p=t[S],Object.prototype.hasOwnProperty.call(t,S)&&p!==void 0){l[S]?p=l[S](p):S===f&&l.err&&(p=l.err(p));let b=o[S]||m;switch(typeof p){case"undefined":case"function":continue;case"number":Number.isFinite(p)===!1&&(p=null);case"boolean":b&&(p=b(p));break;case"string":p=(b||PI)(p);break;default:p=(b||s)(p,i)}if(p===void 0)continue;let y=PI(S);I+=","+y+":"+p}let C="";if(e!==void 0){p=l[d]?l[d](e):e;let S=o[d]||m;switch(typeof p){case"function":break;case"number":Number.isFinite(p)===!1&&(p=null);case"boolean":S&&(p=S(p)),C=',"'+d+'":'+p;break;case"string":p=(S||PI)(p),C=',"'+d+'":'+p;break;default:p=(S||s)(p,i),C=',"'+d+'":'+p}}return this[eJ]&&I?g+this[nJ]+I.slice(1)+"}"+C+a:g+I+C+a}function cJ(t,e){let r,n=t[jG],s=t[KG],i=t[FI],o=t[MG],a=o[zG],c=t[qG],l=t[JG].bindings;e=l(e);for(let u in e)if(r=e[u],(u!=="level"&&u!=="serializers"&&u!=="formatters"&&u!=="customLevels"&&e.hasOwnProperty(u)&&r!==void 0)===!0){if(r=c[u]?c[u](r):r,r=(o[u]||a||s)(r,i),r===void 0)continue;n+=',"'+u+'":'+r}return n}function lJ(t){return t.write!==t.constructor.prototype.write}var uJ=process.env.NODE_V8_COVERAGE||process.env.V8_COVERAGE;function Gf(t){let e=new kI(t);return e.on("error",r),!uJ&&!t.sync&&sJ&&(DG.register(e,dJ),e.on("close",function(){DG.unregister(e)})),e;function r(n){if(n.code==="EPIPE"){e.write=oa,e.end=oa,e.flushSync=oa,e.destroy=oa;return}e.removeListener("error",r),e.emit("error",n)}}function dJ(t,e){t.destroyed||(e==="beforeExit"?(t.flush(),t.on("drain",function(){t.end()})):t.flushSync())}function fJ(t){return function(r,n,s={},i){if(typeof s=="string")i=Gf({dest:s}),s={};else if(typeof i=="string"){if(s&&s.transport)throw Error("only one of option.transport or stream can be specified");i=Gf({dest:i})}else if(s instanceof kI||s.writable||s._writableState)i=s,s={};else if(s.transport){if(s.transport instanceof kI||s.transport.writable||s.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(s.transport.targets&&s.transport.targets.length&&s.formatters&&typeof s.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let c;s.customLevels&&(c=s.useOnlyCustomLevels?s.customLevels:Object.assign({},s.levels,s.customLevels)),i=iJ({caller:n,...s.transport,levels:c})}if(s=Object.assign({},t,s),s.serializers=Object.assign({},t.serializers,s.serializers),s.formatters=Object.assign({},t.formatters,s.formatters),s.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:o,onChild:a}=s;return o===!1&&(s.level="silent"),a||(s.onChild=oa),i||(lJ(process.stdout)?i=process.stdout:i=Gf({fd:process.stdout.fd||1})),{opts:s,stream:i}}}function gJ(t,e){try{return JSON.stringify(t)}catch{try{return(e||this[FI])(t)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function pJ(t,e,r){return{level:t,bindings:e,log:r}}function hJ(t){let e=Number(t);return typeof t=="string"&&Number.isFinite(e)?e:t===void 0?1:t}QG.exports={noop:oa,buildSafeSonicBoom:Gf,asChindings:cJ,asJson:aJ,genLog:oJ,createArgsNormalizer:fJ,stringify:gJ,buildFormatters:pJ,normalizeDestFileDescriptor:hJ}});var Nf=h((_Te,tZ)=>{"use strict";var{lsCacheSym:mJ,levelValSym:xI,useOnlyCustomLevelsSym:yJ,streamSym:IJ,formattersSym:bJ,hooksSym:CJ}=sa(),{noop:SJ,genLog:ji}=Zf(),nn={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},eZ={fatal:t=>{let e=ji(nn.fatal,t);return function(...r){let n=this[IJ];if(e.call(this,...r),typeof n.flushSync=="function")try{n.flushSync()}catch{}}},error:t=>ji(nn.error,t),warn:t=>ji(nn.warn,t),info:t=>ji(nn.info,t),debug:t=>ji(nn.debug,t),trace:t=>ji(nn.trace,t)},LI=Object.keys(nn).reduce((t,e)=>(t[nn[e]]=e,t),{}),vJ=Object.keys(LI).reduce((t,e)=>(t[e]='{"level":'+Number(e),t),{});function _J(t){let e=t[bJ].level,{labels:r}=t.levels,n={};for(let s in r){let i=e(r[s],Number(s));n[s]=JSON.stringify(i).slice(0,-1)}return t[mJ]=n,t}function AJ(t,e){if(e)return!1;switch(t){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function RJ(t){let{labels:e,values:r}=this.levels;if(typeof t=="number"){if(e[t]===void 0)throw Error("unknown level value"+t);t=e[t]}if(r[t]===void 0)throw Error("unknown level "+t);let n=this[xI],s=this[xI]=r[t],i=this[yJ],o=this[CJ].logMethod;for(let a in r){if(s>r[a]){this[a]=SJ;continue}this[a]=AJ(a,i)?eZ[a](o):ji(r[a],o)}this.emit("level-change",t,s,e[n],n,this)}function EJ(t){let{levels:e,levelVal:r}=this;return e&&e.labels?e.labels[r]:""}function wJ(t){let{values:e}=this.levels,r=e[t];return r!==void 0&&r>=this[xI]}function BJ(t=null,e=!1){let r=t?Object.keys(t).reduce((i,o)=>(i[t[o]]=o,i),{}):null,n=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),e?null:LI,r),s=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),e?null:nn,t);return{labels:n,values:s}}function TJ(t,e,r){if(typeof t=="number"){if(![].concat(Object.keys(e||{}).map(i=>e[i]),r?[]:Object.keys(LI).map(i=>+i),1/0).includes(t))throw Error(`default level:${t} must be included in custom levels`);return}let n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:nn,e);if(!(t in n))throw Error(`default level:${t} must be included in custom levels`)}function GJ(t,e){let{labels:r,values:n}=t;for(let s in e){if(s in n)throw Error("levels cannot be overridden");if(e[s]in r)throw Error("pre-existing level values cannot be used for new levels")}}tZ.exports={initialLsCache:vJ,genLsCache:_J,levelMethods:eZ,getLevel:EJ,setLevel:RJ,isLevelEnabled:wJ,mappings:BJ,levels:nn,assertNoLevelCollisions:GJ,assertDefaultLevelFound:TJ}});var UI=h((ATe,rZ)=>{"use strict";rZ.exports={version:"8.17.0"}});var gZ=h((ETe,fZ)=>{"use strict";var{EventEmitter:ZJ}=require("events"),{lsCacheSym:NJ,levelValSym:VJ,setLevelSym:DI,getLevelSym:nZ,chindingsSym:XI,parsedChindingsSym:HJ,mixinSym:WJ,asJsonSym:cZ,writeSym:OJ,mixinMergeStrategySym:PJ,timeSym:kJ,timeSliceIndexSym:FJ,streamSym:lZ,serializersSym:qi,formattersSym:YI,errorKeySym:xJ,messageKeySym:LJ,useOnlyCustomLevelsSym:UJ,needsMetadataGsym:YJ,redactFmtSym:DJ,stringifySym:XJ,formatOptsSym:$J,stringifiersSym:jJ,msgPrefixSym:sZ}=sa(),{getLevel:qJ,setLevel:MJ,isLevelEnabled:KJ,mappings:zJ,initialLsCache:JJ,genLsCache:QJ,assertNoLevelCollisions:e3}=Nf(),{asChindings:uZ,asJson:t3,buildFormatters:iZ,stringify:oZ}=Zf(),{version:r3}=UI(),n3=AI(),s3=class{},dZ={constructor:s3,child:i3,bindings:o3,setBindings:a3,flush:d3,isLevelEnabled:KJ,version:r3,get level(){return this[nZ]()},set level(t){this[DI](t)},get levelVal(){return this[VJ]},set levelVal(t){throw Error("levelVal is read-only")},[NJ]:JJ,[OJ]:l3,[cZ]:t3,[nZ]:qJ,[DI]:MJ};Object.setPrototypeOf(dZ,ZJ.prototype);fZ.exports=function(){return Object.create(dZ)};var aZ=t=>t;function i3(t,e){if(!t)throw Error("missing bindings for child Pino");e=e||{};let r=this[qi],n=this[YI],s=Object.create(this);if(e.hasOwnProperty("serializers")===!0){s[qi]=Object.create(null);for(let u in r)s[qi][u]=r[u];let c=Object.getOwnPropertySymbols(r);for(var i=0;i<c.length;i++){let u=c[i];s[qi][u]=r[u]}for(let u in e.serializers)s[qi][u]=e.serializers[u];let l=Object.getOwnPropertySymbols(e.serializers);for(var o=0;o<l.length;o++){let u=l[o];s[qi][u]=e.serializers[u]}}else s[qi]=r;if(e.hasOwnProperty("formatters")){let{level:c,bindings:l,log:u}=e.formatters;s[YI]=iZ(c||n.level,l||aZ,u||n.log)}else s[YI]=iZ(n.level,aZ,n.log);if(e.hasOwnProperty("customLevels")===!0&&(e3(this.levels,e.customLevels),s.levels=zJ(e.customLevels,s[UJ]),QJ(s)),typeof e.redact=="object"&&e.redact!==null||Array.isArray(e.redact)){s.redact=e.redact;let c=n3(s.redact,oZ),l={stringify:c[DJ]};s[XJ]=oZ,s[jJ]=c,s[$J]=l}typeof e.msgPrefix=="string"&&(s[sZ]=(this[sZ]||"")+e.msgPrefix),s[XI]=uZ(s,t);let a=e.level||this.level;return s[DI](a),this.onChild(s),s}function o3(){let e=`{${this[XI].substr(1)}}`,r=JSON.parse(e);return delete r.pid,delete r.hostname,r}function a3(t){let e=uZ(this,t);this[XI]=e,delete this[HJ]}function c3(t,e){return Object.assign(e,t)}function l3(t,e,r){let n=this[kJ](),s=this[WJ],i=this[xJ],o=this[LJ],a=this[PJ]||c3,c;t==null?c={}:t instanceof Error?(c={[i]:t},e===void 0&&(e=t.message)):(c=t,e===void 0&&t[o]===void 0&&t[i]&&(e=t[i].message)),s&&(c=a(c,s(c,r,this)));let l=this[cZ](c,e,r,n),u=this[lZ];u[YJ]===!0&&(u.lastLevel=r,u.lastObj=c,u.lastMsg=e,u.lastTime=n.slice(this[FJ]),u.lastLogger=this),u.write(l)}function u3(){}function d3(t){if(t!=null&&typeof t!="function")throw Error("callback must be a function");let e=this[lZ];typeof e.flush=="function"?e.flush(t||u3):t&&t()}});var IZ=h((MI,yZ)=>{"use strict";var{hasOwnProperty:Vf}=Object.prototype,Ki=qI();Ki.configure=qI;Ki.stringify=Ki;Ki.default=Ki;MI.stringify=Ki;MI.configure=qI;yZ.exports=Ki;var f3=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;function zs(t){return t.length<5e3&&!f3.test(t)?`"${t}"`:JSON.stringify(t)}function $I(t){if(t.length>200)return t.sort();for(let e=1;e<t.length;e++){let r=t[e],n=e;for(;n!==0&&t[n-1]>r;)t[n]=t[n-1],n--;t[n]=r}return t}var g3=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function jI(t){return g3.call(t)!==void 0&&t.length!==0}function pZ(t,e,r){t.length<r&&(r=t.length);let n=e===","?"":" ",s=`"0":${n}${t[0]}`;for(let i=1;i<r;i++)s+=`${e}"${i}":${n}${t[i]}`;return s}function p3(t){if(Vf.call(t,"circularValue")){let e=t.circularValue;if(typeof e=="string")return`"${e}"`;if(e==null)return e;if(e===Error||e===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function hZ(t,e){let r;if(Vf.call(t,e)&&(r=t[e],typeof r!="boolean"))throw new TypeError(`The "${e}" argument must be of type boolean`);return r===void 0?!0:r}function mZ(t,e){let r;if(Vf.call(t,e)){if(r=t[e],typeof r!="number")throw new TypeError(`The "${e}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${e}" argument must be an integer`);if(r<1)throw new RangeError(`The "${e}" argument must be >= 1`)}return r===void 0?1/0:r}function Mi(t){return t===1?"1 item":`${t} items`}function h3(t){let e=new Set;for(let r of t)(typeof r=="string"||typeof r=="number")&&e.add(String(r));return e}function m3(t){if(Vf.call(t,"strict")){let e=t.strict;if(typeof e!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(e)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}function qI(t){t={...t};let e=m3(t);e&&(t.bigint===void 0&&(t.bigint=!1),"circularValue"in t||(t.circularValue=Error));let r=p3(t),n=hZ(t,"bigint"),s=hZ(t,"deterministic"),i=mZ(t,"maximumDepth"),o=mZ(t,"maximumBreadth");function a(f,g,p,m,I,C){let S=g[f];switch(typeof S=="object"&&S!==null&&typeof S.toJSON=="function"&&(S=S.toJSON(f)),S=m.call(g,f,S),typeof S){case"string":return zs(S);case"object":{if(S===null)return"null";if(p.indexOf(S)!==-1)return r;let b="",y=",",A=C;if(Array.isArray(S)){if(S.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(S),I!==""&&(C+=I,b+=`
${C}`,y=`,
${C}`);let x=Math.min(S.length,o),F=0;for(;F<x-1;F++){let ie=a(String(F),S,p,m,I,C);b+=ie!==void 0?ie:"null",b+=y}let L=a(String(F),S,p,m,I,C);if(b+=L!==void 0?L:"null",S.length-1>o){let ie=S.length-o-1;b+=`${y}"... ${Mi(ie)} not stringified"`}return I!==""&&(b+=`
${A}`),p.pop(),`[${b}]`}let E=Object.keys(S),v=E.length;if(v===0)return"{}";if(i<p.length+1)return'"[Object]"';let B="",H="";I!==""&&(C+=I,y=`,
${C}`,B=" ");let R=Math.min(v,o);s&&!jI(S)&&(E=$I(E)),p.push(S);for(let x=0;x<R;x++){let F=E[x],L=a(F,S,p,m,I,C);L!==void 0&&(b+=`${H}${zs(F)}:${B}${L}`,H=y)}if(v>o){let x=v-o;b+=`${H}"...":${B}"${Mi(x)} not stringified"`,H=y}return I!==""&&H.length>1&&(b=`
${C}${b}
${A}`),p.pop(),`{${b}}`}case"number":return isFinite(S)?String(S):e?e(S):"null";case"boolean":return S===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(S);default:return e?e(S):void 0}}function c(f,g,p,m,I,C){switch(typeof g=="object"&&g!==null&&typeof g.toJSON=="function"&&(g=g.toJSON(f)),typeof g){case"string":return zs(g);case"object":{if(g===null)return"null";if(p.indexOf(g)!==-1)return r;let S=C,b="",y=",";if(Array.isArray(g)){if(g.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(g),I!==""&&(C+=I,b+=`
${C}`,y=`,
${C}`);let v=Math.min(g.length,o),B=0;for(;B<v-1;B++){let R=c(String(B),g[B],p,m,I,C);b+=R!==void 0?R:"null",b+=y}let H=c(String(B),g[B],p,m,I,C);if(b+=H!==void 0?H:"null",g.length-1>o){let R=g.length-o-1;b+=`${y}"... ${Mi(R)} not stringified"`}return I!==""&&(b+=`
${S}`),p.pop(),`[${b}]`}p.push(g);let A="";I!==""&&(C+=I,y=`,
${C}`,A=" ");let E="";for(let v of m){let B=c(v,g[v],p,m,I,C);B!==void 0&&(b+=`${E}${zs(v)}:${A}${B}`,E=y)}return I!==""&&E.length>1&&(b=`
${C}${b}
${S}`),p.pop(),`{${b}}`}case"number":return isFinite(g)?String(g):e?e(g):"null";case"boolean":return g===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(g);default:return e?e(g):void 0}}function l(f,g,p,m,I){switch(typeof g){case"string":return zs(g);case"object":{if(g===null)return"null";if(typeof g.toJSON=="function"){if(g=g.toJSON(f),typeof g!="object")return l(f,g,p,m,I);if(g===null)return"null"}if(p.indexOf(g)!==-1)return r;let C=I;if(Array.isArray(g)){if(g.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(g),I+=m;let B=`
${I}`,H=`,
${I}`,R=Math.min(g.length,o),x=0;for(;x<R-1;x++){let L=l(String(x),g[x],p,m,I);B+=L!==void 0?L:"null",B+=H}let F=l(String(x),g[x],p,m,I);if(B+=F!==void 0?F:"null",g.length-1>o){let L=g.length-o-1;B+=`${H}"... ${Mi(L)} not stringified"`}return B+=`
${C}`,p.pop(),`[${B}]`}let S=Object.keys(g),b=S.length;if(b===0)return"{}";if(i<p.length+1)return'"[Object]"';I+=m;let y=`,
${I}`,A="",E="",v=Math.min(b,o);jI(g)&&(A+=pZ(g,y,o),S=S.slice(g.length),v-=g.length,E=y),s&&(S=$I(S)),p.push(g);for(let B=0;B<v;B++){let H=S[B],R=l(H,g[H],p,m,I);R!==void 0&&(A+=`${E}${zs(H)}: ${R}`,E=y)}if(b>o){let B=b-o;A+=`${E}"...": "${Mi(B)} not stringified"`,E=y}return E!==""&&(A=`
${I}${A}
${C}`),p.pop(),`{${A}}`}case"number":return isFinite(g)?String(g):e?e(g):"null";case"boolean":return g===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(g);default:return e?e(g):void 0}}function u(f,g,p){switch(typeof g){case"string":return zs(g);case"object":{if(g===null)return"null";if(typeof g.toJSON=="function"){if(g=g.toJSON(f),typeof g!="object")return u(f,g,p);if(g===null)return"null"}if(p.indexOf(g)!==-1)return r;let m="";if(Array.isArray(g)){if(g.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(g);let y=Math.min(g.length,o),A=0;for(;A<y-1;A++){let v=u(String(A),g[A],p);m+=v!==void 0?v:"null",m+=","}let E=u(String(A),g[A],p);if(m+=E!==void 0?E:"null",g.length-1>o){let v=g.length-o-1;m+=`,"... ${Mi(v)} not stringified"`}return p.pop(),`[${m}]`}let I=Object.keys(g),C=I.length;if(C===0)return"{}";if(i<p.length+1)return'"[Object]"';let S="",b=Math.min(C,o);jI(g)&&(m+=pZ(g,",",o),I=I.slice(g.length),b-=g.length,S=","),s&&(I=$I(I)),p.push(g);for(let y=0;y<b;y++){let A=I[y],E=u(A,g[A],p);E!==void 0&&(m+=`${S}${zs(A)}:${E}`,S=",")}if(C>o){let y=C-o;m+=`${S}"...":"${Mi(y)} not stringified"`}return p.pop(),`{${m}}`}case"number":return isFinite(g)?String(g):e?e(g):"null";case"boolean":return g===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(g);default:return e?e(g):void 0}}function d(f,g,p){if(arguments.length>1){let m="";if(typeof p=="number"?m=" ".repeat(Math.min(p,10)):typeof p=="string"&&(m=p.slice(0,10)),g!=null){if(typeof g=="function")return a("",{"":f},[],g,m,"");if(Array.isArray(g))return c("",f,[],h3(g),m,"")}if(m.length!==0)return l("",f,[],m,"")}return u("",f,[])}return d}});var SZ=h((wTe,CZ)=>{"use strict";var KI=Symbol.for("pino.metadata"),{levels:bZ}=Nf(),y3=bZ.info;function I3(t,e){let r=0;t=t||[],e=e||{dedupe:!1};let n=Object.create(bZ);n.silent=1/0,e.levels&&typeof e.levels=="object"&&Object.keys(e.levels).forEach(u=>{n[u]=e.levels[u]});let s={write:i,add:a,flushSync:o,end:c,minLevel:0,streams:[],clone:l,[KI]:!0,streamLevels:n};return Array.isArray(t)?t.forEach(a,s):a.call(s,t),t=null,s;function i(u){let d,f=this.lastLevel,{streams:g}=this,p=0,m;for(let I=C3(g.length,e.dedupe);v3(I,g.length,e.dedupe);I=S3(I,e.dedupe))if(d=g[I],d.level<=f){if(p!==0&&p!==d.level)break;if(m=d.stream,m[KI]){let{lastTime:C,lastMsg:S,lastObj:b,lastLogger:y}=this;m.lastLevel=f,m.lastTime=C,m.lastMsg=S,m.lastObj=b,m.lastLogger=y}m.write(u),e.dedupe&&(p=d.level)}else if(!e.dedupe)break}function o(){for(let{stream:u}of this.streams)typeof u.flushSync=="function"&&u.flushSync()}function a(u){if(!u)return s;let d=typeof u.write=="function"||u.stream,f=u.write?u:u.stream;if(!d)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:g,streamLevels:p}=this,m;typeof u.levelVal=="number"?m=u.levelVal:typeof u.level=="string"?m=p[u.level]:typeof u.level=="number"?m=u.level:m=y3;let I={stream:f,level:m,levelVal:void 0,id:r++};return g.unshift(I),g.sort(b3),this.minLevel=g[0].level,s}function c(){for(let{stream:u}of this.streams)typeof u.flushSync=="function"&&u.flushSync(),u.end()}function l(u){let d=new Array(this.streams.length);for(let f=0;f<d.length;f++)d[f]={level:u,stream:this.streams[f].stream};return{write:i,add:a,minLevel:u,streams:d,clone:l,flushSync:o,[KI]:!0}}}function b3(t,e){return t.level-e.level}function C3(t,e){return e?t-1:0}function S3(t,e){return e?t-1:t+1}function v3(t,e,r){return r?t>=0:t<e}CZ.exports=I3});var HZ=h((BTe,Hr)=>{"use strict";var _3=require("os"),TZ=mI(),A3=yI(),R3=AI(),GZ=mG(),E3=gZ(),ZZ=sa(),{configure:w3}=IZ(),{assertDefaultLevelFound:B3,mappings:NZ,genLsCache:T3,levels:G3}=Nf(),{createArgsNormalizer:Z3,asChindings:N3,buildSafeSonicBoom:vZ,buildFormatters:V3,stringify:zI,normalizeDestFileDescriptor:_Z,noop:H3}=Zf(),{version:W3}=UI(),{chindingsSym:AZ,redactFmtSym:O3,serializersSym:RZ,timeSym:P3,timeSliceIndexSym:k3,streamSym:F3,stringifySym:EZ,stringifySafeSym:JI,stringifiersSym:wZ,setLevelSym:x3,endSym:L3,formatOptsSym:U3,messageKeySym:Y3,errorKeySym:D3,nestedKeySym:X3,mixinSym:$3,useOnlyCustomLevelsSym:j3,formattersSym:BZ,hooksSym:q3,nestedKeyStrSym:M3,mixinMergeStrategySym:K3,msgPrefixSym:z3}=ZZ,{epochTime:VZ,nullTime:J3}=GZ,{pid:Q3}=process,e4=_3.hostname(),t4=TZ.err,r4={level:"info",levels:G3,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:Q3,hostname:e4},serializers:Object.assign(Object.create(null),{err:t4}),formatters:Object.assign(Object.create(null),{bindings(t){return t},level(t,e){return{level:e}}}),hooks:{logMethod:void 0},timestamp:VZ,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},n4=Z3(r4),s4=Object.assign(Object.create(null),TZ);function QI(...t){let e={},{opts:r,stream:n}=n4(e,A3(),...t),{redact:s,crlf:i,serializers:o,timestamp:a,messageKey:c,errorKey:l,nestedKey:u,base:d,name:f,level:g,customLevels:p,mixin:m,mixinMergeStrategy:I,useOnlyCustomLevels:C,formatters:S,hooks:b,depthLimit:y,edgeLimit:A,onChild:E,msgPrefix:v}=r,B=w3({maximumDepth:y,maximumBreadth:A}),H=V3(S.level,S.bindings,S.log),R=zI.bind({[JI]:B}),x=s?R3(s,R):{},F=s?{stringify:x[O3]}:{stringify:R},L="}"+(i?`\r
`:`
`),ie=N3.bind(null,{[AZ]:"",[RZ]:o,[wZ]:x,[EZ]:zI,[JI]:B,[BZ]:H}),pe="";d!==null&&(f===void 0?pe=ie(d):pe=ie(Object.assign({},d,{name:f})));let $=a instanceof Function?a:a?VZ:J3,ee=$().indexOf(":")+1;if(C&&!p)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(m&&typeof m!="function")throw Error(`Unknown mixin type "${typeof m}" - expected "function"`);if(v&&typeof v!="string")throw Error(`Unknown msgPrefix type "${typeof v}" - expected "string"`);B3(g,p,C);let ke=NZ(p,C);return Object.assign(e,{levels:ke,[j3]:C,[F3]:n,[P3]:$,[k3]:ee,[EZ]:zI,[JI]:B,[wZ]:x,[L3]:L,[U3]:F,[Y3]:c,[D3]:l,[X3]:u,[M3]:u?`,${JSON.stringify(u)}:{`:"",[RZ]:o,[$3]:m,[K3]:I,[AZ]:pe,[BZ]:H,[q3]:b,silent:H3,onChild:E,[z3]:v}),Object.setPrototypeOf(e,E3()),T3(e),e[x3](g),e}Hr.exports=QI;Hr.exports.destination=(t=process.stdout.fd)=>typeof t=="object"?(t.dest=_Z(t.dest||process.stdout.fd),vZ(t)):vZ({dest:_Z(t),minLength:0});Hr.exports.transport=OI();Hr.exports.multistream=SZ();Hr.exports.levels=NZ();Hr.exports.stdSerializers=s4;Hr.exports.stdTimeFunctions=Object.assign({},GZ);Hr.exports.symbols=ZZ;Hr.exports.version=W3;Hr.exports.default=QI;Hr.exports.pino=QI});var tl=h((TTe,FZ)=>{"use strict";var i4=ET(),Hf=HZ(),{serializersSym:WZ}=Hf.symbols,{FST_ERR_LOG_INVALID_DESTINATION:o4,FST_ERR_LOG_INVALID_LOGGER:a4}=Yt();function OZ(t){if(t.stream&&t.file)throw new o4;t.file&&(t.stream=Hf.destination(t.file),delete t.file);let e=t.logger,r=t.genReqId,n=null;return e?(t.logger=void 0,t.genReqId=void 0,e[WZ]&&(t.serializers=Object.assign({},t.serializers,e[WZ])),n=e.child({},t),t.logger=e,t.genReqId=r):n=Hf(t,t.stream),n}var eb={req:function(e){return{method:e.method,url:e.url,version:e.headers&&e.headers["accept-version"],hostname:e.hostname,remoteAddress:e.ip,remotePort:e.socket?e.socket.remotePort:void 0}},err:Hf.stdSerializers.err,res:function(e){return{statusCode:e.statusCode}}};function c4(){let t=process.hrtime();return t[0]*1e3+t[1]/1e6}function l4(t){if(!t.logger){let n=i4;return n.child=()=>n,{logger:n,hasLogger:!1}}if(PZ(t.logger))return{logger:OZ({logger:t.logger,serializers:Object.assign({},eb,t.logger.serializers)}),hasLogger:!0};let e={};return Object.prototype.toString.call(t.logger)==="[object Object]"&&Reflect.ownKeys(t.logger).forEach(n=>{Object.defineProperty(e,n,{value:t.logger[n],writable:!0,enumerable:!0,configurable:!0})}),e.level=e.level||"info",e.serializers=Object.assign({},eb,e.serializers),t.logger=e,{logger:OZ(t.logger),hasLogger:!0}}function PZ(t,e){let r=["info","error","debug","fatal","warn","trace","child"],n=t?r.filter(s=>!t[s]||typeof t[s]!="function"):r;if(n.length){if(n.length===r.length&&!e)return!1;throw a4(n.join(","))}else return!0}function u4(t,e,r,n,s){let i={[t.requestIdLogLabel]:n},o=t.childLoggerFactory.call(t.server,e,i,s||{},r);return t.childLoggerFactory!==kZ&&PZ(o,!0),o}function kZ(t,e,r){return t.child(e,r)}FZ.exports={createLogger:l4,createChildLogger:u4,defaultChildLoggerFactory:kZ,serializers:eb,now:c4}});var rl=h((GTe,xZ)=>{"use strict";xZ.exports=d4;function aa(t){return t instanceof Buffer?Buffer.from(t):new t.constructor(t.buffer.slice(),t.byteOffset,t.length)}function d4(t){if(t=t||{},t.circles)return f4(t);return t.proto?n:r;function e(s,i){for(var o=Object.keys(s),a=new Array(o.length),c=0;c<o.length;c++){var l=o[c],u=s[l];typeof u!="object"||u===null?a[l]=u:u instanceof Date?a[l]=new Date(u):ArrayBuffer.isView(u)?a[l]=aa(u):a[l]=i(u)}return a}function r(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return e(s,r);if(s instanceof Map)return new Map(e(Array.from(s),r));if(s instanceof Set)return new Set(e(Array.from(s),r));var i={};for(var o in s)if(Object.hasOwnProperty.call(s,o)!==!1){var a=s[o];typeof a!="object"||a===null?i[o]=a:a instanceof Date?i[o]=new Date(a):a instanceof Map?i[o]=new Map(e(Array.from(a),r)):a instanceof Set?i[o]=new Set(e(Array.from(a),r)):ArrayBuffer.isView(a)?i[o]=aa(a):i[o]=r(a)}return i}function n(s){if(typeof s!="object"||s===null)return s;if(s instanceof Date)return new Date(s);if(Array.isArray(s))return e(s,n);if(s instanceof Map)return new Map(e(Array.from(s),n));if(s instanceof Set)return new Set(e(Array.from(s),n));var i={};for(var o in s){var a=s[o];typeof a!="object"||a===null?i[o]=a:a instanceof Date?i[o]=new Date(a):a instanceof Map?i[o]=new Map(e(Array.from(a),n)):a instanceof Set?i[o]=new Set(e(Array.from(a),n)):ArrayBuffer.isView(a)?i[o]=aa(a):i[o]=n(a)}return i}}function f4(t){var e=[],r=[];return t.proto?i:s;function n(o,a){for(var c=Object.keys(o),l=new Array(c.length),u=0;u<c.length;u++){var d=c[u],f=o[d];if(typeof f!="object"||f===null)l[d]=f;else if(f instanceof Date)l[d]=new Date(f);else if(ArrayBuffer.isView(f))l[d]=aa(f);else{var g=e.indexOf(f);g!==-1?l[d]=r[g]:l[d]=a(f)}}return l}function s(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return n(o,s);if(o instanceof Map)return new Map(n(Array.from(o),s));if(o instanceof Set)return new Set(n(Array.from(o),s));var a={};e.push(o),r.push(a);for(var c in o)if(Object.hasOwnProperty.call(o,c)!==!1){var l=o[c];if(typeof l!="object"||l===null)a[c]=l;else if(l instanceof Date)a[c]=new Date(l);else if(l instanceof Map)a[c]=new Map(n(Array.from(l),s));else if(l instanceof Set)a[c]=new Set(n(Array.from(l),s));else if(ArrayBuffer.isView(l))a[c]=aa(l);else{var u=e.indexOf(l);u!==-1?a[c]=r[u]:a[c]=s(l)}}return e.pop(),r.pop(),a}function i(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return n(o,i);if(o instanceof Map)return new Map(n(Array.from(o),i));if(o instanceof Set)return new Set(n(Array.from(o),i));var a={};e.push(o),r.push(a);for(var c in o){var l=o[c];if(typeof l!="object"||l===null)a[c]=l;else if(l instanceof Date)a[c]=new Date(l);else if(l instanceof Map)a[c]=new Map(n(Array.from(l),i));else if(l instanceof Set)a[c]=new Set(n(Array.from(l),i));else if(ArrayBuffer.isView(l))a[c]=aa(l);else{var u=e.indexOf(l);u!==-1?a[c]=r[u]:a[c]=i(l)}}return e.pop(),r.pop(),a}}});var nl=h((ZTe,DZ)=>{"use strict";var g4=rl()({circles:!1,proto:!0}),{kSchemaVisited:LZ,kSchemaResponse:p4}=Tt(),rb=Symbol.for("fluent-schema-object"),{FST_ERR_SCH_MISSING_ID:h4,FST_ERR_SCH_ALREADY_PRESENT:m4,FST_ERR_SCH_DUPLICATE:y4,FST_ERR_SCH_CONTENT_MISSING_SCHEMA:I4}=Yt(),YZ=["params","body","querystring","query","headers"];function Wf(t){this.store=t||{}}Wf.prototype.add=function(t){let e=g4(t.isFluentSchema||t.isFluentJSONSchema||t[rb]?t.valueOf():t),r=e.$id;if(!r)throw new h4;if(this.store[r])throw new m4(r);this.store[r]=e};Wf.prototype.getSchemas=function(){return Object.assign({},this.store)};Wf.prototype.getSchema=function(t){return this.store[t]};function UZ(t){return typeof t=="object"&&Object.getPrototypeOf(t)!==Object.prototype}function b4(t,e){if(t[LZ])return t;if(t.query){if(t.querystring)throw new y4("querystring");t.querystring=t.query}C4(t);for(let r of YZ){let n=t[r];n&&!UZ(n)&&(t[r]=tb(n,e.jsonShorthand))}if(t.response){let r=Object.keys(t.response);for(let n of r){if(UZ(t.response[n]))continue;let s=t.response[n].content,i=!1;if(s){let o=Object.keys(s);for(let a=0;a<o.length;a++){let c=o[a];if(!s[c].schema){if(o.length===1)break;throw new I4(c)}t.response[n].content[c].schema=tb(s[c].schema,e.jsonShorthand),a===o.length-1&&(i=!0)}}i||(t.response[n]=tb(t.response[n],e.jsonShorthand))}}return t[LZ]=!0,t}function C4(t){for(let e of YZ)t[e]&&(t[e].isFluentSchema||t[e][rb])&&(t[e]=t[e].valueOf());if(t.response){let e=Object.keys(t.response);for(let r of e)(t.response[r].isFluentSchema||t.response[r][rb])&&(t.response[r]=t.response[r].valueOf())}}function tb(t,e){return!e||t.$ref||t.oneOf||t.allOf||t.anyOf||t.$merge||t.$patch?t:!t.type&&!t.properties?{type:"object",properties:t}:t}function S4(t,e,r){let n=t[p4];if(!n)return!1;if(n[e]){if(n[e].constructor===Object&&r){let i=r.split(";",1)[0];return n[e][i]?n[e][i]:!1}return n[e]}let s=(e+"")[0]+"xx";if(n[s]){if(n[s].constructor===Object&&r){let i=r.split(";",1)[0];return n[s][i]?n[s][i]:!1}return n[s]}if(n.default){if(n.default.constructor===Object&&r){let i=r.split(";",1)[0];return n.default[i]?n.default[i]:!1}return n.default}return!1}DZ.exports={buildSchemas(t){return new Wf(t)},getSchemaSerializer:S4,normalizeSchema:b4}});var nb=h((NTe,$Z)=>{"use strict";var v4=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;$Z.exports=class XZ{constructor(e){switch(e&&e.rounding){case"floor":this.parseInteger=Math.floor;break;case"ceil":this.parseInteger=Math.ceil;break;case"round":this.parseInteger=Math.round;break;case"trunc":default:this.parseInteger=Math.trunc;break}this._options=e}asInteger(e){if(typeof e=="number"){if(e===1/0||e===-1/0)throw new Error(`The value "${e}" cannot be converted to an integer.`);if(Number.isInteger(e))return""+e;if(Number.isNaN(e))throw new Error(`The value "${e}" cannot be converted to an integer.`);return this.parseInteger(e)}else{if(e===null)return"0";if(typeof e=="bigint")return e.toString();{let r=this.parseInteger(e);if(Number.isFinite(r))return""+r;throw new Error(`The value "${e}" cannot be converted to an integer.`)}}}asNumber(e){let r=Number(e);if(Number.isNaN(r))throw new Error(`The value "${e}" cannot be converted to a number.`);return Number.isFinite(r)?""+r:"null"}asBoolean(e){return e&&"true"||"false"}asDateTime(e){if(e===null)return'""';if(e instanceof Date)return'"'+e.toISOString()+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date-time.`)}asDate(e){if(e===null)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(0,10)+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date.`)}asTime(e){if(e===null)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(11,19)+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a time.`)}asString(e){if(typeof e!="string"){if(e===null)return'""';if(e instanceof Date)return'"'+e.toISOString()+'"';e instanceof RegExp?e=e.source:e=e.toString()}return e.length<42?this.asStringSmall(e):v4.test(e)===!1?'"'+e+'"':JSON.stringify(e)}asStringSmall(e){let r=e.length,n="",s=-1,i=255;for(var o=0;o<r;o++){if(i=e.charCodeAt(o),i<32||i>=55296&&i<=57343)return JSON.stringify(e);(i===34||i===92)&&(s===-1&&(s=0),n+=e.slice(s,o)+"\\",s=o)}return s===-1&&'"'+e+'"'||'"'+n+e.slice(s)+'"'}getState(){return this._options}static restoreFromState(e){return new XZ(e)}}});var ca=h(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.regexpCode=Ee.getEsmExportName=Ee.getProperty=Ee.safeStringify=Ee.stringify=Ee.strConcat=Ee.addCodeArg=Ee.str=Ee._=Ee.nil=Ee._Code=Ee.Name=Ee.IDENTIFIER=Ee._CodeOrName=void 0;var sl=class{};Ee._CodeOrName=sl;Ee.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var zi=class extends sl{constructor(e){if(super(),!Ee.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};Ee.Name=zi;var Wr=class extends sl{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof zi&&(r[n.str]=(r[n.str]||0)+1),r),{})}};Ee._Code=Wr;Ee.nil=new Wr("");function jZ(t,...e){let r=[t[0]],n=0;for(;n<e.length;)ib(r,e[n]),r.push(t[++n]);return new Wr(r)}Ee._=jZ;var sb=new Wr("+");function qZ(t,...e){let r=[il(t[0])],n=0;for(;n<e.length;)r.push(sb),ib(r,e[n]),r.push(sb,il(t[++n]));return _4(r),new Wr(r)}Ee.str=qZ;function ib(t,e){e instanceof Wr?t.push(...e._items):e instanceof zi?t.push(e):t.push(E4(e))}Ee.addCodeArg=ib;function _4(t){let e=1;for(;e<t.length-1;){if(t[e]===sb){let r=A4(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function A4(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof zi||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof zi))return`"${t}${e.slice(1)}`}function R4(t,e){return e.emptyStr()?t:t.emptyStr()?e:qZ`${t}${e}`}Ee.strConcat=R4;function E4(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:il(Array.isArray(t)?t.join(","):t)}function w4(t){return new Wr(il(t))}Ee.stringify=w4;function il(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Ee.safeStringify=il;function B4(t){return typeof t=="string"&&Ee.IDENTIFIER.test(t)?new Wr(`.${t}`):jZ`[${t}]`}Ee.getProperty=B4;function T4(t){if(typeof t=="string"&&Ee.IDENTIFIER.test(t))return new Wr(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}Ee.getEsmExportName=T4;function G4(t){return new Wr(t.toString())}Ee.regexpCode=G4});var kf=h(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.ValueScope=tr.ValueScopeName=tr.Scope=tr.varKinds=tr.UsedValueState=void 0;var ur=ca(),ob=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},ab;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(ab=tr.UsedValueState||(tr.UsedValueState={}));tr.varKinds={const:new ur.Name("const"),let:new ur.Name("let"),var:new ur.Name("var")};var Of=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof ur.Name?e:this.name(e)}name(e){return new ur.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};tr.Scope=Of;var Pf=class extends ur.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,ur._)`.${new ur.Name(r)}[${n}]`}};tr.ValueScopeName=Pf;var Z4=(0,ur._)`\n`,cb=class extends Of{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?Z4:ur.nil}}get(){return this._scope}name(e){return new Pf(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:i}=s,o=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[i];if(a){let u=a.get(o);if(u)return u}else a=this._values[i]=new Map;a.set(o,s);let c=this._scope[i]||(this._scope[i]=[]),l=c.length;return c[l]=r.ref,s.setValue(r,{property:i,itemIndex:l}),s}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,ur._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,s=>{if(s.value===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return s.value.code},r,n)}_reduceValues(e,r,n={},s){let i=ur.nil;for(let o in e){let a=e[o];if(!a)continue;let c=n[o]=n[o]||new Map;a.forEach(l=>{if(c.has(l))return;c.set(l,ab.Started);let u=r(l);if(u){let d=this.opts.es5?tr.varKinds.var:tr.varKinds.const;i=(0,ur._)`${i}${d} ${l} = ${u};${this.opts._n}`}else if(u=s?.(l))i=(0,ur._)`${i}${u}${this.opts._n}`;else throw new ob(l);c.set(l,ab.Completed)})}return i}};tr.ValueScope=cb});var ne=h(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.or=me.and=me.not=me.CodeGen=me.operators=me.varKinds=me.ValueScopeName=me.ValueScope=me.Scope=me.Name=me.regexpCode=me.stringify=me.getProperty=me.nil=me.strConcat=me.str=me._=void 0;var ve=ca(),sn=kf(),Js=ca();Object.defineProperty(me,"_",{enumerable:!0,get:function(){return Js._}});Object.defineProperty(me,"str",{enumerable:!0,get:function(){return Js.str}});Object.defineProperty(me,"strConcat",{enumerable:!0,get:function(){return Js.strConcat}});Object.defineProperty(me,"nil",{enumerable:!0,get:function(){return Js.nil}});Object.defineProperty(me,"getProperty",{enumerable:!0,get:function(){return Js.getProperty}});Object.defineProperty(me,"stringify",{enumerable:!0,get:function(){return Js.stringify}});Object.defineProperty(me,"regexpCode",{enumerable:!0,get:function(){return Js.regexpCode}});Object.defineProperty(me,"Name",{enumerable:!0,get:function(){return Js.Name}});var Uf=kf();Object.defineProperty(me,"Scope",{enumerable:!0,get:function(){return Uf.Scope}});Object.defineProperty(me,"ValueScope",{enumerable:!0,get:function(){return Uf.ValueScope}});Object.defineProperty(me,"ValueScopeName",{enumerable:!0,get:function(){return Uf.ValueScopeName}});Object.defineProperty(me,"varKinds",{enumerable:!0,get:function(){return Uf.varKinds}});me.operators={GT:new ve._Code(">"),GTE:new ve._Code(">="),LT:new ve._Code("<"),LTE:new ve._Code("<="),EQ:new ve._Code("==="),NEQ:new ve._Code("!=="),NOT:new ve._Code("!"),OR:new ve._Code("||"),AND:new ve._Code("&&"),ADD:new ve._Code("+")};var as=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},lb=class extends as{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?sn.varKinds.var:this.varKind,s=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${s};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=ua(this.rhs,e,r)),this}get names(){return this.rhs instanceof ve._CodeOrName?this.rhs.names:{}}},Ff=class extends as{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof ve.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=ua(this.rhs,e,r),this}get names(){let e=this.lhs instanceof ve.Name?{}:{...this.lhs.names};return Lf(e,this.rhs)}},ub=class extends Ff{constructor(e,r,n,s){super(e,n,s),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},db=class extends as{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},fb=class extends as{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},gb=class extends as{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},pb=class extends as{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=ua(this.code,e,r),this}get names(){return this.code instanceof ve._CodeOrName?this.code.names:{}}},ol=class extends as{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,s=n.length;for(;s--;){let i=n[s];i.optimizeNames(e,r)||(N4(e,i.names),n.splice(s,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>eo(e,r.names),{})}},cs=class extends ol{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},hb=class extends ol{},la=class extends cs{};la.kind="else";var Ji=class t extends cs{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new la(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(MZ(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=ua(this.condition,e,r),this}get names(){let e=super.names;return Lf(e,this.condition),this.else&&eo(e,this.else.names),e}};Ji.kind="if";var Qi=class extends cs{};Qi.kind="for";var mb=class extends Qi{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=ua(this.iteration,e,r),this}get names(){return eo(super.names,this.iteration.names)}},yb=class extends Qi{constructor(e,r,n,s){super(),this.varKind=e,this.name=r,this.from=n,this.to=s}render(e){let r=e.es5?sn.varKinds.var:this.varKind,{name:n,from:s,to:i}=this;return`for(${r} ${n}=${s}; ${n}<${i}; ${n}++)`+super.render(e)}get names(){let e=Lf(super.names,this.from);return Lf(e,this.to)}},xf=class extends Qi{constructor(e,r,n,s){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=ua(this.iterable,e,r),this}get names(){return eo(super.names,this.iterable.names)}},al=class extends cs{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};al.kind="func";var cl=class extends ol{render(e){return"return "+super.render(e)}};cl.kind="return";var Ib=class extends cs{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,s;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(s=this.finally)===null||s===void 0||s.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&eo(e,this.catch.names),this.finally&&eo(e,this.finally.names),e}},ll=class extends cs{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};ll.kind="catch";var ul=class extends cs{render(e){return"finally"+super.render(e)}};ul.kind="finally";var bb=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new sn.Scope({parent:e}),this._nodes=[new hb]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,s){let i=this._scope.toName(r);return n!==void 0&&s&&(this._constants[i.str]=n),this._leafNode(new lb(e,i,n)),i}const(e,r,n){return this._def(sn.varKinds.const,e,r,n)}let(e,r,n){return this._def(sn.varKinds.let,e,r,n)}var(e,r,n){return this._def(sn.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Ff(e,r,n))}add(e,r){return this._leafNode(new ub(e,me.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==ve.nil&&this._leafNode(new pb(e)),this}object(...e){let r=["{"];for(let[n,s]of e)r.length>1&&r.push(","),r.push(n),(n!==s||this.opts.es5)&&(r.push(":"),(0,ve.addCodeArg)(r,s));return r.push("}"),new ve._Code(r)}if(e,r,n){if(this._blockNode(new Ji(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Ji(e))}else(){return this._elseNode(new la)}endIf(){return this._endBlockNode(Ji,la)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new mb(e),r)}forRange(e,r,n,s,i=this.opts.es5?sn.varKinds.var:sn.varKinds.let){let o=this._scope.toName(e);return this._for(new yb(i,o,r,n),()=>s(o))}forOf(e,r,n,s=sn.varKinds.const){let i=this._scope.toName(e);if(this.opts.es5){let o=r instanceof ve.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ve._)`${o}.length`,a=>{this.var(i,(0,ve._)`${o}[${a}]`),n(i)})}return this._for(new xf("of",s,i,r),()=>n(i))}forIn(e,r,n,s=this.opts.es5?sn.varKinds.var:sn.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,ve._)`Object.keys(${r})`,n);let i=this._scope.toName(e);return this._for(new xf("in",s,i,r),()=>n(i))}endFor(){return this._endBlockNode(Qi)}label(e){return this._leafNode(new db(e))}break(e){return this._leafNode(new fb(e))}return(e){let r=new cl;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(cl)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let s=new Ib;if(this._blockNode(s),this.code(e),r){let i=this.name("e");this._currNode=s.catch=new ll(i),r(i)}return n&&(this._currNode=s.finally=new ul,this.code(n)),this._endBlockNode(ll,ul)}throw(e){return this._leafNode(new gb(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=ve.nil,n,s){return this._blockNode(new al(e,r,n)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(al)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Ji))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};me.CodeGen=bb;function eo(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Lf(t,e){return e instanceof ve._CodeOrName?eo(t,e.names):t}function ua(t,e,r){if(t instanceof ve.Name)return n(t);if(!s(t))return t;return new ve._Code(t._items.reduce((i,o)=>(o instanceof ve.Name&&(o=n(o)),o instanceof ve._Code?i.push(...o._items):i.push(o),i),[]));function n(i){let o=r[i.str];return o===void 0||e[i.str]!==1?i:(delete e[i.str],o)}function s(i){return i instanceof ve._Code&&i._items.some(o=>o instanceof ve.Name&&e[o.str]===1&&r[o.str]!==void 0)}}function N4(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function MZ(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,ve._)`!${Cb(t)}`}me.not=MZ;var V4=KZ(me.operators.AND);function H4(...t){return t.reduce(V4)}me.and=H4;var W4=KZ(me.operators.OR);function O4(...t){return t.reduce(W4)}me.or=O4;function KZ(t){return(e,r)=>e===ve.nil?r:r===ve.nil?e:(0,ve._)`${Cb(e)} ${t} ${Cb(r)}`}function Cb(t){return t instanceof ve.Name?t:(0,ve._)`(${t})`}});var de=h(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.checkStrictMode=ye.getErrorPath=ye.Type=ye.useFunc=ye.setEvaluated=ye.evaluatedPropsToName=ye.mergeEvaluated=ye.eachItem=ye.unescapeJsonPointer=ye.escapeJsonPointer=ye.escapeFragment=ye.unescapeFragment=ye.schemaRefOrVal=ye.schemaHasRulesButRef=ye.schemaHasRules=ye.checkUnknownRules=ye.alwaysValidSchema=ye.toHash=void 0;var Ue=ne(),P4=ca();function k4(t){let e={};for(let r of t)e[r]=!0;return e}ye.toHash=k4;function F4(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(QZ(t,e),!eN(e,t.self.RULES.all))}ye.alwaysValidSchema=F4;function QZ(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let s=n.RULES.keywords;for(let i in e)s[i]||sN(t,`unknown keyword: "${i}"`)}ye.checkUnknownRules=QZ;function eN(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}ye.schemaHasRules=eN;function x4(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}ye.schemaHasRulesButRef=x4;function L4({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,Ue._)`${r}`}return(0,Ue._)`${t}${e}${(0,Ue.getProperty)(n)}`}ye.schemaRefOrVal=L4;function U4(t){return tN(decodeURIComponent(t))}ye.unescapeFragment=U4;function Y4(t){return encodeURIComponent(Sb(t))}ye.escapeFragment=Y4;function Sb(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}ye.escapeJsonPointer=Sb;function tN(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}ye.unescapeJsonPointer=tN;function D4(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}ye.eachItem=D4;function zZ({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,i,o,a)=>{let c=o===void 0?i:o instanceof Ue.Name?(i instanceof Ue.Name?t(s,i,o):e(s,i,o),o):i instanceof Ue.Name?(e(s,o,i),i):r(i,o);return a===Ue.Name&&!(c instanceof Ue.Name)?n(s,c):c}}ye.mergeEvaluated={props:zZ({mergeNames:(t,e,r)=>t.if((0,Ue._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,Ue._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,Ue._)`${r} || {}`).code((0,Ue._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,Ue._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,Ue._)`${r} || {}`),vb(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:rN}),items:zZ({mergeNames:(t,e,r)=>t.if((0,Ue._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,Ue._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,Ue._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,Ue._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function rN(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,Ue._)`{}`);return e!==void 0&&vb(t,r,e),r}ye.evaluatedPropsToName=rN;function vb(t,e,r){Object.keys(r).forEach(n=>t.assign((0,Ue._)`${e}${(0,Ue.getProperty)(n)}`,!0))}ye.setEvaluated=vb;var JZ={};function X4(t,e){return t.scopeValue("func",{ref:e,code:JZ[e.code]||(JZ[e.code]=new P4._Code(e.code))})}ye.useFunc=X4;var nN;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(nN=ye.Type||(ye.Type={}));function $4(t,e,r){if(t instanceof Ue.Name){let n=e===nN.Num;return r?n?(0,Ue._)`"[" + ${t} + "]"`:(0,Ue._)`"['" + ${t} + "']"`:n?(0,Ue._)`"/" + ${t}`:(0,Ue._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,Ue.getProperty)(t).toString():"/"+Sb(t)}ye.getErrorPath=$4;function sN(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}ye.checkStrictMode=sN});var Or=h(_b=>{"use strict";Object.defineProperty(_b,"__esModule",{value:!0});var Xt=ne(),j4={data:new Xt.Name("data"),valCxt:new Xt.Name("valCxt"),instancePath:new Xt.Name("instancePath"),parentData:new Xt.Name("parentData"),parentDataProperty:new Xt.Name("parentDataProperty"),rootData:new Xt.Name("rootData"),dynamicAnchors:new Xt.Name("dynamicAnchors"),vErrors:new Xt.Name("vErrors"),errors:new Xt.Name("errors"),this:new Xt.Name("this"),self:new Xt.Name("self"),scope:new Xt.Name("scope"),json:new Xt.Name("json"),jsonPos:new Xt.Name("jsonPos"),jsonLen:new Xt.Name("jsonLen"),jsonPart:new Xt.Name("jsonPart")};_b.default=j4});var dl=h($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.extendErrors=$t.resetErrorsCount=$t.reportExtraError=$t.reportError=$t.keyword$DataError=$t.keywordError=void 0;var Ae=ne(),Yf=de(),rr=Or();$t.keywordError={message:({keyword:t})=>(0,Ae.str)`must pass "${t}" keyword validation`};$t.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Ae.str)`"${t}" keyword must be ${e} ($data)`:(0,Ae.str)`"${t}" keyword is invalid ($data)`};function q4(t,e=$t.keywordError,r,n){let{it:s}=t,{gen:i,compositeRule:o,allErrors:a}=s,c=aN(t,e,r);n??(o||a)?iN(i,c):oN(s,(0,Ae._)`[${c}]`)}$t.reportError=q4;function M4(t,e=$t.keywordError,r){let{it:n}=t,{gen:s,compositeRule:i,allErrors:o}=n,a=aN(t,e,r);iN(s,a),i||o||oN(n,rr.default.vErrors)}$t.reportExtraError=M4;function K4(t,e){t.assign(rr.default.errors,e),t.if((0,Ae._)`${rr.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Ae._)`${rr.default.vErrors}.length`,e),()=>t.assign(rr.default.vErrors,null)))}$t.resetErrorsCount=K4;function z4({gen:t,keyword:e,schemaValue:r,data:n,errsCount:s,it:i}){if(s===void 0)throw new Error("ajv implementation error");let o=t.name("err");t.forRange("i",s,rr.default.errors,a=>{t.const(o,(0,Ae._)`${rr.default.vErrors}[${a}]`),t.if((0,Ae._)`${o}.instancePath === undefined`,()=>t.assign((0,Ae._)`${o}.instancePath`,(0,Ae.strConcat)(rr.default.instancePath,i.errorPath))),t.assign((0,Ae._)`${o}.schemaPath`,(0,Ae.str)`${i.errSchemaPath}/${e}`),i.opts.verbose&&(t.assign((0,Ae._)`${o}.schema`,r),t.assign((0,Ae._)`${o}.data`,n))})}$t.extendErrors=z4;function iN(t,e){let r=t.const("err",e);t.if((0,Ae._)`${rr.default.vErrors} === null`,()=>t.assign(rr.default.vErrors,(0,Ae._)`[${r}]`),(0,Ae._)`${rr.default.vErrors}.push(${r})`),t.code((0,Ae._)`${rr.default.errors}++`)}function oN(t,e){let{gen:r,validateName:n,schemaEnv:s}=t;s.$async?r.throw((0,Ae._)`new ${t.ValidationError}(${e})`):(r.assign((0,Ae._)`${n}.errors`,e),r.return(!1))}var to={keyword:new Ae.Name("keyword"),schemaPath:new Ae.Name("schemaPath"),params:new Ae.Name("params"),propertyName:new Ae.Name("propertyName"),message:new Ae.Name("message"),schema:new Ae.Name("schema"),parentSchema:new Ae.Name("parentSchema")};function aN(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Ae._)`{}`:J4(t,e,r)}function J4(t,e,r={}){let{gen:n,it:s}=t,i=[Q4(s,r),eQ(t,r)];return tQ(t,e,i),n.object(...i)}function Q4({errorPath:t},{instancePath:e}){let r=e?(0,Ae.str)`${t}${(0,Yf.getErrorPath)(e,Yf.Type.Str)}`:t;return[rr.default.instancePath,(0,Ae.strConcat)(rr.default.instancePath,r)]}function eQ({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let s=n?e:(0,Ae.str)`${e}/${t}`;return r&&(s=(0,Ae.str)`${s}${(0,Yf.getErrorPath)(r,Yf.Type.Str)}`),[to.schemaPath,s]}function tQ(t,{params:e,message:r},n){let{keyword:s,data:i,schemaValue:o,it:a}=t,{opts:c,propertyName:l,topSchemaRef:u,schemaPath:d}=a;n.push([to.keyword,s],[to.params,typeof e=="function"?e(t):e||(0,Ae._)`{}`]),c.messages&&n.push([to.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([to.schema,o],[to.parentSchema,(0,Ae._)`${u}${d}`],[rr.default.data,i]),l&&n.push([to.propertyName,l])}});var lN=h(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.boolOrEmptySchema=da.topBoolOrEmptySchema=void 0;var rQ=dl(),nQ=ne(),sQ=Or(),iQ={message:"boolean schema is false"};function oQ(t){let{gen:e,schema:r,validateName:n}=t;r===!1?cN(t,!1):typeof r=="object"&&r.$async===!0?e.return(sQ.default.data):(e.assign((0,nQ._)`${n}.errors`,null),e.return(!0))}da.topBoolOrEmptySchema=oQ;function aQ(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),cN(t)):r.var(e,!0)}da.boolOrEmptySchema=aQ;function cN(t,e){let{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,rQ.reportError)(s,iQ,void 0,e)}});var Ab=h(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.getRules=fa.isJSONType=void 0;var cQ=["string","number","integer","boolean","null","object","array"],lQ=new Set(cQ);function uQ(t){return typeof t=="string"&&lQ.has(t)}fa.isJSONType=uQ;function dQ(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}fa.getRules=dQ});var Rb=h(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.shouldUseRule=Qs.shouldUseGroup=Qs.schemaHasRulesForType=void 0;function fQ({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&uN(t,n)}Qs.schemaHasRulesForType=fQ;function uN(t,e){return e.rules.some(r=>dN(t,r))}Qs.shouldUseGroup=uN;function dN(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Qs.shouldUseRule=dN});var gl=h(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.reportTypeError=Ot.checkDataTypes=Ot.checkDataType=Ot.coerceAndCheckDataType=Ot.getJSONTypes=Ot.getSchemaTypes=Ot.DataType=void 0;var gQ=Ab(),pQ=Rb(),hQ=dl(),ue=ne(),fN=de(),fl;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(fl=Ot.DataType||(Ot.DataType={}));function mQ(t){let e=gN(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Ot.getSchemaTypes=mQ;function gN(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(gQ.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ot.getJSONTypes=gN;function yQ(t,e){let{gen:r,data:n,opts:s}=t,i=IQ(e,s.coerceTypes),o=e.length>0&&!(i.length===0&&e.length===1&&(0,pQ.schemaHasRulesForType)(t,e[0]));if(o){let a=wb(e,n,s.strictNumbers,fl.Wrong);r.if(a,()=>{i.length?bQ(t,e,i):Bb(t)})}return o}Ot.coerceAndCheckDataType=yQ;var pN=new Set(["string","number","integer","boolean","null"]);function IQ(t,e){return e?t.filter(r=>pN.has(r)||e==="array"&&r==="array"):[]}function bQ(t,e,r){let{gen:n,data:s,opts:i}=t,o=n.let("dataType",(0,ue._)`typeof ${s}`),a=n.let("coerced",(0,ue._)`undefined`);i.coerceTypes==="array"&&n.if((0,ue._)`${o} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,ue._)`${s}[0]`).assign(o,(0,ue._)`typeof ${s}`).if(wb(e,s,i.strictNumbers),()=>n.assign(a,s))),n.if((0,ue._)`${a} !== undefined`);for(let l of r)(pN.has(l)||l==="array"&&i.coerceTypes==="array")&&c(l);n.else(),Bb(t),n.endIf(),n.if((0,ue._)`${a} !== undefined`,()=>{n.assign(s,a),CQ(t,a)});function c(l){switch(l){case"string":n.elseIf((0,ue._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,ue._)`"" + ${s}`).elseIf((0,ue._)`${s} === null`).assign(a,(0,ue._)`""`);return;case"number":n.elseIf((0,ue._)`${o} == "boolean" || ${s} === null
              || (${o} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,ue._)`+${s}`);return;case"integer":n.elseIf((0,ue._)`${o} === "boolean" || ${s} === null
              || (${o} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,ue._)`+${s}`);return;case"boolean":n.elseIf((0,ue._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,ue._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,ue._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,ue._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${s} === null`).assign(a,(0,ue._)`[${s}]`)}}}function CQ({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,ue._)`${e} !== undefined`,()=>t.assign((0,ue._)`${e}[${r}]`,n))}function Eb(t,e,r,n=fl.Correct){let s=n===fl.Correct?ue.operators.EQ:ue.operators.NEQ,i;switch(t){case"null":return(0,ue._)`${e} ${s} null`;case"array":i=(0,ue._)`Array.isArray(${e})`;break;case"object":i=(0,ue._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=o((0,ue._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=o();break;default:return(0,ue._)`typeof ${e} ${s} ${t}`}return n===fl.Correct?i:(0,ue.not)(i);function o(a=ue.nil){return(0,ue.and)((0,ue._)`typeof ${e} == "number"`,a,r?(0,ue._)`isFinite(${e})`:ue.nil)}}Ot.checkDataType=Eb;function wb(t,e,r,n){if(t.length===1)return Eb(t[0],e,r,n);let s,i=(0,fN.toHash)(t);if(i.array&&i.object){let o=(0,ue._)`typeof ${e} != "object"`;s=i.null?o:(0,ue._)`!${e} || ${o}`,delete i.null,delete i.array,delete i.object}else s=ue.nil;i.number&&delete i.integer;for(let o in i)s=(0,ue.and)(s,Eb(o,e,r,n));return s}Ot.checkDataTypes=wb;var SQ={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,ue._)`{type: ${t}}`:(0,ue._)`{type: ${e}}`};function Bb(t){let e=vQ(t);(0,hQ.reportError)(e,SQ)}Ot.reportTypeError=Bb;function vQ(t){let{gen:e,data:r,schema:n}=t,s=(0,fN.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}});var mN=h(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.assignDefaults=void 0;var ga=ne(),_Q=de();function AQ(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let s in r)hN(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,i)=>hN(t,i,s.default))}Df.assignDefaults=AQ;function hN(t,e,r){let{gen:n,compositeRule:s,data:i,opts:o}=t;if(r===void 0)return;let a=(0,ga._)`${i}${(0,ga.getProperty)(e)}`;if(s){(0,_Q.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,ga._)`${a} === undefined`;o.useDefaults==="empty"&&(c=(0,ga._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,ga._)`${a} = ${(0,ga.stringify)(r)}`)}});var Pt=h(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.validateUnion=xe.validateArray=xe.usePattern=xe.callValidateCode=xe.schemaProperties=xe.allSchemaProperties=xe.noPropertyInData=xe.propertyInData=xe.isOwnProperty=xe.hasPropFunc=xe.reportMissingProp=xe.checkMissingProp=xe.checkReportMissingProp=void 0;var qe=ne(),Tb=de(),ei=Or(),RQ=de();function EQ(t,e){let{gen:r,data:n,it:s}=t;r.if(Zb(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,qe._)`${e}`},!0),t.error()})}xe.checkReportMissingProp=EQ;function wQ({gen:t,data:e,it:{opts:r}},n,s){return(0,qe.or)(...n.map(i=>(0,qe.and)(Zb(t,e,i,r.ownProperties),(0,qe._)`${s} = ${i}`)))}xe.checkMissingProp=wQ;function BQ(t,e){t.setParams({missingProperty:e},!0),t.error()}xe.reportMissingProp=BQ;function yN(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,qe._)`Object.prototype.hasOwnProperty`})}xe.hasPropFunc=yN;function Gb(t,e,r){return(0,qe._)`${yN(t)}.call(${e}, ${r})`}xe.isOwnProperty=Gb;function TQ(t,e,r,n){let s=(0,qe._)`${e}${(0,qe.getProperty)(r)} !== undefined`;return n?(0,qe._)`${s} && ${Gb(t,e,r)}`:s}xe.propertyInData=TQ;function Zb(t,e,r,n){let s=(0,qe._)`${e}${(0,qe.getProperty)(r)} === undefined`;return n?(0,qe.or)(s,(0,qe.not)(Gb(t,e,r))):s}xe.noPropertyInData=Zb;function IN(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}xe.allSchemaProperties=IN;function GQ(t,e){return IN(e).filter(r=>!(0,Tb.alwaysValidSchema)(t,e[r]))}xe.schemaProperties=GQ;function ZQ({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:i},it:o},a,c,l){let u=l?(0,qe._)`${t}, ${e}, ${n}${s}`:e,d=[[ei.default.instancePath,(0,qe.strConcat)(ei.default.instancePath,i)],[ei.default.parentData,o.parentData],[ei.default.parentDataProperty,o.parentDataProperty],[ei.default.rootData,ei.default.rootData]];o.opts.dynamicRef&&d.push([ei.default.dynamicAnchors,ei.default.dynamicAnchors]);let f=(0,qe._)`${u}, ${r.object(...d)}`;return c!==qe.nil?(0,qe._)`${a}.call(${c}, ${f})`:(0,qe._)`${a}(${f})`}xe.callValidateCode=ZQ;var NQ=(0,qe._)`new RegExp`;function VQ({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,qe._)`${s.code==="new RegExp"?NQ:(0,RQ.useFunc)(t,s)}(${r}, ${n})`})}xe.usePattern=VQ;function HQ(t){let{gen:e,data:r,keyword:n,it:s}=t,i=e.name("valid");if(s.allErrors){let a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){let c=e.const("len",(0,qe._)`${r}.length`);e.forRange("i",0,c,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:Tb.Type.Num},i),e.if((0,qe.not)(i),a)})}}xe.validateArray=HQ;function WQ(t){let{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Tb.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;let o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,l)=>{let u=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,qe._)`${o} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,qe.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}xe.validateUnion=WQ});var SN=h(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.validateKeywordUsage=An.validSchemaType=An.funcKeywordCode=An.macroKeywordCode=void 0;var nr=ne(),ro=Or(),OQ=Pt(),PQ=dl();function kQ(t,e){let{gen:r,keyword:n,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),c=CN(r,n,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);let l=r.name("valid");t.subschema({schema:a,schemaPath:nr.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}An.macroKeywordCode=kQ;function FQ(t,e){var r;let{gen:n,keyword:s,schema:i,parentSchema:o,$data:a,it:c}=t;LQ(c,e);let l=!a&&e.compile?e.compile.call(c.self,i,o,c):e.validate,u=CN(n,s,l),d=n.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)m(),e.modifying&&bN(t),I(()=>t.error());else{let C=e.async?g():p();e.modifying&&bN(t),I(()=>xQ(t,C))}}function g(){let C=n.let("ruleErrs",null);return n.try(()=>m((0,nr._)`await `),S=>n.assign(d,!1).if((0,nr._)`${S} instanceof ${c.ValidationError}`,()=>n.assign(C,(0,nr._)`${S}.errors`),()=>n.throw(S))),C}function p(){let C=(0,nr._)`${u}.errors`;return n.assign(C,null),m(nr.nil),C}function m(C=e.async?(0,nr._)`await `:nr.nil){let S=c.opts.passContext?ro.default.this:ro.default.self,b=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,nr._)`${C}${(0,OQ.callValidateCode)(t,u,S,b)}`,e.modifying)}function I(C){var S;n.if((0,nr.not)((S=e.valid)!==null&&S!==void 0?S:d),C)}}An.funcKeywordCode=FQ;function bN(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,nr._)`${n.parentData}[${n.parentDataProperty}]`))}function xQ(t,e){let{gen:r}=t;r.if((0,nr._)`Array.isArray(${e})`,()=>{r.assign(ro.default.vErrors,(0,nr._)`${ro.default.vErrors} === null ? ${e} : ${ro.default.vErrors}.concat(${e})`).assign(ro.default.errors,(0,nr._)`${ro.default.vErrors}.length`),(0,PQ.extendErrors)(t)},()=>t.error())}function LQ({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function CN(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,nr.stringify)(r)})}function UQ(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}An.validSchemaType=UQ;function YQ({schema:t,opts:e,self:r,errSchemaPath:n},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");let o=s.dependencies;if(o?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){let c=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}An.validateKeywordUsage=YQ});var _N=h(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.extendSubschemaMode=ti.extendSubschemaData=ti.getSubschema=void 0;var Rn=ne(),vN=de();function DQ(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Rn._)`${t.schemaPath}${(0,Rn.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Rn._)`${t.schemaPath}${(0,Rn.getProperty)(e)}${(0,Rn.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,vN.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}ti.getSubschema=DQ;function XQ(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:l,dataPathArr:u,opts:d}=e,f=a.let("data",(0,Rn._)`${e.data}${(0,Rn.getProperty)(r)}`,!0);c(f),t.errorPath=(0,Rn.str)`${l}${(0,vN.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Rn._)`${r}`,t.dataPathArr=[...u,t.parentDataProperty]}if(s!==void 0){let l=s instanceof Rn.Name?s:a.let("data",s,!0);c(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function c(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}ti.extendSubschemaData=XQ;function $Q(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:i}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}ti.extendSubschemaMode=$Q});var pa=h((jTe,AN)=>{"use strict";AN.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=n;s--!==0;){var o=i[s];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var EN=h((qTe,RN)=>{"use strict";var ri=RN.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};Xf(e,n,s,t,"",t)};ri.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};ri.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};ri.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};ri.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Xf(t,e,r,n,s,i,o,a,c,l){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,i,o,a,c,l);for(var u in n){var d=n[u];if(Array.isArray(d)){if(u in ri.arrayKeywords)for(var f=0;f<d.length;f++)Xf(t,e,r,d[f],s+"/"+u+"/"+f,i,s,u,n,f)}else if(u in ri.propsKeywords){if(d&&typeof d=="object")for(var g in d)Xf(t,e,r,d[g],s+"/"+u+"/"+jQ(g),i,s,u,n,g)}else(u in ri.keywords||t.allKeys&&!(u in ri.skipKeywords))&&Xf(t,e,r,d,s+"/"+u,i,s,u,n)}r(n,s,i,o,a,c,l)}}function jQ(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var pl=h(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.getSchemaRefs=dr.resolveUrl=dr.normalizeId=dr._getFullPath=dr.getFullPath=dr.inlineRef=void 0;var qQ=de(),MQ=pa(),KQ=EN(),zQ=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function JQ(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Nb(t):e?wN(t)<=e:!1}dr.inlineRef=JQ;var QQ=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Nb(t){for(let e in t){if(QQ.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Nb)||typeof r=="object"&&Nb(r))return!0}return!1}function wN(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!zQ.has(r)&&(typeof t[r]=="object"&&(0,qQ.eachItem)(t[r],n=>e+=wN(n)),e===1/0))return 1/0}return e}function BN(t,e="",r){r!==!1&&(e=ha(e));let n=t.parse(e);return TN(t,n)}dr.getFullPath=BN;function TN(t,e){return t.serialize(e).split("#")[0]+"#"}dr._getFullPath=TN;var e8=/#\/?$/;function ha(t){return t?t.replace(e8,""):""}dr.normalizeId=ha;function t8(t,e,r){return r=ha(r),t.resolve(e,r)}dr.resolveUrl=t8;var r8=/^[a-z_][-a-z0-9._]*$/i;function n8(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,s=ha(t[r]||e),i={"":s},o=BN(n,s,!1),a={},c=new Set;return KQ(t,{allKeys:!0},(d,f,g,p)=>{if(p===void 0)return;let m=o+f,I=i[p];typeof d[r]=="string"&&(I=C.call(this,d[r])),S.call(this,d.$anchor),S.call(this,d.$dynamicAnchor),i[f]=I;function C(b){let y=this.opts.uriResolver.resolve;if(b=ha(I?y(I,b):b),c.has(b))throw u(b);c.add(b);let A=this.refs[b];return typeof A=="string"&&(A=this.refs[A]),typeof A=="object"?l(d,A.schema,b):b!==ha(m)&&(b[0]==="#"?(l(d,a[b],b),a[b]=d):this.refs[b]=m),b}function S(b){if(typeof b=="string"){if(!r8.test(b))throw new Error(`invalid anchor "${b}"`);C.call(this,`#${b}`)}}}),a;function l(d,f,g){if(f!==void 0&&!MQ(d,f))throw u(g)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}dr.getSchemaRefs=n8});var ma=h(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.getData=ni.KeywordCxt=ni.validateFunctionCode=void 0;var HN=lN(),GN=gl(),Hb=Rb(),$f=gl(),s8=mN(),ml=SN(),Vb=_N(),Q=ne(),ae=Or(),i8=pl(),ls=de(),hl=dl();function o8(t){if(PN(t)&&(kN(t),ON(t))){l8(t);return}WN(t,()=>(0,HN.topBoolOrEmptySchema)(t))}ni.validateFunctionCode=o8;function WN({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},i){s.code.es5?t.func(e,(0,Q._)`${ae.default.data}, ${ae.default.valCxt}`,n.$async,()=>{t.code((0,Q._)`"use strict"; ${ZN(r,s)}`),c8(t,s),t.code(i)}):t.func(e,(0,Q._)`${ae.default.data}, ${a8(s)}`,n.$async,()=>t.code(ZN(r,s)).code(i))}function a8(t){return(0,Q._)`{${ae.default.instancePath}="", ${ae.default.parentData}, ${ae.default.parentDataProperty}, ${ae.default.rootData}=${ae.default.data}${t.dynamicRef?(0,Q._)`, ${ae.default.dynamicAnchors}={}`:Q.nil}}={}`}function c8(t,e){t.if(ae.default.valCxt,()=>{t.var(ae.default.instancePath,(0,Q._)`${ae.default.valCxt}.${ae.default.instancePath}`),t.var(ae.default.parentData,(0,Q._)`${ae.default.valCxt}.${ae.default.parentData}`),t.var(ae.default.parentDataProperty,(0,Q._)`${ae.default.valCxt}.${ae.default.parentDataProperty}`),t.var(ae.default.rootData,(0,Q._)`${ae.default.valCxt}.${ae.default.rootData}`),e.dynamicRef&&t.var(ae.default.dynamicAnchors,(0,Q._)`${ae.default.valCxt}.${ae.default.dynamicAnchors}`)},()=>{t.var(ae.default.instancePath,(0,Q._)`""`),t.var(ae.default.parentData,(0,Q._)`undefined`),t.var(ae.default.parentDataProperty,(0,Q._)`undefined`),t.var(ae.default.rootData,ae.default.data),e.dynamicRef&&t.var(ae.default.dynamicAnchors,(0,Q._)`{}`)})}function l8(t){let{schema:e,opts:r,gen:n}=t;WN(t,()=>{r.$comment&&e.$comment&&xN(t),p8(t),n.let(ae.default.vErrors,null),n.let(ae.default.errors,0),r.unevaluated&&u8(t),FN(t),y8(t)})}function u8(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,Q._)`${r}.evaluated`),e.if((0,Q._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,Q._)`${t.evaluated}.props`,(0,Q._)`undefined`)),e.if((0,Q._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,Q._)`${t.evaluated}.items`,(0,Q._)`undefined`))}function ZN(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,Q._)`/*# sourceURL=${r} */`:Q.nil}function d8(t,e){if(PN(t)&&(kN(t),ON(t))){f8(t,e);return}(0,HN.boolOrEmptySchema)(t,e)}function ON({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function PN(t){return typeof t.schema!="boolean"}function f8(t,e){let{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&xN(t),h8(t),m8(t);let i=n.const("_errs",ae.default.errors);FN(t,i),n.var(e,(0,Q._)`${i} === ${ae.default.errors}`)}function kN(t){(0,ls.checkUnknownRules)(t),g8(t)}function FN(t,e){if(t.opts.jtd)return NN(t,[],!1,e);let r=(0,GN.getSchemaTypes)(t.schema),n=(0,GN.coerceAndCheckDataType)(t,r);NN(t,r,!n,e)}function g8(t){let{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,ls.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function p8(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,ls.checkStrictMode)(t,"default is ignored in the schema root")}function h8(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,i8.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function m8(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function xN({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){let i=r.$comment;if(s.$comment===!0)t.code((0,Q._)`${ae.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){let o=(0,Q.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,Q._)`${ae.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function y8(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:i}=t;r.$async?e.if((0,Q._)`${ae.default.errors} === 0`,()=>e.return(ae.default.data),()=>e.throw((0,Q._)`new ${s}(${ae.default.vErrors})`)):(e.assign((0,Q._)`${n}.errors`,ae.default.vErrors),i.unevaluated&&I8(t),e.return((0,Q._)`${ae.default.errors} === 0`))}function I8({gen:t,evaluated:e,props:r,items:n}){r instanceof Q.Name&&t.assign((0,Q._)`${e}.props`,r),n instanceof Q.Name&&t.assign((0,Q._)`${e}.items`,n)}function NN(t,e,r,n){let{gen:s,schema:i,data:o,allErrors:a,opts:c,self:l}=t,{RULES:u}=l;if(i.$ref&&(c.ignoreKeywordsWithRef||!(0,ls.schemaHasRulesButRef)(i,u))){s.block(()=>UN(t,"$ref",u.all.$ref.definition));return}c.jtd||b8(t,e),s.block(()=>{for(let f of u.rules)d(f);d(u.post)});function d(f){(0,Hb.shouldUseGroup)(i,f)&&(f.type?(s.if((0,$f.checkDataType)(f.type,o,c.strictNumbers)),VN(t,f),e.length===1&&e[0]===f.type&&r&&(s.else(),(0,$f.reportTypeError)(t)),s.endIf()):VN(t,f),a||s.if((0,Q._)`${ae.default.errors} === ${n||0}`))}}function VN(t,e){let{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,s8.assignDefaults)(t,e.type),r.block(()=>{for(let i of e.rules)(0,Hb.shouldUseRule)(n,i)&&UN(t,i.keyword,i.definition,e.type)})}function b8(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(C8(t,e),t.opts.allowUnionTypes||S8(t,e),v8(t,t.dataTypes))}function C8(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{LN(t.dataTypes,r)||Wb(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),A8(t,e)}}function S8(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Wb(t,"use allowUnionTypes to allow union type keyword")}function v8(t,e){let r=t.self.RULES.all;for(let n in r){let s=r[n];if(typeof s=="object"&&(0,Hb.shouldUseRule)(t.schema,s)){let{type:i}=s.definition;i.length&&!i.some(o=>_8(e,o))&&Wb(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function _8(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function LN(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function A8(t,e){let r=[];for(let n of t.dataTypes)LN(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Wb(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,ls.checkStrictMode)(t,e,t.opts.strictTypes)}var jf=class{constructor(e,r,n){if((0,ml.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ls.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",YN(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,ml.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",ae.default.errors))}result(e,r,n){this.failResult((0,Q.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,Q.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,Q._)`${r} !== undefined && (${(0,Q.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?hl.reportExtraError:hl.reportError)(this,this.def.error,r)}$dataError(){(0,hl.reportError)(this,this.def.$dataError||hl.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,hl.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=Q.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=Q.nil,r=Q.nil){if(!this.$data)return;let{gen:n,schemaCode:s,schemaType:i,def:o}=this;n.if((0,Q.or)((0,Q._)`${s} === undefined`,r)),e!==Q.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==Q.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:s,it:i}=this;return(0,Q.or)(o(),a());function o(){if(n.length){if(!(r instanceof Q.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,Q._)`${(0,$f.checkDataTypes)(c,r,i.opts.strictNumbers,$f.DataType.Wrong)}`}return Q.nil}function a(){if(s.validateSchema){let c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,Q._)`!${c}(${r})`}return Q.nil}}subschema(e,r){let n=(0,Vb.getSubschema)(this.it,e);(0,Vb.extendSubschemaData)(n,this.it,e),(0,Vb.extendSubschemaMode)(n,e);let s={...this.it,...n,items:void 0,props:void 0};return d8(s,r),s}mergeEvaluated(e,r){let{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=ls.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=ls.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,Q.Name)),!0}};ni.KeywordCxt=jf;function UN(t,e,r,n){let s=new jf(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,ml.funcKeywordCode)(s,r):"macro"in r?(0,ml.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,ml.funcKeywordCode)(s,r)}var R8=/^\/(?:[^~]|~0|~1)*$/,E8=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function YN(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,i;if(t==="")return ae.default.rootData;if(t[0]==="/"){if(!R8.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=ae.default.rootData}else{let l=E8.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);let u=+l[1];if(s=l[2],s==="#"){if(u>=e)throw new Error(c("property/index",u));return n[e-u]}if(u>e)throw new Error(c("data",u));if(i=r[e-u],!s)return i}let o=i,a=s.split("/");for(let l of a)l&&(i=(0,Q._)`${i}${(0,Q.getProperty)((0,ls.unescapeJsonPointer)(l))}`,o=(0,Q._)`${o} && ${i}`);return o;function c(l,u){return`Cannot access ${l} ${u} levels up, current level is ${e}`}}ni.getData=YN});var yl=h(Pb=>{"use strict";Object.defineProperty(Pb,"__esModule",{value:!0});var Ob=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Pb.default=Ob});var si=h(xb=>{"use strict";Object.defineProperty(xb,"__esModule",{value:!0});var kb=pl(),Fb=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,kb.resolveUrl)(e,r,n),this.missingSchema=(0,kb.normalizeId)((0,kb.getFullPath)(e,this.missingRef))}};xb.default=Fb});var so=h(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.resolveSchema=Pr.getCompilingSchema=Pr.resolveRef=Pr.compileSchema=Pr.SchemaEnv=void 0;var on=ne(),w8=yl(),no=Or(),an=pl(),DN=de(),B8=ma(),ya=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,an.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};Pr.SchemaEnv=ya;function Ub(t){let e=XN.call(this,t);if(e)return e;let r=(0,an.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new on.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i}),a;t.$async&&(a=o.scopeValue("Error",{ref:w8.default,code:(0,on._)`require("ajv/dist/runtime/validation_error").default`}));let c=o.scopeName("validate");t.validateName=c;let l={gen:o,allErrors:this.opts.allErrors,data:no.default.data,parentData:no.default.parentData,parentDataProperty:no.default.parentDataProperty,dataNames:[no.default.data],dataPathArr:[on.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,on.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:on.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,on._)`""`,opts:this.opts,self:this},u;try{this._compilations.add(t),(0,B8.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);let d=o.toString();u=`${o.scopeRefs(no.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));let g=new Function(`${no.default.self}`,`${no.default.scope}`,u)(this,this.scope.get());if(this.scope.value(c,{ref:g}),g.errors=null,g.schema=t.schema,g.schemaEnv=t,t.$async&&(g.$async=!0),this.opts.code.source===!0&&(g.source={validateName:c,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){let{props:p,items:m}=l;g.evaluated={props:p instanceof on.Name?void 0:p,items:m instanceof on.Name?void 0:m,dynamicProps:p instanceof on.Name,dynamicItems:m instanceof on.Name},g.source&&(g.source.evaluated=(0,on.stringify)(g.evaluated))}return t.validate=g,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}Pr.compileSchema=Ub;function T8(t,e,r){var n;r=(0,an.resolveUrl)(this.opts.uriResolver,e,r);let s=t.refs[r];if(s)return s;let i=N8.call(this,t,r);if(i===void 0){let o=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;o&&(i=new ya({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=G8.call(this,i)}Pr.resolveRef=T8;function G8(t){return(0,an.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Ub.call(this,t)}function XN(t){for(let e of this._compilations)if(Z8(e,t))return e}Pr.getCompilingSchema=XN;function Z8(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function N8(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||qf.call(this,t,e)}function qf(t,e){let r=this.opts.uriResolver.parse(e),n=(0,an._getFullPath)(this.opts.uriResolver,r),s=(0,an.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Lb.call(this,r,t);let i=(0,an.normalizeId)(n),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){let a=qf.call(this,t,o);return typeof a?.schema!="object"?void 0:Lb.call(this,r,a)}if(typeof o?.schema=="object"){if(o.validate||Ub.call(this,o),i===(0,an.normalizeId)(e)){let{schema:a}=o,{schemaId:c}=this.opts,l=a[c];return l&&(s=(0,an.resolveUrl)(this.opts.uriResolver,s,l)),new ya({schema:a,schemaId:c,root:t,baseId:s})}return Lb.call(this,r,o)}}Pr.resolveSchema=qf;var V8=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Lb(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,DN.unescapeFragment)(a)];if(c===void 0)return;r=c;let l=typeof r=="object"&&r[this.opts.schemaId];!V8.has(a)&&l&&(e=(0,an.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,DN.schemaHasRulesButRef)(r,this.RULES)){let a=(0,an.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=qf.call(this,n,a)}let{schemaId:o}=this.opts;if(i=i||new ya({schema:r,schemaId:o,root:n,baseId:e}),i.schema!==i.root.schema)return i}});var $N=h((eGe,H8)=>{H8.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var qN=h((Mf,jN)=>{(function(t,e){typeof Mf=="object"&&typeof jN<"u"?e(Mf):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(Mf,function(t){"use strict";function e(){for(var w=arguments.length,_=Array(w),T=0;T<w;T++)_[T]=arguments[T];if(_.length>1){_[0]=_[0].slice(0,-1);for(var Z=_.length-1,V=1;V<Z;++V)_[V]=_[V].slice(1,-1);return _[Z]=_[Z].slice(1),_.join("")}else return _[0]}function r(w){return"(?:"+w+")"}function n(w){return w===void 0?"undefined":w===null?"null":Object.prototype.toString.call(w).split(" ").pop().split("]").shift().toLowerCase()}function s(w){return w.toUpperCase()}function i(w){return w!=null?w instanceof Array?w:typeof w.length!="number"||w.split||w.setInterval||w.call?[w]:Array.prototype.slice.call(w):[]}function o(w,_){var T=w;if(_)for(var Z in _)T[Z]=_[Z];return T}function a(w){var _="[A-Za-z]",T="[\\x0D]",Z="[0-9]",V="[\\x22]",q=e(Z,"[A-Fa-f]"),le="[\\x0A]",Re="[\\x20]",Oe=r(r("%[EFef]"+q+"%"+q+q+"%"+q+q)+"|"+r("%[89A-Fa-f]"+q+"%"+q+q)+"|"+r("%"+q+q)),It="[\\:\\/\\?\\#\\[\\]\\@]",_e="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",et=e(It,_e),bt=w?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Qe=w?"[\\uE000-\\uF8FF]":"[]",Be=e(_,Z,"[\\-\\.\\_\\~]",bt),tt=r(_+e(_,Z,"[\\+\\-\\.]")+"*"),Fe=r(r(Oe+"|"+e(Be,_e,"[\\:]"))+"*"),Ui=r(r("25[0-5]")+"|"+r("2[0-4]"+Z)+"|"+r("1"+Z+Z)+"|"+r("[1-9]"+Z)+"|"+Z),vr=r(r("25[0-5]")+"|"+r("2[0-4]"+Z)+"|"+r("1"+Z+Z)+"|"+r("0?[1-9]"+Z)+"|0?0?"+Z),Zr=r(vr+"\\."+vr+"\\."+vr+"\\."+vr),Le=r(q+"{1,4}"),_r=r(r(Le+"\\:"+Le)+"|"+Zr),Nr=r(r(Le+"\\:")+"{6}"+_r),bn=r("\\:\\:"+r(Le+"\\:")+"{5}"+_r),Yi=r(r(Le)+"?\\:\\:"+r(Le+"\\:")+"{4}"+_r),rs=r(r(r(Le+"\\:")+"{0,1}"+Le)+"?\\:\\:"+r(Le+"\\:")+"{3}"+_r),xc=r(r(r(Le+"\\:")+"{0,2}"+Le)+"?\\:\\:"+r(Le+"\\:")+"{2}"+_r),jd=r(r(r(Le+"\\:")+"{0,3}"+Le)+"?\\:\\:"+Le+"\\:"+_r),qd=r(r(r(Le+"\\:")+"{0,4}"+Le)+"?\\:\\:"+_r),Uo=r(r(r(Le+"\\:")+"{0,5}"+Le)+"?\\:\\:"+Le),Yo=r(r(r(Le+"\\:")+"{0,6}"+Le)+"?\\:\\:"),ns=r([Nr,bn,Yi,rs,xc,jd,qd,Uo,Yo].join("|")),Do=r(r(Be+"|"+Oe)+"+"),my=r(ns+"\\%25"+Do),Di=r(ns+r("\\%25|\\%(?!"+q+"{2})")+Do),Aq=r("[vV]"+q+"+\\."+e(Be,_e,"[\\:]")+"+"),Rq=r("\\["+r(Di+"|"+ns+"|"+Aq)+"\\]"),jw=r(r(Oe+"|"+e(Be,_e))+"*"),Lc=r(Rq+"|"+Zr+"(?!"+jw+")|"+jw),Uc=r(Z+"*"),qw=r(r(Fe+"@")+"?"+Lc+r("\\:"+Uc)+"?"),Yc=r(Oe+"|"+e(Be,_e,"[\\:\\@]")),Eq=r(Yc+"*"),Mw=r(Yc+"+"),wq=r(r(Oe+"|"+e(Be,_e,"[\\@]"))+"+"),ss=r(r("\\/"+Eq)+"*"),Xo=r("\\/"+r(Mw+ss)+"?"),yy=r(wq+ss),Md=r(Mw+ss),$o="(?!"+Yc+")",sBe=r(ss+"|"+Xo+"|"+yy+"|"+Md+"|"+$o),jo=r(r(Yc+"|"+e("[\\/\\?]",Qe))+"*"),Dc=r(r(Yc+"|[\\/\\?]")+"*"),Kw=r(r("\\/\\/"+qw+ss)+"|"+Xo+"|"+Md+"|"+$o),Bq=r(tt+"\\:"+Kw+r("\\?"+jo)+"?"+r("\\#"+Dc)+"?"),Tq=r(r("\\/\\/"+qw+ss)+"|"+Xo+"|"+yy+"|"+$o),Gq=r(Tq+r("\\?"+jo)+"?"+r("\\#"+Dc)+"?"),iBe=r(Bq+"|"+Gq),oBe=r(tt+"\\:"+Kw+r("\\?"+jo)+"?"),aBe="^("+tt+")\\:"+r(r("\\/\\/("+r("("+Fe+")@")+"?("+Lc+")"+r("\\:("+Uc+")")+"?)")+"?("+ss+"|"+Xo+"|"+Md+"|"+$o+")")+r("\\?("+jo+")")+"?"+r("\\#("+Dc+")")+"?$",cBe="^(){0}"+r(r("\\/\\/("+r("("+Fe+")@")+"?("+Lc+")"+r("\\:("+Uc+")")+"?)")+"?("+ss+"|"+Xo+"|"+yy+"|"+$o+")")+r("\\?("+jo+")")+"?"+r("\\#("+Dc+")")+"?$",lBe="^("+tt+")\\:"+r(r("\\/\\/("+r("("+Fe+")@")+"?("+Lc+")"+r("\\:("+Uc+")")+"?)")+"?("+ss+"|"+Xo+"|"+Md+"|"+$o+")")+r("\\?("+jo+")")+"?$",uBe="^"+r("\\#("+Dc+")")+"?$",dBe="^"+r("("+Fe+")@")+"?("+Lc+")"+r("\\:("+Uc+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",_,Z,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",Be,_e),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",Be,_e),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",Be,_e),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",Be,_e),"g"),NOT_QUERY:new RegExp(e("[^\\%]",Be,_e,"[\\:\\@\\/\\?]",Qe),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",Be,_e,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",Be,_e),"g"),UNRESERVED:new RegExp(Be,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",Be,et),"g"),PCT_ENCODED:new RegExp(Oe,"g"),IPV4ADDRESS:new RegExp("^("+Zr+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ns+")"+r(r("\\%25|\\%(?!"+q+"{2})")+"("+Do+")")+"?\\]?$")}}var c=a(!1),l=a(!0),u=function(){function w(_,T){var Z=[],V=!0,q=!1,le=void 0;try{for(var Re=_[Symbol.iterator](),Oe;!(V=(Oe=Re.next()).done)&&(Z.push(Oe.value),!(T&&Z.length===T));V=!0);}catch(It){q=!0,le=It}finally{try{!V&&Re.return&&Re.return()}finally{if(q)throw le}}return Z}return function(_,T){if(Array.isArray(_))return _;if(Symbol.iterator in Object(_))return w(_,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(w){if(Array.isArray(w)){for(var _=0,T=Array(w.length);_<w.length;_++)T[_]=w[_];return T}else return Array.from(w)},f=2147483647,g=36,p=1,m=26,I=38,C=700,S=72,b=128,y="-",A=/^xn--/,E=/[^\0-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,B={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},H=g-p,R=Math.floor,x=String.fromCharCode;function F(w){throw new RangeError(B[w])}function L(w,_){for(var T=[],Z=w.length;Z--;)T[Z]=_(w[Z]);return T}function ie(w,_){var T=w.split("@"),Z="";T.length>1&&(Z=T[0]+"@",w=T[1]),w=w.replace(v,".");var V=w.split("."),q=L(V,_).join(".");return Z+q}function pe(w){for(var _=[],T=0,Z=w.length;T<Z;){var V=w.charCodeAt(T++);if(V>=55296&&V<=56319&&T<Z){var q=w.charCodeAt(T++);(q&64512)==56320?_.push(((V&1023)<<10)+(q&1023)+65536):(_.push(V),T--)}else _.push(V)}return _}var $=function(_){return String.fromCodePoint.apply(String,d(_))},ee=function(_){return _-48<10?_-22:_-65<26?_-65:_-97<26?_-97:g},ke=function(_,T){return _+22+75*(_<26)-((T!=0)<<5)},j=function(_,T,Z){var V=0;for(_=Z?R(_/C):_>>1,_+=R(_/T);_>H*m>>1;V+=g)_=R(_/H);return R(V+(H+1)*_/(_+I))},ot=function(_){var T=[],Z=_.length,V=0,q=b,le=S,Re=_.lastIndexOf(y);Re<0&&(Re=0);for(var Oe=0;Oe<Re;++Oe)_.charCodeAt(Oe)>=128&&F("not-basic"),T.push(_.charCodeAt(Oe));for(var It=Re>0?Re+1:0;It<Z;){for(var _e=V,et=1,bt=g;;bt+=g){It>=Z&&F("invalid-input");var Qe=ee(_.charCodeAt(It++));(Qe>=g||Qe>R((f-V)/et))&&F("overflow"),V+=Qe*et;var Be=bt<=le?p:bt>=le+m?m:bt-le;if(Qe<Be)break;var tt=g-Be;et>R(f/tt)&&F("overflow"),et*=tt}var Fe=T.length+1;le=j(V-_e,Fe,_e==0),R(V/Fe)>f-q&&F("overflow"),q+=R(V/Fe),V%=Fe,T.splice(V++,0,q)}return String.fromCodePoint.apply(String,T)},Gr=function(_){var T=[];_=pe(_);var Z=_.length,V=b,q=0,le=S,Re=!0,Oe=!1,It=void 0;try{for(var _e=_[Symbol.iterator](),et;!(Re=(et=_e.next()).done);Re=!0){var bt=et.value;bt<128&&T.push(x(bt))}}catch(Di){Oe=!0,It=Di}finally{try{!Re&&_e.return&&_e.return()}finally{if(Oe)throw It}}var Qe=T.length,Be=Qe;for(Qe&&T.push(y);Be<Z;){var tt=f,Fe=!0,Ui=!1,vr=void 0;try{for(var Zr=_[Symbol.iterator](),Le;!(Fe=(Le=Zr.next()).done);Fe=!0){var _r=Le.value;_r>=V&&_r<tt&&(tt=_r)}}catch(Di){Ui=!0,vr=Di}finally{try{!Fe&&Zr.return&&Zr.return()}finally{if(Ui)throw vr}}var Nr=Be+1;tt-V>R((f-q)/Nr)&&F("overflow"),q+=(tt-V)*Nr,V=tt;var bn=!0,Yi=!1,rs=void 0;try{for(var xc=_[Symbol.iterator](),jd;!(bn=(jd=xc.next()).done);bn=!0){var qd=jd.value;if(qd<V&&++q>f&&F("overflow"),qd==V){for(var Uo=q,Yo=g;;Yo+=g){var ns=Yo<=le?p:Yo>=le+m?m:Yo-le;if(Uo<ns)break;var Do=Uo-ns,my=g-ns;T.push(x(ke(ns+Do%my,0))),Uo=R(Do/my)}T.push(x(ke(Uo,0))),le=j(q,Nr,Be==Qe),q=0,++Be}}}catch(Di){Yi=!0,rs=Di}finally{try{!bn&&xc.return&&xc.return()}finally{if(Yi)throw rs}}++q,++V}return T.join("")},He=function(_){return ie(_,function(T){return A.test(T)?ot(T.slice(4).toLowerCase()):T})},Qn=function(_){return ie(_,function(T){return E.test(T)?"xn--"+Gr(T):T})},Rt={version:"2.1.0",ucs2:{decode:pe,encode:$},decode:ot,encode:Gr,toASCII:Qn,toUnicode:He},Ce={};function mt(w){var _=w.charCodeAt(0),T=void 0;return _<16?T="%0"+_.toString(16).toUpperCase():_<128?T="%"+_.toString(16).toUpperCase():_<2048?T="%"+(_>>6|192).toString(16).toUpperCase()+"%"+(_&63|128).toString(16).toUpperCase():T="%"+(_>>12|224).toString(16).toUpperCase()+"%"+(_>>6&63|128).toString(16).toUpperCase()+"%"+(_&63|128).toString(16).toUpperCase(),T}function ce(w){for(var _="",T=0,Z=w.length;T<Z;){var V=parseInt(w.substr(T+1,2),16);if(V<128)_+=String.fromCharCode(V),T+=3;else if(V>=194&&V<224){if(Z-T>=6){var q=parseInt(w.substr(T+4,2),16);_+=String.fromCharCode((V&31)<<6|q&63)}else _+=w.substr(T,6);T+=6}else if(V>=224){if(Z-T>=9){var le=parseInt(w.substr(T+4,2),16),Re=parseInt(w.substr(T+7,2),16);_+=String.fromCharCode((V&15)<<12|(le&63)<<6|Re&63)}else _+=w.substr(T,9);T+=9}else _+=w.substr(T,3),T+=3}return _}function Ve(w,_){function T(Z){var V=ce(Z);return V.match(_.UNRESERVED)?V:Z}return w.scheme&&(w.scheme=String(w.scheme).replace(_.PCT_ENCODED,T).toLowerCase().replace(_.NOT_SCHEME,"")),w.userinfo!==void 0&&(w.userinfo=String(w.userinfo).replace(_.PCT_ENCODED,T).replace(_.NOT_USERINFO,mt).replace(_.PCT_ENCODED,s)),w.host!==void 0&&(w.host=String(w.host).replace(_.PCT_ENCODED,T).toLowerCase().replace(_.NOT_HOST,mt).replace(_.PCT_ENCODED,s)),w.path!==void 0&&(w.path=String(w.path).replace(_.PCT_ENCODED,T).replace(w.scheme?_.NOT_PATH:_.NOT_PATH_NOSCHEME,mt).replace(_.PCT_ENCODED,s)),w.query!==void 0&&(w.query=String(w.query).replace(_.PCT_ENCODED,T).replace(_.NOT_QUERY,mt).replace(_.PCT_ENCODED,s)),w.fragment!==void 0&&(w.fragment=String(w.fragment).replace(_.PCT_ENCODED,T).replace(_.NOT_FRAGMENT,mt).replace(_.PCT_ENCODED,s)),w}function Ir(w){return w.replace(/^0*(.*)/,"$1")||"0"}function We(w,_){var T=w.match(_.IPV4ADDRESS)||[],Z=u(T,2),V=Z[1];return V?V.split(".").map(Ir).join("."):w}function N(w,_){var T=w.match(_.IPV6ADDRESS)||[],Z=u(T,3),V=Z[1],q=Z[2];if(V){for(var le=V.toLowerCase().split("::").reverse(),Re=u(le,2),Oe=Re[0],It=Re[1],_e=It?It.split(":").map(Ir):[],et=Oe.split(":").map(Ir),bt=_.IPV4ADDRESS.test(et[et.length-1]),Qe=bt?7:8,Be=et.length-Qe,tt=Array(Qe),Fe=0;Fe<Qe;++Fe)tt[Fe]=_e[Fe]||et[Be+Fe]||"";bt&&(tt[Qe-1]=We(tt[Qe-1],_));var Ui=tt.reduce(function(Nr,bn,Yi){if(!bn||bn==="0"){var rs=Nr[Nr.length-1];rs&&rs.index+rs.length===Yi?rs.length++:Nr.push({index:Yi,length:1})}return Nr},[]),vr=Ui.sort(function(Nr,bn){return bn.length-Nr.length})[0],Zr=void 0;if(vr&&vr.length>1){var Le=tt.slice(0,vr.index),_r=tt.slice(vr.index+vr.length);Zr=Le.join(":")+"::"+_r.join(":")}else Zr=tt.join(":");return q&&(Zr+="%"+q),Zr}else return w}var W=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D="".match(/(){0}/)[1]===void 0;function M(w){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T={},Z=_.iri!==!1?l:c;_.reference==="suffix"&&(w=(_.scheme?_.scheme+":":"")+"//"+w);var V=w.match(W);if(V){D?(T.scheme=V[1],T.userinfo=V[3],T.host=V[4],T.port=parseInt(V[5],10),T.path=V[6]||"",T.query=V[7],T.fragment=V[8],isNaN(T.port)&&(T.port=V[5])):(T.scheme=V[1]||void 0,T.userinfo=w.indexOf("@")!==-1?V[3]:void 0,T.host=w.indexOf("//")!==-1?V[4]:void 0,T.port=parseInt(V[5],10),T.path=V[6]||"",T.query=w.indexOf("?")!==-1?V[7]:void 0,T.fragment=w.indexOf("#")!==-1?V[8]:void 0,isNaN(T.port)&&(T.port=w.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?V[4]:void 0)),T.host&&(T.host=N(We(T.host,Z),Z)),T.scheme===void 0&&T.userinfo===void 0&&T.host===void 0&&T.port===void 0&&!T.path&&T.query===void 0?T.reference="same-document":T.scheme===void 0?T.reference="relative":T.fragment===void 0?T.reference="absolute":T.reference="uri",_.reference&&_.reference!=="suffix"&&_.reference!==T.reference&&(T.error=T.error||"URI is not a "+_.reference+" reference.");var q=Ce[(_.scheme||T.scheme||"").toLowerCase()];if(!_.unicodeSupport&&(!q||!q.unicodeSupport)){if(T.host&&(_.domainHost||q&&q.domainHost))try{T.host=Rt.toASCII(T.host.replace(Z.PCT_ENCODED,ce).toLowerCase())}catch(le){T.error=T.error||"Host's domain name can not be converted to ASCII via punycode: "+le}Ve(T,c)}else Ve(T,Z);q&&q.parse&&q.parse(T,_)}else T.error=T.error||"URI can not be parsed.";return T}function he(w,_){var T=_.iri!==!1?l:c,Z=[];return w.userinfo!==void 0&&(Z.push(w.userinfo),Z.push("@")),w.host!==void 0&&Z.push(N(We(String(w.host),T),T).replace(T.IPV6ADDRESS,function(V,q,le){return"["+q+(le?"%25"+le:"")+"]"})),(typeof w.port=="number"||typeof w.port=="string")&&(Z.push(":"),Z.push(String(w.port))),Z.length?Z.join(""):void 0}var oe=/^\.\.?\//,we=/^\/\.(\/|$)/,ze=/^\/\.\.(\/|$)/,xi=/^\/?(?:.|\n)*?(?=\/|$)/;function Je(w){for(var _=[];w.length;)if(w.match(oe))w=w.replace(oe,"");else if(w.match(we))w=w.replace(we,"/");else if(w.match(ze))w=w.replace(ze,"/"),_.pop();else if(w==="."||w==="..")w="";else{var T=w.match(xi);if(T){var Z=T[0];w=w.slice(Z.length),_.push(Z)}else throw new Error("Unexpected dot segment condition")}return _.join("")}function vt(w){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=_.iri?l:c,Z=[],V=Ce[(_.scheme||w.scheme||"").toLowerCase()];if(V&&V.serialize&&V.serialize(w,_),w.host&&!T.IPV6ADDRESS.test(w.host)){if(_.domainHost||V&&V.domainHost)try{w.host=_.iri?Rt.toUnicode(w.host):Rt.toASCII(w.host.replace(T.PCT_ENCODED,ce).toLowerCase())}catch(Re){w.error=w.error||"Host's domain name can not be converted to "+(_.iri?"Unicode":"ASCII")+" via punycode: "+Re}}Ve(w,T),_.reference!=="suffix"&&w.scheme&&(Z.push(w.scheme),Z.push(":"));var q=he(w,_);if(q!==void 0&&(_.reference!=="suffix"&&Z.push("//"),Z.push(q),w.path&&w.path.charAt(0)!=="/"&&Z.push("/")),w.path!==void 0){var le=w.path;!_.absolutePath&&(!V||!V.absolutePath)&&(le=Je(le)),q===void 0&&(le=le.replace(/^\/\//,"/%2F")),Z.push(le)}return w.query!==void 0&&(Z.push("?"),Z.push(w.query)),w.fragment!==void 0&&(Z.push("#"),Z.push(w.fragment)),Z.join("")}function Yw(w,_){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Z=arguments[3],V={};return Z||(w=M(vt(w,T),T),_=M(vt(_,T),T)),T=T||{},!T.tolerant&&_.scheme?(V.scheme=_.scheme,V.userinfo=_.userinfo,V.host=_.host,V.port=_.port,V.path=Je(_.path||""),V.query=_.query):(_.userinfo!==void 0||_.host!==void 0||_.port!==void 0?(V.userinfo=_.userinfo,V.host=_.host,V.port=_.port,V.path=Je(_.path||""),V.query=_.query):(_.path?(_.path.charAt(0)==="/"?V.path=Je(_.path):((w.userinfo!==void 0||w.host!==void 0||w.port!==void 0)&&!w.path?V.path="/"+_.path:w.path?V.path=w.path.slice(0,w.path.lastIndexOf("/")+1)+_.path:V.path=_.path,V.path=Je(V.path)),V.query=_.query):(V.path=w.path,_.query!==void 0?V.query=_.query:V.query=w.query),V.userinfo=w.userinfo,V.host=w.host,V.port=w.port),V.scheme=w.scheme),V.fragment=_.fragment,V}function zr(w,_,T){var Z=o({scheme:"null"},T);return vt(Yw(M(w,Z),M(_,Z),Z,!0),Z)}function es(w,_){return typeof w=="string"?w=vt(M(w,_),_):n(w)==="object"&&(w=M(vt(w,_),_)),w}function kc(w,_,T){return typeof w=="string"?w=vt(M(w,T),T):n(w)==="object"&&(w=vt(w,T)),typeof _=="string"?_=vt(M(_,T),T):n(_)==="object"&&(_=vt(_,T)),w===_}function Us(w,_){return w&&w.toString().replace(!_||!_.iri?c.ESCAPE:l.ESCAPE,mt)}function Jr(w,_){return w&&w.toString().replace(!_||!_.iri?c.PCT_ENCODED:l.PCT_ENCODED,ce)}var Fc={scheme:"http",domainHost:!0,parse:function(_,T){return _.host||(_.error=_.error||"HTTP URIs must have a host."),_},serialize:function(_,T){var Z=String(_.scheme).toLowerCase()==="https";return(_.port===(Z?443:80)||_.port==="")&&(_.port=void 0),_.path||(_.path="/"),_}},Lt={scheme:"https",domainHost:Fc.domainHost,parse:Fc.parse,serialize:Fc.serialize};function Xd(w){return typeof w.secure=="boolean"?w.secure:String(w.scheme).toLowerCase()==="wss"}var Ys={scheme:"ws",domainHost:!0,parse:function(_,T){var Z=_;return Z.secure=Xd(Z),Z.resourceName=(Z.path||"/")+(Z.query?"?"+Z.query:""),Z.path=void 0,Z.query=void 0,Z},serialize:function(_,T){if((_.port===(Xd(_)?443:80)||_.port==="")&&(_.port=void 0),typeof _.secure=="boolean"&&(_.scheme=_.secure?"wss":"ws",_.secure=void 0),_.resourceName){var Z=_.resourceName.split("?"),V=u(Z,2),q=V[0],le=V[1];_.path=q&&q!=="/"?q:void 0,_.query=le,_.resourceName=void 0}return _.fragment=void 0,_}},je={scheme:"wss",domainHost:Ys.domainHost,parse:Ys.parse,serialize:Ys.serialize},br={},bq=!0,Cr="[A-Za-z0-9\\-\\.\\_\\~"+(bq?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",Et="[0-9A-Fa-f]",Cq=r(r("%[EFef]"+Et+"%"+Et+Et+"%"+Et+Et)+"|"+r("%[89A-Fa-f]"+Et+"%"+Et+Et)+"|"+r("%"+Et+Et)),yt="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Li="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Sq=e(Li,'[\\"\\\\]'),Qr="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Sr=new RegExp(Cr,"g"),ts=new RegExp(Cq,"g"),Ds=new RegExp(e("[^]",yt,"[\\.]",'[\\"]',Sq),"g"),Xs=new RegExp(e("[^]",Cr,Qr),"g"),$d=Xs;function In(w){var _=ce(w);return _.match(Sr)?_:w}var Dw={scheme:"mailto",parse:function(_,T){var Z=_,V=Z.to=Z.path?Z.path.split(","):[];if(Z.path=void 0,Z.query){for(var q=!1,le={},Re=Z.query.split("&"),Oe=0,It=Re.length;Oe<It;++Oe){var _e=Re[Oe].split("=");switch(_e[0]){case"to":for(var et=_e[1].split(","),bt=0,Qe=et.length;bt<Qe;++bt)V.push(et[bt]);break;case"subject":Z.subject=Jr(_e[1],T);break;case"body":Z.body=Jr(_e[1],T);break;default:q=!0,le[Jr(_e[0],T)]=Jr(_e[1],T);break}}q&&(Z.headers=le)}Z.query=void 0;for(var Be=0,tt=V.length;Be<tt;++Be){var Fe=V[Be].split("@");if(Fe[0]=Jr(Fe[0]),T.unicodeSupport)Fe[1]=Jr(Fe[1],T).toLowerCase();else try{Fe[1]=Rt.toASCII(Jr(Fe[1],T).toLowerCase())}catch(Ui){Z.error=Z.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ui}V[Be]=Fe.join("@")}return Z},serialize:function(_,T){var Z=_,V=i(_.to);if(V){for(var q=0,le=V.length;q<le;++q){var Re=String(V[q]),Oe=Re.lastIndexOf("@"),It=Re.slice(0,Oe).replace(ts,In).replace(ts,s).replace(Ds,mt),_e=Re.slice(Oe+1);try{_e=T.iri?Rt.toUnicode(_e):Rt.toASCII(Jr(_e,T).toLowerCase())}catch(Be){Z.error=Z.error||"Email address's domain name can not be converted to "+(T.iri?"Unicode":"ASCII")+" via punycode: "+Be}V[q]=It+"@"+_e}Z.path=V.join(",")}var et=_.headers=_.headers||{};_.subject&&(et.subject=_.subject),_.body&&(et.body=_.body);var bt=[];for(var Qe in et)et[Qe]!==br[Qe]&&bt.push(Qe.replace(ts,In).replace(ts,s).replace(Xs,mt)+"="+et[Qe].replace(ts,In).replace(ts,s).replace($d,mt));return bt.length&&(Z.query=bt.join("&")),Z}},vq=/^([^\:]+)\:(.*)/,Xw={scheme:"urn",parse:function(_,T){var Z=_.path&&_.path.match(vq),V=_;if(Z){var q=T.scheme||V.scheme||"urn",le=Z[1].toLowerCase(),Re=Z[2],Oe=q+":"+(T.nid||le),It=Ce[Oe];V.nid=le,V.nss=Re,V.path=void 0,It&&(V=It.parse(V,T))}else V.error=V.error||"URN can not be parsed.";return V},serialize:function(_,T){var Z=T.scheme||_.scheme||"urn",V=_.nid,q=Z+":"+(T.nid||V),le=Ce[q];le&&(_=le.serialize(_,T));var Re=_,Oe=_.nss;return Re.path=(V||T.nid)+":"+Oe,Re}},_q=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,$w={scheme:"urn:uuid",parse:function(_,T){var Z=_;return Z.uuid=Z.nss,Z.nss=void 0,!T.tolerant&&(!Z.uuid||!Z.uuid.match(_q))&&(Z.error=Z.error||"UUID is not valid."),Z},serialize:function(_,T){var Z=_;return Z.nss=(_.uuid||"").toLowerCase(),Z}};Ce[Fc.scheme]=Fc,Ce[Lt.scheme]=Lt,Ce[Ys.scheme]=Ys,Ce[je.scheme]=je,Ce[Dw.scheme]=Dw,Ce[Xw.scheme]=Xw,Ce[$w.scheme]=$w,t.SCHEMES=Ce,t.pctEncChar=mt,t.pctDecChars=ce,t.parse=M,t.removeDotSegments=Je,t.serialize=vt,t.resolveComponents=Yw,t.resolve=zr,t.normalize=es,t.equal=kc,t.escapeComponent=Us,t.unescapeComponent=Jr,Object.defineProperty(t,"__esModule",{value:!0})})});var KN=h(Yb=>{"use strict";Object.defineProperty(Yb,"__esModule",{value:!0});var MN=qN();MN.code='require("ajv/dist/runtime/uri").default';Yb.default=MN});var $b=h(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.CodeGen=kt.Name=kt.nil=kt.stringify=kt.str=kt._=kt.KeywordCxt=void 0;var W8=ma();Object.defineProperty(kt,"KeywordCxt",{enumerable:!0,get:function(){return W8.KeywordCxt}});var Ia=ne();Object.defineProperty(kt,"_",{enumerable:!0,get:function(){return Ia._}});Object.defineProperty(kt,"str",{enumerable:!0,get:function(){return Ia.str}});Object.defineProperty(kt,"stringify",{enumerable:!0,get:function(){return Ia.stringify}});Object.defineProperty(kt,"nil",{enumerable:!0,get:function(){return Ia.nil}});Object.defineProperty(kt,"Name",{enumerable:!0,get:function(){return Ia.Name}});Object.defineProperty(kt,"CodeGen",{enumerable:!0,get:function(){return Ia.CodeGen}});var O8=yl(),tV=si(),P8=Ab(),Il=so(),k8=ne(),bl=pl(),Kf=gl(),Xb=de(),zN=$N(),F8=KN(),rV=(t,e)=>new RegExp(t,e);rV.code="new RegExp";var x8=["removeAdditional","useDefaults","coerceTypes"],L8=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),U8={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Y8={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},JN=200;function D8(t){var e,r,n,s,i,o,a,c,l,u,d,f,g,p,m,I,C,S,b,y,A,E,v,B,H;let R=t.strict,x=(e=t.code)===null||e===void 0?void 0:e.optimize,F=x===!0||x===void 0?1:x||0,L=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:rV,ie=(s=t.uriResolver)!==null&&s!==void 0?s:F8.default;return{strictSchema:(o=(i=t.strictSchema)!==null&&i!==void 0?i:R)!==null&&o!==void 0?o:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:R)!==null&&c!==void 0?c:!0,strictTypes:(u=(l=t.strictTypes)!==null&&l!==void 0?l:R)!==null&&u!==void 0?u:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:R)!==null&&f!==void 0?f:"log",strictRequired:(p=(g=t.strictRequired)!==null&&g!==void 0?g:R)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:F,regExp:L}:{optimize:F,regExp:L},loopRequired:(m=t.loopRequired)!==null&&m!==void 0?m:JN,loopEnum:(I=t.loopEnum)!==null&&I!==void 0?I:JN,meta:(C=t.meta)!==null&&C!==void 0?C:!0,messages:(S=t.messages)!==null&&S!==void 0?S:!0,inlineRefs:(b=t.inlineRefs)!==null&&b!==void 0?b:!0,schemaId:(y=t.schemaId)!==null&&y!==void 0?y:"$id",addUsedSchema:(A=t.addUsedSchema)!==null&&A!==void 0?A:!0,validateSchema:(E=t.validateSchema)!==null&&E!==void 0?E:!0,validateFormats:(v=t.validateFormats)!==null&&v!==void 0?v:!0,unicodeRegExp:(B=t.unicodeRegExp)!==null&&B!==void 0?B:!0,int32range:(H=t.int32range)!==null&&H!==void 0?H:!0,uriResolver:ie}}var Cl=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...D8(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new k8.ValueScope({scope:{},prefixes:L8,es5:r,lines:n}),this.logger=K8(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,P8.getRules)(),QN.call(this,U8,e,"NOT SUPPORTED"),QN.call(this,Y8,e,"DEPRECATED","warn"),this._metaOpts=q8.call(this),e.formats&&$8.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&j8.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),X8.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,s=zN;n==="id"&&(s={...zN},s.id=s.$id,delete s.$id),r&&e&&this.addMetaSchema(s,s[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let s=n(r);return"$async"in n||(this.errors=n.errors),s}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return s.call(this,e,r);async function s(u,d){await i.call(this,u.$schema);let f=this._addSchema(u,d);return f.validate||o.call(this,f)}async function i(u){u&&!this.getSchema(u)&&await s.call(this,{$ref:u},!0)}async function o(u){try{return this._compileSchemaEnv(u)}catch(d){if(!(d instanceof tV.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),o.call(this,u)}}function a({missingSchema:u,missingRef:d}){if(this.refs[u])throw new Error(`AnySchema ${u} is loaded but ${d} cannot be resolved`)}async function c(u){let d=await l.call(this,u);this.refs[u]||await i.call(this,d.$schema),this.refs[u]||this.addSchema(d,u,r)}async function l(u){let d=this._loading[u];if(d)return d;try{return await(this._loading[u]=n(u))}finally{delete this._loading[u]}}}addSchema(e,r,n,s=this.opts.validateSchema){if(Array.isArray(e)){for(let o of e)this.addSchema(o,void 0,n,s);return this}let i;if(typeof e=="object"){let{schemaId:o}=this.opts;if(i=e[o],i!==void 0&&typeof i!="string")throw new Error(`schema ${o} must be string`)}return r=(0,bl.normalizeId)(r||i),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,s,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(n,e);if(!s&&r){let i="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(i);else throw new Error(i)}return s}getSchema(e){let r;for(;typeof(r=eV.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,s=new Il.SchemaEnv({schema:{},schemaId:n});if(r=Il.resolveSchema.call(this,s,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=eV.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,bl.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(J8.call(this,n,r),!r)return(0,Xb.eachItem)(n,i=>Db.call(this,i)),this;e7.call(this,r);let s={...r,type:(0,Kf.getJSONTypes)(r.type),schemaType:(0,Kf.getJSONTypes)(r.schemaType)};return(0,Xb.eachItem)(n,s.type.length===0?i=>Db.call(this,i,s):i=>s.type.forEach(o=>Db.call(this,i,s,o))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let s=n.rules.findIndex(i=>i.keyword===e);s>=0&&n.rules.splice(s,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(s=>`${n}${s.instancePath} ${s.message}`).reduce((s,i)=>s+r+i)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let s of r){let i=s.split("/").slice(1),o=e;for(let a of i)o=o[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:l}=c.definition,u=o[a];l&&u&&(o[a]=nV(u))}}return e}_removeAllSchemas(e,r){for(let n in e){let s=e[n];(!r||r.test(n))&&(typeof s=="string"?delete e[n]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[n]))}}_addSchema(e,r,n,s=this.opts.validateSchema,i=this.opts.addUsedSchema){let o,{schemaId:a}=this.opts;if(typeof e=="object")o=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,bl.normalizeId)(o||n);let l=bl.getSchemaRefs.call(this,e,n);return c=new Il.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:l}),this._cache.set(c.schema,c),i&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),s&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Il.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Il.compileSchema.call(this,e)}finally{this.opts=r}}};kt.default=Cl;Cl.ValidationError=O8.default;Cl.MissingRefError=tV.default;function QN(t,e,r,n="error"){for(let s in t){let i=s;i in e&&this.logger[n](`${r}: option ${s}. ${t[i]}`)}}function eV(t){return t=(0,bl.normalizeId)(t),this.schemas[t]||this.refs[t]}function X8(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function $8(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function j8(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function q8(){let t={...this.opts};for(let e of x8)delete t[e];return t}var M8={log(){},warn(){},error(){}};function K8(t){if(t===!1)return M8;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var z8=/^[a-z_$][a-z0-9_$:-]*$/i;function J8(t,e){let{RULES:r}=this;if((0,Xb.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!z8.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Db(t,e,r){var n;let s=e?.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:i}=this,o=s?i.post:i.rules.find(({type:c})=>c===r);if(o||(o={type:r,rules:[]},i.rules.push(o)),i.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Kf.getJSONTypes)(e.type),schemaType:(0,Kf.getJSONTypes)(e.schemaType)}};e.before?Q8.call(this,o,a,e.before):o.rules.push(a),i.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function Q8(t,e,r){let n=t.rules.findIndex(s=>s.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function e7(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=nV(e)),t.validateSchema=this.compile(e,!0))}var t7={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function nV(t){return{anyOf:[t,t7]}}});var sV=h(jb=>{"use strict";Object.defineProperty(jb,"__esModule",{value:!0});var r7={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};jb.default=r7});var qb=h(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.callRef=io.getValidate=void 0;var n7=si(),iV=Pt(),fr=ne(),ba=Or(),oV=so(),zf=de(),s7={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:c}=n,{root:l}=i;if((r==="#"||r==="#/")&&s===l.baseId)return d();let u=oV.resolveRef.call(c,l,s,r);if(u===void 0)throw new n7.default(n.opts.uriResolver,s,r);if(u instanceof oV.SchemaEnv)return f(u);return g(u);function d(){if(i===l)return Jf(t,o,i,i.$async);let p=e.scopeValue("root",{ref:l});return Jf(t,(0,fr._)`${p}.validate`,l,l.$async)}function f(p){let m=aV(t,p);Jf(t,m,p,p.$async)}function g(p){let m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,fr.stringify)(p)}:{ref:p}),I=e.name("valid"),C=t.subschema({schema:p,dataTypes:[],schemaPath:fr.nil,topSchemaRef:m,errSchemaPath:r},I);t.mergeEvaluated(C),t.ok(I)}}};function aV(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,fr._)`${r.scopeValue("wrapper",{ref:e})}.validate`}io.getValidate=aV;function Jf(t,e,r,n){let{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:c}=i,l=c.passContext?ba.default.this:fr.nil;n?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=s.let("valid");s.try(()=>{s.code((0,fr._)`await ${(0,iV.callValidateCode)(t,e,l)}`),g(e),o||s.assign(p,!0)},m=>{s.if((0,fr._)`!(${m} instanceof ${i.ValidationError})`,()=>s.throw(m)),f(m),o||s.assign(p,!1)}),t.ok(p)}function d(){t.result((0,iV.callValidateCode)(t,e,l),()=>g(e),()=>f(e))}function f(p){let m=(0,fr._)`${p}.errors`;s.assign(ba.default.vErrors,(0,fr._)`${ba.default.vErrors} === null ? ${m} : ${ba.default.vErrors}.concat(${m})`),s.assign(ba.default.errors,(0,fr._)`${ba.default.vErrors}.length`)}function g(p){var m;if(!i.opts.unevaluated)return;let I=(m=r?.validate)===null||m===void 0?void 0:m.evaluated;if(i.props!==!0)if(I&&!I.dynamicProps)I.props!==void 0&&(i.props=zf.mergeEvaluated.props(s,I.props,i.props));else{let C=s.var("props",(0,fr._)`${p}.evaluated.props`);i.props=zf.mergeEvaluated.props(s,C,i.props,fr.Name)}if(i.items!==!0)if(I&&!I.dynamicItems)I.items!==void 0&&(i.items=zf.mergeEvaluated.items(s,I.items,i.items));else{let C=s.var("items",(0,fr._)`${p}.evaluated.items`);i.items=zf.mergeEvaluated.items(s,C,i.items,fr.Name)}}}io.callRef=Jf;io.default=s7});var cV=h(Mb=>{"use strict";Object.defineProperty(Mb,"__esModule",{value:!0});var i7=sV(),o7=qb(),a7=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",i7.default,o7.default];Mb.default=a7});var lV=h(Kb=>{"use strict";Object.defineProperty(Kb,"__esModule",{value:!0});var Qf=ne(),ii=Qf.operators,eg={maximum:{okStr:"<=",ok:ii.LTE,fail:ii.GT},minimum:{okStr:">=",ok:ii.GTE,fail:ii.LT},exclusiveMaximum:{okStr:"<",ok:ii.LT,fail:ii.GTE},exclusiveMinimum:{okStr:">",ok:ii.GT,fail:ii.LTE}},c7={message:({keyword:t,schemaCode:e})=>(0,Qf.str)`must be ${eg[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Qf._)`{comparison: ${eg[t].okStr}, limit: ${e}}`},l7={keyword:Object.keys(eg),type:"number",schemaType:"number",$data:!0,error:c7,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Qf._)`${r} ${eg[e].fail} ${n} || isNaN(${r})`)}};Kb.default=l7});var uV=h(zb=>{"use strict";Object.defineProperty(zb,"__esModule",{value:!0});var Sl=ne(),u7={message:({schemaCode:t})=>(0,Sl.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Sl._)`{multipleOf: ${t}}`},d7={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:u7,code(t){let{gen:e,data:r,schemaCode:n,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,Sl._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,Sl._)`${o} !== parseInt(${o})`;t.fail$data((0,Sl._)`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};zb.default=d7});var fV=h(Jb=>{"use strict";Object.defineProperty(Jb,"__esModule",{value:!0});function dV(t){let e=t.length,r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Jb.default=dV;dV.code='require("ajv/dist/runtime/ucs2length").default'});var gV=h(Qb=>{"use strict";Object.defineProperty(Qb,"__esModule",{value:!0});var oo=ne(),f7=de(),g7=fV(),p7={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,oo.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,oo._)`{limit: ${t}}`},h7={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:p7,code(t){let{keyword:e,data:r,schemaCode:n,it:s}=t,i=e==="maxLength"?oo.operators.GT:oo.operators.LT,o=s.opts.unicode===!1?(0,oo._)`${r}.length`:(0,oo._)`${(0,f7.useFunc)(t.gen,g7.default)}(${r})`;t.fail$data((0,oo._)`${o} ${i} ${n}`)}};Qb.default=h7});var pV=h(eC=>{"use strict";Object.defineProperty(eC,"__esModule",{value:!0});var m7=Pt(),tg=ne(),y7={message:({schemaCode:t})=>(0,tg.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,tg._)`{pattern: ${t}}`},I7={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:y7,code(t){let{data:e,$data:r,schema:n,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,tg._)`(new RegExp(${s}, ${o}))`:(0,m7.usePattern)(t,n);t.fail$data((0,tg._)`!${a}.test(${e})`)}};eC.default=I7});var hV=h(tC=>{"use strict";Object.defineProperty(tC,"__esModule",{value:!0});var vl=ne(),b7={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,vl.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,vl._)`{limit: ${t}}`},C7={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:b7,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?vl.operators.GT:vl.operators.LT;t.fail$data((0,vl._)`Object.keys(${r}).length ${s} ${n}`)}};tC.default=C7});var mV=h(rC=>{"use strict";Object.defineProperty(rC,"__esModule",{value:!0});var _l=Pt(),Al=ne(),S7=de(),v7={message:({params:{missingProperty:t}})=>(0,Al.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Al._)`{missingProperty: ${t}}`},_7={keyword:"required",type:"object",schemaType:"array",$data:!0,error:v7,code(t){let{gen:e,schema:r,schemaCode:n,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;let c=r.length>=a.loopRequired;if(o.allErrors?l():u(),a.strictRequired){let g=t.parentSchema.properties,{definedProperties:p}=t.it;for(let m of r)if(g?.[m]===void 0&&!p.has(m)){let I=o.schemaEnv.baseId+o.errSchemaPath,C=`required property "${m}" is not defined at "${I}" (strictRequired)`;(0,S7.checkStrictMode)(o,C,o.opts.strictRequired)}}function l(){if(c||i)t.block$data(Al.nil,d);else for(let g of r)(0,_l.checkReportMissingProp)(t,g)}function u(){let g=e.let("missing");if(c||i){let p=e.let("valid",!0);t.block$data(p,()=>f(g,p)),t.ok(p)}else e.if((0,_l.checkMissingProp)(t,r,g)),(0,_l.reportMissingProp)(t,g),e.else()}function d(){e.forOf("prop",n,g=>{t.setParams({missingProperty:g}),e.if((0,_l.noPropertyInData)(e,s,g,a.ownProperties),()=>t.error())})}function f(g,p){t.setParams({missingProperty:g}),e.forOf(g,n,()=>{e.assign(p,(0,_l.propertyInData)(e,s,g,a.ownProperties)),e.if((0,Al.not)(p),()=>{t.error(),e.break()})},Al.nil)}}};rC.default=_7});var yV=h(nC=>{"use strict";Object.defineProperty(nC,"__esModule",{value:!0});var Rl=ne(),A7={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,Rl.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,Rl._)`{limit: ${t}}`},R7={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:A7,code(t){let{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?Rl.operators.GT:Rl.operators.LT;t.fail$data((0,Rl._)`${r}.length ${s} ${n}`)}};nC.default=R7});var El=h(sC=>{"use strict";Object.defineProperty(sC,"__esModule",{value:!0});var IV=pa();IV.code='require("ajv/dist/runtime/equal").default';sC.default=IV});var bV=h(oC=>{"use strict";Object.defineProperty(oC,"__esModule",{value:!0});var iC=gl(),Ft=ne(),E7=de(),w7=El(),B7={message:({params:{i:t,j:e}})=>(0,Ft.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ft._)`{i: ${t}, j: ${e}}`},T7={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:B7,code(t){let{gen:e,data:r,$data:n,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!n&&!s)return;let c=e.let("valid"),l=i.items?(0,iC.getSchemaTypes)(i.items):[];t.block$data(c,u,(0,Ft._)`${o} === false`),t.ok(c);function u(){let p=e.let("i",(0,Ft._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(c,!0),e.if((0,Ft._)`${p} > 1`,()=>(d()?f:g)(p,m))}function d(){return l.length>0&&!l.some(p=>p==="object"||p==="array")}function f(p,m){let I=e.name("item"),C=(0,iC.checkDataTypes)(l,I,a.opts.strictNumbers,iC.DataType.Wrong),S=e.const("indices",(0,Ft._)`{}`);e.for((0,Ft._)`;${p}--;`,()=>{e.let(I,(0,Ft._)`${r}[${p}]`),e.if(C,(0,Ft._)`continue`),l.length>1&&e.if((0,Ft._)`typeof ${I} == "string"`,(0,Ft._)`${I} += "_"`),e.if((0,Ft._)`typeof ${S}[${I}] == "number"`,()=>{e.assign(m,(0,Ft._)`${S}[${I}]`),t.error(),e.assign(c,!1).break()}).code((0,Ft._)`${S}[${I}] = ${p}`)})}function g(p,m){let I=(0,E7.useFunc)(e,w7.default),C=e.name("outer");e.label(C).for((0,Ft._)`;${p}--;`,()=>e.for((0,Ft._)`${m} = ${p}; ${m}--;`,()=>e.if((0,Ft._)`${I}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(c,!1).break(C)})))}}};oC.default=T7});var CV=h(cC=>{"use strict";Object.defineProperty(cC,"__esModule",{value:!0});var aC=ne(),G7=de(),Z7=El(),N7={message:"must be equal to constant",params:({schemaCode:t})=>(0,aC._)`{allowedValue: ${t}}`},V7={keyword:"const",$data:!0,error:N7,code(t){let{gen:e,data:r,$data:n,schemaCode:s,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,aC._)`!${(0,G7.useFunc)(e,Z7.default)}(${r}, ${s})`):t.fail((0,aC._)`${i} !== ${r}`)}};cC.default=V7});var SV=h(lC=>{"use strict";Object.defineProperty(lC,"__esModule",{value:!0});var wl=ne(),H7=de(),W7=El(),O7={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,wl._)`{allowedValues: ${t}}`},P7={keyword:"enum",schemaType:"array",$data:!0,error:O7,code(t){let{gen:e,data:r,$data:n,schema:s,schemaCode:i,it:o}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");let a=s.length>=o.opts.loopEnum,c,l=()=>c??(c=(0,H7.useFunc)(e,W7.default)),u;if(a||n)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");let g=e.const("vSchema",i);u=(0,wl.or)(...s.map((p,m)=>f(g,m)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",i,g=>e.if((0,wl._)`${l()}(${r}, ${g})`,()=>e.assign(u,!0).break()))}function f(g,p){let m=s[p];return typeof m=="object"&&m!==null?(0,wl._)`${l()}(${r}, ${g}[${p}])`:(0,wl._)`${r} === ${m}`}}};lC.default=P7});var vV=h(uC=>{"use strict";Object.defineProperty(uC,"__esModule",{value:!0});var k7=lV(),F7=uV(),x7=gV(),L7=pV(),U7=hV(),Y7=mV(),D7=yV(),X7=bV(),$7=CV(),j7=SV(),q7=[k7.default,F7.default,x7.default,L7.default,U7.default,Y7.default,D7.default,X7.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},$7.default,j7.default];uC.default=q7});var fC=h(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.validateAdditionalItems=void 0;var ao=ne(),dC=de(),M7={message:({params:{len:t}})=>(0,ao.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,ao._)`{limit: ${t}}`},K7={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:M7,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,dC.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}_V(t,n)}};function _V(t,e){let{gen:r,schema:n,data:s,keyword:i,it:o}=t;o.items=!0;let a=r.const("len",(0,ao._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,ao._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,dC.alwaysValidSchema)(o,n)){let l=r.var("valid",(0,ao._)`${a} <= ${e.length}`);r.if((0,ao.not)(l),()=>c(l)),t.ok(l)}function c(l){r.forRange("i",e.length,a,u=>{t.subschema({keyword:i,dataProp:u,dataPropType:dC.Type.Num},l),o.allErrors||r.if((0,ao.not)(l),()=>r.break())})}}Bl.validateAdditionalItems=_V;Bl.default=K7});var gC=h(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});Tl.validateTuple=void 0;var AV=ne(),rg=de(),z7=Pt(),J7={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return RV(t,"additionalItems",e);r.items=!0,!(0,rg.alwaysValidSchema)(r,e)&&t.ok((0,z7.validateArray)(t))}};function RV(t,e,r=t.schema){let{gen:n,parentSchema:s,data:i,keyword:o,it:a}=t;u(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=rg.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),l=n.const("len",(0,AV._)`${i}.length`);r.forEach((d,f)=>{(0,rg.alwaysValidSchema)(a,d)||(n.if((0,AV._)`${l} > ${f}`,()=>t.subschema({keyword:o,schemaProp:f,dataProp:f},c)),t.ok(c))});function u(d){let{opts:f,errSchemaPath:g}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(f.strictTuples&&!m){let I=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${g}"`;(0,rg.checkStrictMode)(a,I,f.strictTuples)}}}Tl.validateTuple=RV;Tl.default=J7});var EV=h(pC=>{"use strict";Object.defineProperty(pC,"__esModule",{value:!0});var Q7=gC(),e6={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,Q7.validateTuple)(t,"items")};pC.default=e6});var BV=h(hC=>{"use strict";Object.defineProperty(hC,"__esModule",{value:!0});var wV=ne(),t6=de(),r6=Pt(),n6=fC(),s6={message:({params:{len:t}})=>(0,wV.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,wV._)`{limit: ${t}}`},i6={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:s6,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,t6.alwaysValidSchema)(n,e)&&(s?(0,n6.validateAdditionalItems)(t,s):t.ok((0,r6.validateArray)(t)))}};hC.default=i6});var TV=h(mC=>{"use strict";Object.defineProperty(mC,"__esModule",{value:!0});var kr=ne(),ng=de(),o6={message:({params:{min:t,max:e}})=>e===void 0?(0,kr.str)`must contain at least ${t} valid item(s)`:(0,kr.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,kr._)`{minContains: ${t}}`:(0,kr._)`{minContains: ${t}, maxContains: ${e}}`},a6={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:o6,code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:i}=t,o,a,{minContains:c,maxContains:l}=n;i.opts.next?(o=c===void 0?1:c,a=l):o=1;let u=e.const("len",(0,kr._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,ng.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,ng.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,ng.alwaysValidSchema)(i,r)){let m=(0,kr._)`${u} >= ${o}`;a!==void 0&&(m=(0,kr._)`${m} && ${u} <= ${a}`),t.pass(m);return}i.items=!0;let d=e.name("valid");a===void 0&&o===1?g(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,kr._)`${s}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let m=e.name("_valid"),I=e.let("count",0);g(m,()=>e.if(m,()=>p(I)))}function g(m,I){e.forRange("i",0,u,C=>{t.subschema({keyword:"contains",dataProp:C,dataPropType:ng.Type.Num,compositeRule:!0},m),I()})}function p(m){e.code((0,kr._)`${m}++`),a===void 0?e.if((0,kr._)`${m} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,kr._)`${m} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,kr._)`${m} >= ${o}`,()=>e.assign(d,!0)))}}};mC.default=a6});var NV=h(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.validateSchemaDeps=En.validatePropertyDeps=En.error=void 0;var yC=ne(),c6=de(),Gl=Pt();En.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,yC.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,yC._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var l6={keyword:"dependencies",type:"object",schemaType:"object",error:En.error,code(t){let[e,r]=u6(t);GV(t,e),ZV(t,r)}};function u6({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let s=Array.isArray(t[n])?e:r;s[n]=t[n]}return[e,r]}function GV(t,e=t.schema){let{gen:r,data:n,it:s}=t;if(Object.keys(e).length===0)return;let i=r.let("missing");for(let o in e){let a=e[o];if(a.length===0)continue;let c=(0,Gl.propertyInData)(r,n,o,s.opts.ownProperties);t.setParams({property:o,depsCount:a.length,deps:a.join(", ")}),s.allErrors?r.if(c,()=>{for(let l of a)(0,Gl.checkReportMissingProp)(t,l)}):(r.if((0,yC._)`${c} && (${(0,Gl.checkMissingProp)(t,a,i)})`),(0,Gl.reportMissingProp)(t,i),r.else())}}En.validatePropertyDeps=GV;function ZV(t,e=t.schema){let{gen:r,data:n,keyword:s,it:i}=t,o=r.name("valid");for(let a in e)(0,c6.alwaysValidSchema)(i,e[a])||(r.if((0,Gl.propertyInData)(r,n,a,i.opts.ownProperties),()=>{let c=t.subschema({keyword:s,schemaProp:a},o);t.mergeValidEvaluated(c,o)},()=>r.var(o,!0)),t.ok(o))}En.validateSchemaDeps=ZV;En.default=l6});var HV=h(IC=>{"use strict";Object.defineProperty(IC,"__esModule",{value:!0});var VV=ne(),d6=de(),f6={message:"property name must be valid",params:({params:t})=>(0,VV._)`{propertyName: ${t.propertyName}}`},g6={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:f6,code(t){let{gen:e,schema:r,data:n,it:s}=t;if((0,d6.alwaysValidSchema)(s,r))return;let i=e.name("valid");e.forIn("key",n,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,VV.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};IC.default=g6});var CC=h(bC=>{"use strict";Object.defineProperty(bC,"__esModule",{value:!0});var sg=Pt(),cn=ne(),p6=Or(),ig=de(),h6={message:"must NOT have additional properties",params:({params:t})=>(0,cn._)`{additionalProperty: ${t.additionalProperty}}`},m6={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:h6,code(t){let{gen:e,schema:r,parentSchema:n,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=o;if(o.props=!0,c.removeAdditional!=="all"&&(0,ig.alwaysValidSchema)(o,r))return;let l=(0,sg.allSchemaProperties)(n.properties),u=(0,sg.allSchemaProperties)(n.patternProperties);d(),t.ok((0,cn._)`${i} === ${p6.default.errors}`);function d(){e.forIn("key",s,I=>{!l.length&&!u.length?p(I):e.if(f(I),()=>p(I))})}function f(I){let C;if(l.length>8){let S=(0,ig.schemaRefOrVal)(o,n.properties,"properties");C=(0,sg.isOwnProperty)(e,S,I)}else l.length?C=(0,cn.or)(...l.map(S=>(0,cn._)`${I} === ${S}`)):C=cn.nil;return u.length&&(C=(0,cn.or)(C,...u.map(S=>(0,cn._)`${(0,sg.usePattern)(t,S)}.test(${I})`))),(0,cn.not)(C)}function g(I){e.code((0,cn._)`delete ${s}[${I}]`)}function p(I){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){g(I);return}if(r===!1){t.setParams({additionalProperty:I}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,ig.alwaysValidSchema)(o,r)){let C=e.name("valid");c.removeAdditional==="failing"?(m(I,C,!1),e.if((0,cn.not)(C),()=>{t.reset(),g(I)})):(m(I,C),a||e.if((0,cn.not)(C),()=>e.break()))}}function m(I,C,S){let b={keyword:"additionalProperties",dataProp:I,dataPropType:ig.Type.Str};S===!1&&Object.assign(b,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(b,C)}}};bC.default=m6});var PV=h(vC=>{"use strict";Object.defineProperty(vC,"__esModule",{value:!0});var y6=ma(),WV=Pt(),SC=de(),OV=CC(),I6={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&OV.default.code(new y6.KeywordCxt(i,OV.default,"additionalProperties"));let o=(0,WV.allSchemaProperties)(r);for(let d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=SC.mergeEvaluated.props(e,(0,SC.toHash)(o),i.props));let a=o.filter(d=>!(0,SC.alwaysValidSchema)(i,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)l(d)?u(d):(e.if((0,WV.propertyInData)(e,s,d,i.opts.ownProperties)),u(d),i.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};vC.default=I6});var LV=h(_C=>{"use strict";Object.defineProperty(_C,"__esModule",{value:!0});var kV=Pt(),og=ne(),FV=de(),xV=de(),b6={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,kV.allSchemaProperties)(r),c=a.filter(m=>(0,FV.alwaysValidSchema)(i,r[m]));if(a.length===0||c.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;let l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,u=e.name("valid");i.props!==!0&&!(i.props instanceof og.Name)&&(i.props=(0,xV.evaluatedPropsToName)(e,i.props));let{props:d}=i;f();function f(){for(let m of a)l&&g(m),i.allErrors?p(m):(e.var(u,!0),p(m),e.if(u))}function g(m){for(let I in l)new RegExp(m).test(I)&&(0,FV.checkStrictMode)(i,`property ${I} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,I=>{e.if((0,og._)`${(0,kV.usePattern)(t,m)}.test(${I})`,()=>{let C=c.includes(m);C||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:I,dataPropType:xV.Type.Str},u),i.opts.unevaluated&&d!==!0?e.assign((0,og._)`${d}[${I}]`,!0):!C&&!i.allErrors&&e.if((0,og.not)(u),()=>e.break())})})}}};_C.default=b6});var UV=h(AC=>{"use strict";Object.defineProperty(AC,"__esModule",{value:!0});var C6=de(),S6={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,C6.alwaysValidSchema)(n,r)){t.fail();return}let s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};AC.default=S6});var YV=h(RC=>{"use strict";Object.defineProperty(RC,"__esModule",{value:!0});var v6=Pt(),_6={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:v6.validateUnion,error:{message:"must match a schema in anyOf"}};RC.default=_6});var DV=h(EC=>{"use strict";Object.defineProperty(EC,"__esModule",{value:!0});var ag=ne(),A6=de(),R6={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,ag._)`{passingSchemas: ${t.passing}}`},E6={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:R6,code(t){let{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;let i=r,o=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((u,d)=>{let f;(0,A6.alwaysValidSchema)(s,u)?e.var(c,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,ag._)`${c} && ${o}`).assign(o,!1).assign(a,(0,ag._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(o,!0),e.assign(a,d),f&&t.mergeEvaluated(f,ag.Name)})})}}};EC.default=E6});var XV=h(wC=>{"use strict";Object.defineProperty(wC,"__esModule",{value:!0});var w6=de(),B6={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let s=e.name("valid");r.forEach((i,o)=>{if((0,w6.alwaysValidSchema)(n,i))return;let a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};wC.default=B6});var qV=h(BC=>{"use strict";Object.defineProperty(BC,"__esModule",{value:!0});var cg=ne(),jV=de(),T6={message:({params:t})=>(0,cg.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,cg._)`{failingKeyword: ${t.ifClause}}`},G6={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:T6,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,jV.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let s=$V(n,"then"),i=$V(n,"else");if(!s&&!i)return;let o=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&i){let u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,l("then",u),l("else",u))}else s?e.if(a,l("then")):e.if((0,cg.not)(a),l("else"));t.pass(o,()=>t.error(!0));function c(){let u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function l(u,d){return()=>{let f=t.subschema({keyword:u},a);e.assign(o,a),t.mergeValidEvaluated(f,o),d?e.assign(d,(0,cg._)`${u}`):t.setParams({ifClause:u})}}}};function $V(t,e){let r=t.schema[e];return r!==void 0&&!(0,jV.alwaysValidSchema)(t,r)}BC.default=G6});var MV=h(TC=>{"use strict";Object.defineProperty(TC,"__esModule",{value:!0});var Z6=de(),N6={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,Z6.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};TC.default=N6});var KV=h(GC=>{"use strict";Object.defineProperty(GC,"__esModule",{value:!0});var V6=fC(),H6=EV(),W6=gC(),O6=BV(),P6=TV(),k6=NV(),F6=HV(),x6=CC(),L6=PV(),U6=LV(),Y6=UV(),D6=YV(),X6=DV(),$6=XV(),j6=qV(),q6=MV();function M6(t=!1){let e=[Y6.default,D6.default,X6.default,$6.default,j6.default,q6.default,F6.default,x6.default,k6.default,L6.default,U6.default];return t?e.push(H6.default,O6.default):e.push(V6.default,W6.default),e.push(P6.default),e}GC.default=M6});var zV=h(ZC=>{"use strict";Object.defineProperty(ZC,"__esModule",{value:!0});var lt=ne(),K6={message:({schemaCode:t})=>(0,lt.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,lt._)`{format: ${t}}`},z6={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:K6,code(t,e){let{gen:r,data:n,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:c,errSchemaPath:l,schemaEnv:u,self:d}=a;if(!c.validateFormats)return;s?f():g();function f(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),m=r.const("fDef",(0,lt._)`${p}[${o}]`),I=r.let("fType"),C=r.let("format");r.if((0,lt._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(I,(0,lt._)`${m}.type || "string"`).assign(C,(0,lt._)`${m}.validate`),()=>r.assign(I,(0,lt._)`"string"`).assign(C,m)),t.fail$data((0,lt.or)(S(),b()));function S(){return c.strictSchema===!1?lt.nil:(0,lt._)`${o} && !${C}`}function b(){let y=u.$async?(0,lt._)`(${m}.async ? await ${C}(${n}) : ${C}(${n}))`:(0,lt._)`${C}(${n})`,A=(0,lt._)`(typeof ${C} == "function" ? ${y} : ${C}.test(${n}))`;return(0,lt._)`${C} && ${C} !== true && ${I} === ${e} && !${A}`}}function g(){let p=d.formats[i];if(!p){S();return}if(p===!0)return;let[m,I,C]=b(p);m===e&&t.pass(y());function S(){if(c.strictSchema===!1){d.logger.warn(A());return}throw new Error(A());function A(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function b(A){let E=A instanceof RegExp?(0,lt.regexpCode)(A):c.code.formats?(0,lt._)`${c.code.formats}${(0,lt.getProperty)(i)}`:void 0,v=r.scopeValue("formats",{key:i,ref:A,code:E});return typeof A=="object"&&!(A instanceof RegExp)?[A.type||"string",A.validate,(0,lt._)`${v}.validate`]:["string",A,v]}function y(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!u.$async)throw new Error("async format in sync schema");return(0,lt._)`await ${C}(${n})`}return typeof I=="function"?(0,lt._)`${C}(${n})`:(0,lt._)`${C}.test(${n})`}}}};ZC.default=z6});var JV=h(NC=>{"use strict";Object.defineProperty(NC,"__esModule",{value:!0});var J6=zV(),Q6=[J6.default];NC.default=Q6});var QV=h(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.contentVocabulary=Ca.metadataVocabulary=void 0;Ca.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ca.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var tH=h(VC=>{"use strict";Object.defineProperty(VC,"__esModule",{value:!0});var eee=cV(),tee=vV(),ree=KV(),nee=JV(),eH=QV(),see=[eee.default,tee.default,(0,ree.default)(),nee.default,eH.metadataVocabulary,eH.contentVocabulary];VC.default=see});var HC=h(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});Zl.DiscrError=void 0;var iee;(function(t){t.Tag="tag",t.Mapping="mapping"})(iee=Zl.DiscrError||(Zl.DiscrError={}))});var nH=h(OC=>{"use strict";Object.defineProperty(OC,"__esModule",{value:!0});var Sa=ne(),WC=HC(),rH=so(),oee=de(),aee={message:({params:{discrError:t,tagName:e}})=>t===WC.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Sa._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},cee={keyword:"discriminator",type:"object",schemaType:"object",error:aee,code(t){let{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),l=e.const("tag",(0,Sa._)`${r}${(0,Sa.getProperty)(a)}`);e.if((0,Sa._)`typeof ${l} == "string"`,()=>u(),()=>t.error(!1,{discrError:WC.DiscrError.Tag,tag:l,tagName:a})),t.ok(c);function u(){let g=f();e.if(!1);for(let p in g)e.elseIf((0,Sa._)`${l} === ${p}`),e.assign(c,d(g[p]));e.else(),t.error(!1,{discrError:WC.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(g){let p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:g},p);return t.mergeEvaluated(m,Sa.Name),p}function f(){var g;let p={},m=C(s),I=!0;for(let y=0;y<o.length;y++){let A=o[y];A?.$ref&&!(0,oee.schemaHasRulesButRef)(A,i.self.RULES)&&(A=rH.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,A?.$ref),A instanceof rH.SchemaEnv&&(A=A.schema));let E=(g=A?.properties)===null||g===void 0?void 0:g[a];if(typeof E!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);I=I&&(m||C(A)),S(E,y)}if(!I)throw new Error(`discriminator: "${a}" must be required`);return p;function C({required:y}){return Array.isArray(y)&&y.includes(a)}function S(y,A){if(y.const)b(y.const,A);else if(y.enum)for(let E of y.enum)b(E,A);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function b(y,A){if(typeof y!="string"||y in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[y]=A}}}};OC.default=cee});var sH=h((UGe,lee)=>{lee.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var dg=h((rt,oH)=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.MissingRefError=rt.ValidationError=rt.CodeGen=rt.Name=rt.nil=rt.stringify=rt.str=rt._=rt.KeywordCxt=void 0;var uee=$b(),dee=tH(),fee=nH(),iH=sH(),gee=["/properties"],lg="http://json-schema.org/draft-07/schema",ug=class extends uee.default{_addVocabularies(){super._addVocabularies(),dee.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(fee.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(iH,gee):iH;this.addMetaSchema(e,lg,!1),this.refs["http://json-schema.org/schema"]=lg}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(lg)?lg:void 0)}};oH.exports=rt=ug;Object.defineProperty(rt,"__esModule",{value:!0});rt.default=ug;var pee=ma();Object.defineProperty(rt,"KeywordCxt",{enumerable:!0,get:function(){return pee.KeywordCxt}});var va=ne();Object.defineProperty(rt,"_",{enumerable:!0,get:function(){return va._}});Object.defineProperty(rt,"str",{enumerable:!0,get:function(){return va.str}});Object.defineProperty(rt,"stringify",{enumerable:!0,get:function(){return va.stringify}});Object.defineProperty(rt,"nil",{enumerable:!0,get:function(){return va.nil}});Object.defineProperty(rt,"Name",{enumerable:!0,get:function(){return va.Name}});Object.defineProperty(rt,"CodeGen",{enumerable:!0,get:function(){return va.CodeGen}});var hee=yl();Object.defineProperty(rt,"ValidationError",{enumerable:!0,get:function(){return hee.default}});var mee=si();Object.defineProperty(rt,"MissingRefError",{enumerable:!0,get:function(){return mee.default}})});var cH=h((YGe,aH)=>{"use strict";var yee={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};aH.exports={HEX:yee}});var mH=h((DGe,hH)=>{"use strict";var{HEX:Iee}=cH();function fH(t){if(pH(t,".")<3)return{host:t,isIPV4:!1};let e=t.match(/^(\b[01]?\d{1,2}|\b2[0-4]\d|\b25[0-5])(\.([01]?\d{1,2}|2[0-4]\d|25[0-5])){3}$/u)||[],[r]=e;return r?{host:Cee(r,"."),isIPV4:!0}:{host:t,isIPV4:!1}}function PC(t){let e="",r=!0;for(let n of t){if(n!=="0"&&r===!0&&(r=!1),Iee[n]===void 0)return;r||(e+=n)}return e}function bee(t){let e=0,r={error:!1,address:"",zone:""},n=[],s=[],i=!1,o=!1,a=!1;function c(){if(s.length){if(i===!1){let l=PC(s.join(""));if(l!==void 0)n.push(l);else return r.error=!0,!1}s.length=0}return!0}for(let l=0;l<t.length;l++){let u=t[l];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(a=!0),!c())break;if(e++,n.push(":"),e>7){r.error=!0;break}l-1>=0&&t[l-1]===":"&&(o=!0);continue}else if(u==="%"){if(!c())break;i=!0}else{s.push(u);continue}}return s.length&&(i?r.zone=s.join(""):a?n.push(s.join("")):n.push(PC(s.join("")))),r.address=n.join(""),r}function gH(t,e={}){if(pH(t,":")<2)return{host:t,isIPV6:!1};let r=bee(t);if(r.error)return{host:t,isIPV6:!1};{let n=r.address,s=r.address;return r.zone&&(n+="%"+r.zone,s+="%25"+r.zone),{host:n,escapedHost:s,isIPV6:!0}}}function Cee(t,e){let r="",n=!0,s=t.length;for(let i=0;i<s;i++){let o=t[i];o==="0"&&n?(i+1<=s&&t[i+1]===e||i+1===s)&&(r+=o,n=!1):(o===e?n=!0:n=!1,r+=o)}return r}function pH(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}var lH=/^\.\.?\//u,uH=/^\/\.(?:\/|$)/u,dH=/^\/\.\.(?:\/|$)/u,See=/^\/?(?:.|\n)*?(?=\/|$)/u;function vee(t){let e=[];for(;t.length;)if(t.match(lH))t=t.replace(lH,"");else if(t.match(uH))t=t.replace(uH,"/");else if(t.match(dH))t=t.replace(dH,"/"),e.pop();else if(t==="."||t==="..")t="";else{let r=t.match(See);if(r){let n=r[0];t=t.slice(n.length),e.push(n)}else throw new Error("Unexpected dot segment condition")}return e.join("")}function _ee(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function Aee(t,e){let r=[];if(t.userinfo!==void 0&&(r.push(t.userinfo),r.push("@")),t.host!==void 0){let n=unescape(t.host),s=fH(n);if(s.isIPV4)n=s.host;else{let i=gH(s.host,{isIPV4:!1});i.isIPV6===!0?n=`[${i.escapedHost}]`:n=t.host}r.push(n)}return(typeof t.port=="number"||typeof t.port=="string")&&(r.push(":"),r.push(String(t.port))),r.length?r.join(""):void 0}hH.exports={recomposeAuthority:Aee,normalizeComponentEncoding:_ee,removeDotSegments:vee,normalizeIPv4:fH,normalizeIPv6:gH,stringToHexStripped:PC}});var vH=h((XGe,SH)=>{"use strict";var Ree=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,Eee=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function yH(t){return typeof t.secure=="boolean"?t.secure:String(t.scheme).toLowerCase()==="wss"}function IH(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function bH(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function wee(t){return t.secure=yH(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function Bee(t){if((t.port===(yH(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function Tee(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(Eee);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let s=`${n}:${e.nid||t.nid}`,i=kC[s];t.path=void 0,i&&(t=i.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function Gee(t,e){let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,i=kC[s];i&&(t=i.serialize(t,e));let o=t,a=t.nss;return o.path=`${n||e.nid}:${a}`,e.skipEscape=!0,o}function Zee(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!Ree.test(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Nee(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var CH={scheme:"http",domainHost:!0,parse:IH,serialize:bH},Vee={scheme:"https",domainHost:CH.domainHost,parse:IH,serialize:bH},fg={scheme:"ws",domainHost:!0,parse:wee,serialize:Bee},Hee={scheme:"wss",domainHost:fg.domainHost,parse:fg.parse,serialize:fg.serialize},Wee={scheme:"urn",parse:Tee,serialize:Gee,skipNormalize:!0},Oee={scheme:"urn:uuid",parse:Zee,serialize:Nee,skipNormalize:!0},kC={http:CH,https:Vee,ws:fg,wss:Hee,urn:Wee,"urn:uuid":Oee};SH.exports=kC});var xC=h(($Ge,pg)=>{"use strict";var Pee=require("node:url"),{normalizeIPv6:kee,normalizeIPv4:Fee,removeDotSegments:Nl,recomposeAuthority:xee,normalizeComponentEncoding:gg}=mH(),_H=vH();function Lee(t,e){return typeof t=="string"?t=wn(us(t,e),e):typeof t=="object"&&(t=us(wn(t,e),e)),t}function Uee(t,e,r){let n=Object.assign({scheme:"null"},r),s=AH(us(t,n),us(e,n),n,!0);return wn(s,{...n,skipEscape:!0})}function AH(t,e,r,n){let s={};return n||(t=us(wn(t,r),r),e=us(wn(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=Nl(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=Nl(e.path||""),s.query=e.query):(e.path?(e.path.charAt(0)==="/"?s.path=Nl(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=Nl(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function Yee(t,e,r){return typeof t=="string"?(t=unescape(t),t=wn(gg(us(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=wn(gg(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=wn(gg(us(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=wn(gg(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function wn(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],i=_H[(n.scheme||r.scheme||"").toLowerCase()];i&&i.serialize&&i.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&(s.push(r.scheme),s.push(":"));let o=xee(r,n);if(o!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(o),r.path&&r.path.charAt(0)!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!i||!i.absolutePath)&&(a=Nl(a)),o===void 0&&(a=a.replace(/^\/\//u,"/%2F")),s.push(a)}return r.query!==void 0&&(s.push("?"),s.push(r.query)),r.fragment!==void 0&&(s.push("#"),s.push(r.fragment)),s.join("")}var Dee=Array.from({length:127},(t,e)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(e)));function Xee(t){let e=0;for(let r=0,n=t.length;r<n;++r)if(e=t.charCodeAt(r),e>126||Dee[e])return!0;return!1}var $ee=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function us(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=t.indexOf("%")!==-1;r.reference==="suffix"&&(t=(r.scheme?r.scheme+":":"")+"//"+t);let i=t.match($ee);if(i){if(n.scheme=i[1],n.userinfo=i[3],n.host=i[4],n.port=parseInt(i[5],10),n.path=i[6]||"",n.query=i[7],n.fragment=i[8],isNaN(n.port)&&(n.port=i[5]),n.host){let a=Fee(n.host);a.isIPV4===!1?n.host=kee(a.host,{isIPV4:!1}).host.toLowerCase():n.host=a.host}n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&!n.path&&n.query===void 0?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let o=_H[(r.scheme||n.scheme||"").toLowerCase()];if(!r.unicodeSupport&&(!o||!o.unicodeSupport)&&n.host&&(r.domainHost||o&&o.domainHost)&&Xee(n.host))try{n.host=Pee.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!o||o&&!o.skipNormalize)&&(s&&n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),s&&n.userinfo!==void 0&&(n.userinfo=unescape(n.userinfo)),s&&n.host!==void 0&&(n.host=unescape(n.host)),n.path!==void 0&&n.path.length&&(n.path=encodeURI(n.path)),n.fragment!==void 0&&n.fragment.length&&(n.fragment=encodeURI(decodeURI(n.fragment)))),o&&o.parse&&o.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var FC={normalize:Lee,resolve:Uee,resolveComponents:AH,equal:Yee,serialize:wn,parse:us};pg.exports=FC;pg.exports.default=FC;pg.exports.fastUri=FC});var hg=h(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.formatNames=Bn.fastFormats=Bn.fullFormats=void 0;function _a(t,e){return{validate:t,compare:e}}Bn.fullFormats={date:_a(wH,YC),time:_a(BH,DC),"date-time":_a(Kee,TH),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Qee,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:ote,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:ete,int32:{type:"number",validate:nte},int64:{type:"number",validate:ste},float:{type:"number",validate:EH},double:{type:"number",validate:EH},password:!0,binary:!0};Bn.fastFormats={...Bn.fullFormats,date:_a(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,YC),time:_a(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,DC),"date-time":_a(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,TH),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};Bn.formatNames=Object.keys(Bn.fullFormats);function jee(t){return t%4===0&&(t%100!==0||t%400===0)}var qee=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Mee=[0,31,28,31,30,31,30,31,31,30,31,30,31];function wH(t){let e=qee.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(n===2&&jee(r)?29:Mee[n])}function YC(t,e){if(t&&e)return t>e?1:t<e?-1:0}var LC=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function BH(t,e){let r=LC.exec(t);if(!r)return!1;let n=+r[1],s=+r[2],i=+r[3],o=r[5];return(n<=23&&s<=59&&i<=59||n===23&&s===59&&i===60)&&(!e||o!=="")}function DC(t,e){if(!(t&&e))return;let r=LC.exec(t),n=LC.exec(e);if(r&&n)return t=r[1]+r[2]+r[3]+(r[4]||""),e=n[1]+n[2]+n[3]+(n[4]||""),t>e?1:t<e?-1:0}var UC=/t|\s/i;function Kee(t){let e=t.split(UC);return e.length===2&&wH(e[0])&&BH(e[1],!0)}function TH(t,e){if(!(t&&e))return;let[r,n]=t.split(UC),[s,i]=e.split(UC),o=YC(r,s);if(o!==void 0)return o||DC(n,i)}var zee=/\/|:/,Jee=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Qee(t){return zee.test(t)&&Jee.test(t)}var RH=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function ete(t){return RH.lastIndex=0,RH.test(t)}var tte=-(2**31),rte=2**31-1;function nte(t){return Number.isInteger(t)&&t<=rte&&t>=tte}function ste(t){return Number.isInteger(t)}function EH(){return!0}var ite=/[^\\]\\Z/;function ote(t){if(ite.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var GH=h(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.formatLimitDefinition=void 0;var ate=dg(),ln=ne(),oi=ln.operators,mg={formatMaximum:{okStr:"<=",ok:oi.LTE,fail:oi.GT},formatMinimum:{okStr:">=",ok:oi.GTE,fail:oi.LT},formatExclusiveMaximum:{okStr:"<",ok:oi.LT,fail:oi.GTE},formatExclusiveMinimum:{okStr:">",ok:oi.GT,fail:oi.LTE}},cte={message:({keyword:t,schemaCode:e})=>ln.str`should be ${mg[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>ln._`{comparison: ${mg[t].okStr}, limit: ${e}}`};Aa.formatLimitDefinition={keyword:Object.keys(mg),type:"string",schemaType:"string",$data:!0,error:cte,code(t){let{gen:e,data:r,schemaCode:n,keyword:s,it:i}=t,{opts:o,self:a}=i;if(!o.validateFormats)return;let c=new ate.KeywordCxt(i,a.RULES.all.format.definition,"format");c.$data?l():u();function l(){let f=e.scopeValue("formats",{ref:a.formats,code:o.code.formats}),g=e.const("fmt",ln._`${f}[${c.schemaCode}]`);t.fail$data(ln.or(ln._`typeof ${g} != "object"`,ln._`${g} instanceof RegExp`,ln._`typeof ${g}.compare != "function"`,d(g)))}function u(){let f=c.schema,g=a.formats[f];if(!g||g===!0)return;if(typeof g!="object"||g instanceof RegExp||typeof g.compare!="function")throw new Error(`"${s}": format "${f}" does not define "compare" function`);let p=e.scopeValue("formats",{key:f,ref:g,code:o.code.formats?ln._`${o.code.formats}${ln.getProperty(f)}`:void 0});t.fail$data(d(p))}function d(f){return ln._`${f}.compare(${r}, ${n}) ${mg[s].fail} 0`}},dependencies:["format"]};var lte=t=>(t.addKeyword(Aa.formatLimitDefinition),t);Aa.default=lte});var jC=h((Vl,VH)=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});var Ra=hg(),ute=GH(),XC=ne(),ZH=new XC.Name("fullFormats"),dte=new XC.Name("fastFormats"),$C=(t,e={keywords:!0})=>{if(Array.isArray(e))return NH(t,e,Ra.fullFormats,ZH),t;let[r,n]=e.mode==="fast"?[Ra.fastFormats,dte]:[Ra.fullFormats,ZH],s=e.formats||Ra.formatNames;return NH(t,s,r,n),e.keywords&&ute.default(t),t};$C.get=(t,e="full")=>{let n=(e==="fast"?Ra.fastFormats:Ra.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function NH(t,e,r,n){var s,i;(s=(i=t.opts.code).formats)!==null&&s!==void 0||(i.formats=XC._`require("ajv-formats/dist/formats").${n}`);for(let o of e)t.addFormat(o,r[o])}VH.exports=Vl=$C;Object.defineProperty(Vl,"__esModule",{value:!0});Vl.default=$C});var MC=h((MGe,HH)=>{"use strict";var fte=dg(),gte=xC(),pte=jC(),hte=rl()({proto:!0}),qC=class t{constructor(e){this.ajv=new fte({...e,strictSchema:!1,validateSchema:!1,allowUnionTypes:!0,uriResolver:gte}),pte(this.ajv),this.ajv.addKeyword({keyword:"fjs_type",type:"object",errors:!1,validate:(r,n)=>n instanceof Date}),this._ajvSchemas={},this._ajvOptions=e||{}}addSchema(e,r){let n=e.$id||r;if(e.$id!==void 0&&e.$id[0]==="#"&&(n=r+e.$id),this.ajv.refs[n]===void 0&&this.ajv.schemas[n]===void 0){let s=hte(e);this.convertSchemaToAjvFormat(s),this.ajv.addSchema(s,n),this._ajvSchemas[n]=e}}validate(e,r){return this.ajv.validate(e,r)}convertSchemaToAjvFormat(e){if(e!==null){e.type==="string"?(e.fjs_type="string",e.type=["string","object"]):Array.isArray(e.type)&&e.type.includes("string")&&!e.type.includes("object")&&(e.fjs_type="string",e.type.push("object"));for(let r in e)typeof e[r]=="object"&&this.convertSchemaToAjvFormat(e[r])}}getState(){return{ajvOptions:this._ajvOptions,ajvSchemas:this._ajvSchemas}}static restoreFromState(e){let r=new t(e.ajvOptions);for(let[n,s]of Object.entries(e.ajvSchemas))r.ajv.addSchema(s,n);return r}};HH.exports=qC});var zC=h((KGe,KC)=>{"use strict";function mte(t,e,r,n){let s="";return e.validatorSchemasIds.size>0?(s+=`const validatorState = ${JSON.stringify(n.getState())}
`,s+=`const validator = Validator.restoreFromState(validatorState)
`):s+=`const validator = null
`,`
  'use strict'
  const { dependencies } = require('fast-json-stringify/lib/standalone')

  const { Serializer, Validator } = dependencies

  const serializerState = ${JSON.stringify(r.getState())}
  const serializer = Serializer.restoreFromState(serializerState)

  ${s}

  module.exports = ${t.toString()}(validator, serializer)`}KC.exports=mte;KC.exports.dependencies={Serializer:nb(),Validator:MC()}});var OH=h((JGe,WH)=>{"use strict";var{dependencies:yte}=zC(),{Serializer:Ite,Validator:zGe}=yte,bte={mode:"standalone"},Cte=Ite.restoreFromState(bte),Ste=null;WH.exports=function(e,r){function n(i){let o=i&&typeof i.toJSON=="function"?i.toJSON():i,a=!1,c="{";return o.statusCode!==void 0&&(!a&&(a=!0)||(c+=","),c+='"statusCode":',c+=r.asNumber(o.statusCode)),o.code!==void 0&&(!a&&(a=!0)||(c+=","),c+='"code":',c+=r.asString(o.code)),o.error!==void 0&&(!a&&(a=!0)||(c+=","),c+='"error":',c+=r.asString(o.error)),o.message!==void 0&&(!a&&(a=!0)||(c+=","),c+='"message":',c+=r.asString(o.message)),c+"}"}return n}(Ste,Cte)});var Hl=h((QGe,xH)=>{"use strict";var PH=require("node:http").STATUS_CODES,vte=rI(),{kReplyHeaders:Ea,kReplyNextErrorHandler:yg,kReplyIsRunningOnErrorHook:_te,kReplyHasStatusCode:Ate,kRouteContext:FH}=Tt(),{FST_ERR_REP_INVALID_PAYLOAD_TYPE:Rte,FST_ERR_FAILED_ERROR_SERIALIZATION:Ete}=Yt(),{getSchemaSerializer:wte}=nl(),JC=OH(),Bte={func:Gte,toJSON(){return this.func.name.toString()+"()"}};function Tte(t,e,r){t[_te]=!1;let n=t[FH];if(t[yg]===!1){kH(e,t,function(a,c){try{a.raw.writeHead(a.raw.statusCode,a[Ea])}catch(l){a.log.warn({req:a.request,res:a,err:l},l&&l.message),a.raw.writeHead(a.raw.statusCode)}a.raw.end(c)});return}let s=t[yg]||n.errorHandler;t[yg]=Object.getPrototypeOf(s),delete t[Ea]["content-type"],delete t[Ea]["content-length"];let i=s.func;if(!i){t[yg]=!1,kH(e,t,r);return}let o=i(e,t.request,t);o!==void 0&&(o!==null&&typeof o.then=="function"?vte(o,t):t.send(o))}function Gte(t,e,r){if(Nte(t,r),!r[Ate]||r.statusCode===200){let n=t.statusCode||t.status;r.code(n>=400?n:500)}r.statusCode<500?r.log.info({res:r,err:t},t&&t.message):r.log.error({req:e,res:r,err:t},t&&t.message),r.send(t)}function kH(t,e,r){let n=e.raw,s=e.statusCode,i;try{let o=wte(e[FH],s,e[Ea]["content-type"]);i=o===!1?JC({error:PH[s+""],code:t.code,message:t.message,statusCode:s}):o(Object.create(t,{error:{value:PH[s+""]},message:{value:t.message},statusCode:{value:s}}))}catch(o){e.log.error({err:o,statusCode:n.statusCode},"The serializer for the given status code failed"),e.code(500),i=JC(new Ete(o.message,t.message))}typeof i!="string"&&!Buffer.isBuffer(i)&&(i=JC(new Rte(typeof i))),e[Ea]["content-type"]="application/json; charset=utf-8",e[Ea]["content-length"]=""+Buffer.byteLength(i),r(e,i)}function Zte(t=Bte,e){if(!e)return t;let r=Object.create(t);return r.func=e,r}function Nte(t,e){let r=e.raw,n=r.statusCode;n=n>=400?n:500,t!=null&&(t.headers!==void 0&&e.headers(t.headers),t.status>=400?n=t.status:t.statusCode>=400&&(n=t.statusCode)),r.statusCode=n}xH.exports={buildErrorHandler:Zte,handleError:Tte}});var _g=h((eZe,vg)=>{"use strict";var r0=require("node:stream").finished,{kFourOhFourContext:LH,kPublicRouteContext:UH,kReplyErrorHandlerCalled:MH,kReplyHijacked:Wl,kReplyStartTime:Ol,kReplyEndTime:s0,kReplySerializer:ds,kReplySerializerDefault:bg,kReplyIsError:Cg,kReplyHeaders:Xe,kReplyTrailers:Gt,kReplyHasStatusCode:i0,kReplyIsRunningOnErrorHook:o0,kReplyNextErrorHandler:Vte,kDisableRequestLogging:KH,kSchemaResponse:Sg,kReplyCacheSerializeFns:ai,kSchemaController:QC,kOptions:Hte,kRouteContext:Ie}=Tt(),{onSendHookRunner:zH,onResponseHookRunner:Wte,preHandlerHookRunner:Ote,preSerializationHookRunner:Pte}=js(),YH=oI()[Symbol.for("internals")],kte=tl(),n0=kte.now,{handleError:DH}=Hl(),{getSchemaSerializer:Fte}=nl(),e0={JSON:"application/json; charset=utf-8",PLAIN:"text/plain; charset=utf-8",OCTET:"application/octet-stream"},{FST_ERR_REP_INVALID_PAYLOAD_TYPE:xte,FST_ERR_REP_ALREADY_SENT:JH,FST_ERR_REP_SENT_VALUE:Lte,FST_ERR_SEND_INSIDE_ONERR:Ute,FST_ERR_BAD_STATUS_CODE:Yte,FST_ERR_BAD_TRAILER_NAME:Dte,FST_ERR_BAD_TRAILER_VALUE:Xte,FST_ERR_MISSING_SERIALIZATION_FN:$te,FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:jte}=Yt(),{FSTDEP010:qte,FSTDEP013:Mte,FSTDEP019:Kte}=is();function Ye(t,e,r){this.raw=t,this[ds]=null,this[MH]=!1,this[Cg]=!1,this[o0]=!1,this.request=e,this[Xe]={},this[Gt]=null,this[i0]=!1,this[Ol]=void 0,this.log=r}Ye.props=[];Object.defineProperties(Ye.prototype,{[Ie]:{get(){return this.request[Ie]}},context:{get(){return Kte(),this.request[Ie]}},server:{get(){return this.request[Ie].server}},sent:{enumerable:!0,get(){return(this[Wl]||this.raw.writableEnded)===!0},set(t){if(qte(),t!==!0)throw new Lte;if(this.sent&&this[Wl])throw new JH(this.request.url,this.request.method);this[Wl]=!0}},statusCode:{get(){return this.raw.statusCode},set(t){this.code(t)}},[UH]:{get(){return this.request[UH]}}});Ye.prototype.hijack=function(){return this[Wl]=!0,this};Ye.prototype.send=function(t){if(this[o0]===!0)throw new Ute;if(this.sent)return this.log.warn({err:new JH(this.request.url,this.request.method)}),this;if(t instanceof Error||this[Cg]===!0)return this[Cg]=!1,Pl(this,t,co),this;if(t===void 0)return co(this,t),this;let e=this.getHeader("content-type"),r=e!==void 0;if(t!==null){if(typeof t.pipe=="function")return co(this,t),this;if(t?.buffer instanceof ArrayBuffer){r===!1&&(this[Xe]["content-type"]=e0.OCTET);let n=Buffer.isBuffer(t)?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength);return co(this,n),this}if(r===!1&&typeof t=="string")return this[Xe]["content-type"]=e0.PLAIN,co(this,t),this}if(this[ds]!==null){if(typeof t!="string")return XH(this,t),this;t=this[ds](t)}else if(r===!1||e.indexOf("json")>-1){if(r===!1)this[Xe]["content-type"]=e0.JSON;else if(e.indexOf("charset")===-1){let n=e.trim();n.endsWith(";")?this[Xe]["content-type"]=`${n} charset=utf-8`:this[Xe]["content-type"]=`${n}; charset=utf-8`}if(typeof t!="string")return XH(this,t),this}return co(this,t),this};Ye.prototype.getHeader=function(t){t=t.toLowerCase();let e=this.raw,r=this[Xe][t];return r===void 0&&e.hasHeader(t)&&(r=e.getHeader(t)),r};Ye.prototype.getHeaders=function(){return{...this.raw.getHeaders(),...this[Xe]}};Ye.prototype.hasHeader=function(t){return t=t.toLowerCase(),this[Xe][t]!==void 0||this.raw.hasHeader(t)};Ye.prototype.removeHeader=function(t){return delete this[Xe][t.toLowerCase()],this};Ye.prototype.header=function(t,e=""){return t=t.toLowerCase(),this[Xe][t]&&t==="set-cookie"?(typeof this[Xe][t]=="string"&&(this[Xe][t]=[this[Xe][t]]),Array.isArray(e)?Array.prototype.push.apply(this[Xe][t],e):this[Xe][t].push(e)):this[Xe][t]=e,this};Ye.prototype.headers=function(t){let e=Object.keys(t);for(var r=0;r!==e.length;++r){let n=e[r];this.header(n,t[n])}return this};var zte=new Set(["transfer-encoding","content-length","host","cache-control","max-forwards","te","authorization","set-cookie","content-encoding","content-type","content-range","trailer"]);Ye.prototype.trailer=function(t,e){if(t=t.toLowerCase(),zte.has(t))throw new Dte(t);if(typeof e!="function")throw new Xte(t,typeof e);return this[Gt]===null&&(this[Gt]={}),this[Gt][t]=e,this};Ye.prototype.hasTrailer=function(t){return this[Gt]?.[t.toLowerCase()]!==void 0};Ye.prototype.removeTrailer=function(t){return this[Gt]===null?this:(this[Gt][t.toLowerCase()]=void 0,this)};Ye.prototype.code=function(t){let e=Number(t);if(isNaN(e)||e<100||e>599)throw new Yte(t||String(t));return this.raw.statusCode=e,this[i0]=!0,this};Ye.prototype.status=Ye.prototype.code;Ye.prototype.getSerializationFunction=function(t,e){let r;return typeof t=="string"||typeof t=="number"?typeof e=="string"?r=this[Ie][Sg]?.[t]?.[e]:r=this[Ie][Sg]?.[t]:typeof t=="object"&&(r=this[Ie][ai]?.get(t)),r};Ye.prototype.compileSerializationSchema=function(t,e=null,r=null){let{request:n}=this,{method:s,url:i}=n;if(this[Ie][ai]?.has(t))return this[Ie][ai].get(t);let a=(this[Ie].serializerCompiler||this.server[QC].serializerCompiler||this.server[QC].setupSerializer(this.server[Hte])||this.server[QC].serializerCompiler)({schema:t,method:s,url:i,httpStatus:e,contentType:r});return this[Ie][ai]==null&&(this[Ie][ai]=new WeakMap),this[Ie][ai].set(t,a),a};Ye.prototype.serializeInput=function(t,e,r,n){let s=r,i;if(r=typeof e=="string"||typeof e=="number"?e:r,n=r&&s!==r?s:n,r!=null){if(n!=null?i=this[Ie][Sg]?.[r]?.[n]:i=this[Ie][Sg]?.[r],i==null)throw n?new jte(r,n):new $te(r)}else this[Ie][ai]?.has(e)?i=this[Ie][ai].get(e):i=this.compileSerializationSchema(e,r,n);return i(t)};Ye.prototype.serialize=function(t){return this[ds]!==null?this[ds](t):this[Ie]&&this[Ie][bg]?this[Ie][bg](t,this.raw.statusCode):eW(this[Ie],t,this.raw.statusCode)};Ye.prototype.serializer=function(t){return this[ds]=t,this};Ye.prototype.type=function(t){return this[Xe]["content-type"]=t,this};Ye.prototype.redirect=function(t,e){return typeof t=="string"&&(e=t,t=this[i0]?this.raw.statusCode:302),this.header("location",e).code(t).send()};Ye.prototype.callNotFound=function(){return sre(this),this};Ye.prototype.getResponseTime=function(){let t=0;return this[Ol]!==void 0&&(t=(this[s0]||n0())-this[Ol]),t};Ye.prototype.then=function(t,e){if(this.sent){t();return}r0(this.raw,r=>{r&&r.code!=="ERR_STREAM_PREMATURE_CLOSE"?e?e(r):this.log&&this.log.warn("unhandled rejection on reply.then"):t()})};function XH(t,e){t[Ie].preSerialization!==null?Pte(t[Ie].preSerialization,t.request,t,e,$H):$H(null,t.request,t,e)}function $H(t,e,r,n){if(t!=null){Pl(r,t);return}try{r[ds]!==null?n=r[ds](n):r[Ie]&&r[Ie][bg]?n=r[Ie][bg](n,r.raw.statusCode):n=eW(r[Ie],n,r.raw.statusCode,r[Xe]["content-type"])}catch(s){Jte(s,r),Pl(r,s);return}co(r,n)}function Jte(t,e){t.serialization=e[Ie].config}function co(t,e){t[Ie].onSend!==null?zH(t[Ie].onSend,t.request,t,e,Qte):QH(t,e)}function Qte(t,e,r,n){t!=null?Pl(r,t):QH(r,n)}function t0(t,e){let r=t.raw;try{r.writeHead(e,t[Xe])}catch(n){throw n.code==="ERR_HTTP_HEADERS_SENT"&&t.log.warn(`Reply was already sent, did you forget to "return reply" in the "${t.request.raw.url}" (${t.request.raw.method}) route?`),n}}function QH(t,e){let r=t.raw,n=t.request,s=r.statusCode;if(t[Gt]!==null){let i=Object.keys(t[Gt]),o="";for(let a of i)typeof t[Gt][a]=="function"&&(o+=" ",o+=a);t.header("Transfer-Encoding","chunked"),t.header("Trailer",o.trim())}if(e==null){s>=200&&s!==204&&s!==304&&n.method!=="HEAD"&&t[Gt]===null&&(t[Xe]["content-length"]="0"),t0(t,s),Ig(e,r,t);return}if(s>=100&&s<200||s===204){t.removeHeader("content-type"),t.removeHeader("content-length"),t0(t,s),Ig(void 0,r,t),typeof e.resume=="function"&&(e.on("error",tW),e.resume());return}if(typeof e.pipe=="function"){ere(e,r,t);return}if(typeof e!="string"&&!Buffer.isBuffer(e))throw new xte(typeof e);if(t[Gt]===null){let i=t[Xe]["content-length"];(!i||n.raw.method!=="HEAD"&&Number(i)!==Buffer.byteLength(e))&&(t[Xe]["content-length"]=""+Buffer.byteLength(e))}t0(t,s),r.write(e),Ig(e,r,t)}function jH(t,e,r){e.code==="ERR_STREAM_PREMATURE_CLOSE"?t[KH]||t.info({res:r},"stream closed prematurely"):t.warn({err:e},"response terminated with an error with headers already sent")}function ere(t,e,r){let n=!0,s=!1;if(tre(t,e,r),r0(t,{readable:!0,writable:!1},function(i){n=!1,i!=null&&(e.headersSent||r.request.raw.aborted===!0?(s||(s=!0,jH(r.log,i,e)),e.destroy()):Pl(r,i))}),r0(e,function(i){n&&(i!=null&&e.headersSent&&!s&&(s=!0,jH(r.log,i,e)),typeof t.destroy=="function"?t.destroy():typeof t.close=="function"?t.close(tW):typeof t.abort=="function"?t.abort():r.log.warn("stream payload does not end properly"))}),e.headersSent)r.log.warn("response will send, but you shouldn't use res.writeHead in stream mode");else for(let i in r[Xe])e.setHeader(i,r[Xe][i]);t.pipe(e)}function Ig(t,e,r){if(r[Gt]===null){e.end(null,null,null);return}let n=Object.keys(r[Gt]),s={},i=0,o=!0;function a(){i===0&&(e.addTrailers(s),e.end(null,null,null))}for(let c of n){let l=function(d,f){i++,d?r.log.debug(d):s[c]=f,process.nextTick(a)};if(typeof r[Gt][c]!="function")continue;o=!1,i--;let u=r[Gt][c](r,t,l);typeof u=="object"&&typeof u.then=="function"?u.then(d=>l(null,d),l):u!=null&&(Mte(),l(null,u))}o&&e.end(null,null,null)}function tre(t,e,r){r[Gt]!==null&&t.on("end",()=>Ig(null,e,r))}function Pl(t,e,r){t[Ie].onError!==null&&!t[Vte]?(t[o0]=!0,zH(t[Ie].onError,t.request,t,e,()=>DH(t,e,r))):DH(t,e,r)}function rre(t){t[Ol]=n0();let e=r=>{t[s0]=n0(),t.raw.removeListener("finish",e),t.raw.removeListener("error",e);let n=t[Ie];n&&n.onResponse!==null?Wte(n.onResponse,t.request,t,qH):qH(r,t.request,t)};t.raw.on("finish",e),t.raw.on("error",e)}function qH(t,e,r){if(r.log[KH])return;let n=r.getResponseTime();if(t!=null){r.log.error({res:r,err:t,responseTime:n},"request errored");return}r.log.info({res:r,responseTime:n},"request completed")}function nre(t){let e=t.props.slice();function r(n,s,i){this.raw=n,this[Cg]=!1,this[MH]=!1,this[Wl]=!1,this[ds]=null,this.request=s,this[Xe]={},this[Gt]=null,this[Ol]=void 0,this[s0]=void 0,this.log=i;for(var o,a=0;a<e.length;a++)o=e[a],this[o.key]=o.value}return Object.setPrototypeOf(r.prototype,t.prototype),Object.setPrototypeOf(r,t),r.parent=t,r.props=e,r}function sre(t){if(t[Ie][LH]===null){t.log.warn("Trying to send a NotFound error inside a 404 handler. Sending basic 404 response."),t.code(404).send("404 Not Found");return}t.request[Ie]=t[Ie][LH],t[Ie].preHandler!==null?Ote(t[Ie].preHandler,t.request,t,YH.preHandlerCallback):YH.preHandlerCallback(null,t.request,t)}function eW(t,e,r,n){let s=Fte(t,r,n);return s?s(e):JSON.stringify(e)}function tW(){}vg.exports=Ye;vg.exports.buildReply=nre;vg.exports.setupResponseListeners=rre});var nW=h((tZe,rW)=>{"use strict";rW.exports=ire;function ire(t){if(!t)throw new TypeError("argument req is required");var e=are(t.headers["x-forwarded-for"]||""),r=ore(t),n=[r].concat(e);return n}function ore(t){return t.socket?t.socket.remoteAddress:t.connection.remoteAddress}function are(t){for(var e=t.length,r=[],n=t.length,s=t.length-1;s>=0;s--)switch(t.charCodeAt(s)){case 32:n===e&&(n=e=s);break;case 44:n!==e&&r.push(t.substring(n,e)),n=e=s;break;default:n=s;break}return n!==e&&r.push(t.substring(n,e)),r}});var iW=h((sW,kl)=>{(function(){var t,e,r,n,s,i,o,a,c;e={},a=this,typeof kl<"u"&&kl!==null&&kl.exports?kl.exports=e:a.ipaddr=e,o=function(l,u,d,f){var g,p;if(l.length!==u.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(g=0;f>0;){if(p=d-f,p<0&&(p=0),l[g]>>p!==u[g]>>p)return!1;f-=d,g+=1}return!0},e.subnetMatch=function(l,u,d){var f,g,p,m,I;d==null&&(d="unicast");for(p in u)for(m=u[p],m[0]&&!(m[0]instanceof Array)&&(m=[m]),f=0,g=m.length;f<g;f++)if(I=m[f],l.kind()===I[0].kind()&&l.match.apply(l,I))return p;return d},e.IPv4=function(){function l(u){var d,f,g;if(u.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");for(d=0,f=u.length;d<f;d++)if(g=u[d],!(0<=g&&g<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=u}return l.prototype.kind=function(){return"ipv4"},l.prototype.toString=function(){return this.octets.join(".")},l.prototype.toNormalizedString=function(){return this.toString()},l.prototype.toByteArray=function(){return this.octets.slice(0)},l.prototype.match=function(u,d){var f;if(d===void 0&&(f=u,u=f[0],d=f[1]),u.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return o(this.octets,u.octets,8,d)},l.prototype.SpecialRanges={unspecified:[[new l([0,0,0,0]),8]],broadcast:[[new l([255,255,255,255]),32]],multicast:[[new l([224,0,0,0]),4]],linkLocal:[[new l([169,254,0,0]),16]],loopback:[[new l([127,0,0,0]),8]],carrierGradeNat:[[new l([100,64,0,0]),10]],private:[[new l([10,0,0,0]),8],[new l([172,16,0,0]),12],[new l([192,168,0,0]),16]],reserved:[[new l([192,0,0,0]),24],[new l([192,0,2,0]),24],[new l([192,88,99,0]),24],[new l([198,51,100,0]),24],[new l([203,0,113,0]),24],[new l([240,0,0,0]),4]]},l.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},l.prototype.toIPv4MappedAddress=function(){return e.IPv6.parse("::ffff:"+this.toString())},l.prototype.prefixLengthFromSubnetMask=function(){var u,d,f,g,p,m,I;for(I={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},u=0,p=!1,d=f=3;f>=0;d=f+=-1)if(g=this.octets[d],g in I){if(m=I[g],p&&m!==0)return null;m!==8&&(p=!0),u+=m}else return null;return 32-u},l}(),r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp("^"+r+"\\."+r+"\\."+r+"\\."+r+"$","i"),longValue:new RegExp("^"+r+"$","i")},e.IPv4.parser=function(l){var u,d,f,g,p;if(d=function(m){return m[0]==="0"&&m[1]!=="x"?parseInt(m,8):parseInt(m)},u=l.match(n.fourOctet))return function(){var m,I,C,S;for(C=u.slice(1,6),S=[],m=0,I=C.length;m<I;m++)f=C[m],S.push(d(f));return S}();if(u=l.match(n.longValue)){if(p=d(u[1]),p>4294967295||p<0)throw new Error("ipaddr: address outside defined range");return function(){var m,I;for(I=[],g=m=0;m<=24;g=m+=8)I.push(p>>g&255);return I}().reverse()}else return null},e.IPv6=function(){function l(u,d){var f,g,p,m,I,C;if(u.length===16)for(this.parts=[],f=g=0;g<=14;f=g+=2)this.parts.push(u[f]<<8|u[f+1]);else if(u.length===8)this.parts=u;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(C=this.parts,p=0,m=C.length;p<m;p++)if(I=C[p],!(0<=I&&I<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");d&&(this.zoneId=d)}return l.prototype.kind=function(){return"ipv6"},l.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},l.prototype.toRFC5952String=function(){var u,d,f,g,p;for(g=/((^|:)(0(:|$)){2,})/g,p=this.toNormalizedString(),u=0,d=-1;f=g.exec(p);)f[0].length>d&&(u=f.index,d=f[0].length);return d<0?p:p.substring(0,u)+"::"+p.substring(u+d)},l.prototype.toByteArray=function(){var u,d,f,g,p;for(u=[],p=this.parts,d=0,f=p.length;d<f;d++)g=p[d],u.push(g>>8),u.push(g&255);return u},l.prototype.toNormalizedString=function(){var u,d,f;return u=function(){var g,p,m,I;for(m=this.parts,I=[],g=0,p=m.length;g<p;g++)d=m[g],I.push(d.toString(16));return I}.call(this).join(":"),f="",this.zoneId&&(f="%"+this.zoneId),u+f},l.prototype.toFixedLengthString=function(){var u,d,f;return u=function(){var g,p,m,I;for(m=this.parts,I=[],g=0,p=m.length;g<p;g++)d=m[g],I.push(d.toString(16).padStart(4,"0"));return I}.call(this).join(":"),f="",this.zoneId&&(f="%"+this.zoneId),u+f},l.prototype.match=function(u,d){var f;if(d===void 0&&(f=u,u=f[0],d=f[1]),u.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return o(this.parts,u.parts,16,d)},l.prototype.SpecialRanges={unspecified:[new l([0,0,0,0,0,0,0,0]),128],linkLocal:[new l([65152,0,0,0,0,0,0,0]),10],multicast:[new l([65280,0,0,0,0,0,0,0]),8],loopback:[new l([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new l([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new l([0,0,0,0,0,65535,0,0]),96],rfc6145:[new l([0,0,0,0,65535,0,0,0]),96],rfc6052:[new l([100,65435,0,0,0,0,0,0]),96],"6to4":[new l([8194,0,0,0,0,0,0,0]),16],teredo:[new l([8193,0,0,0,0,0,0,0]),32],reserved:[[new l([8193,3512,0,0,0,0,0,0]),32]]},l.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},l.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},l.prototype.toIPv4Address=function(){var u,d,f;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return f=this.parts.slice(-2),u=f[0],d=f[1],new e.IPv4([u>>8,u&255,d>>8,d&255])},l.prototype.prefixLengthFromSubnetMask=function(){var u,d,f,g,p,m,I;for(I={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},u=0,p=!1,d=f=7;f>=0;d=f+=-1)if(g=this.parts[d],g in I){if(m=I[g],p&&m!==0)return null;m!==16&&(p=!0),u+=m}else return null;return 128-u},l}(),s="(?:[0-9a-f]+::?)+",c="%[0-9a-z]{1,}",i={zoneIndex:new RegExp(c,"i"),native:new RegExp("^(::)?("+s+")?([0-9a-f]+)?(::)?("+c+")?$","i"),transitional:new RegExp("^((?:"+s+")|(?:::)(?:"+s+")?)"+(r+"\\."+r+"\\."+r+"\\."+r)+("("+c+")?$"),"i")},t=function(l,u){var d,f,g,p,m,I;if(l.indexOf("::")!==l.lastIndexOf("::"))return null;for(I=(l.match(i.zoneIndex)||[])[0],I&&(I=I.substring(1),l=l.replace(/%.+$/,"")),d=0,f=-1;(f=l.indexOf(":",f+1))>=0;)d++;if(l.substr(0,2)==="::"&&d--,l.substr(-2,2)==="::"&&d--,d>u)return null;for(m=u-d,p=":";m--;)p+="0:";return l=l.replace("::",p),l[0]===":"&&(l=l.slice(1)),l[l.length-1]===":"&&(l=l.slice(0,-1)),u=function(){var C,S,b,y;for(b=l.split(":"),y=[],C=0,S=b.length;C<S;C++)g=b[C],y.push(parseInt(g,16));return y}(),{parts:u,zoneId:I}},e.IPv6.parser=function(l){var u,d,f,g,p,m,I;if(i.native.test(l))return t(l,8);if((g=l.match(i.transitional))&&(I=g[6]||"",u=t(g[1].slice(0,-1)+I,6),u.parts)){for(m=[parseInt(g[2]),parseInt(g[3]),parseInt(g[4]),parseInt(g[5])],d=0,f=m.length;d<f;d++)if(p=m[d],!(0<=p&&p<=255))return null;return u.parts.push(m[0]<<8|m[1]),u.parts.push(m[2]<<8|m[3]),{parts:u.parts,zoneId:u.zoneId}}return null},e.IPv4.isIPv4=e.IPv6.isIPv6=function(l){return this.parser(l)!==null},e.IPv4.isValid=function(l){var u;try{return new this(this.parser(l)),!0}catch(d){return u=d,!1}},e.IPv4.isValidFourPartDecimal=function(l){return!!(e.IPv4.isValid(l)&&l.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},e.IPv6.isValid=function(l){var u,d;if(typeof l=="string"&&l.indexOf(":")===-1)return!1;try{return u=this.parser(l),new this(u.parts,u.zoneId),!0}catch(f){return d=f,!1}},e.IPv4.parse=function(l){var u;if(u=this.parser(l),u===null)throw new Error("ipaddr: string is not formatted like ip address");return new this(u)},e.IPv6.parse=function(l){var u;if(u=this.parser(l),u.parts===null)throw new Error("ipaddr: string is not formatted like ip address");return new this(u.parts,u.zoneId)},e.IPv4.parseCIDR=function(l){var u,d,f;if((d=l.match(/^(.+)\/(\d+)$/))&&(u=parseInt(d[2]),u>=0&&u<=32))return f=[this.parse(d[1]),u],Object.defineProperty(f,"toString",{value:function(){return this.join("/")}}),f;throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},e.IPv4.subnetMaskFromPrefixLength=function(l){var u,d,f;if(l=parseInt(l),l<0||l>32)throw new Error("ipaddr: invalid IPv4 prefix length");for(f=[0,0,0,0],d=0,u=Math.floor(l/8);d<u;)f[d]=255,d++;return u<4&&(f[u]=Math.pow(2,l%8)-1<<8-l%8),new this(f)},e.IPv4.broadcastAddressFromCIDR=function(l){var u,d,f,g,p,m;try{for(u=this.parseCIDR(l),g=u[0].toByteArray(),m=this.subnetMaskFromPrefixLength(u[1]).toByteArray(),p=[],f=0;f<4;)p.push(parseInt(g[f],10)|parseInt(m[f],10)^255),f++;return new this(p)}catch(I){throw d=I,new Error("ipaddr: the address does not have IPv4 CIDR format")}},e.IPv4.networkAddressFromCIDR=function(l){var u,d,f,g,p,m;try{for(u=this.parseCIDR(l),g=u[0].toByteArray(),m=this.subnetMaskFromPrefixLength(u[1]).toByteArray(),p=[],f=0;f<4;)p.push(parseInt(g[f],10)&parseInt(m[f],10)),f++;return new this(p)}catch(I){throw d=I,new Error("ipaddr: the address does not have IPv4 CIDR format")}},e.IPv6.parseCIDR=function(l){var u,d,f;if((d=l.match(/^(.+)\/(\d+)$/))&&(u=parseInt(d[2]),u>=0&&u<=128))return f=[this.parse(d[1]),u],Object.defineProperty(f,"toString",{value:function(){return this.join("/")}}),f;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},e.isValid=function(l){return e.IPv6.isValid(l)||e.IPv4.isValid(l)},e.parse=function(l){if(e.IPv6.isValid(l))return e.IPv6.parse(l);if(e.IPv4.isValid(l))return e.IPv4.parse(l);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},e.parseCIDR=function(l){var u;try{return e.IPv6.parseCIDR(l)}catch(d){u=d;try{return e.IPv4.parseCIDR(l)}catch(f){throw u=f,new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},e.fromByteArray=function(l){var u;if(u=l.length,u===4)return new e.IPv4(l);if(u===16)return new e.IPv6(l);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},e.process=function(l){var u;return u=this.parse(l),u.kind()==="ipv6"&&u.isIPv4MappedAddress()?u.toIPv4Address():u}}).call(sW)});var uW=h((rZe,Eg)=>{"use strict";Eg.exports=pre;Eg.exports.all=cW;Eg.exports.compile=lW;var cre=nW(),aW=iW(),lre=/^[0-9]+$/,Ag=aW.isValid,Rg=aW.parse,oW={linklocal:["169.254.0.0/16","fe80::/10"],loopback:["127.0.0.1/8","::1/128"],uniquelocal:["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","fc00::/7"]};function cW(t,e){var r=cre(t);if(!e)return r;typeof e!="function"&&(e=lW(e));for(var n=0;n<r.length-1;n++)e(r[n],n)||(r.length=n+1);return r}function lW(t){if(!t)throw new TypeError("argument is required");var e;if(typeof t=="string")e=[t];else if(Array.isArray(t))e=t.slice();else throw new TypeError("unsupported trust argument");for(var r=0;r<e.length;r++)t=e[r],Object.prototype.hasOwnProperty.call(oW,t)&&(t=oW[t],e.splice.apply(e,[r,1].concat(t)),r+=t.length-1);return dre(ure(e))}function ure(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=fre(t[r]);return e}function dre(t){var e=t.length;return e===0?hre:e===1?yre(t[0]):mre(t)}function fre(t){var e=t.lastIndexOf("/"),r=e!==-1?t.substring(0,e):t;if(!Ag(r))throw new TypeError("invalid IP address: "+r);var n=Rg(r);e===-1&&n.kind()==="ipv6"&&n.isIPv4MappedAddress()&&(n=n.toIPv4Address());var s=n.kind()==="ipv6"?128:32,i=e!==-1?t.substring(e+1,t.length):null;if(i===null?i=s:lre.test(i)?i=parseInt(i,10):n.kind()==="ipv4"&&Ag(i)?i=gre(i):i=null,i<=0||i>s)throw new TypeError("invalid range on address: "+t);return[n,i]}function gre(t){var e=Rg(t),r=e.kind();return r==="ipv4"?e.prefixLengthFromSubnetMask():null}function pre(t,e){if(!t)throw new TypeError("req argument is required");if(!e)throw new TypeError("trust argument is required");var r=cW(t,e),n=r[r.length-1];return n}function hre(){return!1}function mre(t){return function(r){if(!Ag(r))return!1;for(var n=Rg(r),s,i=n.kind(),o=0;o<t.length;o++){var a=t[o],c=a[0],l=c.kind(),u=a[1],d=n;if(i!==l){if(l==="ipv4"&&!n.isIPv4MappedAddress())continue;s||(s=l==="ipv4"?n.toIPv4Address():n.toIPv4MappedAddress()),d=s}if(d.match(c,u))return!0}return!1}}function yre(t){var e=t[0],r=e.kind(),n=r==="ipv4",s=t[1];return function(o){if(!Ag(o))return!1;var a=Rg(o),c=a.kind();if(c!==r){if(n&&!a.isIPv4MappedAddress())return!1;a=n?a.toIPv4Address():a.toIPv4MappedAddress()}return a.match(e,s)}}});var Fl=h((nZe,dW)=>{var Ire="2.0.0",bre=Number.MAX_SAFE_INTEGER||9007199254740991,Cre=16,Sre=250,vre=["major","premajor","minor","preminor","patch","prepatch","prerelease"];dW.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Cre,MAX_SAFE_BUILD_LENGTH:Sre,MAX_SAFE_INTEGER:bre,RELEASE_TYPES:vre,SEMVER_SPEC_VERSION:Ire,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var xl=h((sZe,fW)=>{var _re=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};fW.exports=_re});var wa=h((fs,gW)=>{var{MAX_SAFE_COMPONENT_LENGTH:a0,MAX_SAFE_BUILD_LENGTH:Are,MAX_LENGTH:Rre}=Fl(),Ere=xl();fs=gW.exports={};var wre=fs.re=[],Bre=fs.safeRe=[],K=fs.src=[],z=fs.t={},Tre=0,c0="[a-zA-Z0-9-]",Gre=[["\\s",1],["\\d",Rre],[c0,Are]],Zre=t=>{for(let[e,r]of Gre)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},fe=(t,e,r)=>{let n=Zre(e),s=Tre++;Ere(t,s,e),z[t]=s,K[s]=e,wre[s]=new RegExp(e,r?"g":void 0),Bre[s]=new RegExp(n,r?"g":void 0)};fe("NUMERICIDENTIFIER","0|[1-9]\\d*");fe("NUMERICIDENTIFIERLOOSE","\\d+");fe("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${c0}*`);fe("MAINVERSION",`(${K[z.NUMERICIDENTIFIER]})\\.(${K[z.NUMERICIDENTIFIER]})\\.(${K[z.NUMERICIDENTIFIER]})`);fe("MAINVERSIONLOOSE",`(${K[z.NUMERICIDENTIFIERLOOSE]})\\.(${K[z.NUMERICIDENTIFIERLOOSE]})\\.(${K[z.NUMERICIDENTIFIERLOOSE]})`);fe("PRERELEASEIDENTIFIER",`(?:${K[z.NUMERICIDENTIFIER]}|${K[z.NONNUMERICIDENTIFIER]})`);fe("PRERELEASEIDENTIFIERLOOSE",`(?:${K[z.NUMERICIDENTIFIERLOOSE]}|${K[z.NONNUMERICIDENTIFIER]})`);fe("PRERELEASE",`(?:-(${K[z.PRERELEASEIDENTIFIER]}(?:\\.${K[z.PRERELEASEIDENTIFIER]})*))`);fe("PRERELEASELOOSE",`(?:-?(${K[z.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${K[z.PRERELEASEIDENTIFIERLOOSE]})*))`);fe("BUILDIDENTIFIER",`${c0}+`);fe("BUILD",`(?:\\+(${K[z.BUILDIDENTIFIER]}(?:\\.${K[z.BUILDIDENTIFIER]})*))`);fe("FULLPLAIN",`v?${K[z.MAINVERSION]}${K[z.PRERELEASE]}?${K[z.BUILD]}?`);fe("FULL",`^${K[z.FULLPLAIN]}$`);fe("LOOSEPLAIN",`[v=\\s]*${K[z.MAINVERSIONLOOSE]}${K[z.PRERELEASELOOSE]}?${K[z.BUILD]}?`);fe("LOOSE",`^${K[z.LOOSEPLAIN]}$`);fe("GTLT","((?:<|>)?=?)");fe("XRANGEIDENTIFIERLOOSE",`${K[z.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);fe("XRANGEIDENTIFIER",`${K[z.NUMERICIDENTIFIER]}|x|X|\\*`);fe("XRANGEPLAIN",`[v=\\s]*(${K[z.XRANGEIDENTIFIER]})(?:\\.(${K[z.XRANGEIDENTIFIER]})(?:\\.(${K[z.XRANGEIDENTIFIER]})(?:${K[z.PRERELEASE]})?${K[z.BUILD]}?)?)?`);fe("XRANGEPLAINLOOSE",`[v=\\s]*(${K[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${K[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${K[z.XRANGEIDENTIFIERLOOSE]})(?:${K[z.PRERELEASELOOSE]})?${K[z.BUILD]}?)?)?`);fe("XRANGE",`^${K[z.GTLT]}\\s*${K[z.XRANGEPLAIN]}$`);fe("XRANGELOOSE",`^${K[z.GTLT]}\\s*${K[z.XRANGEPLAINLOOSE]}$`);fe("COERCE",`(^|[^\\d])(\\d{1,${a0}})(?:\\.(\\d{1,${a0}}))?(?:\\.(\\d{1,${a0}}))?(?:$|[^\\d])`);fe("COERCERTL",K[z.COERCE],!0);fe("LONETILDE","(?:~>?)");fe("TILDETRIM",`(\\s*)${K[z.LONETILDE]}\\s+`,!0);fs.tildeTrimReplace="$1~";fe("TILDE",`^${K[z.LONETILDE]}${K[z.XRANGEPLAIN]}$`);fe("TILDELOOSE",`^${K[z.LONETILDE]}${K[z.XRANGEPLAINLOOSE]}$`);fe("LONECARET","(?:\\^)");fe("CARETTRIM",`(\\s*)${K[z.LONECARET]}\\s+`,!0);fs.caretTrimReplace="$1^";fe("CARET",`^${K[z.LONECARET]}${K[z.XRANGEPLAIN]}$`);fe("CARETLOOSE",`^${K[z.LONECARET]}${K[z.XRANGEPLAINLOOSE]}$`);fe("COMPARATORLOOSE",`^${K[z.GTLT]}\\s*(${K[z.LOOSEPLAIN]})$|^$`);fe("COMPARATOR",`^${K[z.GTLT]}\\s*(${K[z.FULLPLAIN]})$|^$`);fe("COMPARATORTRIM",`(\\s*)${K[z.GTLT]}\\s*(${K[z.LOOSEPLAIN]}|${K[z.XRANGEPLAIN]})`,!0);fs.comparatorTrimReplace="$1$2$3";fe("HYPHENRANGE",`^\\s*(${K[z.XRANGEPLAIN]})\\s+-\\s+(${K[z.XRANGEPLAIN]})\\s*$`);fe("HYPHENRANGELOOSE",`^\\s*(${K[z.XRANGEPLAINLOOSE]})\\s+-\\s+(${K[z.XRANGEPLAINLOOSE]})\\s*$`);fe("STAR","(<|>)?=?\\s*\\*");fe("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");fe("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var wg=h((iZe,pW)=>{var Nre=Object.freeze({loose:!0}),Vre=Object.freeze({}),Hre=t=>t?typeof t!="object"?Nre:t:Vre;pW.exports=Hre});var l0=h((oZe,yW)=>{var hW=/^[0-9]+$/,mW=(t,e)=>{let r=hW.test(t),n=hW.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},Wre=(t,e)=>mW(e,t);yW.exports={compareIdentifiers:mW,rcompareIdentifiers:Wre}});var jt=h((aZe,SW)=>{var Bg=xl(),{MAX_LENGTH:IW,MAX_SAFE_INTEGER:Tg}=Fl(),{safeRe:bW,t:CW}=wa(),Ore=wg(),{compareIdentifiers:Ba}=l0(),u0=class t{constructor(e,r){if(r=Ore(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>IW)throw new TypeError(`version is longer than ${IW} characters`);Bg("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?bW[CW.LOOSE]:bW[CW.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Tg||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Tg||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Tg||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<Tg)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Bg("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),Ba(this.major,e.major)||Ba(this.minor,e.minor)||Ba(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],s=e.prerelease[r];if(Bg("prerelease compare",r,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Ba(n,s)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],s=e.build[r];if(Bg("prerelease compare",r,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Ba(n,s)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(r){let i=[r,s];n===!1&&(i=[r]),Ba(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};SW.exports=u0});var lo=h((cZe,_W)=>{var vW=jt(),Pre=(t,e,r=!1)=>{if(t instanceof vW)return t;try{return new vW(t,e)}catch(n){if(!r)return null;throw n}};_W.exports=Pre});var RW=h((lZe,AW)=>{var kre=lo(),Fre=(t,e)=>{let r=kre(t,e);return r?r.version:null};AW.exports=Fre});var wW=h((uZe,EW)=>{var xre=lo(),Lre=(t,e)=>{let r=xre(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};EW.exports=Lre});var GW=h((dZe,TW)=>{var BW=jt(),Ure=(t,e,r,n,s)=>{typeof r=="string"&&(s=n,n=r,r=void 0);try{return new BW(t instanceof BW?t.version:t,r).inc(e,n,s).version}catch{return null}};TW.exports=Ure});var VW=h((fZe,NW)=>{var ZW=lo(),Yre=(t,e)=>{let r=ZW(t,null,!0),n=ZW(e,null,!0),s=r.compare(n);if(s===0)return null;let i=s>0,o=i?r:n,a=i?n:r,c=!!o.prerelease.length;if(!!a.prerelease.length&&!c)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let u=c?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"};NW.exports=Yre});var WW=h((gZe,HW)=>{var Dre=jt(),Xre=(t,e)=>new Dre(t,e).major;HW.exports=Xre});var PW=h((pZe,OW)=>{var $re=jt(),jre=(t,e)=>new $re(t,e).minor;OW.exports=jre});var FW=h((hZe,kW)=>{var qre=jt(),Mre=(t,e)=>new qre(t,e).patch;kW.exports=Mre});var LW=h((mZe,xW)=>{var Kre=lo(),zre=(t,e)=>{let r=Kre(t,e);return r&&r.prerelease.length?r.prerelease:null};xW.exports=zre});var Fr=h((yZe,YW)=>{var UW=jt(),Jre=(t,e,r)=>new UW(t,r).compare(new UW(e,r));YW.exports=Jre});var XW=h((IZe,DW)=>{var Qre=Fr(),ene=(t,e,r)=>Qre(e,t,r);DW.exports=ene});var jW=h((bZe,$W)=>{var tne=Fr(),rne=(t,e)=>tne(t,e,!0);$W.exports=rne});var Gg=h((CZe,MW)=>{var qW=jt(),nne=(t,e,r)=>{let n=new qW(t,r),s=new qW(e,r);return n.compare(s)||n.compareBuild(s)};MW.exports=nne});var zW=h((SZe,KW)=>{var sne=Gg(),ine=(t,e)=>t.sort((r,n)=>sne(r,n,e));KW.exports=ine});var QW=h((vZe,JW)=>{var one=Gg(),ane=(t,e)=>t.sort((r,n)=>one(n,r,e));JW.exports=ane});var Ll=h((_Ze,eO)=>{var cne=Fr(),lne=(t,e,r)=>cne(t,e,r)>0;eO.exports=lne});var Zg=h((AZe,tO)=>{var une=Fr(),dne=(t,e,r)=>une(t,e,r)<0;tO.exports=dne});var d0=h((RZe,rO)=>{var fne=Fr(),gne=(t,e,r)=>fne(t,e,r)===0;rO.exports=gne});var f0=h((EZe,nO)=>{var pne=Fr(),hne=(t,e,r)=>pne(t,e,r)!==0;nO.exports=hne});var Ng=h((wZe,sO)=>{var mne=Fr(),yne=(t,e,r)=>mne(t,e,r)>=0;sO.exports=yne});var Vg=h((BZe,iO)=>{var Ine=Fr(),bne=(t,e,r)=>Ine(t,e,r)<=0;iO.exports=bne});var g0=h((TZe,oO)=>{var Cne=d0(),Sne=f0(),vne=Ll(),_ne=Ng(),Ane=Zg(),Rne=Vg(),Ene=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Cne(t,r,n);case"!=":return Sne(t,r,n);case">":return vne(t,r,n);case">=":return _ne(t,r,n);case"<":return Ane(t,r,n);case"<=":return Rne(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};oO.exports=Ene});var cO=h((GZe,aO)=>{var wne=jt(),Bne=lo(),{safeRe:Hg,t:Wg}=wa(),Tne=(t,e)=>{if(t instanceof wne)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(Hg[Wg.COERCE]);else{let n;for(;(n=Hg[Wg.COERCERTL].exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||n.index+n[0].length!==r.index+r[0].length)&&(r=n),Hg[Wg.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;Hg[Wg.COERCERTL].lastIndex=-1}return r===null?null:Bne(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,e)};aO.exports=Tne});var uO=h((ZZe,lO)=>{"use strict";lO.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var fO=h((NZe,dO)=>{"use strict";dO.exports=Te;Te.Node=uo;Te.create=Te;function Te(t){var e=this;if(e instanceof Te||(e=new Te),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}Te.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Te.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Te.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Te.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)Zne(this,arguments[t]);return this.length};Te.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)Nne(this,arguments[t]);return this.length};Te.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Te.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Te.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;r!==null;n++)t.call(e,r.value,n,this),r=r.next};Te.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;r!==null;n--)t.call(e,r.value,n,this),r=r.prev};Te.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};Te.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};Te.prototype.map=function(t,e){e=e||this;for(var r=new Te,n=this.head;n!==null;)r.push(t.call(e,n.value,this)),n=n.next;return r};Te.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Te,n=this.tail;n!==null;)r.push(t.call(e,n.value,this)),n=n.prev;return r};Te.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)r=t(r,n.value,s),n=n.next;return r};Te.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)r=t(r,n.value,s),n=n.prev;return r};Te.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};Te.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};Te.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Te;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(;s!==null&&n<e;n++,s=s.next)r.push(s.value);return r};Te.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Te;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;s!==null&&n>e;n--)s=s.prev;for(;s!==null&&n>t;n--,s=s.prev)r.push(s.value);return r};Te.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,s=this.head;s!==null&&n<t;n++)s=s.next;for(var i=[],n=0;s&&n<e;n++)i.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<r.length;n++)s=Gne(this,s,r[n]);return i};Te.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};function Gne(t,e,r){var n=e===t.head?new uo(r,null,e,t):new uo(r,e,e.next,t);return n.next===null&&(t.tail=n),n.prev===null&&(t.head=n),t.length++,n}function Zne(t,e){t.tail=new uo(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function Nne(t,e){t.head=new uo(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function uo(t,e,r,n){if(!(this instanceof uo))return new uo(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{uO()(Te)}catch{}});var yO=h((VZe,mO)=>{"use strict";var Vne=fO(),fo=Symbol("max"),ps=Symbol("length"),Ta=Symbol("lengthCalculator"),Yl=Symbol("allowStale"),go=Symbol("maxAge"),gs=Symbol("dispose"),gO=Symbol("noDisposeOnSet"),Zt=Symbol("lruList"),un=Symbol("cache"),hO=Symbol("updateAgeOnGet"),p0=()=>1,m0=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let r=this[fo]=e.max||1/0,n=e.length||p0;if(this[Ta]=typeof n!="function"?p0:n,this[Yl]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[go]=e.maxAge||0,this[gs]=e.dispose,this[gO]=e.noDisposeOnSet||!1,this[hO]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[fo]=e||1/0,Ul(this)}get max(){return this[fo]}set allowStale(e){this[Yl]=!!e}get allowStale(){return this[Yl]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[go]=e,Ul(this)}get maxAge(){return this[go]}set lengthCalculator(e){typeof e!="function"&&(e=p0),e!==this[Ta]&&(this[Ta]=e,this[ps]=0,this[Zt].forEach(r=>{r.length=this[Ta](r.value,r.key),this[ps]+=r.length})),Ul(this)}get lengthCalculator(){return this[Ta]}get length(){return this[ps]}get itemCount(){return this[Zt].length}rforEach(e,r){r=r||this;for(let n=this[Zt].tail;n!==null;){let s=n.prev;pO(this,e,n,r),n=s}}forEach(e,r){r=r||this;for(let n=this[Zt].head;n!==null;){let s=n.next;pO(this,e,n,r),n=s}}keys(){return this[Zt].toArray().map(e=>e.key)}values(){return this[Zt].toArray().map(e=>e.value)}reset(){this[gs]&&this[Zt]&&this[Zt].length&&this[Zt].forEach(e=>this[gs](e.key,e.value)),this[un]=new Map,this[Zt]=new Vne,this[ps]=0}dump(){return this[Zt].map(e=>Og(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Zt]}set(e,r,n){if(n=n||this[go],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let s=n?Date.now():0,i=this[Ta](r,e);if(this[un].has(e)){if(i>this[fo])return Ga(this,this[un].get(e)),!1;let c=this[un].get(e).value;return this[gs]&&(this[gO]||this[gs](e,c.value)),c.now=s,c.maxAge=n,c.value=r,this[ps]+=i-c.length,c.length=i,this.get(e),Ul(this),!0}let o=new y0(e,r,i,s,n);return o.length>this[fo]?(this[gs]&&this[gs](e,r),!1):(this[ps]+=o.length,this[Zt].unshift(o),this[un].set(e,this[Zt].head),Ul(this),!0)}has(e){if(!this[un].has(e))return!1;let r=this[un].get(e).value;return!Og(this,r)}get(e){return h0(this,e,!0)}peek(e){return h0(this,e,!1)}pop(){let e=this[Zt].tail;return e?(Ga(this,e),e.value):null}del(e){Ga(this,this[un].get(e))}load(e){this.reset();let r=Date.now();for(let n=e.length-1;n>=0;n--){let s=e[n],i=s.e||0;if(i===0)this.set(s.k,s.v);else{let o=i-r;o>0&&this.set(s.k,s.v,o)}}}prune(){this[un].forEach((e,r)=>h0(this,r,!1))}},h0=(t,e,r)=>{let n=t[un].get(e);if(n){let s=n.value;if(Og(t,s)){if(Ga(t,n),!t[Yl])return}else r&&(t[hO]&&(n.value.now=Date.now()),t[Zt].unshiftNode(n));return s.value}},Og=(t,e)=>{if(!e||!e.maxAge&&!t[go])return!1;let r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[go]&&r>t[go]},Ul=t=>{if(t[ps]>t[fo])for(let e=t[Zt].tail;t[ps]>t[fo]&&e!==null;){let r=e.prev;Ga(t,e),e=r}},Ga=(t,e)=>{if(e){let r=e.value;t[gs]&&t[gs](r.key,r.value),t[ps]-=r.length,t[un].delete(r.key),t[Zt].removeNode(e)}},y0=class{constructor(e,r,n,s,i){this.key=e,this.value=r,this.length=n,this.now=s,this.maxAge=i||0}},pO=(t,e,r,n)=>{let s=r.value;Og(t,s)&&(Ga(t,r),t[Yl]||(s=void 0)),s&&e.call(n,s.value,s.key,t)};mO.exports=m0});var xr=h((HZe,SO)=>{var I0=class t{constructor(e,r){if(r=Wne(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof b0)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(s=>!bO(s[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&Une(s[0])){this.set=[s];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&xne)|(this.options.loose&&Lne))+":"+e,s=IO.get(n);if(s)return s;let i=this.options.loose,o=i?gr[sr.HYPHENRANGELOOSE]:gr[sr.HYPHENRANGE];e=e.replace(o,Jne(this.options.includePrerelease)),Me("hyphen replace",e),e=e.replace(gr[sr.COMPARATORTRIM],Pne),Me("comparator trim",e),e=e.replace(gr[sr.TILDETRIM],kne),Me("tilde trim",e),e=e.replace(gr[sr.CARETTRIM],Fne),Me("caret trim",e);let a=e.split(" ").map(d=>Yne(d,this.options)).join(" ").split(/\s+/).map(d=>zne(d,this.options));i&&(a=a.filter(d=>(Me("loose invalid filter",d,this.options),!!d.match(gr[sr.COMPARATORLOOSE])))),Me("range list",a);let c=new Map,l=a.map(d=>new b0(d,this.options));for(let d of l){if(bO(d))return[d];c.set(d.value,d)}c.size>1&&c.has("")&&c.delete("");let u=[...c.values()];return IO.set(n,u),u}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>CO(n,r)&&e.set.some(s=>CO(s,r)&&n.every(i=>s.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new One(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Qne(this.set[r],e,this.options))return!0;return!1}};SO.exports=I0;var Hne=yO(),IO=new Hne({max:1e3}),Wne=wg(),b0=Dl(),Me=xl(),One=jt(),{safeRe:gr,t:sr,comparatorTrimReplace:Pne,tildeTrimReplace:kne,caretTrimReplace:Fne}=wa(),{FLAG_INCLUDE_PRERELEASE:xne,FLAG_LOOSE:Lne}=Fl(),bO=t=>t.value==="<0.0.0-0",Une=t=>t.value==="",CO=(t,e)=>{let r=!0,n=t.slice(),s=n.pop();for(;r&&n.length;)r=n.every(i=>s.intersects(i,e)),s=n.pop();return r},Yne=(t,e)=>(Me("comp",t,e),t=$ne(t,e),Me("caret",t),t=Dne(t,e),Me("tildes",t),t=qne(t,e),Me("xrange",t),t=Kne(t,e),Me("stars",t),t),ir=t=>!t||t.toLowerCase()==="x"||t==="*",Dne=(t,e)=>t.trim().split(/\s+/).map(r=>Xne(r,e)).join(" "),Xne=(t,e)=>{let r=e.loose?gr[sr.TILDELOOSE]:gr[sr.TILDE];return t.replace(r,(n,s,i,o,a)=>{Me("tilde",t,n,s,i,o,a);let c;return ir(s)?c="":ir(i)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:ir(o)?c=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:a?(Me("replaceTilde pr",a),c=`>=${s}.${i}.${o}-${a} <${s}.${+i+1}.0-0`):c=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,Me("tilde return",c),c})},$ne=(t,e)=>t.trim().split(/\s+/).map(r=>jne(r,e)).join(" "),jne=(t,e)=>{Me("caret",t,e);let r=e.loose?gr[sr.CARETLOOSE]:gr[sr.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(s,i,o,a,c)=>{Me("caret",t,s,i,o,a,c);let l;return ir(i)?l="":ir(o)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:ir(a)?i==="0"?l=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.0${n} <${+i+1}.0.0-0`:c?(Me("replaceCaret pr",c),i==="0"?o==="0"?l=`>=${i}.${o}.${a}-${c} <${i}.${o}.${+a+1}-0`:l=`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${a}-${c} <${+i+1}.0.0-0`):(Me("no pr"),i==="0"?o==="0"?l=`>=${i}.${o}.${a}${n} <${i}.${o}.${+a+1}-0`:l=`>=${i}.${o}.${a}${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${a} <${+i+1}.0.0-0`),Me("caret return",l),l})},qne=(t,e)=>(Me("replaceXRanges",t,e),t.split(/\s+/).map(r=>Mne(r,e)).join(" ")),Mne=(t,e)=>{t=t.trim();let r=e.loose?gr[sr.XRANGELOOSE]:gr[sr.XRANGE];return t.replace(r,(n,s,i,o,a,c)=>{Me("xRange",t,n,s,i,o,a,c);let l=ir(i),u=l||ir(o),d=u||ir(a),f=d;return s==="="&&f&&(s=""),c=e.includePrerelease?"-0":"",l?s===">"||s==="<"?n="<0.0.0-0":n="*":s&&f?(u&&(o=0),a=0,s===">"?(s=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):s==="<="&&(s="<",u?i=+i+1:o=+o+1),s==="<"&&(c="-0"),n=`${s+i}.${o}.${a}${c}`):u?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),Me("xRange return",n),n})},Kne=(t,e)=>(Me("replaceStars",t,e),t.trim().replace(gr[sr.STAR],"")),zne=(t,e)=>(Me("replaceGTE0",t,e),t.trim().replace(gr[e.includePrerelease?sr.GTE0PRE:sr.GTE0],"")),Jne=t=>(e,r,n,s,i,o,a,c,l,u,d,f,g)=>(ir(n)?r="":ir(s)?r=`>=${n}.0.0${t?"-0":""}`:ir(i)?r=`>=${n}.${s}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,ir(l)?c="":ir(u)?c=`<${+l+1}.0.0-0`:ir(d)?c=`<${l}.${+u+1}.0-0`:f?c=`<=${l}.${u}.${d}-${f}`:t?c=`<${l}.${u}.${+d+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),Qne=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(Me(t[n].semver),t[n].semver!==b0.ANY&&t[n].semver.prerelease.length>0){let s=t[n].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0}});var Dl=h((WZe,wO)=>{var Xl=Symbol("SemVer ANY"),v0=class t{static get ANY(){return Xl}constructor(e,r){if(r=vO(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),S0("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Xl?this.value="":this.value=this.operator+this.semver.version,S0("comp",this)}parse(e){let r=this.options.loose?_O[AO.COMPARATORLOOSE]:_O[AO.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new RO(n[2],this.options.loose):this.semver=Xl}toString(){return this.value}test(e){if(S0("Comparator.test",e,this.options.loose),this.semver===Xl||e===Xl)return!0;if(typeof e=="string")try{e=new RO(e,this.options)}catch{return!1}return C0(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new EO(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new EO(this.value,r).test(e.semver):(r=vO(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||C0(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||C0(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};wO.exports=v0;var vO=wg(),{safeRe:_O,t:AO}=wa(),C0=g0(),S0=xl(),RO=jt(),EO=xr()});var $l=h((OZe,BO)=>{var ese=xr(),tse=(t,e,r)=>{try{e=new ese(e,r)}catch{return!1}return e.test(t)};BO.exports=tse});var GO=h((PZe,TO)=>{var rse=xr(),nse=(t,e)=>new rse(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));TO.exports=nse});var NO=h((kZe,ZO)=>{var sse=jt(),ise=xr(),ose=(t,e,r)=>{let n=null,s=null,i=null;try{i=new ise(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!n||s.compare(o)===-1)&&(n=o,s=new sse(n,r))}),n};ZO.exports=ose});var HO=h((FZe,VO)=>{var ase=jt(),cse=xr(),lse=(t,e,r)=>{let n=null,s=null,i=null;try{i=new cse(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!n||s.compare(o)===1)&&(n=o,s=new ase(n,r))}),n};VO.exports=lse});var PO=h((xZe,OO)=>{var _0=jt(),use=xr(),WO=Ll(),dse=(t,e)=>{t=new use(t,e);let r=new _0("0.0.0");if(t.test(r)||(r=new _0("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let s=t.set[n],i=null;s.forEach(o=>{let a=new _0(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||WO(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||WO(r,i))&&(r=i)}return r&&t.test(r)?r:null};OO.exports=dse});var FO=h((LZe,kO)=>{var fse=xr(),gse=(t,e)=>{try{return new fse(t,e).range||"*"}catch{return null}};kO.exports=gse});var Pg=h((UZe,YO)=>{var pse=jt(),UO=Dl(),{ANY:hse}=UO,mse=xr(),yse=$l(),xO=Ll(),LO=Zg(),Ise=Vg(),bse=Ng(),Cse=(t,e,r,n)=>{t=new pse(t,n),e=new mse(e,n);let s,i,o,a,c;switch(r){case">":s=xO,i=Ise,o=LO,a=">",c=">=";break;case"<":s=LO,i=bse,o=xO,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(yse(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let u=e.set[l],d=null,f=null;if(u.forEach(g=>{g.semver===hse&&(g=new UO(">=0.0.0")),d=d||g,f=f||g,s(g.semver,d.semver,n)?d=g:o(g.semver,f.semver,n)&&(f=g)}),d.operator===a||d.operator===c||(!f.operator||f.operator===a)&&i(t,f.semver))return!1;if(f.operator===c&&o(t,f.semver))return!1}return!0};YO.exports=Cse});var XO=h((YZe,DO)=>{var Sse=Pg(),vse=(t,e,r)=>Sse(t,e,">",r);DO.exports=vse});var jO=h((DZe,$O)=>{var _se=Pg(),Ase=(t,e,r)=>_se(t,e,"<",r);$O.exports=Ase});var KO=h((XZe,MO)=>{var qO=xr(),Rse=(t,e,r)=>(t=new qO(t,r),e=new qO(e,r),t.intersects(e,r));MO.exports=Rse});var JO=h(($Ze,zO)=>{var Ese=$l(),wse=Fr();zO.exports=(t,e,r)=>{let n=[],s=null,i=null,o=t.sort((u,d)=>wse(u,d,r));for(let u of o)Ese(u,e,r)?(i=u,s||(s=u)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);let a=[];for(let[u,d]of n)u===d?a.push(u):!d&&u===o[0]?a.push("*"):d?u===o[0]?a.push(`<=${d}`):a.push(`${u} - ${d}`):a.push(`>=${u}`);let c=a.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var s1=h((jZe,n1)=>{var QO=xr(),R0=Dl(),{ANY:A0}=R0,jl=$l(),E0=Fr(),Bse=(t,e,r={})=>{if(t===e)return!0;t=new QO(t,r),e=new QO(e,r);let n=!1;e:for(let s of t.set){for(let i of e.set){let o=Gse(s,i,r);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},Tse=[new R0(">=0.0.0-0")],e1=[new R0(">=0.0.0")],Gse=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===A0){if(e.length===1&&e[0].semver===A0)return!0;r.includePrerelease?t=Tse:t=e1}if(e.length===1&&e[0].semver===A0){if(r.includePrerelease)return!0;e=e1}let n=new Set,s,i;for(let g of t)g.operator===">"||g.operator===">="?s=t1(s,g,r):g.operator==="<"||g.operator==="<="?i=r1(i,g,r):n.add(g.semver);if(n.size>1)return null;let o;if(s&&i){if(o=E0(s.semver,i.semver,r),o>0)return null;if(o===0&&(s.operator!==">="||i.operator!=="<="))return null}for(let g of n){if(s&&!jl(g,String(s),r)||i&&!jl(g,String(i),r))return null;for(let p of e)if(!jl(g,String(p),r))return!1;return!0}let a,c,l,u,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,f=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let g of e){if(u=u||g.operator===">"||g.operator===">=",l=l||g.operator==="<"||g.operator==="<=",s){if(f&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===f.major&&g.semver.minor===f.minor&&g.semver.patch===f.patch&&(f=!1),g.operator===">"||g.operator===">="){if(a=t1(s,g,r),a===g&&a!==s)return!1}else if(s.operator===">="&&!jl(s.semver,String(g),r))return!1}if(i){if(d&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===d.major&&g.semver.minor===d.minor&&g.semver.patch===d.patch&&(d=!1),g.operator==="<"||g.operator==="<="){if(c=r1(i,g,r),c===g&&c!==i)return!1}else if(i.operator==="<="&&!jl(i.semver,String(g),r))return!1}if(!g.operator&&(i||s)&&o!==0)return!1}return!(s&&l&&!i&&o!==0||i&&u&&!s&&o!==0||f||d)},t1=(t,e,r)=>{if(!t)return e;let n=E0(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},r1=(t,e,r)=>{if(!t)return e;let n=E0(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};n1.exports=Bse});var B0=h((qZe,a1)=>{var w0=wa(),i1=Fl(),Zse=jt(),o1=l0(),Nse=lo(),Vse=RW(),Hse=wW(),Wse=GW(),Ose=VW(),Pse=WW(),kse=PW(),Fse=FW(),xse=LW(),Lse=Fr(),Use=XW(),Yse=jW(),Dse=Gg(),Xse=zW(),$se=QW(),jse=Ll(),qse=Zg(),Mse=d0(),Kse=f0(),zse=Ng(),Jse=Vg(),Qse=g0(),eie=cO(),tie=Dl(),rie=xr(),nie=$l(),sie=GO(),iie=NO(),oie=HO(),aie=PO(),cie=FO(),lie=Pg(),uie=XO(),die=jO(),fie=KO(),gie=JO(),pie=s1();a1.exports={parse:Nse,valid:Vse,clean:Hse,inc:Wse,diff:Ose,major:Pse,minor:kse,patch:Fse,prerelease:xse,compare:Lse,rcompare:Use,compareLoose:Yse,compareBuild:Dse,sort:Xse,rsort:$se,gt:jse,lt:qse,eq:Mse,neq:Kse,gte:zse,lte:Jse,cmp:Qse,coerce:eie,Comparator:tie,Range:rie,satisfies:nie,toComparators:sie,maxSatisfying:iie,minSatisfying:oie,minVersion:aie,validRange:cie,outside:lie,gtr:uie,ltr:die,intersects:fie,simplifyRange:gie,subset:pie,SemVer:Zse,re:w0.re,src:w0.src,tokens:w0.t,SEMVER_SPEC_VERSION:i1.SEMVER_SPEC_VERSION,RELEASE_TYPES:i1.RELEASE_TYPES,compareIdentifiers:o1.compareIdentifiers,rcompareIdentifiers:o1.rcompareIdentifiers}});var Fg=h((MZe,N0)=>{"use strict";var kg=uW(),hie=B0(),{FSTDEP005:mie,FSTDEP012:yie,FSTDEP015:Iie,FSTDEP016:bie,FSTDEP017:Cie,FSTDEP018:Sie}=is(),{kHasBeenDecorated:vie,kSchemaBody:_ie,kSchemaHeaders:Aie,kSchemaParams:Rie,kSchemaQuerystring:c1,kSchemaController:T0,kOptions:Eie,kRequestCacheValidateFns:ci,kRouteContext:ut,kPublicRouteContext:l1,kRequestOriginalUrl:G0}=Tt(),{FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:wie}=Yt(),u1={body:_ie,headers:Aie,params:Rie,querystring:c1,query:c1};function Z0(t,e,r,n,s,i){this.id=t,this[ut]=i,this.params=e,this.raw=r,this.query=n,this.log=s,this.body=void 0}Z0.props=[];function Bie(t){if(typeof t=="function")return t;if(t===!0)return function(){return!0};if(typeof t=="number")return function(e,r){return r<t};if(typeof t=="string"){let e=t.split(",").map(r=>r.trim());return kg.compile(e)}return kg.compile(t)}function Tie(t,e){return e?Gie(t,e):f1(t)}function f1(t){let e=t.props.slice();function r(n,s,i,o,a,c){this.id=n,this[ut]=c,this.params=s,this.raw=i,this.query=o,this.log=a,this.body=void 0;for(var l,u=0;u<e.length;u++)l=e[u],this[l.key]=l.value}return Object.setPrototypeOf(r.prototype,t.prototype),Object.setPrototypeOf(r,t),r.props=e,r.parent=t,r}function d1(t){let e=t.lastIndexOf(",");return e===-1?t.trim():t.slice(e+1).trim()}function Gie(t,e){let r=f1(t),n=Bie(e);return r[vie]=!0,Object.defineProperties(r.prototype,{ip:{get(){return kg(this.raw,n)}},ips:{get(){return kg.all(this.raw,n)}},hostname:{get(){return this.ip!==void 0&&this.headers["x-forwarded-host"]?d1(this.headers["x-forwarded-host"]):this.headers.host||this.headers[":authority"]}},protocol:{get(){if(this.headers["x-forwarded-proto"])return d1(this.headers["x-forwarded-proto"]);if(this.socket)return this.socket.encrypted?"https":"http"}}}),r}Object.defineProperties(Z0.prototype,{server:{get(){return this[ut].server}},url:{get(){return this.raw.url}},originalUrl:{get(){return this[G0]||(this[G0]=this.raw.originalUrl||this.raw.url),this[G0]}},method:{get(){return this.raw.method}},context:{get(){return yie(),this[ut]}},routerPath:{get(){return Cie(),this[ut].config?.url}},routeOptions:{get(){let t=this[ut],e=t._parserOptions.limit,r=t.server.initialConfig.bodyLimit,n=t.server.hasConstraintStrategy("version")?this.raw.headers["accept-version"]:void 0,s={method:t.config?.method,url:t.config?.url,bodyLimit:e||r,attachValidation:t.attachValidation,logLevel:t.logLevel,exposeHeadRoute:t.exposeHeadRoute,prefixTrailingSlash:t.prefixTrailingSlash,handler:t.handler,version:n};return Object.defineProperties(s,{config:{get:()=>t.config},schema:{get:()=>t.schema}}),Object.freeze(s)}},routerMethod:{get(){return Sie(),this[ut].config?.method}},routeConfig:{get(){return bie(),this[ut][l1]?.config}},routeSchema:{get(){return Iie(),this[ut][l1].schema}},is404:{get(){return this[ut].config?.url===void 0}},connection:{get(){return hie.gte(process.versions.node,"13.0.0")&&mie(),this.raw.connection}},socket:{get(){return this.raw.socket}},ip:{get(){if(this.socket)return this.socket.remoteAddress}},hostname:{get(){return this.raw.headers.host||this.raw.headers[":authority"]}},protocol:{get(){if(this.socket)return this.socket.encrypted?"https":"http"}},headers:{get(){return this.additionalHeaders?Object.assign({},this.raw.headers,this.additionalHeaders):this.raw.headers},set(t){this.additionalHeaders=t}},getValidationFunction:{value:function(t){if(typeof t=="string"){let e=u1[t];return this[ut][e]}else if(typeof t=="object")return this[ut][ci]?.get(t)}},compileValidationSchema:{value:function(t,e=null){let{method:r,url:n}=this;if(this[ut][ci]?.has(t))return this[ut][ci].get(t);let i=(this[ut].validatorCompiler||this.server[T0].validatorCompiler||this.server[T0].setupValidator(this.server[Eie])||this.server[T0].validatorCompiler)({schema:t,method:r,url:n,httpPart:e});return this[ut][ci]==null&&(this[ut][ci]=new WeakMap),this[ut][ci].set(t,i),i}},validateInput:{value:function(t,e,r){r=typeof e=="string"?e:r;let n=r!=null&&typeof r=="string"&&u1[r],s;if(n&&(s=this[ut][n]),s==null&&(e==null||typeof e!="object"||Array.isArray(e)))throw new wie(r);return s==null&&(this[ut][ci]?.has(e)?s=this[ut][ci].get(e):s=this.compileValidationSchema(e,r)),s(t)}}});N0.exports=Z0;N0.exports.buildRequest=Tie});var xg=h((KZe,g1)=>{"use strict";var{kFourOhFourContext:Zie,kReplySerializerDefault:Nie,kSchemaErrorFormatter:Vie,kErrorHandler:Hie,kChildLoggerFactory:Wie,kOptions:Oie,kReply:Pie,kRequest:kie,kBodyLimit:Fie,kLogLevel:xie,kContentTypeParser:Lie,kRouteByFastify:Uie,kRequestCacheValidateFns:Yie,kReplyCacheSerializeFns:Die,kPublicRouteContext:Xie}=Tt();function $ie({schema:t,handler:e,config:r,requestIdLogLabel:n,childLoggerFactory:s,errorHandler:i,bodyLimit:o,logLevel:a,logSerializers:c,attachValidation:l,validatorCompiler:u,serializerCompiler:d,replySerializer:f,schemaErrorFormatter:g,exposeHeadRoute:p,prefixTrailingSlash:m,server:I,isFastify:C}){this.schema=t,this.handler=e,this.Reply=I[Pie],this.Request=I[kie],this.contentTypeParser=I[Lie],this.onRequest=null,this.onSend=null,this.onError=null,this.onTimeout=null,this.preHandler=null,this.onResponse=null,this.preSerialization=null,this.onRequestAbort=null,this.config=r,this.errorHandler=i||I[Hie],this.requestIdLogLabel=n||I[Oie].requestIdLogLabel,this.childLoggerFactory=s||I[Wie],this._middie=null,this._parserOptions={limit:o||I[Fie]},this.exposeHeadRoute=p,this.prefixTrailingSlash=m,this.logLevel=a||I[xie],this.logSerializers=c,this[Zie]=null,this.attachValidation=l,this[Nie]=f,this.schemaErrorFormatter=g||I[Vie]||qie,this[Uie]=C,this[Yie]=null,this[Die]=null,this.validatorCompiler=u||null,this.serializerCompiler=d||null,this[Xie]=jie(this),this.server=I}function jie(t){return Object.create(null,{schema:{enumerable:!0,get(){return t.schema}},config:{enumerable:!0,get(){return t.config}}})}function qie(t,e){let r="",n=", ";for(var s=0;s!==t.length;++s){let i=t[s];r+=e+(i.instancePath||"")+" "+i.message+n}return new Error(r.slice(0,-n.length))}g1.exports=$ie});var V0=h((zZe,p1)=>{"use strict";p1.exports={supportedMethods:["DELETE","GET","HEAD","PATCH","POST","PUT","OPTIONS","PROPFIND","PROPPATCH","MKCOL","COPY","MOVE","LOCK","UNLOCK","TRACE","SEARCH"]}});var k0=h((JZe,I1)=>{"use strict";var{kReply:H0,kRequest:W0,kState:Mie,kHasBeenDecorated:Kie}=Tt(),{FST_ERR_DEC_ALREADY_PRESENT:h1,FST_ERR_DEC_MISSING_DEPENDENCY:zie,FST_ERR_DEC_AFTER_START:Jie,FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:Qie}=Yt(),{FSTDEP006:eoe}=is();function toe(t,e,r,n){if(Object.prototype.hasOwnProperty.call(t,e))throw new h1(e);O0(t,e,n),r&&(typeof r.getter=="function"||typeof r.setter=="function")?Object.defineProperty(t,e,{get:r.getter,set:r.setter}):t[e]=r}function m1(t,e,r,n){let s=t.prototype;if(Object.prototype.hasOwnProperty.call(s,e)||Ug(t,e))throw new h1(e);t[Kie]=!0,O0(t,e,n),r&&(typeof r.getter=="function"||typeof r.setter=="function")?Object.defineProperty(s,e,{get:r.getter,set:r.setter}):typeof r=="function"?s[e]=r:t.props.push({key:e,value:r})}function y1(t,e){typeof e=="object"&&e&&!(typeof e.getter=="function"||typeof e.setter=="function")&&eoe(t)}function roe(t,e,r){return P0(this,t),toe(this,t,e,r),this}function Lg(t,e){return e?e in t||t.prototype&&e in t.prototype||Ug(t,e):t in this}function Ug(t,e){return t.props?t.props.find(({key:r})=>r===e):!1}function noe(t){return t&&Ug(this[W0],t)?!0:Lg(this[W0].prototype,t)}function soe(t){return t&&Ug(this[H0],t)?!0:Lg(this[H0].prototype,t)}function O0(t,e,r){if(r!=null){if(!Array.isArray(r))throw new Qie(e);for(var n=0;n!==r.length;++n)if(!Lg(t,r[n]))throw new zie(r[n])}}function ioe(t,e,r){return P0(this,t),y1(t,e),m1(this[H0],t,e,r),this}function ooe(t,e,r){return P0(this,t),y1(t,e),m1(this[W0],t,e,r),this}function P0(t,e){if(t[Mie].started)throw new Jie(e)}I1.exports={add:roe,exist:Lg,existRequest:noe,existReply:soe,dependencies:O0,decorateReply:ioe,decorateRequest:ooe}});var b1=h(Tn=>{"use strict";var x0=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=r}get size(){return this.items.size}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let r=this.items.get(e);this.items.delete(e),r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let r=this.items.get(e);if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return r.value}}getMany(e){let r=[];for(var n=0;n<e.length;n++)r.push(this.get(e[n]));return r}keys(){return this.items.keys()}set(e,r){if(this.items.has(e)){let s=this.items.get(e);s.value=r,s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl;return}this.max>0&&this.size===this.max&&this.evict();let n={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items.set(e,n),this.size===1?this.first=n:this.last.next=n,this.last=n}},L0=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=r}get size(){return this.items.size}bumpLru(e){if(this.last===e)return;let r=this.last,n=e.next,s=e.prev;this.first===e&&(this.first=n),e.next=null,e.prev=r,r.next=e,s!==null&&(s.next=n),n!==null&&(n.prev=s),this.last=e}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let r=this.items.get(e);this.items.delete(e),r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let r=this.items.get(e);if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return this.bumpLru(r),r.value}}getMany(e){let r=[];for(var n=0;n<e.length;n++)r.push(this.get(e[n]));return r}keys(){return this.items.keys()}set(e,r){if(this.items.has(e)){let s=this.items.get(e);s.value=r,s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,this.last!==s&&this.bumpLru(s);return}this.max>0&&this.size===this.max&&this.evict();let n={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items.set(e,n),this.size===1?this.first=n:this.last.next=n,this.last=n}},ql=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=r}bumpLru(e){if(this.last===e)return;let r=this.last,n=e.next,s=e.prev;this.first===e&&(this.first=n),e.next=null,e.prev=r,r.next=e,s!==null&&(s.next=n),n!==null&&(n.prev=s),this.last=e}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];delete this.items[e],this.size--,r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return this.bumpLru(r),r.value}}getMany(e){let r=[];for(var n=0;n<e.length;n++)r.push(this.get(e[n]));return r}keys(){return Object.keys(this.items)}set(e,r){if(Object.prototype.hasOwnProperty.call(this.items,e)){let s=this.items[e];s.value=r,s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,this.last!==s&&this.bumpLru(s);return}this.max>0&&this.size===this.max&&this.evict();let n={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items[e]=n,++this.size===1?this.first=n:this.last.next=n,this.last=n}},Yg=class{constructor(){this.records={}}initForCache(e,r){this.records[e]={[r]:{hits:0,misses:0,expirations:0}}}resetForCache(e){for(let r of Object.keys(this.records[e]))this.records[e][r]={hits:0,misses:0,expirations:0}}getStatistics(){return this.records}};function F0(t){return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}var U0=class{constructor(e,r,n){this.collectionStart=new Date,this.lastTimeStamp="",this.currentTimeStamp=F0(this.collectionStart),this.cacheId=e,this.statisticTtlInHours=r,this.records=n||new Yg,this.records.initForCache(this.cacheId,this.currentTimeStamp)}hoursPassed(){return(Date.now()-this.collectionStart)/1e3/60/60}addHit(){this.archiveIfNeeded(),this.records.records[this.cacheId][this.currentTimeStamp].hits++}addMiss(){this.archiveIfNeeded(),this.records.records[this.cacheId][this.currentTimeStamp].misses++}addExpiration(){this.archiveIfNeeded(),this.records.records[this.cacheId][this.currentTimeStamp].expirations++}getStatistics(){return this.records.getStatistics()}archiveIfNeeded(){if(this.hoursPassed()>=this.statisticTtlInHours){let e=new Date,r=F0(e);this.lastTimeStamp&&this.lastTimeStamp!==r&&delete this.records.records[this.cacheId][this.lastTimeStamp],this.lastTimeStamp=this.currentTimeStamp,this.collectionStart=e,this.currentTimeStamp=F0(this.collectionStart),this.records.initForCache(this.cacheId,this.currentTimeStamp)}}},Dg=class extends ql{constructor(e,r,n,s,i){if(super(e||1e3,r||0),!n)throw new Error("Cache id is mandatory");this.hitStatistics=new U0(n,i!==void 0?i:24,s)}getStatistics(){return this.hitStatistics.getStatistics()}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e),this.hitStatistics.addExpiration();return}return this.bumpLru(r),this.hitStatistics.addHit(),r.value}this.hitStatistics.addMiss()}},Xg=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=r}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];delete this.items[e],this.size--,r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return r.value}}getMany(e){let r=[];for(var n=0;n<e.length;n++)r.push(this.get(e[n]));return r}keys(){return Object.keys(this.items)}set(e,r){if(Object.prototype.hasOwnProperty.call(this.items,e)){let s=this.items[e];s.value=r,s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl;return}this.max>0&&this.size===this.max&&this.evict();let n={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items[e]=n,++this.size===1?this.first=n:this.last.next=n,this.last=n}};Tn.Fifo=Xg;Tn.FifoMap=x0;Tn.FifoObject=Xg;Tn.HitStatisticsRecord=Yg;Tn.Lru=ql;Tn.LruHitStatistics=Dg;Tn.LruMap=L0;Tn.LruObject=ql;Tn.LruObjectHitStatistics=Dg});var _1=h((eNe,Ml)=>{"use strict";var qg=function(){};qg.prototype=Object.create(null);var $g=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,jg=/\\([\v\u0020-\u00ff])/gu,C1=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,po={type:"",parameters:new qg};Object.freeze(po.parameters);Object.freeze(po);function S1(t){if(typeof t!="string")throw new TypeError("argument header is required and must be a string");let e=t.indexOf(";"),r=e!==-1?t.slice(0,e).trim():t.trim();if(C1.test(r)===!1)throw new TypeError("invalid media type");let n={type:r.toLowerCase(),parameters:new qg};if(e===-1)return n;let s,i,o;for($g.lastIndex=e;i=$g.exec(t);){if(i.index!==e)throw new TypeError("invalid parameter format");e+=i[0].length,s=i[1].toLowerCase(),o=i[2],o[0]==='"'&&(o=o.slice(1,o.length-1),jg.test(o)&&(o=o.replace(jg,"$1"))),n.parameters[s]=o}if(e!==t.length)throw new TypeError("invalid parameter format");return n}function v1(t){if(typeof t!="string")return po;let e=t.indexOf(";"),r=e!==-1?t.slice(0,e).trim():t.trim();if(C1.test(r)===!1)return po;let n={type:r.toLowerCase(),parameters:new qg};if(e===-1)return n;let s,i,o;for($g.lastIndex=e;i=$g.exec(t);){if(i.index!==e)return po;e+=i[0].length,s=i[1].toLowerCase(),o=i[2],o[0]==='"'&&(o=o.slice(1,o.length-1),jg.test(o)&&(o=o.replace(jg,"$1"))),n.parameters[s]=o}return e!==t.length?po:n}Ml.exports.default={parse:S1,safeParse:v1};Ml.exports.parse=S1;Ml.exports.safeParse=v1;Ml.exports.defaultContentType=po});var B1=h((tNe,Za)=>{"use strict";var aoe=typeof Buffer<"u",A1=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,R1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function E1(t,e,r){r==null&&e!==null&&typeof e=="object"&&(r=e,e=void 0),aoe&&Buffer.isBuffer(t)&&(t=t.toString()),t&&t.charCodeAt(0)===65279&&(t=t.slice(1));let n=JSON.parse(t,e);if(n===null||typeof n!="object")return n;let s=r&&r.protoAction||"error",i=r&&r.constructorAction||"error";if(s==="ignore"&&i==="ignore")return n;if(s!=="ignore"&&i!=="ignore"){if(A1.test(t)===!1&&R1.test(t)===!1)return n}else if(s!=="ignore"&&i==="ignore"){if(A1.test(t)===!1)return n}else if(R1.test(t)===!1)return n;return w1(n,{protoAction:s,constructorAction:i,safe:r&&r.safe})}function w1(t,{protoAction:e="error",constructorAction:r="error",safe:n}={}){let s=[t];for(;s.length;){let i=s;s=[];for(let o of i){if(e!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"__proto__")){if(n===!0)return null;if(e==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.__proto__}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"constructor")&&Object.prototype.hasOwnProperty.call(o.constructor,"prototype")){if(n===!0)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.constructor}for(let a in o){let c=o[a];c&&typeof c=="object"&&s.push(c)}}}return t}function Y0(t,e,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return E1(t,e,r)}finally{Error.stackTraceLimit=n}}function coe(t,e){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return E1(t,e,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}}Za.exports=Y0;Za.exports.default=Y0;Za.exports.parse=Y0;Za.exports.safeParse=coe;Za.exports.scan=w1});var q0=h((rNe,zl)=>{"use strict";var{AsyncResource:loe}=require("node:async_hooks"),{Fifo:G1}=b1(),{safeParse:Z1,defaultContentType:uoe}=_1(),doe=B1(),{kDefaultJsonParse:Kl,kContentTypeParser:Na,kBodyLimit:foe,kRequestPayloadStream:N1,kState:X0,kTestInternals:goe,kReplyIsError:V1,kRouteContext:poe}=Tt(),{FST_ERR_CTP_INVALID_TYPE:H1,FST_ERR_CTP_EMPTY_TYPE:hoe,FST_ERR_CTP_ALREADY_PRESENT:moe,FST_ERR_CTP_INVALID_HANDLER:yoe,FST_ERR_CTP_INVALID_PARSE_TYPE:Ioe,FST_ERR_CTP_BODY_TOO_LARGE:T1,FST_ERR_CTP_INVALID_MEDIA_TYPE:boe,FST_ERR_CTP_INVALID_CONTENT_LENGTH:Coe,FST_ERR_CTP_EMPTY_JSON_BODY:Soe,FST_ERR_CTP_INSTANCE_ALREADY_STARTED:$0}=Yt();function hs(t,e,r){this[Kl]=O1(e,r),this.customParsers=new Map,this.customParsers.set("application/json",new D0(!0,!1,t,this[Kl])),this.customParsers.set("text/plain",new D0(!0,!1,t,j0)),this.parserList=[new Mg("application/json"),new Mg("text/plain")],this.parserRegExpList=[],this.cache=new G1(100)}hs.prototype.add=function(t,e,r){let n=typeof t=="string";if(!n&&!(t instanceof RegExp))throw new H1;if(n&&t.length===0)throw new hoe;if(typeof r!="function")throw new yoe;if(this.existingParser(t))throw new moe(t);if(e.parseAs!==void 0&&e.parseAs!=="string"&&e.parseAs!=="buffer")throw new Ioe(e.parseAs);let s=new D0(e.parseAs==="string",e.parseAs==="buffer",e.bodyLimit,r);n&&t==="*"?this.customParsers.set("",s):(n?this.parserList.unshift(new Mg(t)):(t.isEssence=t.source.indexOf(";")===-1,this.parserRegExpList.unshift(t)),this.customParsers.set(t.toString(),s))};hs.prototype.hasParser=function(t){return this.customParsers.has(typeof t=="string"?t:t.toString())};hs.prototype.existingParser=function(t){return t==="application/json"&&this.customParsers.has(t)?this.customParsers.get(t).fn!==this[Kl]:t==="text/plain"&&this.customParsers.has(t)?this.customParsers.get(t).fn!==j0:this.hasParser(t)};hs.prototype.getParser=function(t){if(this.hasParser(t))return this.customParsers.get(t);let e=this.cache.get(t);if(e!==void 0)return e;let r=Z1(t);if(r===uoe)return this.customParsers.get("");for(var n=0;n!==this.parserList.length;++n){let i=this.parserList[n];if(woe(r,i)){let o=this.customParsers.get(i.name);return this.cache.set(t,o),o}}for(var s=0;s!==this.parserRegExpList.length;++s){let i=this.parserRegExpList[s];if(Boe(t,r.type,i)){let o=this.customParsers.get(i.toString());return this.cache.set(t,o),o}}return this.customParsers.get("")};hs.prototype.removeAll=function(){this.customParsers=new Map,this.parserRegExpList=[],this.parserList=[],this.cache=new G1(100)};hs.prototype.remove=function(t){if(!(typeof t=="string"||t instanceof RegExp))throw new H1;let e=this.customParsers.delete(t.toString()),r=typeof t=="string"?this.parserList:this.parserRegExpList,n=r.findIndex(s=>s.toString()===t.toString());return n>-1&&r.splice(n,1),e||n>-1};hs.prototype.run=function(t,e,r,n){let s=this.getParser(t),i=new loe("content-type-parser:run",r);if(s===void 0)r.is404?e(r,n):n.send(new boe(t||void 0));else if(s.asString===!0||s.asBuffer===!0)W1(r,n,n[poe]._parserOptions,s,o);else{let a=s.fn(r,r[N1],o);a&&typeof a.then=="function"&&a.then(c=>o(null,c),o)}function o(a,c){i.runInAsyncScope(()=>{a?(n[V1]=!0,n.send(a)):(r.body=c,e(r,n))})}};function W1(t,e,r,n,s){let i=n.asString,o=r.limit===null?n.bodyLimit:r.limit,a=t.headers["content-length"]===void 0?NaN:Number(t.headers["content-length"]);if(a>o){e.header("connection","close"),e.send(new T1);return}let c=0,l=i===!0?"":[],u=t[N1]||t.raw;i===!0&&u.setEncoding("utf8"),u.on("data",d),u.on("end",f),u.on("error",f),u.resume();function d(g){c+=g.length;let{receivedEncodedLength:p=0}=u;if(c>o||p>o){u.removeListener("data",d),u.removeListener("end",f),u.removeListener("error",f),e.send(new T1);return}i===!0?l+=g:l.push(g)}function f(g){if(u.removeListener("data",d),u.removeListener("end",f),u.removeListener("error",f),g!==void 0){typeof g.statusCode=="number"&&g.statusCode>=400||(g.statusCode=400),e[V1]=!0,e.code(g.statusCode).send(g);return}if(i===!0&&(c=Buffer.byteLength(l)),!Number.isNaN(a)&&(u.receivedEncodedLength||c)!==a){e.header("connection","close"),e.send(new Coe);return}i===!1&&(l=Buffer.concat(l));let p=n.fn(t,l,s);p&&typeof p.then=="function"&&p.then(m=>s(null,m),s)}}function O1(t,e){return r;function r(n,s,i){if(s===""||s==null||Buffer.isBuffer(s)&&s.length===0)return i(new Soe,void 0);let o;try{o=doe.parse(s,{protoAction:t,constructorAction:e})}catch(a){return a.statusCode=400,i(a,void 0)}i(null,o)}}function j0(t,e,r){r(null,e)}function D0(t,e,r,n){this.asString=t,this.asBuffer=e,this.bodyLimit=r,this.fn=n}function voe(t){let e=new hs;return e[Kl]=t[Kl],e.customParsers=new Map(t.customParsers.entries()),e.parserList=t.parserList.slice(),e.parserRegExpList=t.parserRegExpList.slice(),e}function _oe(t,e,r){if(this[X0].started)throw new $0("addContentTypeParser");return typeof e=="function"&&(r=e,e={}),e||(e={}),e.bodyLimit||(e.bodyLimit=this[foe]),Array.isArray(t)?t.forEach(n=>this[Na].add(n,e,r)):this[Na].add(t,e,r),this}function Aoe(t){return this[Na].hasParser(t)}function Roe(t){if(this[X0].started)throw new $0("removeContentTypeParser");if(Array.isArray(t))for(let e of t)this[Na].remove(e);else this[Na].remove(t)}function Eoe(){if(this[X0].started)throw new $0("removeAllContentTypeParsers");this[Na].removeAll()}function woe(t,e){if(e.isEssence)return t.type.indexOf(e)!==-1;if(t.type.indexOf(e.type)===-1)return!1;for(let r of e.parameterKeys)if(!(r in t.parameters)||t.parameters[r]!==e.parameters[r])return!1;return!0}function Boe(t,e,r){return r.isEssence?r.test(e):r.test(t)}function Mg(t){this.name=t;let e=Z1(t);if(this.isEssence=t.indexOf(";")===-1,this.isEssence===!1&&e.type===""){let r=t.split(";",1)[0];this.type=r===""?t:r}else this.type=e.type;this.parameters=e.parameters,this.parameterKeys=Object.keys(e.parameters)}Mg.prototype.toString=function(){return this.name};zl.exports=hs;zl.exports.helpers={buildContentTypeParser:voe,addContentTypeParser:_oe,hasContentTypeParser:Aoe,removeContentTypeParser:Roe,removeAllContentTypeParsers:Eoe};zl.exports.defaultParsers={getDefaultJsonParser:O1,defaultTextParser:j0};zl.exports[goe]={rawBody:W1}});var P1=h((nNe,Kg)=>{"use strict";var Toe=Object.getPrototypeOf({});function M0(t){function e(C){return C!=="constructor"&&C!=="prototype"&&C!=="__proto__"}function r(C){let S=0,b=C.length,y=new Array(b);for(S=0;S<b;++S)y[S]=g(C[S]);return y}function n(C){let S={};if(c&&Object.getPrototypeOf(C)!==Toe)return c(C);let b=a(C),y,A,E;for(y=0,A=b.length;y<A;++y)e(E=b[y])&&(S[E]=g(C[E]));return S}function s(C,S){let b=C.length,y=S.length,A=0,E=new Array(b+y);for(A=0;A<b;++A)E[A]=g(C[A]);for(A=0;A<y;++A)E[A+b]=g(S[A]);return E}let i=Object.prototype.propertyIsEnumerable;function o(C){let S=Object.keys(C),b=Object.getOwnPropertySymbols(C);for(let y=0,A=b.length;y<A;++y)i.call(C,b[y])&&S.push(b[y]);return S}let a=t&&t.symbols?o:Object.keys,c=typeof t?.cloneProtoObject=="function"?t.cloneProtoObject:void 0;function l(C){return typeof C=="object"&&C!==null&&!(C instanceof RegExp)&&!(C instanceof Date)}function u(C){return typeof C!="object"||C===null}let d=typeof Buffer<"u"?C=>typeof C!="object"||C===null||C instanceof RegExp||C instanceof Date||C instanceof Buffer:C=>typeof C!="object"||C===null||C instanceof RegExp||C instanceof Date,f=t&&typeof t.mergeArray=="function"?t.mergeArray({clone:g,deepmerge:m,getKeys:a,isMergeableObject:l}):s;function g(C){return l(C)?Array.isArray(C)?r(C):n(C):C}function p(C,S){let b={},y=a(C),A=a(S),E,v,B;for(E=0,v=y.length;E<v;++E)e(B=y[E])&&A.indexOf(B)===-1&&(b[B]=g(C[B]));for(E=0,v=A.length;E<v;++E)e(B=A[E])&&(B in C&&(y.indexOf(B)!==-1&&(b[B]=m(C[B],S[B])),!0)||(b[B]=g(S[B])));return b}function m(C,S){let b=Array.isArray(S),y=Array.isArray(C);return u(S)?S:d(C)?g(S):b&&y?f(C,S):b!==y?g(S):p(C,S)}function I(){switch(arguments.length){case 0:return{};case 1:return g(arguments[0]);case 2:return m(arguments[0],arguments[1])}let C;for(let S=0,b=arguments.length;S<b;++S)C=m(C,arguments[S]);return C}return t&&t.all?I:m}Kg.exports=M0;Kg.exports.default=M0;Kg.exports.deepmerge=M0});var L1=h((sNe,x1)=>{"use strict";var k1=pa(),Goe=Symbol.for("json-schema-ref"),K0=class{#e;#t;#n;#s;#i;constructor(e={}){this.#e={},this.#t={},this.#n=e.insertRefSymbol??!1,this.#s=e.allowEqualDuplicates??!0,this.#i=e.cloneSchemaWithoutRefs??!1}addSchema(e,r){e.$id!==void 0&&e.$id.charAt(0)!=="#"?r=e.$id:this.#l(e,r),this.#a(e,r)}getSchema(e,r="#"){let n=this.#e[e];if(n===void 0)throw new Error(`Cannot resolve ref "${e}${r}". Schema with id "${e}" is not found.`);return n.anchors[r]!==void 0?n.anchors[r]:F1(n.schema,r)}hasSchema(e){return this.#e[e]!==void 0}getSchemaRefs(e){let r=this.#e[e];if(r===void 0)throw new Error(`Schema with id "${e}" is not found.`);return r.refs}getSchemaDependencies(e,r={}){let n=this.#e[e];for(let s of n.refs){let i=s.schemaId;r[i]===void 0&&(r[i]=this.getSchema(i),this.getSchemaDependencies(i,r))}return r}derefSchema(e){if(this.#t[e]!==void 0)return;let r=this.#e[e];if(r===void 0)throw new Error(`Schema with id "${e}" is not found.`);!this.#i&&r.refs.length===0&&(this.#t[e]={schema:r.schema,anchors:r.anchors});let n=[];this.#r(r.schema,e,n);let s=this.getSchemaDependencies(e);for(let i in s){let o=s[i];this.#r(o,i,n)}for(let i of n){let{refSchemaId:o,refJsonPointer:a}=this.#o(i.ref,i.sourceSchemaId),c=this.getDerefSchema(o,a);if(c===null)throw new Error(`Cannot resolve ref "${i.ref}". Ref "${a}" is not found in schema "${o}".`);i.targetSchema=c,i.targetSchemaId=o}for(let i of n)this.#c(i,n)}getDerefSchema(e,r="#"){let n=this.#t[e];return n===void 0&&(this.derefSchema(e),n=this.#t[e]),n.anchors[r]!==void 0?n.anchors[r]:F1(n.schema,r)}#o(e,r){let n=e.indexOf("#");return n===-1?{refSchemaId:e,refJsonPointer:"#"}:n===0?{refSchemaId:r,refJsonPointer:e}:{refSchemaId:e.slice(0,n),refJsonPointer:e.slice(n)}}#a(e,r){let n=e.$id;n!==void 0&&typeof n=="string"&&(n.charAt(0)==="#"?this.#u(e,r,n):(this.#l(e,n),r=n));let s=e.$ref;if(s!==void 0&&typeof s=="string"){let{refSchemaId:i,refJsonPointer:o}=this.#o(s,r);this.#e[r].refs.push({schemaId:i,jsonPointer:o})}for(let i in e)typeof e[i]=="object"&&e[i]!==null&&this.#a(e[i],r)}#r(e,r,n=[]){let s=Array.isArray(e)?[...e]:{...e},i=s.$id;i!==void 0&&typeof i=="string"&&(i.charAt(0)==="#"?this.#f(s,r,i):(this.#d(s,i),r=i)),s.$ref!==void 0&&n.push({ref:s.$ref,sourceSchemaId:r,sourceSchema:s});for(let o in s){let a=s[o];typeof a=="object"&&a!==null&&(s[o]=this.#r(a,r,n))}return s}#c(e,r){let{sourceSchema:n,targetSchema:s}=e;if(n.$ref){if(this.#n&&(n[Goe]=n.$ref),delete n.$ref,s.$ref){let i=r.find(o=>o.sourceSchema===s);this.#c(i,r)}for(let i in s)if(i!=="$id"){if(n[i]!==void 0){if(k1(n[i],s[i]))continue;throw new Error(`Cannot resolve ref "${e.ref}". Property "${i}" is already exist in schema "${e.sourceSchemaId}".`)}n[i]=s[i]}e.isResolved=!0}}#l(e,r){let n=this.#e[r];if(n!==void 0){if(this.#s&&k1(e,n.schema))return;throw new Error(`There is already another schema with id "${r}".`)}this.#e[r]={schema:e,anchors:{},refs:[]}}#u(e,r,n){let{anchors:s}=this.#e[r];if(s[n]!==void 0)throw new Error(`There is already another anchor "${n}" in a schema "${r}".`);s[n]=e}#d(e,r){this.#t[r]===void 0&&(this.#t[r]={schema:e,anchors:{}})}#f(e,r,n){let{anchors:s}=this.#t[r];s[n]=e}};function F1(t,e){let r=e.split("/"),n=t;for(let s of r)if(!(s===""||s==="#")){if(typeof n!="object"||n===null)return null;n=n[s]}return n??null}x1.exports={RefResolver:K0}});var $1=h((iNe,J0)=>{"use strict";J0.exports=U;J0.exports.default=U;var Zoe={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},U1={enum:["array","boolean","integer","null","number","object","string"]},Y1=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Noe=hg().fullFormats.uri,D1=hg().fullFormats.regex;function Lr(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0,a=o;return typeof t=="number"&&!(t%1)&&!isNaN(t)&&isFinite(t)?o===a&&typeof t=="number"&&isFinite(t)&&(t<0||isNaN(t))?(Lr.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1):(Lr.errors=i,o===0):(Lr.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1)}var z0={validate:U};function or(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(Array.isArray(t)){if(t.length<1)return or.errors=[{instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var a=!0;let c=t.length;for(let l=0;l<c;l++){let u=o;z0.validate(t[l],{instancePath:e+"/"+l,parentData:t,parentDataProperty:l,rootData:s})||(i=i===null?z0.validate.errors:i.concat(z0.validate.errors),o=i.length);var a=u===o;if(!a)break}}}else return or.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;return or.errors=i,o===0}var X1=El().default;function U(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean")return U.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Zoe.type},message:"must be object,boolean"}],!1;if(o===0&&t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){let b=t.$id,y=o;if(o===y&&o===y)if(typeof b=="string"){if(!Y1.test(b))return U.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}else return U.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$schema!==void 0){let b=t.$schema,y=o;if(o===y&&o===y)if(typeof b=="string"){if(!Noe(b))return U.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/format",keyword:"format",params:{format:"uri"},message:'must match format "uri"'}],!1}else return U.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$ref!==void 0){let b=t.$ref,y=o;if(o===y&&o===y)if(typeof b=="string"){if(!Y1.test(b))return U.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}else return U.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$comment!==void 0){let b=o;if(typeof t.$comment!="string")return U.errors=[{instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.title!==void 0){let b=o;if(typeof t.title!="string")return U.errors=[{instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.description!==void 0){let b=o;if(typeof t.description!="string")return U.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.readOnly!==void 0){let b=o;if(typeof t.readOnly!="boolean")return U.errors=[{instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=b===o}else var a=!0;if(a){if(t.examples!==void 0){let b=o;if(o===b&&!Array.isArray(t.examples))return U.errors=[{instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=b===o}else var a=!0;if(a){if(t.multipleOf!==void 0){let b=t.multipleOf,y=o;if(o===y)if(typeof b=="number"&&isFinite(b)){if(b<=0||isNaN(b))return U.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0"}],!1}else return U.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.maximum!==void 0){let b=t.maximum,y=o;if(!(typeof b=="number"&&isFinite(b)))return U.errors=[{instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.exclusiveMaximum!==void 0){let b=t.exclusiveMaximum,y=o;if(!(typeof b=="number"&&isFinite(b)))return U.errors=[{instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.minimum!==void 0){let b=t.minimum,y=o;if(!(typeof b=="number"&&isFinite(b)))return U.errors=[{instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.exclusiveMinimum!==void 0){let b=t.exclusiveMinimum,y=o;if(!(typeof b=="number"&&isFinite(b)))return U.errors=[{instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.maxLength!==void 0){let b=t.maxLength,y=o,A=o;if(!(typeof b=="number"&&!(b%1)&&!isNaN(b)&&isFinite(b)))return U.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===A&&typeof b=="number"&&isFinite(b)&&(b<0||isNaN(b)))return U.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minLength!==void 0){let b=o;Lr(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:s})||(i=i===null?Lr.errors:i.concat(Lr.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.pattern!==void 0){let b=t.pattern,y=o;if(o===y&&o===y)if(typeof b=="string"){if(!D1(b))return U.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"'}],!1}else return U.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.additionalItems!==void 0){let b=o;U(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.items!==void 0){let b=t.items,y=o,A=o,E=!1,v=o;U(b,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var c=v===o;if(E=E||c,!E){let H=o;or(b,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?or.errors:i.concat(or.errors),o=i.length);var c=H===o;E=E||c}if(E)o=A,i!==null&&(A?i.length=A:i=null);else{let H={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[H]:i.push(H),o++,U.errors=i,!1}var a=y===o}else var a=!0;if(a){if(t.maxItems!==void 0){let b=t.maxItems,y=o,A=o;if(!(typeof b=="number"&&!(b%1)&&!isNaN(b)&&isFinite(b)))return U.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===A&&typeof b=="number"&&isFinite(b)&&(b<0||isNaN(b)))return U.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minItems!==void 0){let b=o;Lr(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:s})||(i=i===null?Lr.errors:i.concat(Lr.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.uniqueItems!==void 0){let b=o;if(typeof t.uniqueItems!="boolean")return U.errors=[{instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=b===o}else var a=!0;if(a){if(t.contains!==void 0){let b=o;U(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.maxProperties!==void 0){let b=t.maxProperties,y=o,A=o;if(!(typeof b=="number"&&!(b%1)&&!isNaN(b)&&isFinite(b)))return U.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===A&&typeof b=="number"&&isFinite(b)&&(b<0||isNaN(b)))return U.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minProperties!==void 0){let b=o;Lr(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:s})||(i=i===null?Lr.errors:i.concat(Lr.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.required!==void 0){let b=t.required,y=o;if(o===o)if(Array.isArray(b)){var l=!0;let v=b.length;for(let B=0;B<v;B++){let H=o;if(typeof b[B]!="string")return U.errors=[{instancePath:e+"/required/"+B,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=H===o;if(!l)break}if(l){let B=b.length,H;if(B>1){let R={};for(;B--;){let x=b[B];if(typeof x=="string"){if(typeof R[x]=="number"){return H=R[x],U.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:B,j:H},message:"must NOT have duplicate items (items ## "+H+" and "+B+" are identical)"}],!1;break}R[x]=B}}}}}else return U.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=y===o}else var a=!0;if(a){if(t.additionalProperties!==void 0){let b=o;U(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.definitions!==void 0){let b=t.definitions,y=o;if(o===y)if(b&&typeof b=="object"&&!Array.isArray(b))for(let E in b){let v=o;U(b[E],{instancePath:e+"/definitions/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:b,parentDataProperty:E,rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var u=v===o;if(!u)break}else return U.errors=[{instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.properties!==void 0){let b=t.properties,y=o;if(o===y)if(b&&typeof b=="object"&&!Array.isArray(b))for(let E in b){let v=o;U(b[E],{instancePath:e+"/properties/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:b,parentDataProperty:E,rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var d=v===o;if(!d)break}else return U.errors=[{instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.patternProperties!==void 0){let b=t.patternProperties,y=o;if(o===y)if(b&&typeof b=="object"&&!Array.isArray(b)){for(let E in b){let v=o;if(o===v&&typeof E=="string"&&!D1(E)){let B={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"',propertyName:E};i===null?i=[B]:i.push(B),o++}var f=v===o;if(!f){let B={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:E},message:"property name must be valid"};return i===null?i=[B]:i.push(B),o++,U.errors=i,!1;break}}if(f)for(let E in b){let v=o;U(b[E],{instancePath:e+"/patternProperties/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:b,parentDataProperty:E,rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var g=v===o;if(!g)break}}else return U.errors=[{instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.dependencies!==void 0){let b=t.dependencies,y=o;if(o===y)if(b&&typeof b=="object"&&!Array.isArray(b))for(let E in b){let v=b[E],B=o,H=o,R=!1,x=o;U(v,{instancePath:e+"/dependencies/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:b,parentDataProperty:E,rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var p=x===o;if(R=R||p,!R){let F=o;if(o===o)if(Array.isArray(v)){var m=!0;let pe=v.length;for(let $=0;$<pe;$++){let ee=o;if(typeof v[$]!="string"){let j={instancePath:e+"/dependencies/"+E.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+$,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[j]:i.push(j),o++}var m=ee===o;if(!m)break}if(m){let $=v.length,ee;if($>1){let ke={};for(;$--;){let j=v[$];if(typeof j=="string"){if(typeof ke[j]=="number"){ee=ke[j];let ot={instancePath:e+"/dependencies/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:$,j:ee},message:"must NOT have duplicate items (items ## "+ee+" and "+$+" are identical)"};i===null?i=[ot]:i.push(ot),o++;break}ke[j]=$}}}}}else{let pe={instancePath:e+"/dependencies/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[pe]:i.push(pe),o++}var p=F===o;R=R||p}if(R)o=H,i!==null&&(H?i.length=H:i=null);else{let F={instancePath:e+"/dependencies/"+E.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[F]:i.push(F),o++,U.errors=i,!1}var I=B===o;if(!I)break}else return U.errors=[{instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.propertyNames!==void 0){let b=o;U(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.enum!==void 0){let b=t.enum,y=o;if(o===y)if(Array.isArray(b)){if(b.length<1)return U.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let E=b.length,v;if(E>1){e:for(;E--;)for(v=E;v--;)if(X1(b[E],b[v])){return U.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:E,j:v},message:"must NOT have duplicate items (items ## "+v+" and "+E+" are identical)"}],!1;break e}}}}else return U.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=y===o}else var a=!0;if(a){if(t.type!==void 0){let b=t.type,y=o,A=o,E=!1,v=o;if(!(b==="array"||b==="boolean"||b==="integer"||b==="null"||b==="number"||b==="object"||b==="string")){let H={instancePath:e+"/type",schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:U1.enum},message:"must be equal to one of the allowed values"};i===null?i=[H]:i.push(H),o++}var C=v===o;if(E=E||C,!E){let H=o;if(o===H)if(Array.isArray(b))if(b.length<1){let x={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};i===null?i=[x]:i.push(x),o++}else{var S=!0;let x=b.length;for(let F=0;F<x;F++){let L=b[F],ie=o;if(!(L==="array"||L==="boolean"||L==="integer"||L==="null"||L==="number"||L==="object"||L==="string")){let $={instancePath:e+"/type/"+F,schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:U1.enum},message:"must be equal to one of the allowed values"};i===null?i=[$]:i.push($),o++}var S=ie===o;if(!S)break}if(S){let F=b.length,L;if(F>1){e:for(;F--;)for(L=F;L--;)if(X1(b[F],b[L])){let ie={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:F,j:L},message:"must NOT have duplicate items (items ## "+L+" and "+F+" are identical)"};i===null?i=[ie]:i.push(ie),o++;break e}}}}else{let x={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[x]:i.push(x),o++}var C=H===o;E=E||C}if(E)o=A,i!==null&&(A?i.length=A:i=null);else{let H={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[H]:i.push(H),o++,U.errors=i,!1}var a=y===o}else var a=!0;if(a){if(t.format!==void 0){let b=o;if(typeof t.format!="string")return U.errors=[{instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.contentMediaType!==void 0){let b=o;if(typeof t.contentMediaType!="string")return U.errors=[{instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.contentEncoding!==void 0){let b=o;if(typeof t.contentEncoding!="string")return U.errors=[{instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=b===o}else var a=!0;if(a){if(t.if!==void 0){let b=o;U(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.then!==void 0){let b=o;U(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.else!==void 0){let b=o;U(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.allOf!==void 0){let b=o;or(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:s})||(i=i===null?or.errors:i.concat(or.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.anyOf!==void 0){let b=o;or(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:s})||(i=i===null?or.errors:i.concat(or.errors),o=i.length);var a=b===o}else var a=!0;if(a){if(t.oneOf!==void 0){let b=o;or(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:s})||(i=i===null?or.errors:i.concat(or.errors),o=i.length);var a=b===o}else var a=!0;if(a)if(t.not!==void 0){let b=o;U(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:s})||(i=i===null?U.errors:i.concat(U.errors),o=i.length);var a=b===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return U.errors=i,o===0}});var q1=h((oNe,j1)=>{"use strict";var Q0=class t{constructor(e,r,n="#"){this.schema=e,this.schemaId=r,this.jsonPointer=n,this.mergedSchemaId=null}getPropertyLocation(e){let r=new t(this.schema[e],this.schemaId,this.jsonPointer+"/"+e);return this.mergedSchemaId!==null&&r.addMergedSchema(this.schema[e],this.mergedSchemaId,this.jsonPointer+"/"+e),r}getSchemaId(){return this.mergedSchemaId||this.schemaId}getOriginSchemaId(){return this.schemaId}getSchemaRef(){return this.getSchemaId()+this.jsonPointer}addMergedSchema(e,r,n="#"){this.schema=e,this.mergedSchemaId=r,this.jsonPointer=n}};j1.exports=Q0});var a2=h((aNe,Wa)=>{"use strict";var eS=P1()(),Voe=rl()({proto:!0}),{randomUUID:z1}=require("crypto"),{RefResolver:Hoe}=L1(),M1=$1(),Woe=nb(),Ooe=MC(),J1=q1(),Poe=/'/g,zg=2e4,Q1="default",koe=["floor","ceil","round","trunc"],e2=["default","json-stringify"],Va="!addComma && (addComma = true) || (json += ',')";function tS(t,e){if(!M1(t)){e?e=`"${e}" `:e="";let r=M1.errors[0],n=new Error(`${e}schema is invalid: data${r.instancePath} ${r.message}`);throw n.errors=tS.errors,n}}function Ha(t,e,r){let n=r.indexOf("#");n===-1&&(n=r.length);let s=r.slice(0,n)||e.getOriginSchemaId(),i=r.slice(n)||"#",o=t.refResolver.getSchema(s,i);if(o===null)throw new Error(`Cannot find reference "${r}"`);let a=new J1(o,s,i);return o.$ref!==void 0?Ha(t,a,o.$ref):a}function K1(t,e){return t.$id&&t.$id.charAt(0)!=="#"?t.$id:e}function rS(t,e){tS(t),e=e||{};let r={functions:[],functionsCounter:0,functionsNamesBySchema:new Map,options:e,wrapObjects:!0,refResolver:new Hoe,rootSchemaId:t.$id||z1(),validatorSchemasIds:new Set},n=K1(t,r.rootSchemaId);if(r.refResolver.hasSchema(n)||r.refResolver.addSchema(t,r.rootSchemaId),e.schema)for(let u in e.schema){let d=e.schema[u],f=K1(d,u);r.refResolver.hasSchema(f)||(tS(d,u),r.refResolver.addSchema(d,u))}if(e.rounding&&!koe.includes(e.rounding))throw new Error(`Unsupported integer rounding method ${e.rounding}`);if(e.largeArrayMechanism)if(e2.includes(e.largeArrayMechanism))Q1=e.largeArrayMechanism;else throw new Error(`Unsupported large array mechanism ${e.largeArrayMechanism}`);if(e.largeArraySize)if(typeof e.largeArraySize=="string"&&Number.isFinite(Number.parseInt(e.largeArraySize,10)))zg=Number.parseInt(e.largeArraySize,10);else if(typeof e.largeArraySize=="number"&&Number.isInteger(e.largeArraySize))zg=e.largeArraySize;else if(typeof e.largeArraySize=="bigint")zg=Number(e.largeArraySize);else throw new Error(`Unsupported large array size. Expected integer-like, got ${typeof e.largeArraySize} with value ${e.largeArraySize}`);let s=new J1(t,r.rootSchemaId),i=Gn(r,s,"input"),o;i==="json += anonymous0(input)"?o=`
    ${r.functions.join(`
`)}
    const main = anonymous0
    return main
    `:o=`
    function main (input) {
      let json = ''
      ${i}
      return json
    }
    ${r.functions.join(`
`)}
    return main
    `;let a=new Woe(e),c=new Ooe(e.ajv);for(let u of r.validatorSchemasIds){let d=r.refResolver.getSchema(u);c.addSchema(d,u);let f=r.refResolver.getSchemaDependencies(u);for(let[g,p]of Object.entries(f))c.addSchema(p,g)}if(e.debugMode&&(e.mode="debug"),e.mode==="debug")return{validator:c,serializer:a,code:`validator
serializer
${o}`,ajv:c.ajv};let l=new Function("validator","serializer",o);return e.mode==="standalone"?zC()(l,r,a,c):l(c,a)}var Foe=["properties","required","additionalProperties","patternProperties","maxProperties","minProperties","dependencies"],xoe=["items","additionalItems","maxItems","minItems","uniqueItems","contains"],Loe=["maxLength","minLength","pattern"],Uoe=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum"];function t2(t){for(var e of Foe)if(e in t)return"object";for(var e of xoe)if(e in t)return"array";for(var e of Loe)if(e in t)return"string";for(var e of Uoe)if(e in t)return"number";return t.type}function Yoe(t,e){let r=e.schema,n=Object.keys(r.properties||{}),s=`
    const propertiesKeys = ${JSON.stringify(n)}
    for (const [key, value] of Object.entries(obj)) {
      if (
        propertiesKeys.includes(key) ||
        value === undefined ||
        typeof value === 'function' ||
        typeof value === 'symbol'
      ) continue
  `,i=e.getPropertyLocation("patternProperties"),o=i.schema;if(o!==void 0)for(let l in o){let u=i.getPropertyLocation(l);s+=`
        if (/${l.replace(/\\*\//g,"\\/")}/.test(key)) {
          ${Va}
          json += serializer.asString(key) + ':'
          ${Gn(t,u,"value")}
          continue
        }
      `}let c=e.getPropertyLocation("additionalProperties").schema;if(c!==void 0)if(c===!0)s+=`
        ${Va}
        json += serializer.asString(key) + ':' + JSON.stringify(value)
      `;else{let l=e.getPropertyLocation("additionalProperties");s+=`
        ${Va}
        json += serializer.asString(key) + ':'
        ${Gn(t,l,"value")}
      `}return s+=`
    }
  `,s}function Doe(t,e){let r="",n=e.schema,s=n.required||[],i=e.getPropertyLocation("properties"),o=[],a=[];if(n.properties)for(let l of Object.keys(n.properties)){if(s.indexOf(l)===-1)continue;let u=i.getPropertyLocation(l);u.schema.$ref&&(u=Ha(t,e,u.schema.$ref));let d=JSON.stringify(l);u.schema.default===void 0&&(r+=`if (obj[${d}] === undefined) throw new Error('${d} is required!')
`,a.push(l)),o.push(l)}for(let l of s)o.indexOf(l)===-1&&(r+=`if (obj['${l}'] === undefined) throw new Error('"${l}" is required!')
`);r+=`
    let addComma = false
    let json = '${t.wrapObjects?"{":""}'
  `;let c=t.wrapObjects;if(t.wrapObjects=!0,n.properties)for(let l of Object.keys(n.properties)){let u=i.getPropertyLocation(l);u.schema.$ref&&(u=Ha(t,e,u.schema.$ref));let d=JSON.stringify(l);if(a.indexOf(l)!==-1)r+=`
        ${Va}
        json += ${JSON.stringify(d+":")}
        ${Gn(t,u,`obj[${d}]`)}
      `;else{r+=`
        if (obj[${d}] !== undefined) {
          ${Va}
          json += ${JSON.stringify(d+":")}
          ${Gn(t,u,`obj[${d}]`)}
        }
        `;let f=u.schema.default;f!==void 0&&(r+=`
        else {
          ${Va}
          json += ${JSON.stringify(d+":"+JSON.stringify(f))}
        }
        `)}}return(n.patternProperties||n.additionalProperties)&&(r+=Yoe(t,e)),t.wrapObjects=c,r+=`
  return json${t.wrapObjects?" + '}'":""}
  `,r}function r2(t,e,r,n){let s=e.getPropertyLocation("allOf");for(let i=0;i<r.allOf.length;i++){let o=r.allOf[i];if(o.$ref){let c=s.getPropertyLocation(i);o=Ha(t,c,o.$ref).schema}let a=o.type;if(a===void 0&&(a=t2(o)),a!==void 0){if(n.type!==void 0&&n.type!==a)throw new Error("allOf schemas have different type values");n.type=a}if(o.format!==void 0){if(n.format!==void 0&&n.format!==o.format)throw new Error("allOf schemas have different format values");n.format=o.format}if(o.nullable!==void 0){if(n.nullable!==void 0&&n.nullable!==o.nullable)throw new Error("allOf schemas have different nullable values");n.nullable=o.nullable}o.properties!==void 0&&(n.properties===void 0&&(n.properties={}),Object.assign(n.properties,o.properties)),o.additionalProperties!==void 0&&(n.additionalProperties===void 0&&(n.additionalProperties={}),Object.assign(n.additionalProperties,o.additionalProperties)),o.patternProperties!==void 0&&(n.patternProperties===void 0&&(n.patternProperties={}),Object.assign(n.patternProperties,o.patternProperties)),o.required!==void 0&&(n.required===void 0&&(n.required=[]),n.required.push(...o.required)),o.oneOf!==void 0&&(n.oneOf===void 0&&(n.oneOf=[]),n.oneOf.push(...o.oneOf)),o.anyOf!==void 0&&(n.anyOf===void 0&&(n.anyOf=[]),n.anyOf.push(...o.anyOf)),o.allOf!==void 0&&r2(t,e,o,n)}delete n.allOf,n.$id=`merged_${z1()}`,t.refResolver.addSchema(n),e.addMergedSchema(n,n.$id)}function Xoe(t,e,r){t.validatorSchemasIds.add(e.getSchemaId());let n=eS({},e.schema),s=n.then,i=n.else||{additionalProperties:!0};delete n.if,delete n.then,delete n.else;let a=e.getPropertyLocation("if").getSchemaRef(),c=e.getPropertyLocation("then");c.schema=eS(n,s);let l=e.getPropertyLocation("else");return l.schema=eS(n,i),`
    if (validator.validate("${a}", ${r})) {
      ${Gn(t,c,r)}
    } else {
      ${Gn(t,l,r)}
    }
  `}function $oe(t){return`(${t} && typeof ${t}.toJSON === 'function')
    ? ${t}.toJSON()
    : ${t}
  `}function n2(t,e){let r=e.schema;if(t.functionsNamesBySchema.has(r))return t.functionsNamesBySchema.get(r);let n=i2(t);t.functionsNamesBySchema.set(r,n);let s=e.getSchemaRef();s.startsWith(t.rootSchemaId)&&(s=s.replace(t.rootSchemaId,""));let i=`
  `;return i+=`
    // ${s}
    function ${n} (input) {
      const obj = ${$oe("input")}
      ${Doe(t,e)}
    }
  `,t.functions.push(i),n}function joe(t,e){let r=e.schema,n=e.getPropertyLocation("items");n.schema=n.schema||{},n.schema.$ref&&(n=Ha(t,n,n.schema.$ref));let s=n.schema;if(t.functionsNamesBySchema.has(r))return t.functionsNamesBySchema.get(r);let i=i2(t);t.functionsNamesBySchema.set(r,i);let o=e.getSchemaRef();o.startsWith(t.rootSchemaId)&&(o=o.replace(t.rootSchemaId,""));let a=`
    function ${i} (obj) {
      // ${o}
  `;if(a+=`
    if (!Array.isArray(obj)) {
      throw new TypeError(\`The value of '${o}' does not match schema definition.\`)
    }
    const arrayLength = obj.length
  `,!r.additionalItems&&Array.isArray(s)&&(a+=`
      if (arrayLength > ${s.length}) {
        throw new Error(\`Item at ${s.length} does not match schema definition.\`)
      }
    `),Q1==="json-stringify"&&(a+=`if (arrayLength && arrayLength >= ${zg}) return JSON.stringify(obj)
`),a+=`
    let jsonOutput = ''
  `,Array.isArray(s)){for(let c=0;c<s.length;c++){let l=s[c],u=Gn(t,n.getPropertyLocation(c),`obj[${c}]`);a+=`
        if (${c} < arrayLength) {
          if (${s2(l.type,`[${c}]`)}) {
            let json = ''
            ${u}
            jsonOutput += json
            if (${c} < arrayLength - 1) {
              jsonOutput += ','
            }
          } else {
            throw new Error(\`Item at ${c} does not match schema definition.\`)
          }
        }
        `}r.additionalItems&&(a+=`
        for (let i = ${s.length}; i < arrayLength; i++) {
          jsonOutput += JSON.stringify(obj[i])
          if (i < arrayLength - 1) {
            jsonOutput += ','
          }
        }`)}else{let c=Gn(t,n,"obj[i]");a+=`
      for (let i = 0; i < arrayLength; i++) {
        let json = ''
        ${c}
        jsonOutput += json
        if (i < arrayLength - 1) {
          jsonOutput += ','
        }
      }`}return a+="\n    return `[${jsonOutput}]`\n  }",t.functions.push(a),i}function s2(t,e){let r;switch(t){case"null":r=`obj${e} === null`;break;case"string":r=`typeof obj${e} === 'string'`;break;case"integer":r=`Number.isInteger(obj${e})`;break;case"number":r=`Number.isFinite(obj${e})`;break;case"boolean":r=`typeof obj${e} === 'boolean'`;break;case"object":r=`obj${e} && typeof obj${e} === 'object' && obj${e}.constructor === Object`;break;case"array":r=`Array.isArray(obj${e})`;break;default:Array.isArray(t)&&(r=`(${t.map(s=>s2(s,e)).join(" || ")})`)}return r}function i2(t){return"anonymous"+t.functionsCounter++}function qoe(t,e,r){let s=e.schema.type.sort(a=>a==="null"?-1:1),i="";s.forEach((a,c)=>{e.schema={...e.schema,type:a};let l=o2(t,e,r),u=c===0?"if":"else if";switch(a){case"null":i+=`
          ${u} (${r} === null)
            ${l}
          `;break;case"string":{i+=`
          ${u}(
            typeof ${r} === "string" ||
            ${r} === null ||
            ${r} instanceof Date ||
            ${r} instanceof RegExp ||
            (
              typeof ${r} === "object" &&
              typeof ${r}.toString === "function" &&
              ${r}.toString !== Object.prototype.toString &&
              !(${r} instanceof Date)
            )
          )
            ${l}
        `;break}case"array":{i+=`
          ${u}(Array.isArray(${r}))
            ${l}
        `;break}case"integer":{i+=`
          ${u}(Number.isInteger(${r}) || ${r} === null)
            ${l}
        `;break}default:{i+=`
          ${u}(typeof ${r} === "${a}" || ${r} === null)
            ${l}
        `;break}}});let o=e.getSchemaRef();return o.startsWith(t.rootSchemaId)&&(o=o.replace(t.rootSchemaId,"")),i+=`
    else throw new TypeError(\`The value of '${o}' does not match schema definition.\`)
  `,i}function o2(t,e,r){let n=e.schema;switch(n.type){case"null":return"json += 'null'";case"string":return n.format==="date-time"?`json += serializer.asDateTime(${r})`:n.format==="date"?`json += serializer.asDate(${r})`:n.format==="time"?`json += serializer.asTime(${r})`:`json += serializer.asString(${r})`;case"integer":return`json += serializer.asInteger(${r})`;case"number":return`json += serializer.asNumber(${r})`;case"boolean":return`json += serializer.asBoolean(${r})`;case"object":return`json += ${n2(t,e)}(${r})`;case"array":return`json += ${joe(t,e)}(${r})`;case void 0:return`json += JSON.stringify(${r})`;default:throw new Error(`${n.type} unsupported`)}}function Moe(t,e){let r=t.schema,n=r.type,s=Array.isArray(n)&&n.includes("null"),i="";return s&&(i+=`
      if (${e} === null) {
        json += 'null'
      } else {
    `),i+=`json += '${JSON.stringify(r.const).replace(Poe,"\\'")}'`,s&&(i+=`
      }
    `),i}function Gn(t,e,r){let n=e.schema;if(typeof n=="boolean")return`json += JSON.stringify(${r})`;if(n.$ref&&(e=Ha(t,e,n.$ref),n=e.schema),n.type===void 0){let a=t2(n);a&&(n.type=a)}if(n.if&&n.then)return Xoe(t,e,r);n.allOf&&(r2(t,e,n,Voe(n)),n=e.schema);let s=n.type,i="";if((s===void 0||s==="object")&&(n.anyOf||n.oneOf)){if(t.validatorSchemasIds.add(e.getSchemaId()),n.type==="object"){t.wrapObjects=!1;let u=n2(t,e);i+=`
        json += '{'
        json += ${u}(${r})
        json += ','
      `}let a=n.anyOf?"anyOf":"oneOf",c=e.getPropertyLocation(a);for(let u=0;u<e.schema[a].length;u++){let d=c.getPropertyLocation(u),f=d.getSchemaRef(),g=Gn(t,d,r);i+=`
        ${u===0?"if":"else if"}(validator.validate("${f}", ${r}))
          ${g}
      `}let l=e.getSchemaRef();return l.startsWith(t.rootSchemaId)&&(l=l.replace(t.rootSchemaId,"")),i+=`
      else throw new TypeError(\`The value of '${l}' does not match schema definition.\`)
    `,n.type==="object"&&(i+=`
        json += '}'
      `,t.wrapObjects=!0),i}let o=n.nullable===!0;return o&&(i+=`
      if (${r} === null) {
        json += 'null'
      } else {
    `),n.const!==void 0?i+=Moe(e,r):Array.isArray(s)?i+=qoe(t,e,r):i+=o2(t,e,r),o&&(i+=`
      }
    `),i}Wa.exports=rS;Wa.exports.default=rS;Wa.exports.build=rS;Wa.exports.validLargeArrayMechanisms=e2;Wa.exports.restore=function({code:t,validator:e,serializer:r}){return Function.apply(null,["validator","serializer",t]).apply(null,[e,r])}});var l2=h((cNe,nS)=>{"use strict";var Koe=sS();function c2(t={readMode:!0}){if(t.readMode===!0&&typeof t.restoreFunction!="function")throw new Error("You must provide a function for the restoreFunction-option when readMode ON");if(t.readMode!==!0&&typeof t.storeFunction!="function")throw new Error("You must provide a function for the storeFunction-option when readMode OFF");if(t.readMode===!0)return function(){return function(n){return t.restoreFunction(n)}};let e=Koe();return function(n,s={}){s.mode="standalone";let i=e(n,s);return function(o){let a=i(o);return t.storeFunction(o,a),new Function(a)}}}nS.exports=c2;nS.exports.default=c2});var sS=h((lNe,Jl)=>{"use strict";var zoe=a2();function iS(){return function(e,r){let n=Object.assign({},r,{schema:e});return Joe.bind(null,n)}}function Joe(t,{schema:e}){return t.schema&&e.$id&&t.schema[e.$id]&&(t.schema={...t.schema},delete t.schema[e.$id]),zoe(e,t)}Jl.exports=iS;Jl.exports.default=iS;Jl.exports.SerializerSelector=iS;Jl.exports.StandaloneSerializer=l2()});var ms=h(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.checkMetadata=void 0;var Qoe=de(),eae={keyword:"metadata",schemaType:"object",code(t){u2(t);let{gen:e,schema:r,it:n}=t;if((0,Qoe.alwaysValidSchema)(n,r))return;let s=e.name("valid");t.subschema({keyword:"metadata",jtdMetadata:!0},s),t.ok(s)}};function u2({it:t,keyword:e},r){if(t.jtdMetadata!==r)throw new Error(`JTD: "${e}" cannot be used in this schema location`)}Ql.checkMetadata=u2;Ql.default=eae});var Jg=h(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.hasRef=void 0;var d2=so(),eu=ne(),tae=si(),f2=Or(),g2=qb(),rae=ms(),nae={keyword:"ref",schemaType:"string",code(t){(0,rae.checkMetadata)(t);let{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{schemaEnv:{root:o}}=i,a=e.name("valid");s.nullable?(e.var(a,(0,eu._)`${r} === null`),e.if((0,eu.not)(a),c)):(e.var(a,!1),c()),t.ok(a);function c(){var d;let f=(d=o.schema.definitions)===null||d===void 0?void 0:d[n];if(!f)throw new tae.default(i.opts.uriResolver,"",n,`No definition ${n}`);oS(f)||!i.opts.inlineRefs?l(f):u(f)}function l(d){let f=d2.compileSchema.call(i.self,new d2.SchemaEnv({schema:d,root:o,schemaPath:`/definitions/${n}`})),g=(0,g2.getValidate)(t,f),p=e.const("_errs",f2.default.errors);(0,g2.callRef)(t,g,f,f.$async),e.assign(a,(0,eu._)`${p} === ${f2.default.errors}`)}function u(d){let f=e.scopeValue("schema",i.opts.code.source===!0?{ref:d,code:(0,eu.stringify)(d)}:{ref:d});t.subschema({schema:d,dataTypes:[],schemaPath:eu.nil,topSchemaRef:f,errSchemaPath:`/definitions/${n}`},a)}}};function oS(t){for(let e in t){let r;if(e==="ref"||typeof(r=t[e])=="object"&&oS(r))return!0}return!1}tu.hasRef=oS;tu.default=nae});var cS=h(aS=>{"use strict";Object.defineProperty(aS,"__esModule",{value:!0});var sae=/t|\s/i,iae=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,oae=/^(\d\d):(\d\d):(\d\d)(?:\.\d+)?(?:z|([+-]\d\d)(?::?(\d\d))?)$/i,aae=[0,31,28,31,30,31,30,31,31,30,31,30,31];function h2(t,e){let r=t.split(sae);return r.length===2&&p2(r[0])&&cae(r[1])||e&&r.length===1&&p2(r[0])}aS.default=h2;function p2(t){let e=iae.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&(s<=aae[n]||n===2&&s===29&&(r%100===0?r%400===0:r%4===0))}function cae(t){let e=oae.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],s=+e[3],i=+(e[4]||0),o=+(e[5]||0);return r<=23&&n<=59&&s<=59||r-i===23&&n-o===59&&s===60}h2.code='require("ajv/dist/runtime/timestamp").default'});var Oa=h(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.typeErrorParams=li.typeErrorMessage=li.typeError=void 0;var lae=ne();function uae(t){return{message:e=>m2(e,t),params:e=>y2(e,t)}}li.typeError=uae;function m2({parentSchema:t},e){return t?.nullable?`must be ${e} or null`:`must be ${e}`}li.typeErrorMessage=m2;function y2({parentSchema:t},e){return(0,lae._)`{type: ${e}, nullable: ${!!t?.nullable}}`}li.typeErrorParams=y2});var lS=h(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});Pa.intRange=void 0;var Rr=ne(),dae=cS(),fae=de(),gae=ms(),I2=Oa();Pa.intRange={int8:[-128,127,3],uint8:[0,255,3],int16:[-32768,32767,5],uint16:[0,65535,5],int32:[-2147483648,2147483647,10],uint32:[0,4294967295,10]};var pae={message:t=>(0,I2.typeErrorMessage)(t,t.schema),params:t=>(0,I2.typeErrorParams)(t,t.schema)};function hae(t){let{gen:e,data:r,it:n}=t,{timestamp:s,allowDate:i}=n.opts;if(s==="date")return(0,Rr._)`${r} instanceof Date `;let o=(0,fae.useFunc)(e,dae.default),a=i?(0,Rr._)`, true`:Rr.nil,c=(0,Rr._)`typeof ${r} == "string" && ${o}(${r}${a})`;return s==="string"?c:(0,Rr.or)((0,Rr._)`${r} instanceof Date`,c)}var mae={keyword:"type",schemaType:"string",error:pae,code(t){(0,gae.checkMetadata)(t);let{data:e,schema:r,parentSchema:n,it:s}=t,i;switch(r){case"boolean":case"string":i=(0,Rr._)`typeof ${e} == ${r}`;break;case"timestamp":{i=hae(t);break}case"float32":case"float64":i=(0,Rr._)`typeof ${e} == "number"`;break;default:{let o=r;if(i=(0,Rr._)`typeof ${e} == "number" && isFinite(${e}) && !(${e} % 1)`,!s.opts.int32range&&(o==="int32"||o==="uint32"))o==="uint32"&&(i=(0,Rr._)`${i} && ${e} >= 0`);else{let[a,c]=Pa.intRange[o];i=(0,Rr._)`${i} && ${e} >= ${a} && ${e} <= ${c}`}}}t.pass(n.nullable?(0,Rr.or)((0,Rr._)`${e} === null`,i):i)}};Pa.default=mae});var Fa=h(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.checkNullableObject=ka.checkNullable=void 0;var Qg=ne();function b2({gen:t,data:e,parentSchema:r},n=Qg.nil){let s=t.name("valid");return r.nullable?(t.let(s,(0,Qg._)`${e} === null`),n=(0,Qg.not)(s)):t.let(s,!1),[s,n]}ka.checkNullable=b2;function yae(t,e){let[r,n]=b2(t,e);return[r,(0,Qg._)`${n} && typeof ${t.data} == "object" && !Array.isArray(${t.data})`]}ka.checkNullableObject=yae});var C2=h(uS=>{"use strict";Object.defineProperty(uS,"__esModule",{value:!0});var ui=ne(),Iae=ms(),bae=Fa(),Cae={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ui._)`{allowedValues: ${t}}`},Sae={keyword:"enum",schemaType:"array",error:Cae,code(t){(0,Iae.checkMetadata)(t);let{gen:e,data:r,schema:n,schemaValue:s,parentSchema:i,it:o}=t;if(n.length===0)throw new Error("enum must have non-empty array");if(n.length!==new Set(n).size)throw new Error("enum items must be unique");let a,c=(0,ui._)`typeof ${r} == "string"`;if(n.length>=o.opts.loopEnum){let u;[a,u]=(0,bae.checkNullable)(t,c),e.if(u,l)}else{if(!Array.isArray(n))throw new Error("ajv implementation error");a=(0,ui.and)(c,(0,ui.or)(...n.map(u=>(0,ui._)`${r} === ${u}`))),i.nullable&&(a=(0,ui.or)((0,ui._)`${r} === null`,a))}t.pass(a);function l(){e.forOf("v",s,u=>e.if((0,ui._)`${a} = ${r} === ${u}`,()=>e.break()))}}};uS.default=Sae});var v2=h(dS=>{"use strict";Object.defineProperty(dS,"__esModule",{value:!0});var vae=de(),_ae=Pt(),S2=ne(),Aae=ms(),Rae=Fa(),Eae=Oa(),wae={keyword:"elements",schemaType:"object",error:(0,Eae.typeError)("array"),code(t){(0,Aae.checkMetadata)(t);let{gen:e,data:r,schema:n,it:s}=t;if((0,vae.alwaysValidSchema)(s,n))return;let[i]=(0,Rae.checkNullable)(t);e.if((0,S2.not)(i),()=>e.if((0,S2._)`Array.isArray(${r})`,()=>e.assign(i,(0,_ae.validateArray)(t)),()=>t.error())),t.ok(i)}};dS.default=wae});var gS=h(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.validateProperties=di.error=void 0;var fS=Pt(),_2=de(),ys=ne(),Bae=ms(),Tae=Fa(),A2=Oa(),xa;(function(t){t.Additional="additional",t.Missing="missing"})(xa||(xa={}));di.error={message:t=>{let{params:e}=t;return e.propError?e.propError===xa.Additional?"must NOT have additional properties":`must have property '${e.missingProperty}'`:(0,A2.typeErrorMessage)(t,"object")},params:t=>{let{params:e}=t;return e.propError?e.propError===xa.Additional?(0,ys._)`{error: ${e.propError}, additionalProperty: ${e.additionalProperty}}`:(0,ys._)`{error: ${e.propError}, missingProperty: ${e.missingProperty}}`:(0,A2.typeErrorParams)(t,"object")}};var Gae={keyword:"properties",schemaType:"object",error:di.error,code:R2};function R2(t){(0,Bae.checkMetadata)(t);let{gen:e,data:r,parentSchema:n,it:s}=t,{additionalProperties:i,nullable:o}=n;if(s.jtdDiscriminator&&o)throw new Error("JTD: nullable inside discriminator mapping");if(g())throw new Error("JTD: properties and optionalProperties have common members");let[a,c]=p("properties"),[l,u]=p("optionalProperties");if(c.length===0&&u.length===0&&i)return;let[d,f]=s.jtdDiscriminator===void 0?(0,Tae.checkNullableObject)(t,r):[e.let("valid",!1),!0];e.if(f,()=>e.assign(d,!0).block(()=>{m(c,"properties",!0),m(u,"optionalProperties"),i||C()})),t.pass(d);function g(){let b=n.properties,y=n.optionalProperties;if(!(b&&y))return!1;for(let A in b)if(Object.prototype.hasOwnProperty.call(y,A))return!0;return!1}function p(b){let y=n[b],A=y?(0,fS.allSchemaProperties)(y):[];if(s.jtdDiscriminator&&A.some(v=>v===s.jtdDiscriminator))throw new Error(`JTD: discriminator tag used in ${b}`);let E=A.filter(v=>!(0,_2.alwaysValidSchema)(s,y[v]));return[A,E]}function m(b,y,A){let E=e.var("valid");for(let B of b)e.if((0,fS.propertyInData)(e,r,B,s.opts.ownProperties),()=>I(B,y,E),()=>v(B)),t.ok(E);function v(B){A?(e.assign(E,!1),t.error(!1,{propError:xa.Missing,missingProperty:B},{schemaPath:B})):e.assign(E,!0)}}function I(b,y,A){t.subschema({keyword:y,schemaProp:b,dataProp:b},A)}function C(){e.forIn("key",r,b=>{let y=S(b,a,"properties",s.jtdDiscriminator),A=S(b,l,"optionalProperties"),E=y===!0?A:A===!0?y:(0,ys.and)(y,A);e.if(E,()=>{s.opts.removeAdditional?e.code((0,ys._)`delete ${r}[${b}]`):(t.error(!1,{propError:xa.Additional,additionalProperty:b},{instancePath:b,parentSchema:!0}),s.opts.allErrors||e.break())})})}function S(b,y,A,E){let v;if(y.length>8){let B=(0,_2.schemaRefOrVal)(s,n[A],A);v=(0,ys.not)((0,fS.isOwnProperty)(e,B,b)),E!==void 0&&(v=(0,ys.and)(v,(0,ys._)`${b} !== ${E}`))}else if(y.length||E!==void 0){let B=E===void 0?y:[E].concat(y);v=(0,ys.and)(...B.map(H=>(0,ys._)`${b} !== ${H}`))}else v=!0;return v}}di.validateProperties=R2;di.default=Gae});var w2=h(pS=>{"use strict";Object.defineProperty(pS,"__esModule",{value:!0});var E2=gS(),Zae={keyword:"optionalProperties",schemaType:"object",error:E2.error,code(t){t.parentSchema.properties||(0,E2.validateProperties)(t)}};pS.default=Zae});var T2=h(hS=>{"use strict";Object.defineProperty(hS,"__esModule",{value:!0});var ho=ne(),Nae=ms(),Vae=Fa(),B2=Oa(),ep=HC(),Hae={message:t=>{let{schema:e,params:r}=t;return r.discrError?r.discrError===ep.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in mapping`:(0,B2.typeErrorMessage)(t,"object")},params:t=>{let{schema:e,params:r}=t;return r.discrError?(0,ho._)`{error: ${r.discrError}, tag: ${e}, tagValue: ${r.tag}}`:(0,B2.typeErrorParams)(t,"object")}},Wae={keyword:"discriminator",schemaType:"string",implements:["mapping"],error:Hae,code(t){(0,Nae.checkMetadata)(t);let{gen:e,data:r,schema:n,parentSchema:s}=t,[i,o]=(0,Vae.checkNullableObject)(t,r);e.if(o),a(),e.elseIf((0,ho.not)(i)),t.error(),e.endIf(),t.ok(i);function a(){let u=e.const("tag",(0,ho._)`${r}${(0,ho.getProperty)(n)}`);e.if((0,ho._)`${u} === undefined`),t.error(!1,{discrError:ep.DiscrError.Tag,tag:u}),e.elseIf((0,ho._)`typeof ${u} == "string"`),c(u),e.else(),t.error(!1,{discrError:ep.DiscrError.Tag,tag:u},{instancePath:n}),e.endIf()}function c(u){e.if(!1);for(let d in s.mapping)e.elseIf((0,ho._)`${u} === ${d}`),e.assign(i,l(d));e.else(),t.error(!1,{discrError:ep.DiscrError.Mapping,tag:u},{instancePath:n,schemaPath:"mapping",parentSchema:!0}),e.endIf()}function l(u){let d=e.name("valid");return t.subschema({keyword:"mapping",schemaProp:u,jtdDiscriminator:n},d),d}}};hS.default=Wae});var Z2=h(mS=>{"use strict";Object.defineProperty(mS,"__esModule",{value:!0});var G2=de(),tp=ne(),Oae=ms(),Pae=Fa(),kae=Oa(),Fae={keyword:"values",schemaType:"object",error:(0,kae.typeError)("object"),code(t){(0,Oae.checkMetadata)(t);let{gen:e,data:r,schema:n,it:s}=t,[i,o]=(0,Pae.checkNullableObject)(t,r);(0,G2.alwaysValidSchema)(s,n)?e.if((0,tp.not)((0,tp.or)(o,i)),()=>t.error()):(e.if(o),e.assign(i,a()),e.elseIf((0,tp.not)(i)),t.error(),e.endIf()),t.ok(i);function a(){let c=e.name("valid");if(s.allErrors){let u=e.let("valid",!0);return l(()=>e.assign(u,!1)),u}return e.var(c,!0),l(()=>e.break()),c;function l(u){e.forIn("key",r,d=>{t.subschema({keyword:"values",dataProp:d,dataPropType:G2.Type.Str},c),e.if((0,tp.not)(c),u)})}}}};mS.default=Fae});var N2=h(yS=>{"use strict";Object.defineProperty(yS,"__esModule",{value:!0});var xae=Pt(),Lae={keyword:"union",schemaType:"array",trackErrors:!0,code:xae.validateUnion,error:{message:"must match a schema in union"}};yS.default=Lae});var V2=h(IS=>{"use strict";Object.defineProperty(IS,"__esModule",{value:!0});var Uae=Jg(),Yae=lS(),Dae=C2(),Xae=v2(),$ae=gS(),jae=w2(),qae=T2(),Mae=Z2(),Kae=N2(),zae=ms(),Jae=["definitions",Uae.default,Yae.default,Dae.default,Xae.default,$ae.default,jae.default,qae.default,Mae.default,Kae.default,zae.default,{keyword:"additionalProperties",schemaType:"boolean"},{keyword:"nullable",schemaType:"boolean"}];IS.default=Jae});var P2=h(bS=>{"use strict";Object.defineProperty(bS,"__esModule",{value:!0});var Is=t=>{let e={nullable:{type:"boolean"},metadata:{optionalProperties:{union:{elements:{ref:"schema"}}},additionalProperties:!0}};return t&&(e.definitions={values:{ref:"schema"}}),e},Qae=t=>({optionalProperties:Is(t)}),ece=t=>({properties:{ref:{type:"string"}},optionalProperties:Is(t)}),tce=t=>({properties:{type:{enum:["boolean","timestamp","string","float32","float64","int8","uint8","int16","uint16","int32","uint32"]}},optionalProperties:Is(t)}),rce=t=>({properties:{enum:{elements:{type:"string"}}},optionalProperties:Is(t)}),nce=t=>({properties:{elements:{ref:"schema"}},optionalProperties:Is(t)}),W2=t=>({properties:{properties:{values:{ref:"schema"}}},optionalProperties:{optionalProperties:{values:{ref:"schema"}},additionalProperties:{type:"boolean"},...Is(t)}}),O2=t=>({properties:{optionalProperties:{values:{ref:"schema"}}},optionalProperties:{additionalProperties:{type:"boolean"},...Is(t)}}),sce=t=>({properties:{discriminator:{type:"string"},mapping:{values:{metadata:{union:[W2(!1),O2(!1)]}}}},optionalProperties:Is(t)}),ice=t=>({properties:{values:{ref:"schema"}},optionalProperties:Is(t)}),H2=t=>({metadata:{union:[Qae,ece,tce,rce,nce,W2,O2,sce,ice].map(e=>e(t))}}),oce={definitions:{schema:H2(!1)},...H2(!0)};bS.default=oce});var CS=h(rp=>{"use strict";Object.defineProperty(rp,"__esModule",{value:!0});rp.jtdForms=void 0;rp.jtdForms=["elements","values","discriminator","properties","optionalProperties","enum","type","ref"]});var F2=h(vS=>{"use strict";Object.defineProperty(vS,"__esModule",{value:!0});var SS=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,ace={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function k2(t){return SS.lastIndex=0,'"'+(SS.test(t)?t.replace(SS,e=>{let r=ace[e];return typeof r=="string"?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):t)+'"'}vS.default=k2;k2.code='require("ajv/dist/runtime/quote").default'});var X2=h(AS=>{"use strict";Object.defineProperty(AS,"__esModule",{value:!0});var cce=CS(),L2=so(),Se=ne(),lce=si(),$e=Or(),uce=Pt(),dce=Jg(),fce=de(),gce=F2(),pce={elements:mce,values:yce,discriminator:Ice,properties:x2,optionalProperties:x2,enum:ru,type:bce,ref:Sce};function U2(t,e){let r=L2.getCompilingSchema.call(this,t);if(r)return r;let{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new Se.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i}),a=o.scopeName("serialize"),c={self:this,gen:o,schema:t.schema,schemaEnv:t,definitions:e,data:$e.default.data},l;try{this._compilations.add(t),t.serializeName=a,o.func(a,$e.default.data,!1,()=>{o.let($e.default.json,(0,Se.str)``),nu(c),o.return($e.default.json)}),o.optimize(this.opts.code.optimize);let u=o.toString();l=`${o.scopeRefs($e.default.scope)}return ${u}`;let f=new Function(`${$e.default.scope}`,l)(this.scope.get());this.scope.value(a,{ref:f}),t.serialize=f}catch(u){throw l&&this.logger.error("Error compiling serializer, function code:",l),delete t.serialize,delete t.serializeName,u}finally{this._compilations.delete(t)}return t}AS.default=U2;function nu(t){let e;for(let r of cce.jtdForms)if(r in t.schema){e=r;break}hce(t,e?pce[e]:_ce)}function hce(t,e){let{gen:r,schema:n,data:s}=t;if(!n.nullable)return e(t);r.if((0,Se._)`${s} === undefined || ${s} === null`,()=>r.add($e.default.json,(0,Se._)`"null"`),()=>e(t))}function mce(t){let{gen:e,schema:r,data:n}=t;e.add($e.default.json,(0,Se.str)`[`);let s=e.let("first",!0);e.forOf("el",n,i=>{_S(t,s),nu({...t,schema:r.elements,data:i})}),e.add($e.default.json,(0,Se.str)`]`)}function yce(t){let{gen:e,schema:r,data:n}=t;e.add($e.default.json,(0,Se.str)`{`);let s=e.let("first",!0);e.forIn("key",n,i=>Y2(t,i,r.values,s)),e.add($e.default.json,(0,Se.str)`}`)}function Y2(t,e,r,n){let{gen:s,data:i}=t;_S(t,n),ru({...t,data:e}),s.add($e.default.json,(0,Se.str)`:`);let o=s.const("value",(0,Se._)`${i}${(0,Se.getProperty)(e)}`);nu({...t,schema:r,data:o})}function Ice(t){let{gen:e,schema:r,data:n}=t,{discriminator:s}=r;e.add($e.default.json,(0,Se.str)`{${JSON.stringify(s)}:`);let i=e.const("tag",(0,Se._)`${n}${(0,Se.getProperty)(s)}`);ru({...t,data:i}),e.if(!1);for(let o in r.mapping){e.elseIf((0,Se._)`${i} === ${o}`);let a=r.mapping[o];D2({...t,schema:a},s)}e.endIf(),e.add($e.default.json,(0,Se.str)`}`)}function x2(t){let{gen:e}=t;e.add($e.default.json,(0,Se.str)`{`),D2(t),e.add($e.default.json,(0,Se.str)`}`)}function D2(t,e){let{gen:r,schema:n,data:s}=t,{properties:i,optionalProperties:o}=n,a=f(i),c=f(o),l=g(a.concat(c)),u=!e,d;for(let C of a)u?u=!1:r.add($e.default.json,(0,Se.str)`,`),m(C,i[C],p(C));u&&(d=r.let("first",!0));for(let C of c){let S=p(C);r.if((0,Se.and)((0,Se._)`${S} !== undefined`,(0,uce.isOwnProperty)(r,s,C)),()=>{_S(t,d),m(C,o[C],S)})}n.additionalProperties&&r.forIn("key",s,C=>r.if(I(C,l),()=>Y2(t,C,{},d)));function f(C){return C?Object.keys(C):[]}function g(C){if(e&&C.push(e),new Set(C).size!==C.length)throw new Error("JTD: properties/optionalProperties/disciminator overlap");return C}function p(C){return r.const("value",(0,Se._)`${s}${(0,Se.getProperty)(C)}`)}function m(C,S,b){r.add($e.default.json,(0,Se.str)`${JSON.stringify(C)}:`),nu({...t,schema:S,data:b})}function I(C,S){return S.length?(0,Se.and)(...S.map(b=>(0,Se._)`${C} !== ${b}`)):!0}}function bce(t){let{gen:e,schema:r,data:n}=t;switch(r.type){case"boolean":e.add($e.default.json,(0,Se._)`${n} ? "true" : "false"`);break;case"string":ru(t);break;case"timestamp":e.if((0,Se._)`${n} instanceof Date`,()=>e.add($e.default.json,(0,Se._)`'"' + ${n}.toISOString() + '"'`),()=>ru(t));break;default:Cce(t)}}function ru({gen:t,data:e}){t.add($e.default.json,(0,Se._)`${(0,fce.useFunc)(t,gce.default)}(${e})`)}function Cce({gen:t,data:e}){t.add($e.default.json,(0,Se._)`"" + ${e}`)}function Sce(t){let{gen:e,self:r,data:n,definitions:s,schema:i,schemaEnv:o}=t,{ref:a}=i,c=s[a];if(!c)throw new lce.default(r.opts.uriResolver,"",a,`No definition ${a}`);if(!(0,dce.hasRef)(c))return nu({...t,schema:c});let{root:l}=o,u=U2.call(r,new L2.SchemaEnv({schema:c,root:l}),s);e.add($e.default.json,(0,Se._)`${vce(e,u)}(${n})`)}function vce(t,e){return e.serialize?t.scopeValue("serialize",{ref:e.serialize}):(0,Se._)`${t.scopeValue("wrapper",{ref:e})}.serialize`}function _ce({gen:t,data:e}){t.add($e.default.json,(0,Se._)`JSON.stringify(${e})`)}function _S({gen:t},e){e?t.if(e,()=>t.assign(e,!1),()=>t.add($e.default.json,(0,Se.str)`,`)):t.add($e.default.json,(0,Se.str)`,`)}});var j2=h(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.parseJsonString=gi.parseJsonNumber=gi.parseJson=void 0;var Ace=/position\s(\d+)$/;function bs(t,e){let r;bs.message=void 0;let n;e&&(t=t.slice(e));try{return bs.position=e+t.length,JSON.parse(t)}catch(s){if(n=Ace.exec(s.message),!n){bs.message="unexpected end";return}r=+n[1];let i=t[r];t=t.slice(0,r),bs.position=e+r;try{return JSON.parse(t)}catch{bs.message=`unexpected token ${i}`;return}}}gi.parseJson=bs;bs.message=void 0;bs.position=0;bs.code='require("ajv/dist/runtime/parseJson").parseJson';function Cs(t,e,r){let n="",s;if(Cs.message=void 0,t[e]==="-"&&(n+="-",e++),t[e]==="0")n+="0",e++;else if(!i(r)){o();return}if(r)return Cs.position=e,+n;if(t[e]==="."&&(n+=".",e++,!i())){o();return}if(s=t[e],(s==="e"||s==="E")&&(n+="e",e++,s=t[e],(s==="+"||s==="-")&&(n+=s,e++),!i())){o();return}return Cs.position=e,+n;function i(a){let c=!1;for(;s=t[e],s>="0"&&s<="9"&&(a===void 0||a-- >0);)c=!0,n+=s,e++;return c}function o(){Cs.position=e,Cs.message=e<t.length?`unexpected token ${t[e]}`:"unexpected end"}}gi.parseJsonNumber=Cs;Cs.message=void 0;Cs.position=0;Cs.code='require("ajv/dist/runtime/parseJson").parseJsonNumber';var $2={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"/":"/","\\":"\\"},Rce=97,Ece=48;function fi(t,e){let r="",n;for(fi.message=void 0;n=t[e++],n!=='"';)if(n==="\\")if(n=t[e],n in $2)r+=$2[n],e++;else if(n==="u"){e++;let i=4,o=0;for(;i--;){if(o<<=4,n=t[e],n===void 0){s("unexpected end");return}if(n=n.toLowerCase(),n>="a"&&n<="f")o+=n.charCodeAt(0)-Rce+10;else if(n>="0"&&n<="9")o+=n.charCodeAt(0)-Ece;else{s(`unexpected token ${n}`);return}e++}r+=String.fromCharCode(o)}else{s(`unexpected token ${n}`);return}else if(n===void 0){s("unexpected end");return}else if(n.charCodeAt(0)>=32)r+=n;else{s(`unexpected token ${n}`);return}return fi.position=e,r;function s(i){fi.position=e,fi.message=i}}gi.parseJsonString=fi;fi.message=void 0;fi.position=0;fi.code='require("ajv/dist/runtime/parseJson").parseJsonString'});var sP=h(NS=>{"use strict";Object.defineProperty(NS,"__esModule",{value:!0});var wce=CS(),z2=so(),te=ne(),Bce=si(),be=Or(),Tce=Pt(),Gce=Jg(),Zce=lS(),wS=j2(),J2=de(),Nce=cS(),Vce={elements:Pce,values:kce,discriminator:xce,properties:q2,optionalProperties:q2,enum:Uce,type:Lce,ref:Yce};function Q2(t,e){let r=z2.getCompilingSchema.call(this,t);if(r)return r;let{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new te.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i}),a=o.scopeName("parse"),c={self:this,gen:o,schema:t.schema,schemaEnv:t,definitions:e,data:be.default.data,parseName:a,char:o.name("c")},l;try{this._compilations.add(t),t.parseName=a,Hce(c),o.optimize(this.opts.code.optimize);let u=o.toString();l=`${o.scopeRefs(be.default.scope)}return ${u}`;let f=new Function(`${be.default.scope}`,l)(this.scope.get());this.scope.value(a,{ref:f}),t.parse=f}catch(u){throw l&&this.logger.error("Error compiling parser, function code:",l),delete t.parse,delete t.parseName,u}finally{this._compilations.delete(t)}return t}NS.default=Q2;var ES=(0,te._)`undefined`;function Hce(t){let{gen:e,parseName:r,char:n}=t;e.func(r,(0,te._)`${be.default.json}, ${be.default.jsonPos}, ${be.default.jsonPart}`,!1,()=>{e.let(be.default.data),e.let(n),e.assign((0,te._)`${r}.message`,ES),e.assign((0,te._)`${r}.position`,ES),e.assign(be.default.jsonPos,(0,te._)`${be.default.jsonPos} || 0`),e.const(be.default.jsonLen,(0,te._)`${be.default.json}.length`),np(t),ZS(t),e.if(be.default.jsonPart,()=>{e.assign((0,te._)`${r}.position`,be.default.jsonPos),e.return(be.default.data)}),e.if((0,te._)`${be.default.jsonPos} === ${be.default.jsonLen}`,()=>e.return(be.default.data)),La(t)})}function np(t){let e;for(let r of wce.jtdForms)if(r in t.schema){e=r;break}e?Oce(t,Vce[e]):TS(t)}var Wce=K2(!0,K2(!1,La));function Oce(t,e){let{gen:r,schema:n,data:s}=t;if(!n.nullable)return e(t);su(t,"null",e,()=>r.assign(s,null))}function Pce(t){let{gen:e,schema:r,data:n}=t;Zn(t,"[");let s=e.let("i",0);e.assign(n,(0,te._)`[]`),BS(t,"]",()=>{let i=e.let("el");np({...t,schema:r.elements,data:i}),e.assign((0,te._)`${n}[${s}++]`,i)})}function kce(t){let{gen:e,schema:r,data:n}=t;Zn(t,"{"),e.assign(n,(0,te._)`{}`),BS(t,"}",()=>Fce(t,r.values))}function BS(t,e,r){eP(t,e,r),Zn(t,e)}function eP(t,e,r){let{gen:n}=t;n.for((0,te._)`;${be.default.jsonPos}<${be.default.jsonLen} && ${sp(1)}!==${e};`,()=>{r(),su(t,",",()=>n.break(),s)});function s(){su(t,e,()=>{},La)}}function Fce(t,e){let{gen:r}=t,n=r.let("key");mo({...t,data:n}),Zn(t,":"),rP(t,n,e)}function xce(t){let{gen:e,data:r,schema:n}=t,{discriminator:s,mapping:i}=n;Zn(t,"{"),e.assign(r,(0,te._)`{}`);let o=e.const("pos",be.default.jsonPos),a=e.let("value"),c=e.let("tag");eP(t,"}",()=>{let l=e.let("key");mo({...t,data:l}),Zn(t,":"),e.if((0,te._)`${l} === ${s}`,()=>{mo({...t,data:c}),e.assign((0,te._)`${r}[${l}]`,c),e.break()},()=>TS({...t,data:a}))}),e.assign(be.default.jsonPos,o),e.if((0,te._)`${c} === undefined`),Ss(t,(0,te.str)`discriminator tag not found`);for(let l in i)e.elseIf((0,te._)`${c} === ${l}`),tP({...t,schema:i[l]},s);e.else(),Ss(t,(0,te.str)`discriminator value not in schema`),e.endIf()}function q2(t){let{gen:e,data:r}=t;Zn(t,"{"),e.assign(r,(0,te._)`{}`),tP(t)}function tP(t,e){let{gen:r,schema:n,data:s}=t,{properties:i,optionalProperties:o,additionalProperties:a}=n;if(BS(t,"}",()=>{let c=r.let("key");if(mo({...t,data:c}),Zn(t,":"),r.if(!1),M2(t,c,i),M2(t,c,o),e){r.elseIf((0,te._)`${c} === ${e}`);let l=r.let("tag");mo({...t,data:l})}r.else(),a?TS({...t,data:(0,te._)`${s}[${c}]`}):Ss(t,(0,te.str)`property ${c} not allowed`),r.endIf()}),i){let c=(0,Tce.hasPropFunc)(r),l=(0,te.and)(...Object.keys(i).map(u=>(0,te._)`${c}.call(${s}, ${u})`));r.if((0,te.not)(l),()=>Ss(t,(0,te.str)`missing required properties`))}}function M2(t,e,r={}){let{gen:n}=t;for(let s in r)n.elseIf((0,te._)`${e} === ${s}`),rP(t,e,r[s])}function rP(t,e,r){np({...t,schema:r,data:(0,te._)`${t.data}[${e}]`})}function Lce(t){let{gen:e,schema:r,data:n,self:s}=t;switch(r.type){case"boolean":Wce(t);break;case"string":mo(t);break;case"timestamp":{mo(t);let i=(0,J2.useFunc)(e,Nce.default),{allowDate:o,parseDate:a}=s.opts,c=o?(0,te._)`!${i}(${n}, true)`:(0,te._)`!${i}(${n})`,l=a?(0,te.or)(c,(0,te._)`(${n} = new Date(${n}), false)`,(0,te._)`isNaN(${n}.valueOf())`):c;e.if(l,()=>Ss(t,(0,te.str)`invalid timestamp`));break}case"float32":case"float64":RS(t);break;default:{let i=r.type;if(!s.opts.int32range&&(i==="int32"||i==="uint32"))RS(t,16),i==="uint32"&&e.if((0,te._)`${n} < 0`,()=>Ss(t,(0,te.str)`integer out of range`));else{let[o,a,c]=Zce.intRange[i];RS(t,c),e.if((0,te._)`${n} < ${o} || ${n} > ${a}`,()=>Ss(t,(0,te.str)`integer out of range`))}}}}function mo(t){Zn(t,'"'),GS(t,wS.parseJsonString)}function Uce(t){let{gen:e,data:r,schema:n}=t,s=n.enum;Zn(t,'"'),e.if(!1);for(let i of s){let o=JSON.stringify(i).slice(1);e.elseIf((0,te._)`${sp(o.length)} === ${o}`),e.assign(r,(0,te.str)`${i}`),e.add(be.default.jsonPos,o.length)}e.else(),La(t),e.endIf()}function RS(t,e){let{gen:r}=t;ZS(t),r.if((0,te._)`"-0123456789".indexOf(${sp(1)}) < 0`,()=>La(t),()=>GS(t,wS.parseJsonNumber,e))}function K2(t,e){return r=>{let{gen:n,data:s}=r;su(r,`${t}`,()=>e(r),()=>n.assign(s,t))}}function Yce(t){let{gen:e,self:r,definitions:n,schema:s,schemaEnv:i}=t,{ref:o}=s,a=n[o];if(!a)throw new Bce.default(r.opts.uriResolver,"",o,`No definition ${o}`);if(!(0,Gce.hasRef)(a))return np({...t,schema:a});let{root:c}=i,l=Q2.call(r,new z2.SchemaEnv({schema:a,root:c}),n);nP(t,Dce(e,l),!0)}function Dce(t,e){return e.parse?t.scopeValue("parse",{ref:e.parse}):(0,te._)`${t.scopeValue("wrapper",{ref:e})}.parse`}function TS(t){GS(t,wS.parseJson)}function GS(t,e,r){nP(t,(0,J2.useFunc)(t.gen,e),r)}function nP(t,e,r){let{gen:n,data:s}=t;n.assign(s,(0,te._)`${e}(${be.default.json}, ${be.default.jsonPos}${r?(0,te._)`, ${r}`:te.nil})`),n.assign(be.default.jsonPos,(0,te._)`${e}.position`),n.if((0,te._)`${s} === undefined`,()=>Ss(t,(0,te._)`${e}.message`))}function Zn(t,e){su(t,e,La)}function su(t,e,r,n){let{gen:s}=t,i=e.length;ZS(t),s.if((0,te._)`${sp(i)} === ${e}`,()=>{s.add(be.default.jsonPos,i),n?.(t)},()=>r(t))}function ZS({gen:t,char:e}){t.code((0,te._)`while((${e}=${be.default.json}[${be.default.jsonPos}],${e}===" "||${e}==="\\n"||${e}==="\\r"||${e}==="\\t"))${be.default.jsonPos}++;`)}function sp(t){return t===1?(0,te._)`${be.default.json}[${be.default.jsonPos}]`:(0,te._)`${be.default.json}.slice(${be.default.jsonPos}, ${be.default.jsonPos}+${t})`}function La(t){Ss(t,(0,te._)`"unexpected token " + ${be.default.json}[${be.default.jsonPos}]`)}function Ss({gen:t,parseName:e},r){t.assign((0,te._)`${e}.message`,r),t.assign((0,te._)`${e}.position`,be.default.jsonPos),t.return(ES)}});var HS=h((nt,iP)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.MissingRefError=nt.ValidationError=nt.CodeGen=nt.Name=nt.nil=nt.stringify=nt.str=nt._=nt.KeywordCxt=void 0;var Xce=$b(),$ce=V2(),jce=P2(),qce=X2(),Mce=sP(),VS="JTD-meta-schema",ip=class extends Xce.default{constructor(e={}){super({...e,jtd:!0})}_addVocabularies(){super._addVocabularies(),this.addVocabulary($ce.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema(),this.opts.meta&&this.addMetaSchema(jce.default,VS,!1)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(VS)?VS:void 0)}compileSerializer(e){let r=this._addSchema(e);return r.serialize||this._compileSerializer(r)}compileParser(e){let r=this._addSchema(e);return r.parse||this._compileParser(r)}_compileSerializer(e){if(qce.default.call(this,e,e.schema.definitions||{}),!e.serialize)throw new Error("ajv implementation error");return e.serialize}_compileParser(e){if(Mce.default.call(this,e,e.schema.definitions||{}),!e.parse)throw new Error("ajv implementation error");return e.parse}};iP.exports=nt=ip;Object.defineProperty(nt,"__esModule",{value:!0});nt.default=ip;var Kce=ma();Object.defineProperty(nt,"KeywordCxt",{enumerable:!0,get:function(){return Kce.KeywordCxt}});var Ua=ne();Object.defineProperty(nt,"_",{enumerable:!0,get:function(){return Ua._}});Object.defineProperty(nt,"str",{enumerable:!0,get:function(){return Ua.str}});Object.defineProperty(nt,"stringify",{enumerable:!0,get:function(){return Ua.stringify}});Object.defineProperty(nt,"nil",{enumerable:!0,get:function(){return Ua.nil}});Object.defineProperty(nt,"Name",{enumerable:!0,get:function(){return Ua.Name}});Object.defineProperty(nt,"CodeGen",{enumerable:!0,get:function(){return Ua.CodeGen}});var zce=yl();Object.defineProperty(nt,"ValidationError",{enumerable:!0,get:function(){return zce.default}});var Jce=si();Object.defineProperty(nt,"MissingRefError",{enumerable:!0,get:function(){return Jce.default}})});var WS=h((GNe,oP)=>{"use strict";var Qce=xC();oP.exports=Object.freeze({coerceTypes:"array",useDefaults:!0,removeAdditional:!0,uriResolver:Qce,addUsedSchema:!1,allErrors:!1})});var lP=h((ZNe,cP)=>{"use strict";var ele=dg().default,tle=HS(),aP=WS(),OS=class{constructor(e,r){r.mode==="JTD"?this.ajv=new tle(Object.assign({},aP,r.customOptions)):this.ajv=new ele(Object.assign({},aP,r.customOptions));let n=!0;if(r.plugins&&r.plugins.length>0)for(let i of r.plugins)Array.isArray(i)?(n=n&&i[0].name!=="formatsPlugin",i[0](this.ajv,i[1])):(n=n&&i.name!=="formatsPlugin",i(this.ajv));n&&jC()(this.ajv);let s=Object.values(e);for(let i of s)this.ajv.addSchema(i)}buildValidatorFunction({schema:e}){if(e.$id){let r=this.ajv.getSchema(e.$id);if(r)return r}return this.ajv.compile(e)}};cP.exports=OS});var dP=h((NNe,uP)=>{"use strict";var rle=HS(),nle=WS(),PS=class{constructor(e,r){this.ajv=new rle(Object.assign({},nle,r))}buildSerializerFunction({schema:e}){return this.ajv.compileSerializer(e)}};uP.exports=PS});var pP=h((ou,gP)=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});var iu=kf(),dn=ca();function fP(t,e){if(!t.opts.code.source)throw new Error("moduleCode: ajv instance must have code.source option");let{_n:r}=t.scope.opts;return typeof e=="function"?s(e.source):e!==void 0?i(e,n):i(t.schemas,a=>a.meta?void 0:t.compile(a.schema));function n(a){let c=t.getSchema(a);if(!c)throw new Error(`moduleCode: no schema with id ${a}`);return c}function s(a){let c={},l=a?.validateName,u=o(c,a);return t.opts.code.esm?`"use strict";${r}export const validate = ${l};${r}export default ${l};${r}${u}`:`"use strict";${r}module.exports = ${l};${r}module.exports.default = ${l};${r}${u}`}function i(a,c){var l;let u={},d=(0,dn._)`"use strict";`;for(let f in a){let g=c(a[f]);if(g){let p=o(u,g.source),m=t.opts.code.esm?(0,dn._)`export const ${(0,dn.getEsmExportName)(f)}`:(0,dn._)`exports${(0,dn.getProperty)(f)}`;d=(0,dn._)`${d}${r}${m} = ${(l=g.source)===null||l===void 0?void 0:l.validateName};${r}${p}`}}return`${d}`}function o(a,c){if(!c)throw new Error('moduleCode: function does not have "source" property');if(f(c.validateName)===iu.UsedValueState.Completed)return dn.nil;g(c.validateName,iu.UsedValueState.Started);let l=t.scope.scopeCode(c.scopeValues,a,d),u=new dn._Code(`${l}${r}${c.validateCode}`);return c.evaluated?(0,dn._)`${u}${c.validateName}.evaluated = ${c.evaluated};${r}`:u;function d(p){var m;let I=(m=p.value)===null||m===void 0?void 0:m.ref;if(p.prefix==="validate"&&typeof I=="function")return o(a,I.source);if((p.prefix==="root"||p.prefix==="wrapper")&&typeof I=="object"){let{validate:C,validateName:S}=I;if(!S)throw new Error("ajv internal error");let b=t.opts.code.es5?iu.varKinds.var:iu.varKinds.const,y=(0,dn._)`${b} ${p} = {validate: ${S}};`;if(f(S)===iu.UsedValueState.Started)return y;let A=o(a,C?.source);return(0,dn._)`${y}${r}${A}`}}function f(p){var m;return(m=a[p.prefix])===null||m===void 0?void 0:m.get(p)}function g(p,m){let{prefix:I}=p;(a[I]=a[I]||new Map).set(p,m)}}}gP.exports=ou=fP;Object.defineProperty(ou,"__esModule",{value:!0});ou.default=fP});var yP=h((VNe,mP)=>{"use strict";var hP=kS(),sle=pP().default;function ile(t={readMode:!0}){if(t.readMode===!0&&!t.restoreFunction)throw new Error("You must provide a restoreFunction options when readMode ON");if(t.readMode!==!0&&!t.storeFunction)throw new Error("You must provide a storeFunction options when readMode OFF");if(t.readMode===!0)return function(){return function(n){return t.restoreFunction(n)}};let e=hP();return function(n,s={}){(!s.customOptions||!s.customOptions.code)&&(s.customOptions=Object.assign({},s.customOptions,{code:{source:!0}}));let i=e(n,s);return function(o){let a=i(o),c=sle(i[hP.AjvReference].ajv,a);return t.storeFunction(o,c),a}}}mP.exports=ile});var kS=h((HNe,Ya)=>{"use strict";var bP=Symbol.for("fastify.ajv-compiler.reference"),ole=lP(),ale=dP();function FS(t){let e=new Map,r=new Map;return t&&t.jtdSerializer===!0?function(s,i){let o=IP({},i);if(r.has(o))return r.get(o);let a=new ale(s,i),c=a.buildSerializerFunction.bind(a);return r.set(o,c),c}:function(s,i){let o=IP(s,i.customOptions);if(e.has(o))return e.get(o);let a=new ole(s,i),c=a.buildValidatorFunction.bind(a);return e.set(o,c),i.customOptions.code!==void 0&&(c[bP]=a),c}}function IP(t,e){let r=JSON.stringify(t),n=JSON.stringify(e);return`${r}${n}`}Ya.exports=FS;Ya.exports.default=FS;Ya.exports.AjvCompiler=FS;Ya.exports.AjvReference=bP;Ya.exports.StandaloneValidator=yP()});var xS=h((WNe,CP)=>{"use strict";var{buildSchemas:cle}=nl(),lle=sS(),ule=kS();function dle(t,e){if(t)return new Da(t,e);let r=Object.assign({buildValidator:null,buildSerializer:null},e?.compilersFactory);r.buildValidator||(r.buildValidator=ule()),r.buildSerializer||(r.buildSerializer=lle());let n={bucket:e&&e.bucket||cle,compilersFactory:r,isCustomValidatorCompiler:typeof e?.compilersFactory?.buildValidator=="function",isCustomSerializerCompiler:typeof e?.compilersFactory?.buildValidator=="function"};return new Da(void 0,n)}var Da=class{constructor(e,r){this.opts=r||e&&e.opts,this.addedSchemas=!1,this.compilersFactory=this.opts.compilersFactory,this.isCustomValidatorCompiler=this.opts.isCustomValidatorCompiler||!1,this.isCustomSerializerCompiler=this.opts.isCustomSerializerCompiler||!1,e?(this.schemaBucket=this.opts.bucket(e.getSchemas()),this.validatorCompiler=e.getValidatorCompiler(),this.serializerCompiler=e.getSerializerCompiler(),this.isCustomValidatorCompiler=e.isCustomValidatorCompiler,this.isCustomSerializerCompiler=e.isCustomSerializerCompiler,this.parent=e):this.schemaBucket=this.opts.bucket()}add(e){return this.addedSchemas=!0,this.schemaBucket.add(e)}getSchema(e){return this.schemaBucket.getSchema(e)}getSchemas(){return this.schemaBucket.getSchemas()}setValidatorCompiler(e){this.validatorCompiler=e,this.isCustomValidatorCompiler=!0}setSerializerCompiler(e){this.serializerCompiler=e,this.isCustomSerializerCompiler=!0}getValidatorCompiler(){return this.validatorCompiler||this.parent&&this.parent.getValidatorCompiler()}getSerializerCompiler(){return this.serializerCompiler||this.parent&&this.parent.getSerializerCompiler()}getSerializerBuilder(){return this.compilersFactory.buildSerializer||this.parent&&this.parent.getSerializerBuilder()}getValidatorBuilder(){return this.compilersFactory.buildValidator||this.parent&&this.parent.getValidatorBuilder()}setupValidator(e){this.validatorCompiler!==void 0&&!this.addedSchemas||(this.validatorCompiler=this.getValidatorBuilder()(this.schemaBucket.getSchemas(),e.ajv))}setupSerializer(e){this.serializerCompiler!==void 0&&!this.addedSchemas||(this.serializerCompiler=this.getSerializerBuilder()(this.schemaBucket.getSchemas(),e.serializerOpts))}};Da.buildSchemaController=dle;CP.exports=Da});var $S=h((ONe,XS)=>{"use strict";var LS=B0(),YS=require("node:assert"),DS=Symbol.for("registered-plugin"),{kTestInternals:fle}=Tt(),{exist:gle,existReply:ple,existRequest:hle}=k0(),{FST_ERR_PLUGIN_VERSION_MISMATCH:mle,FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:yle}=Yt(),{FSTWRN002:Ile}=is();function au(t){return t[Symbol.for("plugin-meta")]}function SP(t){let e=vP(t);if(e)return e;let r=require.cache;if(r){let n=Object.keys(r);for(let s=0;s<n.length;s++){let i=n[s];if(r[i].exports===t)return i}}return t.name?t.name:null}function ble(t){return t.toString().split(`
`).slice(0,2).map(e=>e.trim()).join(" -- ")}function vP(t){return t[Symbol.for("fastify.display-name")]}function _P(t){return!!t[Symbol.for("skip-override")]}function AP(t){let e=au(t);if(!e)return;let r=e.dependencies;r&&(YS(Array.isArray(r),"The dependencies should be an array of strings"),r.forEach(n=>{YS(this[DS].indexOf(n)>-1,`The dependency '${n}' of plugin '${e.name}' is not registered`)}))}function RP(t){let e=au(t);if(!e)return;let{decorators:r,name:n}=e;r&&(r.fastify&&US(this,"Fastify",r.fastify,n),r.reply&&US(this,"Reply",r.reply,n),r.request&&US(this,"Request",r.request,n))}var Cle={Fastify:gle,Request:hle,Reply:ple};function US(t,e,r,n){YS(Array.isArray(r),"The decorators should be an array of strings"),r.forEach(s=>{let i=typeof n=="string"?` required by '${n}'`:"";if(!Cle[e].call(t,s))throw new yle(s,i,e)})}function Sle(t){let e=au(t);if(!e)return;let r=e.fastify,n=/-rc.+$/.test(this.version);if(!(n===!0&&LS.gt(this.version,LS.coerce(r))===!0)&&r&&LS.satisfies(this.version,r,{includePrerelease:n})===!1)throw new mle(e.name,r,this.version)}function vle(t){let e=au(t);if(!e)return;let r=e.name;if(r)return this[DS].push(r),r}function _le(t,e){t.constructor.name==="AsyncFunction"&&t.length===3&&Ile(e||"anonymous")}function Ale(t){let e=vle.call(this,t)||SP(t);return _le.call(this,t,e),Sle.call(this,t),RP.call(this,t),AP.call(this,t),_P(t)}XS.exports={getPluginName:SP,getFuncPreview:ble,kRegisteredPlugins:DS,getDisplayName:vP,registerPlugin:Ale};XS.exports[fle]={shouldSkipOverride:_P,getMeta:au,checkDecorators:RP,checkDependencies:AP}});var wP=h((PNe,EP)=>{"use strict";function Rle(t,e){let r=e||Ele();return t?wle(t,r):r}function Ele(){let e=0;return function(){return e=e+1&2147483647,`req-${e.toString(36)}`}}function wle(t,e){return function(r){return r.headers[t]||e(r)}}EP.exports={reqIdGenFactory:Rle}});var ZP=h((kNe,GP)=>{"use strict";var BP=12,Ble=0,jS=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7];function Tle(t){var e=t.indexOf("%");if(e===-1)return t;for(var r=t.length,n="",s=0,i=0,o=e,a=BP;e>-1&&e<r;){var c=TP(t[e+1],4),l=TP(t[e+2],0),u=c|l,d=jS[u];if(a=jS[256+a+d],i=i<<6|u&jS[364+d],a===BP)n+=t.slice(s,o),n+=i<=65535?String.fromCharCode(i):String.fromCharCode(55232+(i>>10),56320+(i&1023)),i=0,s=e+3,e=o=t.indexOf("%",s);else{if(a===Ble)return null;if(e+=3,e<r&&t.charCodeAt(e)===37)continue;return null}}return n+t.slice(s)}var Gle={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function TP(t,e){var r=Gle[t];return r===void 0?255:r<<e}GP.exports=Tle});var OP=h((FNe,WP)=>{"use strict";var NP=ZP(),VP=/\+/g,HP=function(){};HP.prototype=Object.create(null);function Zle(t){let e=new HP;if(typeof t!="string")return e;let r=t.length,n="",s="",i=-1,o=-1,a=!1,c=!1,l=!1,u=!1,d=!1,f=0;for(let g=0;g<r+1;g++)if(f=g!==r?t.charCodeAt(g):38,f===38){if(d=o>i,d||(o=g),n=t.slice(i+1,o),d||n.length>0){l&&(n=n.replace(VP," ")),a&&(n=NP(n)||n),d&&(s=t.slice(o+1,g),u&&(s=s.replace(VP," ")),c&&(s=NP(s)||s));let p=e[n];p===void 0?e[n]=s:p.pop?p.push(s):e[n]=[p,s]}s="",i=g,o=g,a=!1,c=!1,l=!1,u=!1}else f===61?o<=i?o=g:c=!0:f===43?o>i?u=!0:l=!0:f===37&&(o>i?c=!0:a=!0);return e}WP.exports=Zle});var kP=h((xNe,PP)=>{var Nn=Array.from({length:256},(t,e)=>"%"+((e<16?"0":"")+e.toString(16)).toUpperCase()),Nle=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);function Vle(t){let e=t.length;if(e===0)return"";let r="",n=0,s=0;e:for(;s<e;s++){let i=t.charCodeAt(s);for(;i<128;){if(Nle[i]!==1&&(n<s&&(r+=t.slice(n,s)),n=s+1,r+=Nn[i]),++s===e)break e;i=t.charCodeAt(s)}if(n<s&&(r+=t.slice(n,s)),i<2048){n=s+1,r+=Nn[192|i>>6]+Nn[128|i&63];continue}if(i<55296||i>=57344){n=s+1,r+=Nn[224|i>>12]+Nn[128|i>>6&63]+Nn[128|i&63];continue}if(++s,s>=e)throw new Error("URI malformed");let o=t.charCodeAt(s)&1023;n=s+1,i=65536+((i&1023)<<10|o),r+=Nn[240|i>>18]+Nn[128|i>>12&63]+Nn[128|i>>6&63]+Nn[128|i&63]}return n===0?t:n<e?r+t.slice(n):r}PP.exports={encodeString:Vle}});var LP=h((LNe,xP)=>{"use strict";var{encodeString:qS}=kP();function FP(t){let e=typeof t;return e==="string"?qS(t):e==="bigint"?t.toString():e==="boolean"?t?"true":"false":e==="number"&&Number.isFinite(t)?t<1e21?""+t:qS(""+t):""}function Hle(t){let e="";if(t===null||typeof t!="object")return e;let r="&",n=Object.keys(t),s=n.length,i=0;for(let o=0;o<s;o++){let a=n[o],c=t[a],l=qS(a)+"=";if(o&&(e+=r),Array.isArray(c)){i=c.length;for(let u=0;u<i;u++)u&&(e+=r),e+=l,e+=FP(c[u])}else e+=l,e+=FP(c)}return e}xP.exports=Hle});var XP=h((UNe,cu)=>{"use strict";var UP=OP(),YP=LP(),DP={parse:UP,stringify:YP};cu.exports=DP;cu.exports.default=DP;cu.exports.parse=UP;cu.exports.stringify=YP});var lu=h((YNe,$P)=>{$P.exports={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7}});var KS=h(pi=>{var Pe=lu(),MS=()=>[{type:Pe.RANGE,from:48,to:57}],jP=()=>[{type:Pe.CHAR,value:95},{type:Pe.RANGE,from:97,to:122},{type:Pe.RANGE,from:65,to:90}].concat(MS()),qP=()=>[{type:Pe.CHAR,value:9},{type:Pe.CHAR,value:10},{type:Pe.CHAR,value:11},{type:Pe.CHAR,value:12},{type:Pe.CHAR,value:13},{type:Pe.CHAR,value:32},{type:Pe.CHAR,value:160},{type:Pe.CHAR,value:5760},{type:Pe.RANGE,from:8192,to:8202},{type:Pe.CHAR,value:8232},{type:Pe.CHAR,value:8233},{type:Pe.CHAR,value:8239},{type:Pe.CHAR,value:8287},{type:Pe.CHAR,value:12288},{type:Pe.CHAR,value:65279}],Wle=()=>[{type:Pe.CHAR,value:10},{type:Pe.CHAR,value:13},{type:Pe.CHAR,value:8232},{type:Pe.CHAR,value:8233}];pi.words=()=>({type:Pe.SET,set:jP(),not:!1});pi.notWords=()=>({type:Pe.SET,set:jP(),not:!0});pi.ints=()=>({type:Pe.SET,set:MS(),not:!1});pi.notInts=()=>({type:Pe.SET,set:MS(),not:!0});pi.whitespace=()=>({type:Pe.SET,set:qP(),not:!1});pi.notWhitespace=()=>({type:Pe.SET,set:qP(),not:!0});pi.anyChar=()=>({type:Pe.SET,set:Wle(),not:!0})});var KP=h(uu=>{var MP=lu(),Xa=KS(),Ole="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",Ple={0:0,t:9,n:10,v:11,f:12,r:13};uu.strToChars=function(t){var e=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g;return t=t.replace(e,function(r,n,s,i,o,a,c,l){if(s)return r;var u=n?8:i?parseInt(i,16):o?parseInt(o,16):a?parseInt(a,8):c?Ole.indexOf(c):Ple[l],d=String.fromCharCode(u);return/[[\]{}^$.|?*+()]/.test(d)&&(d="\\"+d),d}),t};uu.tokenizeClass=(t,e)=>{for(var r=[],n=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?([^])/g,s,i;(s=n.exec(t))!=null;)if(s[1])r.push(Xa.words());else if(s[2])r.push(Xa.ints());else if(s[3])r.push(Xa.whitespace());else if(s[4])r.push(Xa.notWords());else if(s[5])r.push(Xa.notInts());else if(s[6])r.push(Xa.notWhitespace());else if(s[7])r.push({type:MP.RANGE,from:(s[8]||s[9]).charCodeAt(0),to:s[10].charCodeAt(0)});else if(i=s[12])r.push({type:MP.CHAR,value:i.charCodeAt(0)});else return[r,n.lastIndex];uu.error(e,"Unterminated character class")};uu.error=(t,e)=>{throw new SyntaxError("Invalid regular expression: /"+t+"/: "+e)}});var zP=h(du=>{var op=lu();du.wordBoundary=()=>({type:op.POSITION,value:"b"});du.nonWordBoundary=()=>({type:op.POSITION,value:"B"});du.begin=()=>({type:op.POSITION,value:"^"});du.end=()=>({type:op.POSITION,value:"$"})});var JP=h((jNe,zS)=>{var $a=KP(),Ur=lu(),yo=KS(),ap=zP();zS.exports=t=>{var e=0,r,n,s={type:Ur.ROOT,stack:[]},i=s,o=s.stack,a=[],c=C=>{$a.error(t,`Nothing to repeat at column ${C-1}`)},l=$a.strToChars(t);for(r=l.length;e<r;)switch(n=l[e++],n){case"\\":switch(n=l[e++],n){case"b":o.push(ap.wordBoundary());break;case"B":o.push(ap.nonWordBoundary());break;case"w":o.push(yo.words());break;case"W":o.push(yo.notWords());break;case"d":o.push(yo.ints());break;case"D":o.push(yo.notInts());break;case"s":o.push(yo.whitespace());break;case"S":o.push(yo.notWhitespace());break;default:/\d/.test(n)?o.push({type:Ur.REFERENCE,value:parseInt(n,10)}):o.push({type:Ur.CHAR,value:n.charCodeAt(0)})}break;case"^":o.push(ap.begin());break;case"$":o.push(ap.end());break;case"[":var u;l[e]==="^"?(u=!0,e++):u=!1;var d=$a.tokenizeClass(l.slice(e),t);e+=d[1],o.push({type:Ur.SET,set:d[0],not:u});break;case".":o.push(yo.anyChar());break;case"(":var f={type:Ur.GROUP,stack:[],remember:!0};n=l[e],n==="?"&&(n=l[e+1],e+=2,n==="="?f.followedBy=!0:n==="!"?f.notFollowedBy=!0:n!==":"&&$a.error(t,`Invalid group, character '${n}' after '?' at column ${e-1}`),f.remember=!1),o.push(f),a.push(i),i=f,o=f.stack;break;case")":a.length===0&&$a.error(t,`Unmatched ) at column ${e-1}`),i=a.pop(),o=i.options?i.options[i.options.length-1]:i.stack;break;case"|":i.options||(i.options=[i.stack],delete i.stack);var g=[];i.options.push(g),o=g;break;case"{":var p=/^(\d+)(,(\d+)?)?\}/.exec(l.slice(e)),m,I;p!==null?(o.length===0&&c(e),m=parseInt(p[1],10),I=p[2]?p[3]?parseInt(p[3],10):1/0:m,e+=p[0].length,o.push({type:Ur.REPETITION,min:m,max:I,value:o.pop()})):o.push({type:Ur.CHAR,value:123});break;case"?":o.length===0&&c(e),o.push({type:Ur.REPETITION,min:0,max:1,value:o.pop()});break;case"+":o.length===0&&c(e),o.push({type:Ur.REPETITION,min:1,max:1/0,value:o.pop()});break;case"*":o.length===0&&c(e),o.push({type:Ur.REPETITION,min:0,max:1/0,value:o.pop()});break;default:o.push({type:Ur.CHAR,value:n.charCodeAt(0)})}return a.length!==0&&$a.error(t,"Unterminated group"),s};zS.exports.types=Ur});var tk=h((qNe,ek)=>{"use strict";var QP=JP(),kle=QP.types;ek.exports=function(t,e){e||(e={});var r=e.limit===void 0?25:e.limit;Fle(t)?t=t.source:typeof t!="string"&&(t=String(t));try{t=QP(t)}catch{return!1}var n=0;return function s(i,o){var a,c,l;if(i.type===kle.REPETITION&&(o++,n++,o>1||n>r))return!1;if(i.options){for(a=0,l=i.options.length;a<l;a++)if(c=s({stack:i.options[a]},o),!c)return!1}var u=i.stack||i.value&&i.value.stack;if(!u)return!0;for(a=0;a<u.length;a++)if(c=s(u[a],o),!c)return!1;return!0}(t,0)};function Fle(t){return{}.toString.call(t)==="[object RegExp]"}});var cp=h((MNe,rk)=>{"use strict";rk.exports={name:"__fmw_internal_strategy_merged_tree_http_method__",storage:function(){let t={};return{get:e=>t[e]||null,set:(e,r)=>{t[e]=r}}},deriveConstraint:t=>t.method,mustMatchWhenDerived:!0}});var lk=h((KNe,ck)=>{"use strict";var nk=pa(),sk=cp(),ik=Symbol("treeData");function ok(t,e=""){let r="",n=Object.keys(t);for(let s=0;s<n.length;s++){let i=n[s],o=t[i],a=s===n.length-1,c=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ",l=a?"    ":"\u2502   ",d=(o[ik]||"").split(`
`).join(`
`+e+l);r+=e+c+i+d+`
`,r+=ok(o,e+l)}return r}function xle(t){let e=t.name||"";return e=e.replace("bound","").trim(),e=(e||"anonymous")+"()",e}function ak(t){return Array.isArray(t)?t.map(e=>ak(e)):typeof t=="symbol"?t.toString():typeof t=="function"?xle(t):t}function Lle(t,e){if(!e.includeMeta)return{};let r=e.buildPrettyMeta(t),n={},s=e.includeMeta;Array.isArray(s)||(s=Reflect.ownKeys(r));for(let i of s){if(!Object.prototype.hasOwnProperty.call(r,i))continue;let o=i.toString(),a=r[i];if(a!=null){let c=JSON.stringify(ak(a));n[o]=c}}return n}function Ule(t){let e="";for(let[r,n]of Object.entries(t))e+=`
\u2022 (${r}) ${n}`;return e}function Yle(t){let e={...t.opts.constraints},r=e[sk.name];return delete e[sk.name],{...t,method:r,opts:{constraints:e}}}function Dle(t){let e=` (${t.method})`,r=t.opts.constraints||{};return Object.keys(r).length!==0&&(e+=" "+JSON.stringify(r)),e+=Ule(t.metaData),e}function Xle(t){return t.reduce((e,r)=>{for(let n of e)if(nk(r.opts.constraints,n.opts.constraints)&&nk(r.metaData,n.metaData))return n.method+=", "+r.method,e;return e.push(r),e},[])}function $le(t,e,r){let n=t.routes;return r.method===void 0&&(n=n.map(Yle)),n=n.map(s=>(s.metaData=Lle(s,r),s)),r.method===void 0&&(n=Xle(n)),n.map(Dle).join(`
${e}`)}function lp(t,e,r,n){if((t.isLeafNode||n.commonPrefix!==!1)&&(r=r||"(empty root node)",e=e[r]={},t.isLeafNode&&(e[ik]=$le(t,r,n)),r=""),t.staticChildren)for(let s of Object.values(t.staticChildren))lp(s,e,r+s.prefix,n);if(t.parametricChildren)for(let s of Object.values(t.parametricChildren)){let i=Array.from(s.nodePaths).join("|");lp(s,e,r+i,n)}t.wildcardChild&&lp(t.wildcardChild,e,"*",n)}function jle(t,e){let r={};return lp(t,r,t.prefix,e),ok(r)}ck.exports={prettyPrintTree:jle}});var dk=h((zNe,uk)=>{"use strict";var qle=cp(),JS=class{constructor(){this.unconstrainedHandler=null,this.constraints=[],this.handlers=[],this.constrainedHandlerStores=null}getMatchingHandler(e){return e===void 0?this.unconstrainedHandler:this._getHandlerMatchingConstraints(e)}addHandler(e,r){let n=r.params,s=r.opts.constraints||{},i={params:n,constraints:s,handler:r.handler,store:r.store||null,_createParamsObject:this._compileCreateParamsObject(n)},o=Object.keys(s);o.length===0&&(this.unconstrainedHandler=i);for(let c of o)this.constraints.includes(c)||(c==="version"?this.constraints.unshift(c):this.constraints.push(c));let a=o.includes(qle.name);if(!a&&this.handlers.length>=32)throw new Error("find-my-way supports a maximum of 32 route handlers per node when there are constraints, limit reached");this.handlers.push(i),this.handlers.sort((c,l)=>Object.keys(c.constraints).length-Object.keys(l.constraints).length),a||this._compileGetHandlerMatchingConstraints(e,s)}_compileCreateParamsObject(e){let r=[];for(let n=0;n<e.length;n++)r.push(`'${e[n]}': paramsArray[${n}]`);return new Function("paramsArray",`return {${r.join(",")}}`)}_getHandlerMatchingConstraints(){return null}_buildConstraintStore(e,r){for(let n=0;n<this.handlers.length;n++){let i=this.handlers[n].constraints[r];if(i!==void 0){let o=e.get(i)||0;o|=1<<n,e.set(i,o)}}}_constrainedIndexBitmask(e){let r=0;for(let n=0;n<this.handlers.length;n++)this.handlers[n].constraints[e]!==void 0&&(r|=1<<n);return~r}_compileGetHandlerMatchingConstraints(e){this.constrainedHandlerStores={};for(let n of this.constraints){let s=e.newStoreForConstraint(n);this.constrainedHandlerStores[n]=s,this._buildConstraintStore(s,n)}let r=[];r.push(`
    let candidates = ${(1<<this.handlers.length)-1}
    let mask, matches
    `);for(let n of this.constraints){r.push(`
      mask = ${this._constrainedIndexBitmask(n)}
      value = derivedConstraints.${n}
      `);let i=e.strategies[n].mustMatchWhenDerived?"matches":"(matches | mask)";r.push(`
      if (value === undefined) {
        candidates &= mask
      } else {
        matches = this.constrainedHandlerStores.${n}.get(value) || 0
        candidates &= ${i}
      }
      if (candidates === 0) return null;
      `)}for(let n in e.strategies)e.strategies[n].mustMatchWhenDerived&&!this.constraints.includes(n)&&r.push(`if (derivedConstraints.${n} !== undefined) return null`);r.push("return this.handlers[Math.floor(Math.log2(candidates))]"),this._getHandlerMatchingConstraints=new Function("derivedConstraints",r.join(`
`))}};uk.exports=JS});var gk=h((JNe,fk)=>{"use strict";var Mle=dk(),hp={STATIC:0,PARAMETRIC:1,WILDCARD:2},up=class{constructor(){this.isLeafNode=!1,this.routes=null,this.handlerStorage=null}addRoute(e,r){this.routes===null&&(this.routes=[]),this.handlerStorage===null&&(this.handlerStorage=new Mle),this.isLeafNode=!0,this.routes.push(e),this.handlerStorage.addHandler(r,e)}},dp=class extends up{constructor(){super(),this.staticChildren={}}findStaticMatchingChild(e,r){let n=this.staticChildren[e.charAt(r)];return n===void 0||!n.matchPrefix(e,r)?null:n}getStaticChild(e,r=0){if(e.length===r)return this;let n=this.findStaticMatchingChild(e,r);return n?n.getStaticChild(e,r+n.prefix.length):null}createStaticChild(e){if(e.length===0)return this;let r=this.staticChildren[e.charAt(0)];if(r){let s=1;for(;s<r.prefix.length;s++)if(e.charCodeAt(s)!==r.prefix.charCodeAt(s)){r=r.split(this,s);break}return r.createStaticChild(e.slice(s))}let n=e.charAt(0);return this.staticChildren[n]=new fp(e),this.staticChildren[n]}},fp=class t extends dp{constructor(e){super(),this.prefix=e,this.wildcardChild=null,this.parametricChildren=[],this.kind=hp.STATIC,this._compilePrefixMatch()}getParametricChild(e){let r=e&&e.source,n=this.parametricChildren.find(s=>(s.regex&&s.regex.source)===r);return n||null}createParametricChild(e,r,n){let s=this.getParametricChild(e);return s?(s.nodePaths.add(n),s):(s=new gp(e,r,n),this.parametricChildren.push(s),this.parametricChildren.sort((i,o)=>i.isRegex?o.isRegex?i.staticSuffix===null?1:o.staticSuffix===null?-1:o.staticSuffix.endsWith(i.staticSuffix)?1:i.staticSuffix.endsWith(o.staticSuffix)?-1:0:-1:1),s)}getWildcardChild(){return this.wildcardChild?this.wildcardChild:null}createWildcardChild(){return this.wildcardChild=this.getWildcardChild()||new pp,this.wildcardChild}split(e,r){let n=this.prefix.slice(0,r),s=this.prefix.slice(r);this.prefix=s,this._compilePrefixMatch();let i=new t(n);return i.staticChildren[s.charAt(0)]=this,e.staticChildren[n.charAt(0)]=i,i}getNextNode(e,r,n,s){let i=this.findStaticMatchingChild(e,r),o=0;if(i===null){if(this.parametricChildren.length===0)return this.wildcardChild;i=this.parametricChildren[0],o=1}this.wildcardChild!==null&&n.push({paramsCount:s,brotherPathIndex:r,brotherNode:this.wildcardChild});for(let a=this.parametricChildren.length-1;a>=o;a--)n.push({paramsCount:s,brotherPathIndex:r,brotherNode:this.parametricChildren[a]});return i}_compilePrefixMatch(){if(this.prefix.length===1){this.matchPrefix=()=>!0;return}let e=[];for(let r=1;r<this.prefix.length;r++){let n=this.prefix.charCodeAt(r);e.push(`path.charCodeAt(i + ${r}) === ${n}`)}this.matchPrefix=new Function("path","i",`return ${e.join(" && ")}`)}},gp=class extends dp{constructor(e,r,n){super(),this.isRegex=!!e,this.regex=e||null,this.staticSuffix=r||null,this.kind=hp.PARAMETRIC,this.nodePaths=new Set([n])}getNextNode(e,r){return this.findStaticMatchingChild(e,r)}},pp=class extends up{constructor(){super(),this.kind=hp.WILDCARD}getNextNode(){return null}};fk.exports={StaticNode:fp,ParametricNode:gp,WildcardNode:pp,NODE_TYPES:hp}});var hk=h((QNe,pk)=>{"use strict";var Kle=require("assert");function fu(){if(!(this instanceof fu))return new fu;this.store={},this.maxMajor=0,this.maxMinors={},this.maxPatches={}}fu.prototype.set=function(t,e){if(typeof t!="string")throw new TypeError("Version should be a string");let[r,n,s]=t.split(".");return r=Number(r)||0,n=Number(n)||0,s=Number(s)||0,r>=this.maxMajor&&(this.maxMajor=r,this.store.x=e,this.store["*"]=e,this.store["x.x"]=e,this.store["x.x.x"]=e),n>=(this.maxMinors[r]||0)&&(this.maxMinors[r]=n,this.store[`${r}.x`]=e,this.store[`${r}.x.x`]=e),s>=(this.store[`${r}.${n}`]||0)&&(this.maxPatches[`${r}.${n}`]=s,this.store[`${r}.${n}.x`]=e),this.store[`${r}.${n}.${s}`]=e,this};fu.prototype.get=function(t){return this.store[t]};pk.exports={name:"version",mustMatchWhenDerived:!0,storage:fu,validate(t){Kle(typeof t=="string","Version should be a string")}}});var yk=h((eVe,mk)=>{"use strict";var zle=require("assert");function Jle(){let t={},e=[];return{get:r=>{let n=t[r];if(n)return n;for(let s of e)if(s.host.test(r))return s.value},set:(r,n)=>{r instanceof RegExp?e.push({host:r,value:n}):t[r]=n}}}mk.exports={name:"host",mustMatchWhenDerived:!1,storage:Jle,validate(t){zle(typeof t=="string"||Object.prototype.toString.call(t)==="[object RegExp]","Host should be a string or a RegExp")}}});var bk=h((tVe,Ik)=>{"use strict";var Qle=hk(),eue=yk(),QS=require("assert"),ev=class{constructor(e){if(this.strategies={version:Qle,host:eue},this.strategiesInUse=new Set,this.asyncStrategiesInUse=new Set,e)for(let r of Object.values(e))this.addConstraintStrategy(r)}isStrategyUsed(e){return this.strategiesInUse.has(e)||this.asyncStrategiesInUse.has(e)}hasConstraintStrategy(e){let r=this.strategies[e];return r!==void 0?r.isCustom||this.isStrategyUsed(e):!1}addConstraintStrategy(e){if(QS(typeof e.name=="string"&&e.name!=="","strategy.name is required."),QS(e.storage&&typeof e.storage=="function","strategy.storage function is required."),QS(e.deriveConstraint&&typeof e.deriveConstraint=="function","strategy.deriveConstraint function is required."),this.strategies[e.name]&&this.strategies[e.name].isCustom)throw new Error(`There already exists a custom constraint with the name ${e.name}.`);if(this.isStrategyUsed(e.name))throw new Error(`There already exists a route with ${e.name} constraint.`);e.isCustom=!0,e.isAsync=e.deriveConstraint.length===3,this.strategies[e.name]=e,e.mustMatchWhenDerived&&this.noteUsage({[e.name]:e})}deriveConstraints(e,r,n){let s=this.deriveSyncConstraints(e,r);if(n===void 0)return s;this.deriveAsyncConstraints(s,e,r,n)}deriveSyncConstraints(e,r){}noteUsage(e){if(e){let r=this.strategiesInUse.size;for(let n in e)this.strategies[n].isAsync?this.asyncStrategiesInUse.add(n):this.strategiesInUse.add(n);r!==this.strategiesInUse.size&&this._buildDeriveConstraints()}}newStoreForConstraint(e){if(!this.strategies[e])throw new Error(`No strategy registered for constraint key ${e}`);return this.strategies[e].storage()}validateConstraints(e){for(let r in e){let n=e[r];if(typeof n>"u")throw new Error("Can't pass an undefined constraint value, must pass null or no key at all");let s=this.strategies[r];if(!s)throw new Error(`No strategy registered for constraint key ${r}`);s.validate&&s.validate(n)}}deriveAsyncConstraints(e,r,n,s){let i=this.asyncStrategiesInUse.size;if(i===0){s(null,e);return}e=e||{};for(let o of this.asyncStrategiesInUse)this.strategies[o].deriveConstraint(r,n,(c,l)=>{if(c!==null){s(c);return}e[o]=l,--i===0&&s(null,e)})}_buildDeriveConstraints(){if(this.strategiesInUse.size===0)return;let e=["return {"];for(let r of this.strategiesInUse){let n=this.strategies[r];if(n.isCustom)e.push(`  ${n.name}: this.strategies.${r}.deriveConstraint(req, ctx),`);else if(r==="version")e.push("   version: req.headers['accept-version'],");else if(r==="host")e.push("   host: req.headers.host || req.headers[':authority'],");else throw new Error("unknown non-custom strategy for compiling constraint derivation function")}e.push("}"),this.deriveSyncConstraints=new Function("req","ctx",e.join(`
`)).bind(this)}};Ik.exports=ev});var Sk=h((rVe,Ck)=>{"use strict";var tue=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"];Ck.exports=tue});var Ak=h((nVe,_k)=>{"use strict";function vk(t,e){return t===50?e===53?"%":e===51?"#":e===52?"$":e===54?"&":e===66||e===98?"+":e===67||e===99?",":e===70||e===102?"/":null:t===51?e===65||e===97?":":e===66||e===98?";":e===68||e===100?"=":e===70||e===102?"?":null:t===52&&e===48?"@":null}function rue(t){let e=!1,r=!1,n="";for(let i=1;i<t.length;i++){let o=t.charCodeAt(i);if(o===37){let a=t.charCodeAt(i+1),c=t.charCodeAt(i+2);vk(a,c)===null?e=!0:(r=!0,a===50&&c===53&&(e=!0,t=t.slice(0,i+1)+"25"+t.slice(i+1),i+=2),i+=2)}else if(o===63||o===59||o===35){n=t.slice(i+1),t=t.slice(0,i);break}}return{path:e?decodeURI(t):t,querystring:n,shouldDecodeParam:r}}function nue(t){let e=t.indexOf("%");if(e===-1)return t;let r="",n=e;for(let s=e;s<t.length;s++)if(t.charCodeAt(s)===37){let i=t.charCodeAt(s+1),o=t.charCodeAt(s+2),a=vk(i,o);r+=t.slice(n,s)+a,n=s+3}return t.slice(0,e)+r+t.slice(n)}_k.exports={safeDecodeURI:rue,safeDecodeURIComponent:nue}});var ov=h((sVe,Zk)=>{"use strict";var dt=require("assert"),sue=XP(),mp=tk(),nv=pa(),{prettyPrintTree:iue}=lk(),{StaticNode:Rk,NODE_TYPES:tv}=gk(),oue=bk(),ja=Sk(),rv=cp(),{safeDecodeURI:aue,safeDecodeURIComponent:Ek}=Ak(),wk=/^https?:\/\/.*?\//,Io=/(\/:[^/()]*?)\?(\/?)/;if(!mp(wk))throw new Error("the FULL_PATH_REGEXP is not safe, update this module");if(!mp(Io))throw new Error("the OPTIONAL_PARAM_REGEXP is not safe, update this module");function st(t){if(!(this instanceof st))return new st(t);t=t||{},this._opts=t,t.defaultRoute?(dt(typeof t.defaultRoute=="function","The default route must be a function"),this.defaultRoute=t.defaultRoute):this.defaultRoute=null,t.onBadUrl?(dt(typeof t.onBadUrl=="function","The bad url handler must be a function"),this.onBadUrl=t.onBadUrl):this.onBadUrl=null,t.buildPrettyMeta?(dt(typeof t.buildPrettyMeta=="function","buildPrettyMeta must be a function"),this.buildPrettyMeta=t.buildPrettyMeta):this.buildPrettyMeta=cue,t.querystringParser?(dt(typeof t.querystringParser=="function","querystringParser must be a function"),this.querystringParser=t.querystringParser):this.querystringParser=e=>e===""?{}:sue.parse(e),this.caseSensitive=t.caseSensitive===void 0?!0:t.caseSensitive,this.ignoreTrailingSlash=t.ignoreTrailingSlash||!1,this.ignoreDuplicateSlashes=t.ignoreDuplicateSlashes||!1,this.maxParamLength=t.maxParamLength||100,this.allowUnsafeRegex=t.allowUnsafeRegex||!1,this.constrainer=new oue(t.constraints),this.routes=[],this.trees={}}st.prototype.on=function(e,r,n,s,i){typeof n=="function"&&(s!==void 0&&(i=s),s=n,n={}),dt(typeof r=="string","Path should be a string"),dt(r.length>0,"The path could not be empty"),dt(r[0]==="/"||r[0]==="*","The first character of a path should be `/` or `*`"),dt(typeof s=="function","Handler should be a function");let o=r.match(Io);if(o){dt(r.length===o.index+o[0].length,"Optional Parameter needs to be the last parameter of the path");let l=r.replace(Io,"$1$2"),u=r.replace(Io,"$2");this.on(e,l,n,s,i),this.on(e,u,n,s,i);return}let a=r;this.ignoreDuplicateSlashes&&(r=sv(r)),this.ignoreTrailingSlash&&(r=iv(r));let c=Array.isArray(e)?e:[e];for(let l of c)dt(typeof l=="string","Method should be a string"),dt(ja.includes(l),`Method '${l}' is not an http method.`),this._on(l,r,n,s,i,a)};st.prototype._on=function(e,r,n,s,i){let o={};n.constraints!==void 0&&(dt(typeof n.constraints=="object"&&n.constraints!==null,"Constraints should be an object"),Object.keys(n.constraints).length!==0&&(o=n.constraints)),this.constrainer.validateConstraints(o),this.constrainer.noteUsage(o),this.trees[e]===void 0&&(this.trees[e]=new Rk("/"));let a=r;if(a==="*"&&this.trees[e].prefix.length!==0){let f=this.trees[e];this.trees[e]=new Rk(""),this.trees[e].staticChildren["/"]=f}let c=this.trees[e],l=c.prefix.length,u=[];for(let f=0;f<=a.length;f++){if(a.charCodeAt(f)===58&&a.charCodeAt(f+1)===58){f++;continue}let g=a.charCodeAt(f)===58&&a.charCodeAt(f+1)!==58,p=a.charCodeAt(f)===42;if(g||p||f===a.length&&f!==l){let m=a.slice(l,f);this.caseSensitive||(m=m.toLowerCase()),m=m.split("::").join(":"),m=m.split("%").join("%25"),c=c.createStaticChild(m)}if(g){let m=!1,I=[],C=f+1;for(let S=C;;S++){let b=a.charCodeAt(S),y=b===40,A=b===45||b===46,E=b===47||S===a.length;if(y||A||E){let v=a.slice(C,S);if(u.push(v),m=m||y||A,y){let R=Gk(a,S),x=a.slice(S,R+1);this.allowUnsafeRegex||dt(mp(new RegExp(x)),`The regex '${x}' is not safe!`),I.push(Tk(x)),S=R+1}else I.push("(.*?)");let B=S;for(;S<a.length;S++){let R=a.charCodeAt(S);if(R===47)break;if(R===58)if(a.charCodeAt(S+1)===58)S++;else break}let H=a.slice(B,S);if(H&&(H=H.split("::").join(":"),H=H.split("%").join("%25"),I.push(Bk(H))),C=S+1,E||a.charCodeAt(S)===47||S===a.length){let R=m?"()"+H:H,x=a.slice(f,S);a=a.slice(0,f+1)+R+a.slice(S),f+=R.length;let F=m?new RegExp("^"+I.join("")+"$"):null;c=c.createParametricChild(F,H||null,x),l=f+1;break}}}}else if(p&&(u.push("*"),c=c.createWildcardChild(),l=f+1,f!==a.length-1))throw new Error("Wildcard must be the last character in the route")}this.caseSensitive||(a=a.toLowerCase()),a==="*"&&(a="/*");for(let f of this.routes){let g=f.opts.constraints||{};if(f.method===e&&f.pattern===a&&nv(g,o))throw new Error(`Method '${e}' already declared for route '${a}' with constraints '${JSON.stringify(o)}'`)}let d={method:e,path:r,pattern:a,params:u,opts:n,handler:s,store:i};this.routes.push(d),c.addRoute(d,this.constrainer)};st.prototype.hasRoute=function(e,r,n){return this.findRoute(e,r,n)!==null};st.prototype.findRoute=function(e,r,n={}){if(this.trees[e]===void 0)return null;let s=r,i=this.trees[e],o=i.prefix.length,a=[];for(let c=0;c<=s.length;c++){if(s.charCodeAt(c)===58&&s.charCodeAt(c+1)===58){c++;continue}let l=s.charCodeAt(c)===58&&s.charCodeAt(c+1)!==58,u=s.charCodeAt(c)===42;if(l||u||c===s.length&&c!==o){let d=s.slice(o,c);if(this.caseSensitive||(d=d.toLowerCase()),d=d.split("::").join(":"),d=d.split("%").join("%25"),i=i.getStaticChild(d),i===null)return null}if(l){let d=!1,f=[],g=c+1;for(let p=g;;p++){let m=s.charCodeAt(p),I=m===40,C=m===45||m===46,S=m===47||p===s.length;if(I||C||S){let b=s.slice(g,p);if(a.push(b),d=d||I||C,I){let E=Gk(s,p),v=s.slice(p,E+1);this.allowUnsafeRegex||dt(mp(new RegExp(v)),`The regex '${v}' is not safe!`),f.push(Tk(v)),p=E+1}else f.push("(.*?)");let y=p;for(;p<s.length;p++){let E=s.charCodeAt(p);if(E===47)break;if(E===58)if(s.charCodeAt(p+1)===58)p++;else break}let A=s.slice(y,p);if(A&&(A=A.split("::").join(":"),A=A.split("%").join("%25"),f.push(Bk(A))),g=p+1,S||s.charCodeAt(p)===47||p===s.length){let E=d?"()"+A:A,v=s.slice(c,p);s=s.slice(0,c+1)+E+s.slice(p),c+=E.length;let B=d?new RegExp("^"+f.join("")+"$"):null;if(i=i.getParametricChild(B,A||null,v),i===null)return null;o=c+1;break}}}}else if(u){if(a.push("*"),i=i.getWildcardChild(),i===null)return null;if(o=c+1,c!==s.length-1)throw new Error("Wildcard must be the last character in the route")}}this.caseSensitive||(s=s.toLowerCase()),s==="*"&&(s="/*");for(let c of this.routes){let l=c.opts.constraints||{};if(c.method===e&&c.pattern===s&&nv(l,n))return{handler:c.handler,store:c.store}}return null};st.prototype.hasConstraintStrategy=function(t){return this.constrainer.hasConstraintStrategy(t)};st.prototype.addConstraintStrategy=function(t){this.constrainer.addConstraintStrategy(t),this._rebuild(this.routes)};st.prototype.reset=function(){this.trees={},this.routes=[]};st.prototype.off=function(e,r,n){dt(typeof r=="string","Path should be a string"),dt(r.length>0,"The path could not be empty"),dt(r[0]==="/"||r[0]==="*","The first character of a path should be `/` or `*`"),dt(typeof n>"u"||typeof n=="object"&&!Array.isArray(n)&&n!==null,"Constraints should be an object or undefined.");let s=r.match(Io);if(s){dt(r.length===s.index+s[0].length,"Optional Parameter needs to be the last parameter of the path");let o=r.replace(Io,"$1$2"),a=r.replace(Io,"$2");this.off(e,o,n),this.off(e,a,n);return}this.ignoreDuplicateSlashes&&(r=sv(r)),this.ignoreTrailingSlash&&(r=iv(r));let i=Array.isArray(e)?e:[e];for(let o of i)this._off(o,r,n)};st.prototype._off=function(e,r,n){dt(typeof e=="string","Method should be a string"),dt(ja.includes(e),`Method '${e}' is not an http method.`);function s(c){return e!==c.method||r!==c.path}function i(c){return s(c)||!nv(n,c.opts.constraints||{})}let o=n?i:s,a=this.routes.filter(o);this._rebuild(a)};st.prototype.lookup=function(e,r,n,s){if(typeof n=="function"&&(s=n,n=void 0),s===void 0){let i=this.constrainer.deriveConstraints(e,n),o=this.find(e.method,e.url,i);return this.callHandler(o,e,r,n)}this.constrainer.deriveConstraints(e,n,(i,o)=>{if(i!==null){s(i);return}try{let a=this.find(e.method,e.url,o),c=this.callHandler(a,e,r,n);s(null,c)}catch(a){s(a)}})};st.prototype.callHandler=function(e,r,n,s){return e===null?this._defaultRoute(r,n,s):s===void 0?e.handler(r,n,e.params,e.store,e.searchParams):e.handler.call(s,r,n,e.params,e.store,e.searchParams)};st.prototype.find=function(e,r,n){let s=this.trees[e];if(s===void 0)return null;r.charCodeAt(0)!==47&&(r=r.replace(wk,"/")),this.ignoreDuplicateSlashes&&(r=sv(r));let i,o,a;try{i=aue(r),r=i.path,o=i.querystring,a=i.shouldDecodeParam}catch{return this._onBadUrl(r)}this.ignoreTrailingSlash&&(r=iv(r));let c=r;this.caseSensitive===!1&&(r=r.toLowerCase());let l=this.maxParamLength,u=s.prefix.length,d=[],f=r.length,g=[];for(;;){if(u===f&&s.isLeafNode){let m=s.handlerStorage.getMatchingHandler(n);if(m!==null)return{handler:m.handler,store:m.store,params:m._createParamsObject(d),searchParams:this.querystringParser(o)}}let p=s.getNextNode(r,u,g,d.length);if(p===null){if(g.length===0)return null;let m=g.pop();u=m.brotherPathIndex,d.splice(m.paramsCount),p=m.brotherNode}if(s=p,s.kind===tv.STATIC){u+=s.prefix.length;continue}if(s.kind===tv.WILDCARD){let m=c.slice(u);a&&(m=Ek(m)),d.push(m),u=f;continue}if(s.kind===tv.PARAMETRIC){let m=c.indexOf("/",u);m===-1&&(m=f);let I=c.slice(u,m);if(a&&(I=Ek(I)),s.isRegex){let C=s.regex.exec(I);if(C===null)continue;for(let S=1;S<C.length;S++){let b=C[S];if(b.length>l)return null;d.push(b)}}else{if(I.length>l)return null;d.push(I)}u=m}}};st.prototype._rebuild=function(t){this.reset();for(let e of t){let{method:r,path:n,opts:s,handler:i,store:o}=e;this._on(r,n,s,i,o)}};st.prototype._defaultRoute=function(t,e,r){if(this.defaultRoute!==null)return r===void 0?this.defaultRoute(t,e):this.defaultRoute.call(r,t,e);e.statusCode=404,e.end()};st.prototype._onBadUrl=function(t){if(this.onBadUrl===null)return null;let e=this.onBadUrl;return{handler:(r,n,s)=>e(t,r,n),params:{},store:null}};st.prototype.prettyPrint=function(t={}){let e=t.method;t.buildPrettyMeta=this.buildPrettyMeta.bind(this);let r=null;if(e===void 0){let{version:n,host:s,...i}=this.constrainer.strategies;i[rv.name]=rv;let o=new st({...this._opts,constraints:i}),a=this.routes.map(c=>{let l={...c.opts.constraints,[rv.name]:c.method};return{...c,method:"MERGED",opts:{constraints:l}}});o._rebuild(a),r=o.trees.MERGED}else r=this.trees[e];return r==null?"(empty tree)":iue(r,t)};for(let t in ja){if(!ja.hasOwnProperty(t))continue;let e=ja[t],r=e.toLowerCase();if(st.prototype[r])throw new Error("Method already exists: "+r);st.prototype[r]=function(n,s,i){return this.on(e,n,s,i)}}st.prototype.all=function(t,e,r){this.on(ja,t,e,r)};Zk.exports=st;function Bk(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sv(t){return t.replace(/\/\/+/g,"/")}function iv(t){return t.length>1&&t.charCodeAt(t.length-1)===47?t.slice(0,-1):t}function Tk(t){return t.charCodeAt(1)===94&&(t=t.slice(0,1)+t.slice(2)),t.charCodeAt(t.length-2)===36&&(t=t.slice(0,t.length-2)+t.slice(t.length-1)),t}function Gk(t,e){let r=1;for(;e<t.length;){if(e++,t[e]==="\\"){e++;continue}if(t[e]===")"?r--:t[e]==="("&&r++,!r)return e}throw new TypeError('Invalid regexp expression in "'+t+'"')}function cue(t){return t?t.store?Object.assign({},t.store):{}:{}}});var Vk=h((iVe,Nk)=>{"use strict";function av(t,e,r,n){if(r===void 0)return e.header("content-length","0"),n(null,null);if(typeof r.resume=="function")return r.on("error",i=>{e.log.error({err:i},"Error on Stream found for HEAD route")}),r.resume(),n(null,null);let s=""+Buffer.byteLength(r);e.header("content-length",s),n(null,null)}function lue(t){return t==null?av:Array.isArray(t)?[...t,av]:[t,av]}Nk.exports={parseHeadOnSendHandlers:lue}});var Kk=h((oVe,Mk)=>{"use strict";var uue=ov(),due=xg(),Hk=oI(),{onRequestAbortHookRunner:fue,lifecycleHooks:Wk,preParsingHookRunner:gue,onTimeoutHookRunner:pue,onRequestHookRunner:hue}=js(),{supportedMethods:mue}=V0(),{normalizeSchema:yue}=nl(),{parseHeadOnSendHandlers:Iue}=Vk(),{FSTDEP007:bue,FSTDEP008:Cue,FSTDEP014:Ok}=is(),{compileSchemasForValidation:Sue,compileSchemasForSerialization:vue}=tI(),{FST_ERR_SCH_VALIDATION_BUILD:_ue,FST_ERR_SCH_SERIALIZATION_BUILD:Aue,FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:Rue,FST_ERR_DUPLICATED_ROUTE:Eue,FST_ERR_INVALID_URL:wue,FST_ERR_HOOK_INVALID_HANDLER:Pk,FST_ERR_ROUTE_OPTIONS_NOT_OBJ:Bue,FST_ERR_ROUTE_DUPLICATED_HANDLER:Tue,FST_ERR_ROUTE_HANDLER_NOT_FN:kk,FST_ERR_ROUTE_MISSING_HANDLER:Gue,FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:Zue,FST_ERR_ROUTE_METHOD_INVALID:Nue,FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:Vue,FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:Hue,FST_ERR_HOOK_INVALID_ASYNC_HANDLER:cv}=Yt(),{kRoutePrefix:Wue,kLogLevel:Oue,kLogSerializers:Fk,kHooks:xk,kSchemaController:Pue,kOptions:Lk,kReplySerializerDefault:lv,kReplyIsError:kue,kRequestPayloadStream:Fue,kDisableRequestLogging:xue,kSchemaErrorFormatter:Lue,kErrorHandler:Uk,kHasBeenDecorated:Yk,kRequestAcceptVersion:uv,kRouteByFastify:dv,kRouteContext:Dk}=Tt(),{buildErrorHandler:Uue}=Hl(),{createChildLogger:Yue}=tl();function Due(t){let e=uue(t.config),r,n,s,i,o,a,c,l,u,d,f,g,p,m,I=!1;return{setup(B,H){r=H.avvio,n=H.fourOhFour,s=H.logger,i=H.hasLogger,o=H.setupResponseListeners,a=H.throwIfAlreadyStarted,p=H.validateHTTPVersion,g=B.exposeHeadRoutes,c=B.genReqId,l=B.disableRequestLogging,u=B.ignoreTrailingSlash,d=B.ignoreDuplicateSlashes,f=Object.prototype.hasOwnProperty.call(B,"return503OnClosing")?B.return503OnClosing:!0,m=H.keepAliveConnections},routing:e.lookup.bind(e),route:E,hasRoute:A,prepareRoute:y,getDefaultRoute:function(){return Ok(),e.defaultRoute},setDefaultRoute:function(B){if(Ok(),typeof B!="function")throw new Rue;e.defaultRoute=B},routeHandler:v,closeRoutes:()=>{I=!0},printRoutes:e.prettyPrint.bind(e),addConstraintStrategy:C,hasConstraintStrategy:S,isAsyncConstraint:b};function C(B){return a("Cannot add constraint strategy!"),e.addConstraintStrategy(B)}function S(B){return e.hasConstraintStrategy(B)}function b(){return e.constrainer.asyncStrategiesInUse.size>0}function y({method:B,url:H,options:R,handler:x,isFastify:F}){if(typeof H!="string")throw new wue(typeof H);if(!x&&typeof R=="function")x=R,R={};else if(x&&typeof x=="function"){if(Object.prototype.toString.call(R)!=="[object Object]")throw new Bue(B,H);if(R.handler)throw typeof R.handler=="function"?new Tue(B,H):new kk(B,H)}return R=Object.assign({},R,{method:B,url:H,path:H,handler:x||R&&R.handler}),E.call(this,{options:R,isFastify:F})}function A({options:B}){return e.find(B.method,B.url||"",B.constraints)!==null}function E({options:B,isFastify:H}){let R={...B},{exposeHeadRoute:x}=R,L=x!=null?x:g,ie=R.method==="GET"||Array.isArray(R.method)&&R.method.includes("GET"),pe=R.method==="HEAD"||Array.isArray(R.method)&&R.method.includes("HEAD"),$=L&&ie?{...B}:null;a("Cannot add route!");let ee=R.url||R.path||"";if(Array.isArray(R.method))for(var ke=0;ke<R.method.length;++ke)R.method[ke]=Xk(R.method[ke]),$k(R.method[ke],ee,R.schema);else R.method=Xk(R.method),$k(R.method,ee,R.schema);if(!R.handler)throw new Gue(R.method,ee);if(R.errorHandler!==void 0&&typeof R.errorHandler!="function")throw new kk(R.method,ee);qk(R.bodyLimit);let j=this[Wue];if(ee==="/"&&j.length>0&&R.method!=="HEAD")switch(R.prefixTrailingSlash){case"slash":ot.call(this,{path:ee,isFastify:H});break;case"no-slash":ot.call(this,{path:"",isFastify:H});break;case"both":default:ot.call(this,{path:"",isFastify:H}),u!==!0&&(d!==!0||!j.endsWith("/"))&&ot.call(this,{path:ee,prefixing:!0,isFastify:H})}else ee[0]==="/"&&j.endsWith("/")?ot.call(this,{path:ee.slice(1),isFastify:H}):ot.call(this,{path:ee,isFastify:H});return this;function ot({path:Gr,prefixing:He=!1,isFastify:Qn=!1}){let Rt=j+Gr;if(R.url=Rt,R.path=Rt,R.routePath=Gr,R.prefix=j,R.logLevel=R.logLevel||this[Oue],(this[Fk]||R.logSerializers)&&(R.logSerializers=Object.assign(Object.create(this[Fk]),R.logSerializers)),R.attachValidation==null&&(R.attachValidation=!1),He===!1)for(let We of this[xk].onRoute)We.call(this,R);for(let We of Wk)if(R&&We in R){if(Array.isArray(R[We]))for(let N of R[We]){if(typeof N!="function")throw new Pk(We,Object.prototype.toString.call(N));if(We==="onSend"||We==="preSerialization"||We==="onError"||We==="preParsing"){if(N.constructor.name==="AsyncFunction"&&N.length===4)throw new cv}else if(We==="onRequestAbort"){if(N.constructor.name==="AsyncFunction"&&N.length!==1)throw new cv}else if(N.constructor.name==="AsyncFunction"&&N.length===3)throw new cv}else if(R[We]!==void 0&&typeof R[We]!="function")throw new Pk(We,Object.prototype.toString.call(R[We]))}let Ce=R.constraints||{},mt={...R.config,url:Rt,method:R.method},ce=new due({schema:R.schema,handler:R.handler.bind(this),config:mt,errorHandler:R.errorHandler,childLoggerFactory:R.childLoggerFactory,bodyLimit:R.bodyLimit,logLevel:R.logLevel,logSerializers:R.logSerializers,attachValidation:R.attachValidation,schemaErrorFormatter:R.schemaErrorFormatter,replySerializer:this[lv],validatorCompiler:R.validatorCompiler,serializerCompiler:R.serializerCompiler,exposeHeadRoute:L,prefixTrailingSlash:R.prefixTrailingSlash||"both",server:this,isFastify:Qn});R.version&&(Cue(),Ce.version=R.version);let Ve=e.findRoute("HEAD",R.url,Ce),Ir=Ve!==null;pe&&Ir&&!ce[dv]&&Ve.store[dv]&&e.off("HEAD",R.url,Ce);try{e.on(R.method,R.url,{constraints:Ce},v,ce)}catch(We){if(!ce[dv])throw We.message.includes(`Method '${R.method}' already declared for route '${R.url}'`)?new Eue(R.method,R.url):We}if(this.after((We,N)=>{ce.errorHandler=R.errorHandler?Uue(this[Uk],R.errorHandler):this[Uk],ce._parserOptions.limit=R.bodyLimit||null,ce.logLevel=R.logLevel,ce.logSerializers=R.logSerializers,ce.attachValidation=R.attachValidation,ce[lv]=this[lv],ce.schemaErrorFormatter=R.schemaErrorFormatter||this[Lue]||ce.schemaErrorFormatter,r.once("preReady",()=>{for(let W of Wk){let D=this[xk][W].concat(R[W]||[]).map(M=>M.bind(this));ce[W]=D.length?D:null}for(;!ce.Request[Yk]&&ce.Request.parent;)ce.Request=ce.Request.parent;for(;!ce.Reply[Yk]&&ce.Reply.parent;)ce.Reply=ce.Reply.parent;if(n.setContext(this,ce),R.schema){ce.schema=yue(ce.schema,this.initialConfig);let W=this[Pue];!R.validatorCompiler&&(R.schema.body||R.schema.headers||R.schema.querystring||R.schema.params)&&W.setupValidator(this[Lk]);try{let D=typeof R?.validatorCompiler=="function"||W.isCustomValidatorCompiler;Sue(ce,R.validatorCompiler||W.validatorCompiler,D)}catch(D){throw new _ue(R.method,Rt,D.message)}R.schema.response&&!R.serializerCompiler&&W.setupSerializer(this[Lk]);try{vue(ce,R.serializerCompiler||W.serializerCompiler)}catch(D){throw new Aue(R.method,Rt,D.message)}}}),N(We)}),L&&ie&&!pe&&!Ir){let We=Iue($.onSend);y.call(this,{method:"HEAD",url:Gr,options:{...$,onSend:We},isFastify:!0})}else Ir&&x&&bue()}}function v(B,H,R,x,F){let L=c(B),ie={level:x.logLevel};x.logSerializers&&(ie.serializers=x.logSerializers);let pe=Yue(x,s,B,L,ie);if(pe[xue]=l,!p(B.httpVersion)){pe.info({res:{statusCode:505}},"request aborted - invalid HTTP version");let j='{"error":"HTTP Version Not Supported","message":"HTTP Version Not Supported","statusCode":505}',ot={"Content-Type":"application/json","Content-Length":j.length};H.writeHead(505,ot),H.end(j);return}if(I===!0&&(B.httpVersionMajor!==2&&H.setHeader("Connection","close"),f)){let j={"Content-Type":"application/json","Content-Length":"80"};H.writeHead(503,j),H.end('{"error":"Service Unavailable","message":"Service Unavailable","statusCode":503}'),pe.info({res:{statusCode:503}},"request aborted - refusing to accept new requests as server is closing");return}String.prototype.toLowerCase.call(B.headers.connection||"")==="keep-alive"&&m.has(B.socket)===!1&&(m.add(B.socket),B.socket.on("close",jue.bind({keepAliveConnections:m,socket:B.socket}))),B.headers[uv]!==void 0&&(B.headers["accept-version"]=B.headers[uv],B.headers[uv]=void 0);let ee=new x.Request(L,R,B,F,pe,x),ke=new x.Reply(H,ee,pe);l===!1&&pe.info({req:ee},"incoming request"),(i===!0||x.onResponse!==null)&&o(ke),x.onRequest!==null?hue(x.onRequest,ee,ke,jk):jk(null,ee,ke),x.onRequestAbort!==null&&B.on("close",()=>{B.aborted&&fue(x.onRequestAbort,ee,Xue.bind(null,ke))}),x.onTimeout!==null&&(ee.raw.socket._meta||ee.raw.socket.on("timeout",$ue),ee.raw.socket._meta={context:x,request:ee,reply:ke})}}function Xue(t,e){e&&t.log.error({err:e},"onRequestAborted hook failed")}function $ue(){let{context:t,request:e,reply:r}=this._meta;pue(t.onTimeout,e,r,que)}function Xk(t){if(typeof t!="string")throw new Nue;if(t=t.toUpperCase(),mue.indexOf(t)===-1)throw new Zue(t);return t}function $k(t,e,r){if((t==="GET"||t==="HEAD")&&r&&r.body)throw new Vue(t,e)}function qk(t){if(t!==void 0&&(!Number.isInteger(t)||t<=0))throw new Hue(t)}function jk(t,e,r){if(r.sent!==!0){if(t!=null){r[kue]=!0,r.send(t);return}e[Fue]=e.raw,e[Dk].preParsing!==null?gue(e[Dk].preParsing,e,r,Hk):Hk(null,e,r)}}function jue(){this.keepAliveConnections.delete(this.socket)}function que(){}Mk.exports={buildRouting:Due,validateBodyLimitOption:qk}});var rF=h((aVe,tF)=>{"use strict";var Mue=ov(),zk=_g(),Jk=Fg(),Kue=xg(),{kRoutePrefix:zue,kCanSetNotFoundHandler:gu,kFourOhFourLevelInstance:pu,kFourOhFourContext:Vn,kHooks:Jue,kErrorHandler:Qk}=Tt(),{lifecycleHooks:Que}=js(),{buildErrorHandler:ede}=Hl(),{FST_ERR_NOT_FOUND:tde}=Yt(),{createChildLogger:eF}=tl();function rde(t){let{logger:e,genReqId:r}=t,n=Mue({onBadUrl:a(),defaultRoute:d}),s=null;return{router:n,setNotFoundHandler:l,setContext:c,arrange404:i};function i(f){f[pu]=f,f[gu]=!0,n.onBadUrl=n.onBadUrl.bind(f),n.defaultRoute=n.defaultRoute.bind(f)}function o(f,g){let{url:p,method:m}=f.raw,I=`Route ${m}:${p} not found`;f.log.info(I),g.code(404).send({message:I,error:"Not Found",statusCode:404})}function a(){return function(g,p,m){let I=r(p),C=this[pu][Vn],S=eF(C,e,p,I),b=new Jk(I,null,p,null,S,C),y=new zk(m,b,S);s(b,y)}}function c(f,g){let p=Object.assign({},f[Vn]);p.onSend=g.onSend,g[Vn]=p}function l(f,g,p,m){this[gu]===void 0&&(this[gu]=!0),this[Vn]===void 0&&(this[Vn]=null);let I=this,C=this[zue]||"/";if(this[gu]===!1)throw new Error(`Not found handler already set for Fastify instance with prefix: '${C}'`);typeof f=="object"&&(f.preHandler&&(Array.isArray(f.preHandler)?f.preHandler=f.preHandler.map(S=>S.bind(I)):f.preHandler=f.preHandler.bind(I)),f.preValidation&&(Array.isArray(f.preValidation)?f.preValidation=f.preValidation.map(S=>S.bind(I)):f.preValidation=f.preValidation.bind(I))),typeof f=="function"&&(g=f,f=void 0),f=f||{},g?(this[pu][gu]=!1,g=g.bind(this),s=g):(g=o,s=o),this.after((S,b)=>{u.call(this,C,f,g,p,m),b(S)})}function u(f,g,p,m,I){let C=new Kue({schema:g.schema,handler:p,config:g.config||{},server:this});if(m.once("preReady",()=>{let S=this[Vn];for(let b of Que){let y=this[Jue][b].concat(g[b]||[]).map(A=>A.bind(this));S[b]=y.length?y:null}S.errorHandler=g.errorHandler?ede(this[Qk],g.errorHandler):this[Qk]}),this[Vn]!==null&&f==="/"){Object.assign(this[Vn],C);return}this[pu][Vn]=C,n.all(f+(f.endsWith("/")?"*":"/*"),I,C),n.all(f,I,C)}function d(f,g){let p=r(f),m=this[pu][Vn],I=eF(m,e,f,p);I.info({req:f},"incoming request");let C=new Jk(p,null,f,null,I,m),S=new zk(g,C,I);C.log.warn("the default handler for 404 did not catch this, this is likely a fastify bug, please report it"),C.log.warn(n.prettyPrint()),S.code(404).send(new tde)}}tF.exports=rde});var sF=h((cVe,yp)=>{"use strict";yp.exports=Ge;yp.exports.default=Ge;var nF={type:"object",additionalProperties:!1,properties:{connectionTimeout:{type:"integer",default:0},keepAliveTimeout:{type:"integer",default:72e3},forceCloseConnections:{oneOf:[{type:"string",pattern:"idle"},{type:"boolean"}]},maxRequestsPerSocket:{type:"integer",default:0,nullable:!0},requestTimeout:{type:"integer",default:0},bodyLimit:{type:"integer",default:1048576},caseSensitive:{type:"boolean",default:!0},allowUnsafeRegex:{type:"boolean",default:!1},http2:{type:"boolean"},https:{if:{not:{oneOf:[{type:"boolean"},{type:"null"},{type:"object",additionalProperties:!1,required:["allowHTTP1"],properties:{allowHTTP1:{type:"boolean"}}}]}},then:{setDefaultValue:!0}},ignoreTrailingSlash:{type:"boolean",default:!1},ignoreDuplicateSlashes:{type:"boolean",default:!1},disableRequestLogging:{type:"boolean",default:!1},jsonShorthand:{type:"boolean",default:!0},maxParamLength:{type:"integer",default:100},onProtoPoisoning:{type:"string",default:"error"},onConstructorPoisoning:{type:"string",default:"error"},pluginTimeout:{type:"integer",default:1e4},requestIdHeader:{anyOf:[{enum:[!1]},{type:"string"}],default:"request-id"},requestIdLogLabel:{type:"string",default:"reqId"},http2SessionTimeout:{type:"integer",default:72e3},exposeHeadRoutes:{type:"boolean",default:!0},versioning:{type:"object",additionalProperties:!0,required:["storage","deriveVersion"],properties:{storage:{},deriveVersion:{}}},constraints:{type:"object",additionalProperties:{type:"object",required:["name","storage","validate","deriveConstraint"],additionalProperties:!0,properties:{name:{type:"string"},storage:{},validate:{},deriveConstraint:{}}}}}},nde=Object.prototype.hasOwnProperty,sde=new RegExp("idle","u");function Ge(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){t.connectionTimeout===void 0&&(t.connectionTimeout=0),t.keepAliveTimeout===void 0&&(t.keepAliveTimeout=72e3),t.maxRequestsPerSocket===void 0&&(t.maxRequestsPerSocket=0),t.requestTimeout===void 0&&(t.requestTimeout=0),t.bodyLimit===void 0&&(t.bodyLimit=1048576),t.caseSensitive===void 0&&(t.caseSensitive=!0),t.allowUnsafeRegex===void 0&&(t.allowUnsafeRegex=!1),t.ignoreTrailingSlash===void 0&&(t.ignoreTrailingSlash=!1),t.ignoreDuplicateSlashes===void 0&&(t.ignoreDuplicateSlashes=!1),t.disableRequestLogging===void 0&&(t.disableRequestLogging=!1),t.jsonShorthand===void 0&&(t.jsonShorthand=!0),t.maxParamLength===void 0&&(t.maxParamLength=100),t.onProtoPoisoning===void 0&&(t.onProtoPoisoning="error"),t.onConstructorPoisoning===void 0&&(t.onConstructorPoisoning="error"),t.pluginTimeout===void 0&&(t.pluginTimeout=1e4),t.requestIdHeader===void 0&&(t.requestIdHeader="request-id"),t.requestIdLogLabel===void 0&&(t.requestIdLogLabel="reqId"),t.http2SessionTimeout===void 0&&(t.http2SessionTimeout=72e3),t.exposeHeadRoutes===void 0&&(t.exposeHeadRoutes=!0);let p=o;for(let m in t)nde.call(nF.properties,m)||delete t[m];if(p===o){let m=t.connectionTimeout,I=o;if(!(typeof m=="number"&&!(m%1)&&!isNaN(m)&&isFinite(m))){let C=typeof m,S;if(S===void 0)if(C==="boolean"||m===null||C==="string"&&m&&m==+m&&!(m%1))S=+m;else return Ge.errors=[{instancePath:e+"/connectionTimeout",schemaPath:"#/properties/connectionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;S!==void 0&&(m=S,t!==void 0&&(t.connectionTimeout=S))}var a=I===o;if(a){let C=t.keepAliveTimeout,S=o;if(!(typeof C=="number"&&!(C%1)&&!isNaN(C)&&isFinite(C))){let y=typeof C,A;if(A===void 0)if(y==="boolean"||C===null||y==="string"&&C&&C==+C&&!(C%1))A=+C;else return Ge.errors=[{instancePath:e+"/keepAliveTimeout",schemaPath:"#/properties/keepAliveTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;A!==void 0&&(C=A,t!==void 0&&(t.keepAliveTimeout=A))}var a=S===o;if(a){if(t.forceCloseConnections!==void 0){let y=t.forceCloseConnections,A=o,E=o,v=!1,B=null,H=o;if(typeof y!="string"){let F=typeof y,L;if(L===void 0)if(F=="number"||F=="boolean")L=""+y;else if(y===null)L="";else{let ie={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ie]:i.push(ie),o++}L!==void 0&&(y=L,t!==void 0&&(t.forceCloseConnections=L))}if(o===H&&typeof y=="string"&&!sde.test(y)){let F={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/pattern",keyword:"pattern",params:{pattern:"idle"},message:'must match pattern "idle"'};i===null?i=[F]:i.push(F),o++}var c=H===o;c&&(v=!0,B=0);let R=o;if(typeof y!="boolean"){let F;if(F===void 0)if(y==="false"||y===0||y===null)F=!1;else if(y==="true"||y===1)F=!0;else{let L={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/1/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};i===null?i=[L]:i.push(L),o++}F!==void 0&&(y=F,t!==void 0&&(t.forceCloseConnections=F))}var c=R===o;if(c&&v?(v=!1,B=[B,1]):c&&(v=!0,B=1),v)o=E,i!==null&&(E?i.length=E:i=null);else{let F={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf",keyword:"oneOf",params:{passingSchemas:B},message:"must match exactly one schema in oneOf"};return i===null?i=[F]:i.push(F),o++,Ge.errors=i,!1}var a=A===o}else var a=!0;if(a){let y=t.maxRequestsPerSocket,A=o;if(!(typeof y=="number"&&!(y%1)&&!isNaN(y)&&isFinite(y))&&y!==null){let v=typeof y,B;if(B===void 0)if(v==="boolean"||y===null||v==="string"&&y&&y==+y&&!(y%1))B=+y;else if(y===""||y===0||y===!1)B=null;else return Ge.errors=[{instancePath:e+"/maxRequestsPerSocket",schemaPath:"#/properties/maxRequestsPerSocket/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;B!==void 0&&(y=B,t!==void 0&&(t.maxRequestsPerSocket=B))}var a=A===o;if(a){let v=t.requestTimeout,B=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v))){let R=typeof v,x;if(x===void 0)if(R==="boolean"||v===null||R==="string"&&v&&v==+v&&!(v%1))x=+v;else return Ge.errors=[{instancePath:e+"/requestTimeout",schemaPath:"#/properties/requestTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;x!==void 0&&(v=x,t!==void 0&&(t.requestTimeout=x))}var a=B===o;if(a){let R=t.bodyLimit,x=o;if(!(typeof R=="number"&&!(R%1)&&!isNaN(R)&&isFinite(R))){let L=typeof R,ie;if(ie===void 0)if(L==="boolean"||R===null||L==="string"&&R&&R==+R&&!(R%1))ie=+R;else return Ge.errors=[{instancePath:e+"/bodyLimit",schemaPath:"#/properties/bodyLimit/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;ie!==void 0&&(R=ie,t!==void 0&&(t.bodyLimit=ie))}var a=x===o;if(a){let L=t.caseSensitive,ie=o;if(typeof L!="boolean"){let $;if($===void 0)if(L==="false"||L===0||L===null)$=!1;else if(L==="true"||L===1)$=!0;else return Ge.errors=[{instancePath:e+"/caseSensitive",schemaPath:"#/properties/caseSensitive/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;$!==void 0&&(L=$,t!==void 0&&(t.caseSensitive=$))}var a=ie===o;if(a){let $=t.allowUnsafeRegex,ee=o;if(typeof $!="boolean"){let j;if(j===void 0)if($==="false"||$===0||$===null)j=!1;else if($==="true"||$===1)j=!0;else return Ge.errors=[{instancePath:e+"/allowUnsafeRegex",schemaPath:"#/properties/allowUnsafeRegex/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;j!==void 0&&($=j,t!==void 0&&(t.allowUnsafeRegex=j))}var a=ee===o;if(a){if(t.http2!==void 0){let j=t.http2,ot=o;if(typeof j!="boolean"){let He;if(He===void 0)if(j==="false"||j===0||j===null)He=!1;else if(j==="true"||j===1)He=!0;else return Ge.errors=[{instancePath:e+"/http2",schemaPath:"#/properties/http2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;He!==void 0&&(j=He,t!==void 0&&(t.http2=He))}var a=ot===o}else var a=!0;if(a){if(t.https!==void 0){let j=t.https,ot=o,Gr=o,He=!0,Qn=o,Rt=o,Ce=o,mt=o,ce=!1,Ve=null,Ir=o;if(typeof j!="boolean"){let W;if(W===void 0)if(j==="false"||j===0||j===null)W=!1;else if(j==="true"||j===1)W=!0;else{let D={};i===null?i=[D]:i.push(D),o++}W!==void 0&&(j=W,t!==void 0&&(t.https=W))}var l=Ir===o;l&&(ce=!0,Ve=0);let We=o;if(j!==null){let W;if(W===void 0)if(j===""||j===0||j===!1)W=null;else{let D={};i===null?i=[D]:i.push(D),o++}W!==void 0&&(j=W,t!==void 0&&(t.https=W))}var l=We===o;if(l&&ce)ce=!1,Ve=[Ve,1];else{l&&(ce=!0,Ve=1);let W=o;if(o===W)if(j&&typeof j=="object"&&!Array.isArray(j)){let M;if(j.allowHTTP1===void 0&&(M="allowHTTP1")){let he={};i===null?i=[he]:i.push(he),o++}else{let he=o;for(let oe in j)oe!=="allowHTTP1"&&delete j[oe];if(he===o&&j.allowHTTP1!==void 0){let oe=j.allowHTTP1;if(typeof oe!="boolean"){let we;if(we===void 0)if(oe==="false"||oe===0||oe===null)we=!1;else if(oe==="true"||oe===1)we=!0;else{let ze={};i===null?i=[ze]:i.push(ze),o++}we!==void 0&&(oe=we,j!==void 0&&(j.allowHTTP1=we))}}}}else{let M={};i===null?i=[M]:i.push(M),o++}var l=W===o;l&&ce?(ce=!1,Ve=[Ve,2]):l&&(ce=!0,Ve=2)}if(ce)o=mt,i!==null&&(mt?i.length=mt:i=null);else{let W={};i===null?i=[W]:i.push(W),o++}var u=Ce===o;if(u){let W={};i===null?i=[W]:i.push(W),o++}else o=Rt,i!==null&&(Rt?i.length=Rt:i=null);var d=Qn===o;if(o=Gr,i!==null&&(Gr?i.length=Gr:i=null),d){let W=o;t.https=!0;var d=W===o;He=d}if(!He){let W={instancePath:e+"/https",schemaPath:"#/properties/https/if",keyword:"if",params:{failingKeyword:"then"},message:'must match "then" schema'};return i===null?i=[W]:i.push(W),o++,Ge.errors=i,!1}var a=ot===o}else var a=!0;if(a){let j=t.ignoreTrailingSlash,ot=o;if(typeof j!="boolean"){let He;if(He===void 0)if(j==="false"||j===0||j===null)He=!1;else if(j==="true"||j===1)He=!0;else return Ge.errors=[{instancePath:e+"/ignoreTrailingSlash",schemaPath:"#/properties/ignoreTrailingSlash/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;He!==void 0&&(j=He,t!==void 0&&(t.ignoreTrailingSlash=He))}var a=ot===o;if(a){let He=t.ignoreDuplicateSlashes,Qn=o;if(typeof He!="boolean"){let Ce;if(Ce===void 0)if(He==="false"||He===0||He===null)Ce=!1;else if(He==="true"||He===1)Ce=!0;else return Ge.errors=[{instancePath:e+"/ignoreDuplicateSlashes",schemaPath:"#/properties/ignoreDuplicateSlashes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;Ce!==void 0&&(He=Ce,t!==void 0&&(t.ignoreDuplicateSlashes=Ce))}var a=Qn===o;if(a){let Ce=t.disableRequestLogging,mt=o;if(typeof Ce!="boolean"){let Ve;if(Ve===void 0)if(Ce==="false"||Ce===0||Ce===null)Ve=!1;else if(Ce==="true"||Ce===1)Ve=!0;else return Ge.errors=[{instancePath:e+"/disableRequestLogging",schemaPath:"#/properties/disableRequestLogging/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;Ve!==void 0&&(Ce=Ve,t!==void 0&&(t.disableRequestLogging=Ve))}var a=mt===o;if(a){let Ve=t.jsonShorthand,Ir=o;if(typeof Ve!="boolean"){let N;if(N===void 0)if(Ve==="false"||Ve===0||Ve===null)N=!1;else if(Ve==="true"||Ve===1)N=!0;else return Ge.errors=[{instancePath:e+"/jsonShorthand",schemaPath:"#/properties/jsonShorthand/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;N!==void 0&&(Ve=N,t!==void 0&&(t.jsonShorthand=N))}var a=Ir===o;if(a){let N=t.maxParamLength,W=o;if(!(typeof N=="number"&&!(N%1)&&!isNaN(N)&&isFinite(N))){let M=typeof N,he;if(he===void 0)if(M==="boolean"||N===null||M==="string"&&N&&N==+N&&!(N%1))he=+N;else return Ge.errors=[{instancePath:e+"/maxParamLength",schemaPath:"#/properties/maxParamLength/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;he!==void 0&&(N=he,t!==void 0&&(t.maxParamLength=he))}var a=W===o;if(a){let M=t.onProtoPoisoning,he=o;if(typeof M!="string"){let we=typeof M,ze;if(ze===void 0)if(we=="number"||we=="boolean")ze=""+M;else if(M===null)ze="";else return Ge.errors=[{instancePath:e+"/onProtoPoisoning",schemaPath:"#/properties/onProtoPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;ze!==void 0&&(M=ze,t!==void 0&&(t.onProtoPoisoning=ze))}var a=he===o;if(a){let we=t.onConstructorPoisoning,ze=o;if(typeof we!="string"){let Je=typeof we,vt;if(vt===void 0)if(Je=="number"||Je=="boolean")vt=""+we;else if(we===null)vt="";else return Ge.errors=[{instancePath:e+"/onConstructorPoisoning",schemaPath:"#/properties/onConstructorPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;vt!==void 0&&(we=vt,t!==void 0&&(t.onConstructorPoisoning=vt))}var a=ze===o;if(a){let Je=t.pluginTimeout,vt=o;if(!(typeof Je=="number"&&!(Je%1)&&!isNaN(Je)&&isFinite(Je))){let zr=typeof Je,es;if(es===void 0)if(zr==="boolean"||Je===null||zr==="string"&&Je&&Je==+Je&&!(Je%1))es=+Je;else return Ge.errors=[{instancePath:e+"/pluginTimeout",schemaPath:"#/properties/pluginTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;es!==void 0&&(Je=es,t!==void 0&&(t.pluginTimeout=es))}var a=vt===o;if(a){let zr=t.requestIdHeader,es=o,kc=o,Us=!1,Jr=o;if(zr!==!1){let Lt={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/0/enum",keyword:"enum",params:{allowedValues:nF.properties.requestIdHeader.anyOf[0].enum},message:"must be equal to one of the allowed values"};i===null?i=[Lt]:i.push(Lt),o++}var f=Jr===o;if(Us=Us||f,!Us){let Lt=o;if(typeof zr!="string"){let Ys=typeof zr,je;if(je===void 0)if(Ys=="number"||Ys=="boolean")je=""+zr;else if(zr===null)je="";else{let br={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[br]:i.push(br),o++}je!==void 0&&(zr=je,t!==void 0&&(t.requestIdHeader=je))}var f=Lt===o;Us=Us||f}if(Us)o=kc,i!==null&&(kc?i.length=kc:i=null);else{let Lt={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[Lt]:i.push(Lt),o++,Ge.errors=i,!1}var a=es===o;if(a){let Lt=t.requestIdLogLabel,Xd=o;if(typeof Lt!="string"){let je=typeof Lt,br;if(br===void 0)if(je=="number"||je=="boolean")br=""+Lt;else if(Lt===null)br="";else return Ge.errors=[{instancePath:e+"/requestIdLogLabel",schemaPath:"#/properties/requestIdLogLabel/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;br!==void 0&&(Lt=br,t!==void 0&&(t.requestIdLogLabel=br))}var a=Xd===o;if(a){let je=t.http2SessionTimeout,br=o;if(!(typeof je=="number"&&!(je%1)&&!isNaN(je)&&isFinite(je))){let Cr=typeof je,Et;if(Et===void 0)if(Cr==="boolean"||je===null||Cr==="string"&&je&&je==+je&&!(je%1))Et=+je;else return Ge.errors=[{instancePath:e+"/http2SessionTimeout",schemaPath:"#/properties/http2SessionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;Et!==void 0&&(je=Et,t!==void 0&&(t.http2SessionTimeout=Et))}var a=br===o;if(a){let Cr=t.exposeHeadRoutes,Et=o;if(typeof Cr!="boolean"){let yt;if(yt===void 0)if(Cr==="false"||Cr===0||Cr===null)yt=!1;else if(Cr==="true"||Cr===1)yt=!0;else return Ge.errors=[{instancePath:e+"/exposeHeadRoutes",schemaPath:"#/properties/exposeHeadRoutes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;yt!==void 0&&(Cr=yt,t!==void 0&&(t.exposeHeadRoutes=yt))}var a=Et===o;if(a){if(t.versioning!==void 0){let yt=t.versioning,Li=o;if(o===Li)if(yt&&typeof yt=="object"&&!Array.isArray(yt)){let Qr;if(yt.storage===void 0&&(Qr="storage")||yt.deriveVersion===void 0&&(Qr="deriveVersion"))return Ge.errors=[{instancePath:e+"/versioning",schemaPath:"#/properties/versioning/required",keyword:"required",params:{missingProperty:Qr},message:"must have required property '"+Qr+"'"}],!1}else return Ge.errors=[{instancePath:e+"/versioning",schemaPath:"#/properties/versioning/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=Li===o}else var a=!0;if(a)if(t.constraints!==void 0){let yt=t.constraints,Li=o;if(o===Li)if(yt&&typeof yt=="object"&&!Array.isArray(yt))for(let Qr in yt){let Sr=yt[Qr],ts=o;if(o===ts)if(Sr&&typeof Sr=="object"&&!Array.isArray(Sr)){let Ds;if(Sr.name===void 0&&(Ds="name")||Sr.storage===void 0&&(Ds="storage")||Sr.validate===void 0&&(Ds="validate")||Sr.deriveConstraint===void 0&&(Ds="deriveConstraint"))return Ge.errors=[{instancePath:e+"/constraints/"+Qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/required",keyword:"required",params:{missingProperty:Ds},message:"must have required property '"+Ds+"'"}],!1;if(Sr.name!==void 0){let Xs=Sr.name;if(typeof Xs!="string"){let $d=typeof Xs,In;if(In===void 0)if($d=="number"||$d=="boolean")In=""+Xs;else if(Xs===null)In="";else return Ge.errors=[{instancePath:e+"/constraints/"+Qr.replace(/~/g,"~0").replace(/\//g,"~1")+"/name",schemaPath:"#/properties/constraints/additionalProperties/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;In!==void 0&&(Xs=In,Sr!==void 0&&(Sr.name=In))}}}else return Ge.errors=[{instancePath:e+"/constraints/"+Qr.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var g=ts===o;if(!g)break}else return Ge.errors=[{instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=Li===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}else return Ge.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ge.errors=i,o===0}yp.exports.defaultInitOptions={connectionTimeout:0,keepAliveTimeout:72e3,maxRequestsPerSocket:0,requestTimeout:0,bodyLimit:1048576,caseSensitive:!0,allowUnsafeRegex:!1,disableRequestLogging:!1,jsonShorthand:!0,ignoreTrailingSlash:!1,ignoreDuplicateSlashes:!1,maxParamLength:100,onProtoPoisoning:"error",onConstructorPoisoning:"error",pluginTimeout:1e4,requestIdHeader:"request-id",requestIdLogLabel:"reqId",http2SessionTimeout:72e3,exposeHeadRoutes:!0}});var iF=h((lVe,bp)=>{"use strict";var Ip=sF(),ide=rl()({circles:!0,proto:!1}),{FST_ERR_INIT_OPTS_INVALID:ode}=Yt();function ade(t){let e=ide(t);if(!Ip(e)){let r=new ode(JSON.stringify(Ip.errors.map(n=>n.message)));throw r.errors=Ip.errors,r}return fv(e)}function fv(t){let e=Object.getOwnPropertyNames(t);for(let r of e){let n=t[r];ArrayBuffer.isView(n)&&!(n instanceof DataView)||(t[r]=n&&typeof n=="object"?fv(n):n)}return Object.freeze(t)}bp.exports=ade;bp.exports.defaultInitOptions=Ip.defaultInitOptions;bp.exports.utils={deepFreezeObject:fv}});var pF=h((uVe,gF)=>{"use strict";var{kAvvioBoot:cde,kChildren:oF,kRoutePrefix:aF,kLogLevel:cF,kLogSerializers:gv,kHooks:pv,kSchemaController:qa,kContentTypeParser:lF,kReply:uF,kRequest:dF,kFourOhFour:lde,kPluginNameChain:fF}=Tt(),ude=_g(),dde=Fg(),fde=xS(),gde=q0(),{buildHooks:pde}=js(),hu=$S();gF.exports=function(e,r,n){let s=hu.registerPlugin.call(e,r),i=hu.getPluginName(r)||hu.getFuncPreview(r);if(s)return e[fF].push(i),e;let o=Object.create(e);e[oF].push(o),o.ready=e[cde].bind(o),o[oF]=[],o[uF]=ude.buildReply(o[uF]),o[dF]=dde.buildRequest(o[dF]),o[lF]=gde.helpers.buildContentTypeParser(o[lF]),o[pv]=pde(o[pv]),o[aF]=hde(o[aF],n.prefix),o[cF]=n.logLevel||o[cF],o[qa]=fde.buildSchemaController(e[qa]),o.getSchema=o[qa].getSchema.bind(o[qa]),o.getSchemas=o[qa].getSchemas.bind(o[qa]),o[hu.kRegisteredPlugins]=Object.create(o[hu.kRegisteredPlugins]),o[fF]=[i],(o[gv]||n.logSerializers)&&(o[gv]=Object.assign(Object.create(o[gv]),n.logSerializers)),n.prefix&&o[lde].arrange404(o);for(let a of o[pv].onRegister)a.call(this,o,n);return o};function hde(t,e){return e?(t.endsWith("/")&&e[0]==="/"?e=e.slice(1):e[0]!=="/"&&(e="/"+e),t+e):t}});var mF=h((dVe,hF)=>{"use strict";hF.exports=function(){return{[Symbol.iterator]:function*(){},add(){},delete(){},has(){return!0}}}});var yF=h(hv=>{"use strict";hv.parse=yde;hv.serialize=Ide;var mde=Object.prototype.toString,Cp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function yde(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var r={},n=e||{},s=n.decode||bde,i=0;i<t.length;){var o=t.indexOf("=",i);if(o===-1)break;var a=t.indexOf(";",i);if(a===-1)a=t.length;else if(a<o){i=t.lastIndexOf(";",o-1)+1;continue}var c=t.slice(i,o).trim();if(r[c]===void 0){var l=t.slice(o+1,a).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1)),r[c]=vde(l,s)}i=a+1}return r}function Ide(t,e,r){var n=r||{},s=n.encode||Cde;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!Cp.test(t))throw new TypeError("argument name is invalid");var i=s(e);if(i&&!Cp.test(i))throw new TypeError("argument val is invalid");var o=t+"="+i;if(n.maxAge!=null){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Cp.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!Cp.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){var c=n.expires;if(!Sde(c)||isNaN(c.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+c.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority){var l=typeof n.priority=="string"?n.priority.toLowerCase():n.priority;switch(l){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(n.sameSite){var u=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(u){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o}function bde(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function Cde(t){return encodeURIComponent(t)}function Sde(t){return mde.call(t)==="[object Date]"||t instanceof Date}function vde(t,e){try{return e(t)}catch{return t}}});var IF=h((gVe,Sp)=>{"use strict";var{format:mv}=require("node:util");function yv(){let t={},e=new Map,r=Object.create(null);function n(o,a,c,{unlimited:l=!1}={}){if(!o)throw new Error("Warning name must not be empty");if(!a)throw new Error("Warning code must not be empty");if(!c)throw new Error("Warning message must not be empty");if(typeof l!="boolean")throw new Error("Warning opts.unlimited must be a boolean");if(a=a.toUpperCase(),t[a]!==void 0)throw new Error(`The code '${a}' already exist`);function u(d,f,g){let p;return d&&f&&g?p=mv(c,d,f,g):d&&f?p=mv(c,d,f):d?p=mv(c,d):p=c,{code:a,name:o,message:p}}return Object.assign(r,{unlimited:l}),e.set(a,l),t[a]=u,t[a]}function s(o,a,c={}){return n("DeprecationWarning",o,a,c)}function i(o,a,c,l){if(e.get(o)===!0&&r.unlimited===!1)return;if(t[o]===void 0)throw new Error(`The code '${o}' does not exist`);e.set(o,!0);let u=t[o](a,c,l);process.emitWarning(u.message,u.name,u.code)}return{create:n,createDeprecation:s,emit:i,emitted:e}}Sp.exports=yv;Sp.exports.default=yv;Sp.exports.processWarning=yv});var SF=h((pVe,CF)=>{"use strict";var{URL:bF}=require("node:url"),Iv="http://localhost";CF.exports=function(e,r){(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]")&&e.startsWith("//")&&(e=Iv+e);let n=typeof e=="object"?Object.assign(new bF(Iv),e):new bF(e,Iv);if(typeof r=="string"){r=new URLSearchParams(r);for(let s of r.keys()){n.searchParams.delete(s);for(let i of r.getAll(s))n.searchParams.append(s,i)}}else{let s=Object.assign({},e.query,r);for(let i in s){let o=s[i];if(Array.isArray(o)){n.searchParams.delete(i);for(let a of o)n.searchParams.append(i,a)}else n.searchParams.set(i,o)}}return n}});var RF=h((hVe,vp)=>{"use strict";var{Readable:vF,addAbortSignal:_de}=require("node:stream"),Cv=require("node:util"),Ade=yF(),Rde=require("node:assert"),_F=IF()(),Ede=SF(),{EventEmitter:wde}=require("node:events");_F.create("FastifyDeprecationLightMyRequest","FST_LIGHTMYREQUEST_DEP01",'You are accessing "request.connection", use "request.socket" instead.');function Bde(t){return t.port?t.host:t.hostname+(t.protocol==="https:"?":443":":80")}var bv=class extends wde{constructor(e){super(),this.remoteAddress=e}};function AF(t){return new e(this);function e(r){Hn.call(r,{...t,Request:void 0}),Object.assign(this,r);for(let n of Object.keys(Hn.prototype))this.constructor.prototype[n]=Hn.prototype[n];return Cv.inherits(this.constructor,t.Request),this}}function Hn(t){vF.call(this,{autoDestroy:!1});let e=Ede(t.url||t.path,t.query);this.url=e.pathname+e.search,this.aborted=!1,this.httpVersionMajor=1,this.httpVersionMinor=1,this.httpVersion="1.1",this.method=t.method?t.method.toUpperCase():"GET",this.headers={},this.rawHeaders=[];let r=t.headers||{};for(let o in r){let a=o.toLowerCase();if((a==="user-agent"||a==="content-type")&&r[o]===void 0){this.headers[a]=void 0;continue}let c=r[o];Rde(c!==void 0,'invalid value "undefined" for header '+o),this.headers[a]=""+c}if("user-agent"in this.headers||(this.headers["user-agent"]="lightMyRequest"),this.headers.host=this.headers.host||t.authority||Bde(e),t.cookies){let{cookies:o}=t,a=Object.keys(o).map(c=>Ade.serialize(c,o[c]));this.headers.cookie&&a.unshift(this.headers.cookie),this.headers.cookie=a.join("; ")}this.socket=new bv(t.remoteAddress||"127.0.0.1"),Object.defineProperty(this,"connection",{get(){return _F.emit("FST_LIGHTMYREQUEST_DEP01"),this.socket},configurable:!0});let n=t.payload||t.body||null,s=n&&typeof n.resume=="function";n&&typeof n!="string"&&!s&&!Buffer.isBuffer(n)&&(n=JSON.stringify(n),"content-type"in this.headers||(this.headers["content-type"]="application/json")),n&&!s&&!Object.prototype.hasOwnProperty.call(this.headers,"content-length")&&(this.headers["content-length"]=(Buffer.isBuffer(n)?n.length:Buffer.byteLength(n)).toString());for(let o of Object.keys(this.headers))this.rawHeaders.push(o,this.headers[o]);this._lightMyRequest={payload:n,isDone:!1,simulate:t.simulate||{}};let i=t.signal;return i&&_de(i,this),this}Cv.inherits(Hn,vF);Cv.inherits(AF,Hn);Hn.prototype.prepare=function(t){let e=this._lightMyRequest.payload;if(!e||typeof e.resume!="function")return t();let r=[];e.on("data",n=>r.push(Buffer.from(n))),e.on("end",()=>{let n=Buffer.concat(r);return this.headers["content-length"]=this.headers["content-length"]||""+n.length,this._lightMyRequest.payload=n,t()}),e.resume()};Hn.prototype._read=function(t){setImmediate(()=>{if(this._lightMyRequest.isDone){this._lightMyRequest.simulate.end!==!1&&this.push(null);return}this._lightMyRequest.isDone=!0,this._lightMyRequest.payload&&(this._lightMyRequest.simulate.split?(this.push(this._lightMyRequest.payload.slice(0,1)),this.push(this._lightMyRequest.payload.slice(1))):this.push(this._lightMyRequest.payload)),this._lightMyRequest.simulate.error&&this.emit("error",new Error("Simulated")),this._lightMyRequest.simulate.close&&this.emit("close"),this._lightMyRequest.simulate.end!==!1&&this.push(null)})};Hn.prototype.destroy=function(t){this.destroyed||this._lightMyRequest.isDone||(this.destroyed=!0,t&&(this._error=!0,process.nextTick(()=>this.emit("error",t))),process.nextTick(()=>this.emit("close")))};vp.exports=Hn;vp.exports.Request=Hn;vp.exports.CustomRequest=AF});var wF=h((mVe,mu)=>{"use strict";var Ma={decodeValues:!0,map:!1,silent:!1};function Sv(t){return typeof t=="string"&&!!t.trim()}function vv(t,e){var r=t.split(";").filter(Sv),n=r.shift(),s=Tde(n),i=s.name,o=s.value;e=e?Object.assign({},Ma,e):Ma;try{o=e.decodeValues?decodeURIComponent(o):o}catch(c){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+o+"'. Set options.decodeValues to false to disable this feature.",c)}var a={name:i,value:o};return r.forEach(function(c){var l=c.split("="),u=l.shift().trimLeft().toLowerCase(),d=l.join("=");u==="expires"?a.expires=new Date(d):u==="max-age"?a.maxAge=parseInt(d,10):u==="secure"?a.secure=!0:u==="httponly"?a.httpOnly=!0:u==="samesite"?a.sameSite=d:a[u]=d}),a}function Tde(t){var e="",r="",n=t.split("=");return n.length>1?(e=n.shift(),r=n.join("=")):r=t,{name:e,value:r}}function EF(t,e){if(e=e?Object.assign({},Ma,e):Ma,!t)return e.map?{}:[];if(t.headers)if(typeof t.headers.getSetCookie=="function")t=t.headers.getSetCookie();else if(t.headers["set-cookie"])t=t.headers["set-cookie"];else{var r=t.headers[Object.keys(t.headers).find(function(s){return s.toLowerCase()==="set-cookie"})];!r&&t.headers.cookie&&!e.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),t=r}if(Array.isArray(t)||(t=[t]),e=e?Object.assign({},Ma,e):Ma,e.map){var n={};return t.filter(Sv).reduce(function(s,i){var o=vv(i,e);return s[o.name]=o,s},n)}else return t.filter(Sv).map(function(s){return vv(s,e)})}function Gde(t){if(Array.isArray(t))return t;if(typeof t!="string")return[];var e=[],r=0,n,s,i,o,a;function c(){for(;r<t.length&&/\s/.test(t.charAt(r));)r+=1;return r<t.length}function l(){return s=t.charAt(r),s!=="="&&s!==";"&&s!==","}for(;r<t.length;){for(n=r,a=!1;c();)if(s=t.charAt(r),s===","){for(i=r,r+=1,c(),o=r;r<t.length&&l();)r+=1;r<t.length&&t.charAt(r)==="="?(a=!0,r=o,e.push(t.substring(n,i)),n=r):r=i+1}else r+=1;(!a||r>=t.length)&&e.push(t.substring(n,t.length))}return e}mu.exports=EF;mu.exports.parse=EF;mu.exports.parseString=vv;mu.exports.splitCookiesString=Gde});var GF=h((yVe,TF)=>{"use strict";var yu=require("node:http"),{Writable:Zde}=require("node:stream"),Nde=require("node:util"),Vde=wF();function hi(t,e,r){yu.ServerResponse.call(this,t),this._lightMyRequest={headers:null,trailers:{},payloadChunks:[]},this.setHeader("foo","bar"),this.removeHeader("foo"),this.assignSocket(Wde()),this._promiseCallback=typeof r=="function";let n=!1,s=o=>{if(n=!0,this._promiseCallback)return process.nextTick(()=>e(o));process.nextTick(()=>e(null,o))},i=o=>{if(!n){if(n=!0,this._promiseCallback)return process.nextTick(()=>r(o));process.nextTick(()=>e(o,null))}};this.once("finish",()=>{let o=Hde(this);o.raw.req=t,s(o)}),this.connection.once("error",i),this.once("error",i),this.once("close",i)}Nde.inherits(hi,yu.ServerResponse);hi.prototype.setTimeout=function(t,e){return this.timeoutHandle=setTimeout(()=>{this.emit("timeout")},t),this.on("timeout",e),this};hi.prototype.writeHead=function(){let t=yu.ServerResponse.prototype.writeHead.apply(this,arguments);return BF(this),t};hi.prototype.write=function(t,e,r){return this.timeoutHandle&&clearTimeout(this.timeoutHandle),yu.ServerResponse.prototype.write.call(this,t,e,r),this._lightMyRequest.payloadChunks.push(Buffer.from(t,e)),!0};hi.prototype.end=function(t,e,r){t&&this.write(t,e),yu.ServerResponse.prototype.end.call(this,r),this.emit("finish"),this.destroy()};hi.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,t&&process.nextTick(()=>this.emit("error",t)),process.nextTick(()=>this.emit("close")))};hi.prototype.addTrailers=function(t){for(let e in t)this._lightMyRequest.trailers[e.toLowerCase().trim()]=t[e].toString().trim()};function Hde(t){t._lightMyRequest.headers===null&&BF(t),Ode(t);let e={raw:{res:t},headers:t._lightMyRequest.headers,statusCode:t.statusCode,statusMessage:t.statusMessage,trailers:{},get cookies(){return Vde.parse(this)}},r=Buffer.concat(t._lightMyRequest.payloadChunks);return e.rawPayload=r,e.payload=r.toString(),e.body=e.payload,e.trailers=t._lightMyRequest.trailers,e.json=function(){return JSON.parse(e.payload)},e}function Wde(){return new Zde({write(t,e,r){setImmediate(r)}})}function Ode(t){let e=t._lightMyRequest.headers;for(let r of Object.keys(e)){let n=e[r];Array.isArray(n)?e[r]=n.map(s=>""+s):e[r]=""+n}}function BF(t){t._lightMyRequest.headers=Object.assign({},t.getHeaders()),["Date","Connection","Transfer-Encoding"].forEach(e=>{let r=new RegExp("\\r\\n"+e+": ([^\\r]*)\\r\\n"),n=t._header.match(r);n&&(t._lightMyRequest.headers[e.toLowerCase()]=n[1])})}TF.exports=hi});var ZF=h((IVe,_v)=>{"use strict";_v.exports=St;_v.exports.default=St;var Pde={type:"object",properties:{url:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},path:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},cookies:{type:"object",additionalProperties:!0},headers:{type:"object",additionalProperties:!0},query:{anyOf:[{type:"object",additionalProperties:!0},{type:"string"}]},simulate:{type:"object",properties:{end:{type:"boolean"},split:{type:"boolean"},error:{type:"boolean"},close:{type:"boolean"}}},authority:{type:"string"},remoteAddress:{type:"string"},method:{type:"string",enum:["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE","acl","bind","checkout","connect","copy","delete","get","head","link","lock","m-search","merge","mkactivity","mkcalendar","mkcol","move","notify","options","patch","post","propfind","proppatch","purge","put","rebind","report","search","source","subscribe","trace","unbind","unlink","unlock","unsubscribe"]},validate:{type:"boolean"}},additionalProperties:!0,oneOf:[{required:["url"]},{required:["path"]}]};function St(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0,a=o,c=!1,l=null,u=o;if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.url===void 0&&(y="url")){let A={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"};i===null?i=[A]:i.push(A),o++}}var f=u===o;f&&(c=!0,l=0);let d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.path===void 0&&(y="path")){let A={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"};i===null?i=[A]:i.push(A),o++}}var f=d===o;if(f&&c?(c=!1,l=[l,1]):f&&(c=!0,l=1),c)o=a,i!==null&&(a?i.length=a:i=null);else{let y={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf"};return i===null?i=[y]:i.push(y),o++,St.errors=i,!1}if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.url!==void 0){let y=t.url,A=o,E=o,v=!1,B=null,H=o;if(typeof y!="string"){let x=typeof y,F;if(F===void 0)if(x=="number"||x=="boolean")F=""+y;else if(y===null)F="";else{let L={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[L]:i.push(L),o++}F!==void 0&&(y=F,t!==void 0&&(t.url=F))}var p=H===o;p&&(v=!0,B=0);let R=o;if(o===R)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.pathname===void 0&&(x="pathname")){let F={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/1/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"};i===null?i=[F]:i.push(F),o++}else{if(y.protocol!==void 0){let F=y.protocol,L=o;if(typeof F!="string"){let ie=typeof F,pe;if(pe===void 0)if(ie=="number"||ie=="boolean")pe=""+F;else if(F===null)pe="";else{let $={instancePath:e+"/url/protocol",schemaPath:"#/properties/url/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[$]:i.push($),o++}pe!==void 0&&(F=pe,y!==void 0&&(y.protocol=pe))}var g=L===o}else var g=!0;if(g){if(y.hostname!==void 0){let F=y.hostname,L=o;if(typeof F!="string"){let pe=typeof F,$;if($===void 0)if(pe=="number"||pe=="boolean")$=""+F;else if(F===null)$="";else{let ee={instancePath:e+"/url/hostname",schemaPath:"#/properties/url/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ee]:i.push(ee),o++}$!==void 0&&(F=$,y!==void 0&&(y.hostname=$))}var g=L===o}else var g=!0;if(g)if(y.pathname!==void 0){let F=y.pathname,L=o;if(typeof F!="string"){let pe=typeof F,$;if($===void 0)if(pe=="number"||pe=="boolean")$=""+F;else if(F===null)$="";else{let ee={instancePath:e+"/url/pathname",schemaPath:"#/properties/url/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ee]:i.push(ee),o++}$!==void 0&&(F=$,y!==void 0&&(y.pathname=$))}var g=L===o}else var g=!0}}}else{let x={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[x]:i.push(x),o++}var p=R===o;if(p&&v?(v=!1,B=[B,1]):p&&(v=!0,B=1),v)o=E,i!==null&&(E?i.length=E:i=null);else{let x={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf",keyword:"oneOf",params:{passingSchemas:B},message:"must match exactly one schema in oneOf"};return i===null?i=[x]:i.push(x),o++,St.errors=i,!1}var m=A===o}else var m=!0;if(m){if(t.path!==void 0){let y=t.path,A=o,E=o,v=!1,B=null,H=o;if(typeof y!="string"){let F=typeof y,L;if(L===void 0)if(F=="number"||F=="boolean")L=""+y;else if(y===null)L="";else{let ie={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ie]:i.push(ie),o++}L!==void 0&&(y=L,t!==void 0&&(t.path=L))}var C=H===o;C&&(v=!0,B=0);let R=o;if(o===R)if(y&&typeof y=="object"&&!Array.isArray(y)){let F;if(y.pathname===void 0&&(F="pathname")){let L={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/1/required",keyword:"required",params:{missingProperty:F},message:"must have required property '"+F+"'"};i===null?i=[L]:i.push(L),o++}else{if(y.protocol!==void 0){let L=y.protocol,ie=o;if(typeof L!="string"){let pe=typeof L,$;if($===void 0)if(pe=="number"||pe=="boolean")$=""+L;else if(L===null)$="";else{let ee={instancePath:e+"/path/protocol",schemaPath:"#/properties/path/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ee]:i.push(ee),o++}$!==void 0&&(L=$,y!==void 0&&(y.protocol=$))}var I=ie===o}else var I=!0;if(I){if(y.hostname!==void 0){let L=y.hostname,ie=o;if(typeof L!="string"){let $=typeof L,ee;if(ee===void 0)if($=="number"||$=="boolean")ee=""+L;else if(L===null)ee="";else{let ke={instancePath:e+"/path/hostname",schemaPath:"#/properties/path/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ke]:i.push(ke),o++}ee!==void 0&&(L=ee,y!==void 0&&(y.hostname=ee))}var I=ie===o}else var I=!0;if(I)if(y.pathname!==void 0){let L=y.pathname,ie=o;if(typeof L!="string"){let $=typeof L,ee;if(ee===void 0)if($=="number"||$=="boolean")ee=""+L;else if(L===null)ee="";else{let ke={instancePath:e+"/path/pathname",schemaPath:"#/properties/path/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ke]:i.push(ke),o++}ee!==void 0&&(L=ee,y!==void 0&&(y.pathname=ee))}var I=ie===o}else var I=!0}}}else{let F={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[F]:i.push(F),o++}var C=R===o;if(C&&v?(v=!1,B=[B,1]):C&&(v=!0,B=1),v)o=E,i!==null&&(E?i.length=E:i=null);else{let F={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf",keyword:"oneOf",params:{passingSchemas:B},message:"must match exactly one schema in oneOf"};return i===null?i=[F]:i.push(F),o++,St.errors=i,!1}var m=A===o}else var m=!0;if(m){if(t.cookies!==void 0){let y=t.cookies,A=o;if(o===A&&!(y&&typeof y=="object"&&!Array.isArray(y)))return St.errors=[{instancePath:e+"/cookies",schemaPath:"#/properties/cookies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var m=A===o}else var m=!0;if(m){if(t.headers!==void 0){let y=t.headers,A=o;if(o===A&&!(y&&typeof y=="object"&&!Array.isArray(y)))return St.errors=[{instancePath:e+"/headers",schemaPath:"#/properties/headers/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var m=A===o}else var m=!0;if(m){if(t.query!==void 0){let y=t.query,A=o,E=o,v=!1,B=o;if(o===B&&!(y&&typeof y=="object"&&!Array.isArray(y))){let R={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf/0/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[R]:i.push(R),o++}var S=B===o;if(v=v||S,!v){let R=o;if(typeof y!="string"){let F=typeof y,L;if(L===void 0)if(F=="number"||F=="boolean")L=""+y;else if(y===null)L="";else{let ie={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[ie]:i.push(ie),o++}L!==void 0&&(y=L,t!==void 0&&(t.query=L))}var S=R===o;v=v||S}if(v)o=E,i!==null&&(E?i.length=E:i=null);else{let R={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[R]:i.push(R),o++,St.errors=i,!1}var m=A===o}else var m=!0;if(m){if(t.simulate!==void 0){let y=t.simulate,A=o;if(o===A)if(y&&typeof y=="object"&&!Array.isArray(y)){if(y.end!==void 0){let v=y.end,B=o;if(typeof v!="boolean"){let H;if(H===void 0)if(v==="false"||v===0||v===null)H=!1;else if(v==="true"||v===1)H=!0;else return St.errors=[{instancePath:e+"/simulate/end",schemaPath:"#/properties/simulate/properties/end/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;H!==void 0&&(v=H,y!==void 0&&(y.end=H))}var b=B===o}else var b=!0;if(b){if(y.split!==void 0){let v=y.split,B=o;if(typeof v!="boolean"){let R;if(R===void 0)if(v==="false"||v===0||v===null)R=!1;else if(v==="true"||v===1)R=!0;else return St.errors=[{instancePath:e+"/simulate/split",schemaPath:"#/properties/simulate/properties/split/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;R!==void 0&&(v=R,y!==void 0&&(y.split=R))}var b=B===o}else var b=!0;if(b){if(y.error!==void 0){let v=y.error,B=o;if(typeof v!="boolean"){let R;if(R===void 0)if(v==="false"||v===0||v===null)R=!1;else if(v==="true"||v===1)R=!0;else return St.errors=[{instancePath:e+"/simulate/error",schemaPath:"#/properties/simulate/properties/error/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;R!==void 0&&(v=R,y!==void 0&&(y.error=R))}var b=B===o}else var b=!0;if(b)if(y.close!==void 0){let v=y.close,B=o;if(typeof v!="boolean"){let R;if(R===void 0)if(v==="false"||v===0||v===null)R=!1;else if(v==="true"||v===1)R=!0;else return St.errors=[{instancePath:e+"/simulate/close",schemaPath:"#/properties/simulate/properties/close/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;R!==void 0&&(v=R,y!==void 0&&(y.close=R))}var b=B===o}else var b=!0}}}else return St.errors=[{instancePath:e+"/simulate",schemaPath:"#/properties/simulate/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var m=A===o}else var m=!0;if(m){if(t.authority!==void 0){let y=t.authority,A=o;if(typeof y!="string"){let v=typeof y,B;if(B===void 0)if(v=="number"||v=="boolean")B=""+y;else if(y===null)B="";else return St.errors=[{instancePath:e+"/authority",schemaPath:"#/properties/authority/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;B!==void 0&&(y=B,t!==void 0&&(t.authority=B))}var m=A===o}else var m=!0;if(m){if(t.remoteAddress!==void 0){let y=t.remoteAddress,A=o;if(typeof y!="string"){let v=typeof y,B;if(B===void 0)if(v=="number"||v=="boolean")B=""+y;else if(y===null)B="";else return St.errors=[{instancePath:e+"/remoteAddress",schemaPath:"#/properties/remoteAddress/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;B!==void 0&&(y=B,t!==void 0&&(t.remoteAddress=B))}var m=A===o}else var m=!0;if(m){if(t.method!==void 0){let y=t.method,A=o;if(typeof y!="string"){let v=typeof y,B;if(B===void 0)if(v=="number"||v=="boolean")B=""+y;else if(y===null)B="";else return St.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;B!==void 0&&(y=B,t!==void 0&&(t.method=B))}if(!(y==="ACL"||y==="BIND"||y==="CHECKOUT"||y==="CONNECT"||y==="COPY"||y==="DELETE"||y==="GET"||y==="HEAD"||y==="LINK"||y==="LOCK"||y==="M-SEARCH"||y==="MERGE"||y==="MKACTIVITY"||y==="MKCALENDAR"||y==="MKCOL"||y==="MOVE"||y==="NOTIFY"||y==="OPTIONS"||y==="PATCH"||y==="POST"||y==="PROPFIND"||y==="PROPPATCH"||y==="PURGE"||y==="PUT"||y==="REBIND"||y==="REPORT"||y==="SEARCH"||y==="SOURCE"||y==="SUBSCRIBE"||y==="TRACE"||y==="UNBIND"||y==="UNLINK"||y==="UNLOCK"||y==="UNSUBSCRIBE"||y==="acl"||y==="bind"||y==="checkout"||y==="connect"||y==="copy"||y==="delete"||y==="get"||y==="head"||y==="link"||y==="lock"||y==="m-search"||y==="merge"||y==="mkactivity"||y==="mkcalendar"||y==="mkcol"||y==="move"||y==="notify"||y==="options"||y==="patch"||y==="post"||y==="propfind"||y==="proppatch"||y==="purge"||y==="put"||y==="rebind"||y==="report"||y==="search"||y==="source"||y==="subscribe"||y==="trace"||y==="unbind"||y==="unlink"||y==="unlock"||y==="unsubscribe"))return St.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/enum",keyword:"enum",params:{allowedValues:Pde.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var m=A===o}else var m=!0;if(m)if(t.validate!==void 0){let y=t.validate,A=o;if(typeof y!="boolean"){let v;if(v===void 0)if(y==="false"||y===0||y===null)v=!1;else if(y==="true"||y===1)v=!0;else return St.errors=[{instancePath:e+"/validate",schemaPath:"#/properties/validate/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;v!==void 0&&(y=v,t!==void 0&&(t.validate=v))}var m=A===o}else var m=!0}}}}}}}}}else return St.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return St.errors=i,o===0}});var HF=h((bVe,bu)=>{"use strict";var kde=require("node:assert"),Av=RF(),_p=GF(),Rp="The dispatch function has already been invoked",NF=ZF();function Rv(t,e,r){return typeof r>"u"?new Iu(t,e):Ap(t,e,r)}function VF(t,e,r,n){return r.once("error",function(s){this.destroyed&&n.destroy(s)}),r.once("close",function(){this.destroyed&&!this._error&&n.destroy()}),r.prepare(()=>t.call(e,r,n))}function Ap(t,e,r){if(e=typeof e=="string"?{url:e}:e,e.validate!==!1&&(kde(typeof t=="function","dispatchFunc should be a function"),!NF(e)))throw new Error(NF.errors.map(o=>o.message));let n=e.server||{},s=e.Request?Av.CustomRequest:Av;if(t.request&&t.request.app===t&&(Object.setPrototypeOf(Object.getPrototypeOf(t.request),s.prototype),Object.setPrototypeOf(Object.getPrototypeOf(t.response),_p.prototype)),typeof r=="function"){let i=new s(e),o=new _p(i,r);return VF(t,n,i,o)}else return new Promise((i,o)=>{let a=new s(e),c=new _p(a,i,o);VF(t,n,a,c)})}function Iu(t,e){typeof e=="string"?this.option={url:e}:this.option=Object.assign({},e),this.dispatch=t,this._hasInvoked=!1,this._promise=null,this.option.autoStart!==!1&&process.nextTick(()=>{this._hasInvoked||this.end()})}var Fde=["delete","get","head","options","patch","post","put","trace"];Fde.forEach(t=>{Iu.prototype[t]=function(e){if(this._hasInvoked===!0||this._promise)throw new Error(Rp);return this.option.url=e,this.option.method=t.toUpperCase(),this}});var xde=["body","cookies","headers","payload","query"];xde.forEach(t=>{Iu.prototype[t]=function(e){if(this._hasInvoked===!0||this._promise)throw new Error(Rp);return this.option[t]=e,this}});Iu.prototype.end=function(t){if(this._hasInvoked===!0||this._promise)throw new Error(Rp);if(this._hasInvoked=!0,typeof t=="function")Ap(this.dispatch,this.option,t);else return this._promise=Ap(this.dispatch,this.option),this._promise};Object.getOwnPropertyNames(Promise.prototype).forEach(t=>{t!=="constructor"&&(Iu.prototype[t]=function(...e){if(!this._promise){if(this._hasInvoked===!0)throw new Error(Rp);this._hasInvoked=!0,this._promise=Ap(this.dispatch,this.option)}return this._promise[t](...e)})});function Lde(t){return t instanceof Av||t instanceof _p||t&&t.constructor&&t.constructor.name==="_CustomLMRRequest"}bu.exports=Rv;bu.exports.default=Rv;bu.exports.inject=Rv;bu.exports.isInjection=Lde});var qF=h((CVe,Tp)=>{"use strict";var Ude="4.25.2",Yde=qB(),Ev=require("node:http"),Cu,{kAvvioBoot:Su,kChildren:wv,kServerBindings:WF,kBodyLimit:Dde,kRoutePrefix:OF,kLogLevel:Xde,kLogSerializers:$de,kHooks:Bv,kSchemaController:mi,kRequestAcceptVersion:jde,kReplySerializerDefault:PF,kContentTypeParser:qde,kReply:Mde,kRequest:Kde,kFourOhFour:zde,kState:ft,kOptions:kF,kPluginNameChain:vu,kSchemaErrorFormatter:Tv,kErrorHandler:Ep,kKeepAliveConnections:Gv,kChildLoggerFactory:Zv}=Tt(),{createServer:Jde,compileValidateHTTPVersion:Qde}=bT(),_u=_g(),wp=Fg(),efe=xg(),{supportedMethods:tfe}=V0(),Ka=k0(),bo=q0(),FF=xS(),{Hooks:rfe,hookRunnerApplication:xF,supportedHooks:Nv}=js(),{createLogger:nfe,createChildLogger:LF,defaultChildLoggerFactory:sfe}=tl(),UF=$S(),{reqIdGenFactory:ife}=wP(),{buildRouting:ofe,validateBodyLimitOption:afe}=Kk(),cfe=rF(),jF=iF(),lfe=pF(),{FSTDEP009:ufe}=is(),dfe=mF(),{appendStackTrace:ffe,AVVIO_ERRORS_MAP:YF,...Co}=Yt(),{defaultInitOptions:Er}=jF,{FST_ERR_ASYNC_CONSTRAINT:gfe,FST_ERR_BAD_URL:pfe,FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:hfe,FST_ERR_OPTIONS_NOT_OBJ:mfe,FST_ERR_QSP_NOT_FN:yfe,FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:Ife,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:bfe,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:Cfe,FST_ERR_VERSION_CONSTRAINT_NOT_STR:Sfe,FST_ERR_INSTANCE_ALREADY_LISTENING:vfe,FST_ERR_REOPENED_CLOSE_SERVER:_fe,FST_ERR_ROUTE_REWRITE_NOT_STR:Afe,FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:DF}=Co,{buildErrorHandler:XF}=Hl();function Rfe(t){let e={};return["errorHandler","logLevel","logSerializers"].concat(Nv).forEach(n=>{e[n]=t.store[n]}),Object.assign({},e)}function Bp(t){if(t=t||{},typeof t!="object")throw new mfe;if(t.querystringParser&&typeof t.querystringParser!="function")throw new yfe(typeof t.querystringParser);if(t.schemaController&&t.schemaController.bucket&&typeof t.schemaController.bucket!="function")throw new Ife(typeof t.schemaController.bucket);afe(t.bodyLimit);let e=t.requestIdHeader===!1?!1:(t.requestIdHeader||Er.requestIdHeader).toLowerCase(),r=ife(e,t.genReqId),n=t.requestIdLogLabel||"reqId",s=t.bodyLimit||Er.bodyLimit,i=t.disableRequestLogging||!1,o=Object.assign({customOptions:{},plugins:[]},t.ajv),a=t.frameworkErrors;if(!o.customOptions||Object.prototype.toString.call(o.customOptions)!=="[object Object]")throw new bfe(typeof o.customOptions);if(!o.plugins||!Array.isArray(o.plugins))throw new Cfe(typeof o.plugins);let{logger:c,hasLogger:l}=nfe(t);t.connectionTimeout=t.connectionTimeout||Er.connectionTimeout,t.keepAliveTimeout=t.keepAliveTimeout||Er.keepAliveTimeout,t.maxRequestsPerSocket=t.maxRequestsPerSocket||Er.maxRequestsPerSocket,t.requestTimeout=t.requestTimeout||Er.requestTimeout,t.logger=c,t.genReqId=r,t.requestIdHeader=e,t.requestIdLogLabel=n,t.disableRequestLogging=i,t.ajv=o,t.clientErrorHandler=t.clientErrorHandler||ee;let u=jF(t);t.exposeHeadRoutes=u.exposeHeadRoutes;let d=t.constraints;t.versioning&&(ufe(),d={...d,version:{name:"version",mustMatchWhenDerived:!0,storage:t.versioning.storage,deriveConstraint:t.versioning.deriveVersion,validate(N){if(typeof N!="string")throw new Sfe}}});let f=ofe({config:{defaultRoute:ke,onBadUrl:j,constraints:d,ignoreTrailingSlash:t.ignoreTrailingSlash||Er.ignoreTrailingSlash,ignoreDuplicateSlashes:t.ignoreDuplicateSlashes||Er.ignoreDuplicateSlashes,maxParamLength:t.maxParamLength||Er.maxParamLength,caseSensitive:t.caseSensitive,allowUnsafeRegex:t.allowUnsafeRegex||Er.allowUnsafeRegex,buildPrettyMeta:Rfe,querystringParser:t.querystringParser}}),g=cfe(t),p=We(f,t);t.http2SessionTimeout=u.http2SessionTimeout;let{server:m,listen:I}=Jde(t,p),C=typeof m.closeAllConnections=="function",S=typeof m.closeIdleConnections=="function",b=t.forceCloseConnections;if(b==="idle"&&!S)throw new hfe;typeof b!="boolean"&&(b=S?"idle":!1);let y=!C&&b===!0?new Set:dfe(),A=_u.setupResponseListeners,E=FF.buildSchemaController(null,t.schemaController),v={[ft]:{listening:!1,closing:!1,started:!1,ready:!1,booting:!1,readyPromise:null},[Gv]:y,[kF]:t,[wv]:[],[WF]:[],[Dde]:s,[OF]:"",[Xde]:"",[$de]:null,[Bv]:new rfe,[mi]:E,[Tv]:null,[Ep]:XF(),[Zv]:sfe,[PF]:null,[qde]:new bo(s,t.onProtoPoisoning||Er.onProtoPoisoning,t.onConstructorPoisoning||Er.onConstructorPoisoning),[Mde]:_u.buildReply(_u),[Kde]:wp.buildRequest(wp,t.trustProxy),[zde]:g,[UF.kRegisteredPlugins]:[],[vu]:["fastify"],[Su]:null,routing:p,getDefaultRoute:f.getDefaultRoute.bind(f),setDefaultRoute:f.setDefaultRoute.bind(f),delete:function(W,D,M){return f.prepareRoute.call(this,{method:"DELETE",url:W,options:D,handler:M})},get:function(W,D,M){return f.prepareRoute.call(this,{method:"GET",url:W,options:D,handler:M})},head:function(W,D,M){return f.prepareRoute.call(this,{method:"HEAD",url:W,options:D,handler:M})},patch:function(W,D,M){return f.prepareRoute.call(this,{method:"PATCH",url:W,options:D,handler:M})},post:function(W,D,M){return f.prepareRoute.call(this,{method:"POST",url:W,options:D,handler:M})},put:function(W,D,M){return f.prepareRoute.call(this,{method:"PUT",url:W,options:D,handler:M})},options:function(W,D,M){return f.prepareRoute.call(this,{method:"OPTIONS",url:W,options:D,handler:M})},all:function(W,D,M){return f.prepareRoute.call(this,{method:tfe,url:W,options:D,handler:M})},route:function(W){return f.route.call(this,{options:W})},hasRoute:function(W){return f.hasRoute.call(this,{options:W})},log:c,withTypeProvider:ie,addHook:pe,addSchema:$,getSchema:E.getSchema.bind(E),getSchemas:E.getSchemas.bind(E),setValidatorCompiler:He,setSerializerCompiler:Rt,setSchemaController:Ce,setReplySerializer:mt,setSchemaErrorFormatter:Qn,addContentTypeParser:bo.helpers.addContentTypeParser,hasContentTypeParser:bo.helpers.hasContentTypeParser,getDefaultJsonParser:bo.defaultParsers.getDefaultJsonParser,defaultTextParser:bo.defaultParsers.defaultTextParser,removeContentTypeParser:bo.helpers.removeContentTypeParser,removeAllContentTypeParsers:bo.helpers.removeAllContentTypeParsers,register:null,after:null,ready:null,onClose:null,close:null,printPlugins:null,hasPlugin:function(N){return this[UF.kRegisteredPlugins].includes(N)||this[vu].includes(N)},listen:I,server:m,addresses:function(){let N=this[WF].map(W=>W.address());return N.push(this.server.address()),N.filter(W=>W)},decorate:Ka.add,hasDecorator:Ka.exist,decorateReply:Ka.decorateReply,decorateRequest:Ka.decorateRequest,hasRequestDecorator:Ka.existRequest,hasReplyDecorator:Ka.existReply,inject:F,printRoutes:Ir,setNotFoundHandler:Gr,setErrorHandler:ce,setChildLoggerFactory:Ve,initialConfig:u,addConstraintStrategy:f.addConstraintStrategy.bind(f),hasConstraintStrategy:f.hasConstraintStrategy.bind(f)};Object.defineProperties(v,{listeningOrigin:{get(){let N=this.addresses().slice(-1).pop();if(typeof N=="string")return N;let W=N.family==="IPv6"?`[${N.address}]`:N.address;return`${this[kF].https?"https":"http"}://${W}:${N.port}`}},pluginName:{configurable:!0,get(){return this[vu].length>1?this[vu].join(" -> "):this[vu][0]}},prefix:{configurable:!0,get(){return this[OF]}},validatorCompiler:{configurable:!0,get(){return this[mi].getValidatorCompiler()}},serializerCompiler:{configurable:!0,get(){return this[mi].getSerializerCompiler()}},childLoggerFactory:{configurable:!0,get(){return this[Zv]}},version:{configurable:!0,get(){return Ude}},errorHandler:{configurable:!0,get(){return this[Ep].func}}}),t.schemaErrorFormatter&&($F(t.schemaErrorFormatter),v[Tv]=t.schemaErrorFormatter.bind(v));let B=Number(t.pluginTimeout),H=Yde(v,{autostart:!1,timeout:isNaN(B)===!1?B:Er.pluginTimeout,expose:{use:"register"}});H.override=lfe,H.on("start",()=>v[ft].started=!0),v[Su]=v.ready,v.ready=L,v.printPlugins=H.prettyPrint.bind(H),H.once("preReady",()=>{v.onClose((N,W)=>{v[ft].closing=!0,f.closeRoutes(),xF("preClose",v[Su],v,function(){if(v[ft].listening){if(b==="idle")N.server.closeIdleConnections();else if(C&&b)N.server.closeAllConnections();else if(b===!0)for(let D of v[Gv])D.destroy(),v[Gv].delete(D)}!t.serverFactory||v[ft].listening?N.server.close(function(D){D&&D.code!=="ERR_SERVER_NOT_RUNNING"?W(null):W()}):process.nextTick(W,null)})})});let R=new efe({server:v,config:{}});v.setNotFoundHandler(),g.arrange404(v),f.setup(t,{avvio:H,fourOhFour:g,logger:c,hasLogger:l,setupResponseListeners:A,throwIfAlreadyStarted:x,validateHTTPVersion:Qde(t),keepAliveConnections:y}),m.on("clientError",t.clientErrorHandler.bind(v));try{let W=require("node:diagnostics_channel").channel("fastify.initialization");W.hasSubscribers&&W.publish({fastify:v})}catch{}return"asyncDispose"in Symbol&&(v[Symbol.asyncDispose]=function(){return v.close()}),v;function x(N){if(v[ft].started)throw new vfe(N)}function F(N,W){if(Cu===void 0&&(Cu=HF()),v[ft].started){if(v[ft].closing){let D=new _fe;if(W){W(D);return}else return Promise.reject(D)}return Cu(p,N,W)}if(W)this.ready(D=>{D?W(D,null):Cu(p,N,W)});else return Cu((D,M)=>{this.ready(function(he){if(he){M.emit("error",he);return}p(D,M)})},N)}function L(N){if(this[ft].readyPromise!==null){if(N!=null){this[ft].readyPromise.then(()=>N(null,v),N);return}return this[ft].readyPromise}let W,D;if(process.nextTick(M),this[ft].readyPromise=new Promise(function(oe,we){W=oe,D=we}),N)this[ft].readyPromise.then(()=>N(null,v),N);else return this[ft].readyPromise;function M(){v[Su]((oe,we)=>{oe||v[ft].started||v[ft].ready||v[ft].booting?he(oe):(v[ft].booting=!0,xF("onReady",v[Su],v,he)),we()})}function he(oe){if(oe=oe!=null&&YF[oe.code]!=null?ffe(oe,new YF[oe.code](oe.message)):oe,oe)return D(oe);W(v),v[ft].booting=!1,v[ft].ready=!0,v[ft].promise=null}}function ie(){return this}function pe(N,W){if(x('Cannot call "addHook"!'),W==null)throw new Co.FST_ERR_HOOK_INVALID_HANDLER(N,W);if(N==="onSend"||N==="preSerialization"||N==="onError"||N==="preParsing"){if(W.constructor.name==="AsyncFunction"&&W.length===4)throw new Co.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(N==="onReady"||N==="onListen"){if(W.constructor.name==="AsyncFunction"&&W.length!==0)throw new Co.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(N==="onRequestAbort"){if(W.constructor.name==="AsyncFunction"&&W.length!==1)throw new Co.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(W.constructor.name==="AsyncFunction"&&W.length===3)throw new Co.FST_ERR_HOOK_INVALID_ASYNC_HANDLER;return N==="onClose"?this.onClose(W):N==="onReady"||N==="onListen"||N==="onRoute"?this[Bv].add(N,W):this.after((M,he)=>{D.call(this,N,W),he(M)}),this;function D(M,he){this[Bv].add(M,he),this[wv].forEach(oe=>D.call(oe,M,he))}}function $(N){return x('Cannot call "addSchema"!'),this[mi].add(N),this[wv].forEach(W=>W.addSchema(N)),this}function ee(N,W){if(N.code==="ECONNRESET"||W.destroyed)return;let D,M,he,oe;N.code==="ERR_HTTP_REQUEST_TIMEOUT"?(M="408",he=Ev.STATUS_CODES[M],D=`{"error":"${he}","message":"Client Timeout","statusCode":408}`,oe="timeout"):N.code==="HPE_HEADER_OVERFLOW"?(M="431",he=Ev.STATUS_CODES[M],D=`{"error":"${he}","message":"Exceeded maximum allowed HTTP header size","statusCode":431}`,oe="header_overflow"):(M="400",he=Ev.STATUS_CODES[M],D=`{"error":"${he}","message":"Client Error","statusCode":400}`,oe="error"),this.log.trace({err:N},`client ${oe}`),W.writable&&W.write(`HTTP/1.1 ${M} ${he}\r
Content-Length: ${D.length}\r
Content-Type: application/json\r
\r
${D}`),W.destroy(N)}function ke(N,W){N.headers["accept-version"]!==void 0&&(N.headers[jde]=N.headers["accept-version"],N.headers["accept-version"]=void 0),g.router.lookup(N,W)}function j(N,W,D){if(a){let he=r(W),oe=LF(R,c,W,he),we=new wp(he,null,W,null,oe,R),ze=new _u(D,we,oe);return i===!1&&oe.info({req:we},"incoming request"),a(new pfe(N),we,ze)}let M=`{"error":"Bad Request","code":"FST_ERR_BAD_URL","message":"'${N}' is not a valid url component","statusCode":400}`;D.writeHead(400,{"Content-Type":"application/json","Content-Length":M.length}),D.end(M)}function ot(N,W,D){if(N!==!1)return function(he){if(he){if(a){let we=r(W),ze=LF(R,c,W,we),xi=new wp(we,null,W,null,ze,R),Je=new _u(D,xi,ze);return i===!1&&ze.info({req:xi},"incoming request"),a(new gfe,xi,Je)}let oe='{"error":"Internal Server Error","message":"Unexpected error from async constraint","statusCode":500}';D.writeHead(500,{"Content-Type":"application/json","Content-Length":oe.length}),D.end(oe)}}}function Gr(N,W){return x('Cannot call "setNotFoundHandler"!'),g.setNotFoundHandler.call(this,N,W,H,f.routeHandler),this}function He(N){return x('Cannot call "setValidatorCompiler"!'),this[mi].setValidatorCompiler(N),this}function Qn(N){return x('Cannot call "setSchemaErrorFormatter"!'),$F(N),this[Tv]=N.bind(this),this}function Rt(N){return x('Cannot call "setSerializerCompiler"!'),this[mi].setSerializerCompiler(N),this}function Ce(N){x('Cannot call "setSchemaController"!');let W=this[mi],D=FF.buildSchemaController(W,Object.assign({},W.opts,N));return this[mi]=D,this.getSchema=D.getSchema.bind(D),this.getSchemas=D.getSchemas.bind(D),this}function mt(N){return x('Cannot call "setReplySerializer"!'),this[PF]=N,this}function ce(N){return x('Cannot call "setErrorHandler"!'),this[Ep]=XF(this[Ep],N.bind(this)),this}function Ve(N){return x('Cannot call "setChildLoggerFactory"!'),this[Zv]=N,this}function Ir(N={}){return N.includeMeta=N.includeHooks?N.includeMeta?Nv.concat(N.includeMeta):Nv:N.includeMeta,f.printRoutes(N)}function We(N,{rewriteUrl:W,logger:D}){let M;return function(oe,we){if(M===void 0&&(M=N.isAsyncConstraint()),W){oe.originalUrl=oe.url;let ze=W.call(v,oe);if(typeof ze=="string")oe.url=ze;else{let xi=new Afe(oe.url,typeof ze);oe.destroy(xi)}}N.routing(oe,we,ot(M,oe,we))}}}Bp.errorCodes=Co;function $F(t){if(typeof t!="function")throw new DF(typeof t);if(t.constructor.name==="AsyncFunction")throw new DF("AsyncFunction")}Tp.exports=Bp;Tp.exports.fastify=Bp;Tp.exports.default=Bp});var MF=h((SVe,Efe)=>{Efe.exports={name:"dotenv",version:"16.3.2",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://github.com/motdotla/dotenv?sponsor=1",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var QF=h((vVe,vs)=>{var KF=require("fs"),Vv=require("path"),wfe=require("os"),Bfe=require("crypto"),Tfe=MF(),Hv=Tfe.version,Gfe=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function Zfe(t){let e={},r=t.toString();r=r.replace(/\r\n?/mg,`
`);let n;for(;(n=Gfe.exec(r))!=null;){let s=n[1],i=n[2]||"";i=i.trim();let o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),o==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[s]=i}return e}function Nfe(t){let e=JF(t),r=Nt.configDotenv({path:e});if(!r.parsed)throw new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);let n=zF(t).split(","),s=n.length,i;for(let o=0;o<s;o++)try{let a=n[o].trim(),c=Wfe(r,a);i=Nt.decrypt(c.ciphertext,c.key);break}catch(a){if(o+1>=s)throw a}return Nt.parse(i)}function Vfe(t){console.log(`[dotenv@${Hv}][INFO] ${t}`)}function Hfe(t){console.log(`[dotenv@${Hv}][WARN] ${t}`)}function Gp(t){console.log(`[dotenv@${Hv}][DEBUG] ${t}`)}function zF(t){return t&&t.DOTENV_KEY&&t.DOTENV_KEY.length>0?t.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function Wfe(t,e){let r;try{r=new URL(e)}catch(a){throw a.code==="ERR_INVALID_URL"?new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=development"):a}let n=r.password;if(!n)throw new Error("INVALID_DOTENV_KEY: Missing key part");let s=r.searchParams.get("environment");if(!s)throw new Error("INVALID_DOTENV_KEY: Missing environment part");let i=`DOTENV_VAULT_${s.toUpperCase()}`,o=t.parsed[i];if(!o)throw new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);return{ciphertext:o,key:n}}function JF(t){let e=Vv.resolve(process.cwd(),".env");return t&&t.path&&t.path.length>0&&(e=t.path),e.endsWith(".vault")?e:`${e}.vault`}function Ofe(t){return t[0]==="~"?Vv.join(wfe.homedir(),t.slice(1)):t}function Pfe(t){Vfe("Loading env from encrypted .env.vault");let e=Nt._parseVault(t),r=process.env;return t&&t.processEnv!=null&&(r=t.processEnv),Nt.populate(r,e,t),{parsed:e}}function kfe(t){let e=Vv.resolve(process.cwd(),".env"),r="utf8",n=!!(t&&t.debug);t&&(t.path!=null&&(e=Ofe(t.path)),t.encoding!=null?r=t.encoding:n&&Gp("No encoding is specified. UTF-8 is used by default"));try{let s=Nt.parse(KF.readFileSync(e,{encoding:r})),i=process.env;return t&&t.processEnv!=null&&(i=t.processEnv),Nt.populate(i,s,t),{parsed:s}}catch(s){return n&&Gp(`Failed to load ${e} ${s.message}`),{error:s}}}function Ffe(t){let e=JF(t);return zF(t).length===0?Nt.configDotenv(t):KF.existsSync(e)?Nt._configVault(t):(Hfe(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),Nt.configDotenv(t))}function xfe(t,e){let r=Buffer.from(e.slice(-64),"hex"),n=Buffer.from(t,"base64"),s=n.subarray(0,12),i=n.subarray(-16);n=n.subarray(12,-16);try{let o=Bfe.createDecipheriv("aes-256-gcm",r,s);return o.setAuthTag(i),`${o.update(n)}${o.final()}`}catch(o){let a=o instanceof RangeError,c=o.message==="Invalid key length",l=o.message==="Unsupported state or unable to authenticate data";if(a||c){let u="INVALID_DOTENV_KEY: It must be 64 characters long (or more)";throw new Error(u)}else if(l){let u="DECRYPTION_FAILED: Please check your DOTENV_KEY";throw new Error(u)}else throw console.error("Error: ",o.code),console.error("Error: ",o.message),o}}function Lfe(t,e,r={}){let n=!!(r&&r.debug),s=!!(r&&r.override);if(typeof e!="object")throw new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");for(let i of Object.keys(e))Object.prototype.hasOwnProperty.call(t,i)?(s===!0&&(t[i]=e[i]),n&&Gp(s===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):t[i]=e[i]}var Nt={configDotenv:kfe,_configVault:Pfe,_parseVault:Nfe,config:Ffe,decrypt:xfe,parse:Zfe,populate:Lfe};vs.exports.configDotenv=Nt.configDotenv;vs.exports._configVault=Nt._configVault;vs.exports._parseVault=Nt._parseVault;vs.exports.config=Nt.config;vs.exports.decrypt=Nt.decrypt;vs.exports.parse=Nt.parse;vs.exports.populate=Nt.populate;vs.exports=Nt});var dx=h((XVe,ux)=>{"use strict";function Yfe(t){return typeof t!="object"||Array.isArray(t)||t==null?!1:Object.keys(t).length>0}function lx(t,e,r={}){for(let n in e)if(Yfe(e[n]))t[n]=t[n]||{},lx(t[n],e[n],r);else{if(r.skipIfExist===!0&&t[n]!==void 0)continue;t[n]=e[n]}return t}ux.exports=lx});var gx=h(($Ve,fx)=>{function Dfe(t){return t===void 0||t===null?"":typeof t.toString=="function"?t:typeof t}fx.exports=(t,e,r)=>t.replace(e,Dfe(r))});var hx=h((jVe,px)=>{"use strict";px.exports={required:"The '{field}' field is required.",string:"The '{field}' field must be a string.",stringEmpty:"The '{field}' field must not be empty.",stringMin:"The '{field}' field length must be greater than or equal to {expected} characters long.",stringMax:"The '{field}' field length must be less than or equal to {expected} characters long.",stringLength:"The '{field}' field length must be {expected} characters long.",stringPattern:"The '{field}' field fails to match the required pattern.",stringContains:"The '{field}' field must contain the '{expected}' text.",stringEnum:"The '{field}' field does not match any of the allowed values.",stringNumeric:"The '{field}' field must be a numeric string.",stringAlpha:"The '{field}' field must be an alphabetic string.",stringAlphanum:"The '{field}' field must be an alphanumeric string.",stringAlphadash:"The '{field}' field must be an alphadash string.",stringHex:"The '{field}' field must be a hex string.",stringSingleLine:"The '{field}' field must be a single line string.",stringBase64:"The '{field}' field must be a base64 string.",number:"The '{field}' field must be a number.",numberMin:"The '{field}' field must be greater than or equal to {expected}.",numberMax:"The '{field}' field must be less than or equal to {expected}.",numberEqual:"The '{field}' field must be equal to {expected}.",numberNotEqual:"The '{field}' field can't be equal to {expected}.",numberInteger:"The '{field}' field must be an integer.",numberPositive:"The '{field}' field must be a positive number.",numberNegative:"The '{field}' field must be a negative number.",array:"The '{field}' field must be an array.",arrayEmpty:"The '{field}' field must not be an empty array.",arrayMin:"The '{field}' field must contain at least {expected} items.",arrayMax:"The '{field}' field must contain less than or equal to {expected} items.",arrayLength:"The '{field}' field must contain {expected} items.",arrayContains:"The '{field}' field must contain the '{expected}' item.",arrayUnique:"The '{actual}' value in '{field}' field does not unique the '{expected}' values.",arrayEnum:"The '{actual}' value in '{field}' field does not match any of the '{expected}' values.",tuple:"The '{field}' field must be an array.",tupleEmpty:"The '{field}' field must not be an empty array.",tupleLength:"The '{field}' field must contain {expected} items.",boolean:"The '{field}' field must be a boolean.",currency:"The '{field}' must be a valid currency format",date:"The '{field}' field must be a Date.",dateMin:"The '{field}' field must be greater than or equal to {expected}.",dateMax:"The '{field}' field must be less than or equal to {expected}.",enumValue:"The '{field}' field value '{expected}' does not match any of the allowed values.",equalValue:"The '{field}' field value must be equal to '{expected}'.",equalField:"The '{field}' field value must be equal to '{expected}' field value.",forbidden:"The '{field}' field is forbidden.",function:"The '{field}' field must be a function.",email:"The '{field}' field must be a valid e-mail.",emailEmpty:"The '{field}' field must not be empty.",emailMin:"The '{field}' field length must be greater than or equal to {expected} characters long.",emailMax:"The '{field}' field length must be less than or equal to {expected} characters long.",luhn:"The '{field}' field must be a valid checksum luhn.",mac:"The '{field}' field must be a valid MAC address.",object:"The '{field}' must be an Object.",objectStrict:"The object '{field}' contains forbidden keys: '{actual}'.",objectMinProps:"The object '{field}' must contain at least {expected} properties.",objectMaxProps:"The object '{field}' must contain {expected} properties at most.",url:"The '{field}' field must be a valid URL.",urlEmpty:"The '{field}' field must not be empty.",uuid:"The '{field}' field must be a valid UUID.",uuidVersion:"The '{field}' field must be a valid UUID version provided.",classInstanceOf:"The '{field}' field must be an instance of the '{expected}' class.",objectID:"The '{field}' field must be an valid ObjectID",record:"The '{field}' must be an Object."}});var yx=h((qVe,mx)=>{"use strict";mx.exports=function(){let t=[];return t.push(`
		return value;
	`),{source:t.join(`
`)}}});var bx=h((MVe,Ix)=>{"use strict";Ix.exports=function({schema:t,messages:e},r,n){let s=[],i=!1;if(t.convert===!0&&(i=!0,s.push(`
			if (!Array.isArray(value) && value != null) {
				value = [value];
			}
		`)),s.push(`
		if (!Array.isArray(value)) {
			${this.makeError({type:"array",actual:"value",messages:e})}
			return value;
		}

		var len = value.length;
	`),t.empty===!1&&s.push(`
			if (len === 0) {
				${this.makeError({type:"arrayEmpty",actual:"value",messages:e})}
			}
		`),t.min!=null&&s.push(`
			if (len < ${t.min}) {
				${this.makeError({type:"arrayMin",expected:t.min,actual:"len",messages:e})}
			}
		`),t.max!=null&&s.push(`
			if (len > ${t.max}) {
				${this.makeError({type:"arrayMax",expected:t.max,actual:"len",messages:e})}
			}
		`),t.length!=null&&s.push(`
			if (len !== ${t.length}) {
				${this.makeError({type:"arrayLength",expected:t.length,actual:"len",messages:e})}
			}
		`),t.contains!=null&&s.push(`
			if (value.indexOf(${JSON.stringify(t.contains)}) === -1) {
				${this.makeError({type:"arrayContains",expected:JSON.stringify(t.contains),actual:"value",messages:e})}
			}
		`),t.unique===!0&&s.push(`
			if(len > (new Set(value)).size) {
				${this.makeError({type:"arrayUnique",expected:"Array.from(new Set(value.filter((item, index) => value.indexOf(item) !== index)))",actual:"value",messages:e})}
			}
		`),t.enum!=null){let o=JSON.stringify(t.enum);s.push(`
			for (var i = 0; i < value.length; i++) {
				if (${o}.indexOf(value[i]) === -1) {
					${this.makeError({type:"arrayEnum",expected:'"'+t.enum.join(", ")+'"',actual:"value[i]",messages:e})}
				}
			}
		`)}if(t.items!=null){s.push(`
			var arr = value;
			var parentField = field;
			for (var i = 0; i < arr.length; i++) {
				value = arr[i];
		`);let o=r+"[]",a=this.getRuleFromSchema(t.items),c=`arr[i] = ${n.async?"await ":""}context.fn[%%INDEX%%](arr[i], (parentField ? parentField : "") + "[" + i + "]", parent, errors, context)`;s.push(this.compileRule(a,n,o,c,"arr[i]")),s.push(`
			}
		`),s.push(`
		return arr;
	`)}else s.push(`
		return value;
	`);return{sanitized:i,source:s.join(`
`)}}});var Sx=h((KVe,Cx)=>{"use strict";Cx.exports=function({schema:t,messages:e},r,n){let s=[],i=!1;return s.push(`
		var origValue = value;
	`),t.convert===!0&&(i=!0,s.push(`
			if (typeof value !== "boolean") {
				if (
				value === 1
				|| value === "true"
				|| value === "1"
				|| value === "on"
				) {
					value = true;
				} else if (
				value === 0
				|| value === "false"
				|| value === "0"
				|| value === "off"
				) {
					value = false;
				}
			}
		`)),s.push(`
		if (typeof value !== "boolean") {
			${this.makeError({type:"boolean",actual:"origValue",messages:e})}
		}
		
		return value;
	`),{sanitized:i,source:s.join(`
`)}}});var _x=h((zVe,vx)=>{"use strict";vx.exports=function({schema:t,messages:e,index:r},n,s){let i=[],o=t.instanceOf.name?t.instanceOf.name:"<UnknowClass>";return s.customs[r]?s.customs[r].schema=t:s.customs[r]={schema:t},i.push(`
		if (!(value instanceof context.customs[${r}].schema.instanceOf))
			${this.makeError({type:"classInstanceOf",actual:"value",expected:"'"+o+"'",messages:e})}
	`),i.push(`
		return value;
	`),{source:i.join(`
`)}}});var Rx=h((JVe,Ax)=>{"use strict";Ax.exports=function({schema:t,messages:e,index:r},n,s){let i=[];return i.push(`
		${this.makeCustomValidator({fnName:"check",path:n,schema:t,messages:e,context:s,ruleIndex:r})}
		return value;
	`),{source:i.join(`
`)}}});var wx=h((QVe,Ex)=>{"use strict";var Xfe="(?=.*\\d)^(-?~1|~1-?)(([0-9]\\d{0,2}(~2\\d{3})*)|0)?(\\~3\\d{1,2})?$";Ex.exports=function({schema:t,messages:e},r,n){let s=t.currencySymbol||null,i=t.thousandSeparator||",",o=t.decimalSeparator||".",a=t.customRegex,c=!t.symbolOptional,l=Xfe.replace(/~1/g,s?`\\${s}${c?"":"?"}`:"").replace("~2",i).replace("~3",o),u=[];return u.push(`
		if (!value.match(${a||new RegExp(l)})) {
			${this.makeError({type:"currency",actual:"value",messages:e})}
			return value;
		}

		return value;
	`),{source:u.join(`
`)}}});var Tx=h((eHe,Bx)=>{"use strict";Bx.exports=function({schema:t,messages:e},r,n){let s=[],i=!1;return s.push(`
		var origValue = value;
	`),t.convert===!0&&(i=!0,s.push(`
			if (!(value instanceof Date)) {
				value = new Date(value.length && !isNaN(+value) ? +value : value);
			}
		`)),s.push(`
		if (!(value instanceof Date) || isNaN(value.getTime()))
			${this.makeError({type:"date",actual:"origValue",messages:e})}

		return value;
	`),{sanitized:i,source:s.join(`
`)}}});var Zx=h((tHe,Gx)=>{"use strict";var $fe=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,jfe=/^\S+@\S+\.\S+$/;Gx.exports=function({schema:t,messages:e},r,n){let s=[],i=t.mode=="precise"?$fe:jfe,o=!1;return s.push(`
		if (typeof value !== "string") {
			${this.makeError({type:"string",actual:"value",messages:e})}
			return value;
		}
	`),t.empty?s.push(`
			if (value.length === 0) return value;
		`):s.push(`
			if (value.length === 0) {
				${this.makeError({type:"emailEmpty",actual:"value",messages:e})}
				return value;
			}
		`),t.normalize&&(o=!0,s.push(`
			value = value.trim().toLowerCase();
		`)),t.min!=null&&s.push(`
			if (value.length < ${t.min}) {
				${this.makeError({type:"emailMin",expected:t.min,actual:"value.length",messages:e})}
			}
		`),t.max!=null&&s.push(`
			if (value.length > ${t.max}) {
				${this.makeError({type:"emailMax",expected:t.max,actual:"value.length",messages:e})}
			}
		`),s.push(`
		if (!${i.toString()}.test(value)) {
			${this.makeError({type:"email",actual:"value",messages:e})}
		}

		return value;
	`),{sanitized:o,source:s.join(`
`)}}});var Vx=h((rHe,Nx)=>{"use strict";Nx.exports=function({schema:t,messages:e},r,n){return{source:`
			if (${JSON.stringify(t.values||[])}.indexOf(value) === -1)
				${this.makeError({type:"enumValue",expected:'"'+t.values.join(", ")+'"',actual:"value",messages:e})}
			
			return value;
		`}}});var Wx=h((nHe,Hx)=>{"use strict";Hx.exports=function({schema:t,messages:e},r,n){let s=[];return t.field?(t.strict?s.push(`
				if (value !== parent["${t.field}"])
			`):s.push(`
				if (value != parent["${t.field}"])
			`),s.push(`
				${this.makeError({type:"equalField",actual:"value",expected:JSON.stringify(t.field),messages:e})}
		`)):(t.strict?s.push(`
				if (value !== ${JSON.stringify(t.value)})
			`):s.push(`
				if (value != ${JSON.stringify(t.value)})
			`),s.push(`
				${this.makeError({type:"equalValue",actual:"value",expected:JSON.stringify(t.value),messages:e})}
		`)),s.push(`
		return value;
	`),{source:s.join(`
`)}}});var Px=h((sHe,Ox)=>{"use strict";Ox.exports=function({schema:e,messages:r},n,s){let i=[];return i.push(`
		if (value !== null && value !== undefined) {
	`),e.remove?i.push(`
			return undefined;
		`):i.push(`
			${this.makeError({type:"forbidden",actual:"value",messages:r})}
		`),i.push(`
		}

		return value;
	`),{source:i.join(`
`)}}});var Fx=h((iHe,kx)=>{"use strict";kx.exports=function({schema:t,messages:e},r,n){return{source:`
			if (typeof value !== "function")
				${this.makeError({type:"function",actual:"value",messages:e})}

			return value;
		`}}});var Lx=h((oHe,xx)=>{"use strict";xx.exports=function({schema:t,messages:e},r,n){let s=[];s.push(`
		var hasValid = false;
		var newVal = value;
		var checkErrors = [];
		var errorsSize = errors.length;
	`);for(let i=0;i<t.rules.length;i++){s.push(`
			if (!hasValid) {
				var _errors = [];
		`);let o=this.getRuleFromSchema(t.rules[i]);s.push(this.compileRule(o,n,r,`var tmpVal = ${n.async?"await ":""}context.fn[%%INDEX%%](value, field, parent, _errors, context);`,"tmpVal")),s.push(`
				if (errors.length == errorsSize && _errors.length == 0) {
					hasValid = true;
					newVal = tmpVal;
				} else {
					Array.prototype.push.apply(checkErrors, [].concat(_errors, errors.splice(errorsSize)));
				}
			}
		`)}return s.push(`
		if (!hasValid) {
			Array.prototype.push.apply(errors, checkErrors);
		}

		return newVal;
	`),{source:s.join(`
`)}}});var Yx=h((aHe,Ux)=>{"use strict";Ux.exports=function({schema:t,messages:e},r,n){let s=[];s.push(`
		var origValue = value;
	`);let i=!1;return t.convert===!0&&(i=!0,s.push(`
			if (typeof value !== "number") {
				value = Number(value);
			}
		`)),s.push(`
		if (typeof value !== "number" || isNaN(value) || !isFinite(value)) {
			${this.makeError({type:"number",actual:"origValue",messages:e})}
			return value;
		}
	`),t.min!=null&&s.push(`
			if (value < ${t.min}) {
				${this.makeError({type:"numberMin",expected:t.min,actual:"origValue",messages:e})}
			}
		`),t.max!=null&&s.push(`
			if (value > ${t.max}) {
				${this.makeError({type:"numberMax",expected:t.max,actual:"origValue",messages:e})}
			}
		`),t.equal!=null&&s.push(`
			if (value !== ${t.equal}) {
				${this.makeError({type:"numberEqual",expected:t.equal,actual:"origValue",messages:e})}
			}
		`),t.notEqual!=null&&s.push(`
			if (value === ${t.notEqual}) {
				${this.makeError({type:"numberNotEqual",expected:t.notEqual,actual:"origValue",messages:e})}
			}
		`),t.integer===!0&&s.push(`
			if (value % 1 !== 0) {
				${this.makeError({type:"numberInteger",actual:"origValue",messages:e})}
			}
		`),t.positive===!0&&s.push(`
			if (value <= 0) {
				${this.makeError({type:"numberPositive",actual:"origValue",messages:e})}
			}
		`),t.negative===!0&&s.push(`
			if (value >= 0) {
				${this.makeError({type:"numberNegative",actual:"origValue",messages:e})}
			}
		`),s.push(`
		return value;
	`),{sanitized:i,source:s.join(`
`)}}});var Xx=h((cHe,Dx)=>{"use strict";var qfe=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,Mfe=/["'\\\n\r\u2028\u2029]/g;function Pv(t){return t.replace(Mfe,function(e){switch(e){case'"':case"'":case"\\":return"\\"+e;case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029"}})}Dx.exports=function({schema:t,messages:e},r,n){let s=[];s.push(`
		if (typeof value !== "object" || value === null || Array.isArray(value)) {
			${this.makeError({type:"object",actual:"value",messages:e})}
			return value;
		}
	`);let i=t.properties||t.props;if(i){s.push("var parentObj = value;"),s.push("var parentField = field;");let o=Object.keys(i);for(let a=0;a<o.length;a++){let c=o[a],l=Pv(c),u=qfe.test(l)?`.${l}`:`['${l}']`,d=`parentObj${u}`,f=(r?r+".":"")+c,g=i[c].label,p=g?`'${Pv(g)}'`:void 0;s.push(`
// Field: ${Pv(f)}`),s.push(`field = parentField ? parentField + "${u}" : "${l}";`),s.push(`value = ${d};`),s.push(`label = ${p}`);let m=this.getRuleFromSchema(i[c]),I=`
				${d} = ${n.async?"await ":""}context.fn[%%INDEX%%](value, field, parentObj, errors, context, label);
			`;s.push(this.compileRule(m,n,f,I,d)),this.opts.haltOnFirstError===!0&&s.push("if (errors.length) return parentObj;")}if(t.strict){let a=Object.keys(i);s.push(`
				field = parentField;
				var invalidProps = [];
				var props = Object.keys(parentObj);

				for (let i = 0; i < props.length; i++) {
					if (${JSON.stringify(a)}.indexOf(props[i]) === -1) {
						invalidProps.push(props[i]);
					}
				}
				if (invalidProps.length) {
			`),t.strict==="remove"?(s.push(`
					if (errors.length === 0) {
				`),s.push(`
						invalidProps.forEach(function(field) {
							delete parentObj[field];
						});
				`),s.push(`
					}
				`)):s.push(`
					${this.makeError({type:"objectStrict",expected:'"'+a.join(", ")+'"',actual:"invalidProps.join(', ')",messages:e})}
				`),s.push(`
				}
			`)}}return(t.minProps!=null||t.maxProps!=null)&&(t.strict?s.push(`
				props = Object.keys(${i?"parentObj":"value"});
			`):s.push(`
				var props = Object.keys(${i?"parentObj":"value"});
				${i?"field = parentField;":""}
			`)),t.minProps!=null&&s.push(`
			if (props.length < ${t.minProps}) {
				${this.makeError({type:"objectMinProps",expected:t.minProps,actual:"props.length",messages:e})}
			}
		`),t.maxProps!=null&&s.push(`
			if (props.length > ${t.maxProps}) {
				${this.makeError({type:"objectMaxProps",expected:t.maxProps,actual:"props.length",messages:e})}
			}
		`),i?s.push(`
			return parentObj;
		`):s.push(`
			return value;
		`),{source:s.join(`
`)}}});var jx=h((lHe,$x)=>{"use strict";$x.exports=function({schema:t,messages:e,index:r},n,s){let i=[];return s.customs[r]?s.customs[r].schema=t:s.customs[r]={schema:t},i.push(`
		const ObjectID = context.customs[${r}].schema.ObjectID;
		if (!ObjectID.isValid(value)) {
			${this.makeError({type:"objectID",actual:"value",messages:e})}
			return;
		}
	`),t.convert===!0?i.push("return new ObjectID(value)"):t.convert==="hexString"?i.push("return value.toString()"):i.push("return value"),{source:i.join(`
`)}}});var Mx=h((uHe,qx)=>{function Kfe(t){for(let e in t.messages)e.startsWith("string")&&(t.messages[e]=t.messages[e].replace(" field "," key "))}qx.exports=function({schema:e,messages:r},n,s){let i=[];i.push(`
		if (typeof value !== "object" || value === null || Array.isArray(value)) {
			${this.makeError({type:"record",actual:"value",messages:r})}
			return value;
		}
	`);let o=e.key||"string",a=e.value||"any";i.push(`
		const record = value;
		let sanitizedKey, sanitizedValue;
		const result = {};
		for (let key in value) {
	`),i.push("sanitizedKey = value = key;");let c=this.getRuleFromSchema(o);Kfe(c);let l=`
		sanitizedKey = ${s.async?"await ":""}context.fn[%%INDEX%%](key, field ? field + "." + key : key, record, errors, context);
	`;i.push(this.compileRule(c,s,null,l,"sanitizedKey")),i.push("sanitizedValue = value = record[key];");let u=this.getRuleFromSchema(a),d=`
		sanitizedValue = ${s.async?"await ":""}context.fn[%%INDEX%%](value, field ? field + "." + key : key, record, errors, context);
	`;return i.push(this.compileRule(u,s,`${n}[key]`,d,"sanitizedValue")),i.push("result[sanitizedKey] = sanitizedValue;"),i.push(`
		}
	`),i.push("return result;"),{source:i.join(`
`)}}});var zx=h((dHe,Kx)=>{"use strict";var zfe=/^-?[0-9]\d*(\.\d+)?$/,Jfe=/^[a-zA-Z]+$/,Qfe=/^[a-zA-Z0-9]+$/,ege=/^[a-zA-Z0-9_-]+$/,tge=/^[0-9a-fA-F]+$/,rge=/^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?$/;Kx.exports=function({schema:e,messages:r},n,s){let i=[],o=!1;if(e.convert===!0&&(o=!0,i.push(`
			if (typeof value !== "string") {
				value = String(value);
			}
		`)),i.push(`
		if (typeof value !== "string") {
			${this.makeError({type:"string",actual:"value",messages:r})}
			return value;
		}

		var origValue = value;
	`),e.trim&&(o=!0,i.push(`
			value = value.trim();
		`)),e.trimLeft&&(o=!0,i.push(`
			value = value.trimLeft();
		`)),e.trimRight&&(o=!0,i.push(`
			value = value.trimRight();
		`)),e.padStart){o=!0;let a=e.padChar!=null?e.padChar:" ";i.push(`
			value = value.padStart(${e.padStart}, ${JSON.stringify(a)});
		`)}if(e.padEnd){o=!0;let a=e.padChar!=null?e.padChar:" ";i.push(`
			value = value.padEnd(${e.padEnd}, ${JSON.stringify(a)});
		`)}if(e.lowercase&&(o=!0,i.push(`
			value = value.toLowerCase();
		`)),e.uppercase&&(o=!0,i.push(`
			value = value.toUpperCase();
		`)),e.localeLowercase&&(o=!0,i.push(`
			value = value.toLocaleLowerCase();
		`)),e.localeUppercase&&(o=!0,i.push(`
			value = value.toLocaleUpperCase();
		`)),i.push(`
			var len = value.length;
	`),e.empty===!1?i.push(`
			if (len === 0) {
				${this.makeError({type:"stringEmpty",actual:"value",messages:r})}
			}
		`):e.empty===!0&&i.push(`
			if (len === 0) {
				return value;
			}
		`),e.min!=null&&i.push(`
			if (len < ${e.min}) {
				${this.makeError({type:"stringMin",expected:e.min,actual:"len",messages:r})}
			}
		`),e.max!=null&&i.push(`
			if (len > ${e.max}) {
				${this.makeError({type:"stringMax",expected:e.max,actual:"len",messages:r})}
			}
		`),e.length!=null&&i.push(`
			if (len !== ${e.length}) {
				${this.makeError({type:"stringLength",expected:e.length,actual:"len",messages:r})}
			}
		`),e.pattern!=null){let a=e.pattern;typeof e.pattern=="string"&&(a=new RegExp(e.pattern,e.patternFlags)),i.push(`
			if (!${a.toString()}.test(value)) {
				${this.makeError({type:"stringPattern",expected:`"${a.toString().replace(/"/g,"\\$&")}"`,actual:"origValue",messages:r})}
			}
		`)}if(e.contains!=null&&i.push(`
			if (value.indexOf("${e.contains}") === -1) {
				${this.makeError({type:"stringContains",expected:'"'+e.contains+'"',actual:"origValue",messages:r})}
			}
		`),e.enum!=null){let a=JSON.stringify(e.enum);i.push(`
			if (${a}.indexOf(value) === -1) {
				${this.makeError({type:"stringEnum",expected:'"'+e.enum.join(", ")+'"',actual:"origValue",messages:r})}
			}
		`)}return e.numeric===!0&&i.push(`
			if (!${zfe.toString()}.test(value) ) {
				${this.makeError({type:"stringNumeric",actual:"origValue",messages:r})}
			}
		`),e.alpha===!0&&i.push(`
			if(!${Jfe.toString()}.test(value)) {
				${this.makeError({type:"stringAlpha",actual:"origValue",messages:r})}
			}
		`),e.alphanum===!0&&i.push(`
			if(!${Qfe.toString()}.test(value)) {
				${this.makeError({type:"stringAlphanum",actual:"origValue",messages:r})}
			}
		`),e.alphadash===!0&&i.push(`
			if(!${ege.toString()}.test(value)) {
				${this.makeError({type:"stringAlphadash",actual:"origValue",messages:r})}
			}
		`),e.hex===!0&&i.push(`
			if(value.length % 2 !== 0 || !${tge.toString()}.test(value)) {
				${this.makeError({type:"stringHex",actual:"origValue",messages:r})}
			}
		`),e.singleLine===!0&&i.push(`
			if(value.includes("\\n")) {
				${this.makeError({type:"stringSingleLine",messages:r})}
			}
		`),e.base64===!0&&i.push(`
			if(!${rge.toString()}.test(value)) {
				${this.makeError({type:"stringBase64",actual:"origValue",messages:r})}
			}
		`),i.push(`
		return value;
	`),{sanitized:o,source:i.join(`
`)}}});var Qx=h((fHe,Jx)=>{"use strict";Jx.exports=function({schema:t,messages:e},r,n){let s=[];if(t.items!=null){if(!Array.isArray(t.items))throw new Error(`Invalid '${t.type}' schema. The 'items' field must be an array.`);if(t.items.length===0)throw new Error(`Invalid '${t.type}' schema. The 'items' field must not be an empty array.`)}if(s.push(`
		if (!Array.isArray(value)) {
			${this.makeError({type:"tuple",actual:"value",messages:e})}
			return value;
		}

		var len = value.length;
	`),t.empty===!1&&s.push(`
			if (len === 0) {
				${this.makeError({type:"tupleEmpty",actual:"value",messages:e})}
				return value;
			}
		`),t.items!=null){s.push(`
			if (${t.empty} !== false && len === 0) {
				return value;
			}

			if (len !== ${t.items.length}) {
				${this.makeError({type:"tupleLength",expected:t.items.length,actual:"len",messages:e})}
				return value;
			}
		`),s.push(`
			var arr = value;
			var parentField = field;
		`);for(let i=0;i<t.items.length;i++){s.push(`
			value = arr[${i}];
		`);let o=`${r}[${i}]`,a=this.getRuleFromSchema(t.items[i]),c=`
			arr[${i}] = ${n.async?"await ":""}context.fn[%%INDEX%%](arr[${i}], (parentField ? parentField : "") + "[" + ${i} + "]", parent, errors, context);
		`;s.push(this.compileRule(a,n,o,c,`arr[${i}]`))}s.push(`
		return arr;
	`)}else s.push(`
		return value;
	`);return{source:s.join(`
`)}}});var tL=h((gHe,eL)=>{"use strict";var nge=/^https?:\/\/\S+/;eL.exports=function({schema:t,messages:e},r,n){let s=[];return s.push(`
		if (typeof value !== "string") {
			${this.makeError({type:"string",actual:"value",messages:e})}
			return value;
		}
	`),t.empty?s.push(`
			if (value.length === 0) return value;
		`):s.push(`
			if (value.length === 0) {
				${this.makeError({type:"urlEmpty",actual:"value",messages:e})}
				return value;
			}
		`),s.push(`
		if (!${nge.toString()}.test(value)) {
			${this.makeError({type:"url",actual:"value",messages:e})}
		}

		return value;
	`),{source:s.join(`
`)}}});var nL=h((pHe,rL)=>{"use strict";var sge=/^([0-9a-f]{8}-[0-9a-f]{4}-[1-6][0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}|[0]{8}-[0]{4}-[0]{4}-[0]{4}-[0]{12})$/i;rL.exports=function({schema:t,messages:e},r){let n=[];return n.push(`
		if (typeof value !== "string") {
			${this.makeError({type:"string",actual:"value",messages:e})}
			return value;
		}

		var val = value.toLowerCase();
		if (!${sge.toString()}.test(val)) {
			${this.makeError({type:"uuid",actual:"value",messages:e})}
			return value;
		}

		const version = val.charAt(14) | 0;
	`),parseInt(t.version)<7&&n.push(`
			if (${t.version} !== version) {
				${this.makeError({type:"uuidVersion",expected:t.version,actual:"version",messages:e})}
				return value;
			}
		`),n.push(`
		switch (version) {
		case 0:
		case 1:
		case 2:
		case 6:
			break;
		case 3:
		case 4:
		case 5:
			if (["8", "9", "a", "b"].indexOf(val.charAt(19)) === -1) {
				${this.makeError({type:"uuid",actual:"value",messages:e})}
			}
		}

		return value;
	`),{source:n.join(`
`)}}});var iL=h((hHe,sL)=>{"use strict";var ige=/^((([a-f0-9][a-f0-9]+[-]){5}|([a-f0-9][a-f0-9]+[:]){5})([a-f0-9][a-f0-9])$)|(^([a-f0-9][a-f0-9][a-f0-9][a-f0-9]+[.]){2}([a-f0-9][a-f0-9][a-f0-9][a-f0-9]))$/i;sL.exports=function({schema:t,messages:e},r,n){return{source:`
			if (typeof value !== "string") {
				${this.makeError({type:"string",actual:"value",messages:e})}
				return value;
			}

			var v = value.toLowerCase();
			if (!${ige.toString()}.test(v)) {
				${this.makeError({type:"mac",actual:"value",messages:e})}
			}
			
			return value;
		`}}});var aL=h((mHe,oL)=>{"use strict";oL.exports=function({schema:t,messages:e},r,n){return{source:`
			if (typeof value !== "string") {
				${this.makeError({type:"string",actual:"value",messages:e})}
				return value;
			}

			if (typeof value !== "string")
				value = String(value);

			val = value.replace(/\\D+/g, "");

			var array = [0, 2, 4, 6, 8, 1, 3, 5, 7, 9];
			var len = val ? val.length : 0,
				bit = 1,
				sum = 0;
			while (len--) {
				sum += !(bit ^= 1) ? parseInt(val[len], 10) : array[val[len]];
			}

			if (!(sum % 10 === 0 && sum > 0)) {
				${this.makeError({type:"luhn",actual:"value",messages:e})}
			}

			return value;
		`}}});var dL=h((yHe,uL)=>{var kv,cL,Fv,lL,oge="prettier",age="cli-highlight";uL.exports=function(t){kv||(kv=require(oge),cL={parser:"babel",useTabs:!1,printWidth:120,trailingComma:"none",tabWidth:4,singleQuote:!1,semi:!0,bracketSpacing:!0},Fv=require(age),lL={language:"js",theme:Fv.fromJson({keyword:["white","bold"],built_in:"magenta",literal:"cyan",number:"magenta",regexp:"red",string:["yellow","bold"],symbol:"plain",class:"blue",attr:"plain",function:["white","bold"],title:"plain",params:"green",comment:"grey"})});let e=kv.format(t,cL);return Fv.highlight(e,lL)}});var gL=h((IHe,fL)=>{"use strict";var xp;try{xp=new Function("return Object.getPrototypeOf(async function(){}).constructor")()}catch{}var vi=dx(),cge=gx();function lge(){return Object.assign({},hx())}function uge(){return{any:yx(),array:bx(),boolean:Sx(),class:_x(),custom:Rx(),currency:wx(),date:Tx(),email:Zx(),enum:Vx(),equal:Wx(),forbidden:Px(),function:Fx(),multi:Lx(),number:Yx(),object:Xx(),objectID:jx(),record:Mx(),string:zx(),tuple:Qx(),url:tL(),uuid:nL(),mac:iL(),luhn:aL()}}var xv=class{constructor(e){if(this.opts={},this.defaults={},this.messages=lge(),this.rules=uge(),this.aliases={},this.cache=new Map,e){if(vi(this.opts,e),e.defaults&&vi(this.defaults,e.defaults),e.messages)for(let r in e.messages)this.addMessage(r,e.messages[r]);if(e.aliases)for(let r in e.aliases)this.alias(r,e.aliases[r]);if(e.customRules)for(let r in e.customRules)this.add(r,e.customRules[r]);if(e.plugins){let r=e.plugins;if(!Array.isArray(r))throw new Error("Plugins type must be array");r.forEach(this.plugin.bind(this))}if(this.opts.debug){let r=function(n){return n};typeof window>"u"&&(r=dL()),this._formatter=r}}}validate(e,r){return this.compile(r)(e)}wrapRequiredCheckSourceCode(e,r,n,s){let i=[],{considerNullAsAValue:o=!1}=this.opts,a,c=e.schema.optional===!0||e.schema.type==="forbidden",l=o?e.schema.nullable!==!1||e.schema.type==="forbidden":e.schema.optional===!0||e.schema.nullable===!0||e.schema.type==="forbidden";if(o?e.schema.default!=null&&e.schema.default!=null:e.schema.default!=null){c=!1,o?e.schema.nullable===!1&&(l=!1):e.schema.nullable!==!0&&(l=!1);let d;typeof e.schema.default=="function"?(n.customs[e.index]||(n.customs[e.index]={}),n.customs[e.index].defaultFn=e.schema.default,d=`context.customs[${e.index}].defaultFn.call(this, context.rules[${e.index}].schema, field, parent, context)`):d=JSON.stringify(e.schema.default),a=`
				value = ${d};
				${s} = value;
			`}else a=this.makeError({type:"required",actual:"value",messages:e.messages});return i.push(`
			${`if (value === undefined) { ${c?`
// allow undefined
`:a} }`}
			${`else if (value === null) { ${l?`
// allow null
`:a} }`}
			${r?`else { ${r} }`:""}
		`),i.join(`
`)}compile(e){if(e===null||typeof e!="object")throw new Error("Invalid schema.");let r=this,n={index:0,async:e.$$async===!0,rules:[],fn:[],customs:{},utils:{replace:cge}};if(this.cache.clear(),delete e.$$async,n.async&&!xp)throw new Error("Asynchronous mode is not supported.");if(e.$$root!==!0)if(Array.isArray(e))e=this.getRuleFromSchema(e).schema;else{let u=Object.assign({},e);e={type:"object",strict:u.$$strict,properties:u},delete u.$$strict}let s=["var errors = [];","var field;","var parent = null;",`var label = ${e.label?'"'+e.label+'"':"null"};`],i=this.getRuleFromSchema(e);s.push(this.compileRule(i,n,null,`${n.async?"await ":""}context.fn[%%INDEX%%](value, field, null, errors, context, label);`,"value")),s.push("if (errors.length) {"),s.push(`
			return errors.map(err => {
				if (err.message) {
					err.message = context.utils.replace(err.message, /\\{field\\}/g, err.label || err.field);
					err.message = context.utils.replace(err.message, /\\{expected\\}/g, err.expected);
					err.message = context.utils.replace(err.message, /\\{actual\\}/g, err.actual);
				}
				if(!err.label) delete err.label
				return err;
			});
		`),s.push("}"),s.push("return true;");let o=s.join(`
`),a=n.async?xp:Function,c=new a("value","context",o);this.opts.debug&&console.log(this._formatter(`// Main check function
`+c.toString())),this.cache.clear();let l=function(u,d){return n.data=u,d&&d.meta&&(n.meta=d.meta),c.call(r,u,n)};return l.async=n.async,l}compileRule(e,r,n,s,i){let o=[],a=this.cache.get(e.schema);if(a)e=a,e.cycle=!0,e.cycleStack=[],o.push(this.wrapRequiredCheckSourceCode(e,`
				var rule = context.rules[${e.index}];
				if (rule.cycleStack.indexOf(value) === -1) {
					rule.cycleStack.push(value);
					${s.replace(/%%INDEX%%/g,e.index)}
					rule.cycleStack.pop(value);
				}
			`,r,i));else{this.cache.set(e.schema,e),e.index=r.index,r.rules[r.index]=e;let c=n??"$$root";r.index++;let l=e.ruleFunction.call(this,e,n,r);l.source=l.source.replace(/%%INDEX%%/g,e.index);let u=r.async?xp:Function,d=new u("value","field","parent","errors","context","label",l.source);r.fn[e.index]=d.bind(this),o.push(this.wrapRequiredCheckSourceCode(e,s.replace(/%%INDEX%%/g,e.index),r,i)),o.push(this.makeCustomValidator({vName:i,path:c,schema:e.schema,context:r,messages:e.messages,ruleIndex:e.index})),this.opts.debug&&console.log(this._formatter(`// Context.fn[${e.index}]
`+d.toString()))}return o.join(`
`)}getRuleFromSchema(e){e=this.resolveType(e);let r=this.aliases[e.type];r&&(delete e.type,e=vi(e,r,{skipIfExist:!0}));let n=this.rules[e.type];if(!n)throw new Error("Invalid '"+e.type+"' type in validator schema.");return{messages:Object.assign({},this.messages,e.messages),schema:vi(e,this.defaults[e.type],{skipIfExist:!0}),ruleFunction:n}}parseShortHand(e){let r=e.split("|").map(i=>i.trim()),n=r[0],s;return n.endsWith("[]")?s=this.getRuleFromSchema({type:"array",items:n.slice(0,-2)}).schema:s={type:r[0]},r.slice(1).map(i=>{let o=i.indexOf(":");if(o!==-1){let a=i.substr(0,o).trim(),c=i.substr(o+1).trim();c==="true"||c==="false"?c=c==="true":Number.isNaN(Number(c))||(c=Number(c)),s[a]=c}else i.startsWith("no-")?s[i.slice(3)]=!1:s[i]=!0}),s}makeError({type:e,field:r,expected:n,actual:s,messages:i}){let o={type:`"${e}"`,message:`"${i[e]}"`};return r?o.field=`"${r}"`:o.field="field",n!=null&&(o.expected=n),s!=null&&(o.actual=s),o.label="label",`errors.push({ ${Object.keys(o).map(c=>`${c}: ${o[c]}`).join(", ")} });`}makeCustomValidator({vName:e="value",fnName:r="custom",ruleIndex:n,path:s,schema:i,context:o,messages:a}){let c="rule"+n,l="fnCustomErrors"+n;if(typeof i[r]=="function"){if(o.customs[n]?(o.customs[n].messages=a,o.customs[n].schema=i):o.customs[n]={messages:a,schema:i},this.opts.useNewCustomCheckerFunction)return`
               		const ${c} = context.customs[${n}];
					const ${l} = [];
					${e} = ${o.async?"await ":""}${c}.schema.${r}.call(this, ${e}, ${l} , ${c}.schema, "${s}", parent, context);
					if (Array.isArray(${l} )) {
                  		${l} .forEach(err => errors.push(Object.assign({ message: ${c}.messages[err.type], field }, err)));
					}
				`;let u="res_"+c;return`
				const ${c} = context.customs[${n}];
				const ${u} = ${o.async?"await ":""}${c}.schema.${r}.call(this, ${e}, ${c}.schema, "${s}", parent, context);
				if (Array.isArray(${u})) {
					${u}.forEach(err => errors.push(Object.assign({ message: ${c}.messages[err.type], field }, err)));
				}
		`}return""}add(e,r){this.rules[e]=r}addMessage(e,r){this.messages[e]=r}alias(e,r){if(this.rules[e])throw new Error("Alias name must not be a rule name");this.aliases[e]=r}plugin(e){if(typeof e!="function")throw new Error("Plugin fn type must be function");return e(this)}resolveType(e){if(typeof e=="string")e=this.parseShortHand(e);else if(Array.isArray(e)){if(e.length===0)throw new Error("Invalid schema.");e={type:"multi",rules:e},e.rules.map(i=>this.getRuleFromSchema(i)).every(i=>i.schema.optional===!0)&&(e.optional=!0);let n=!this.opts.considerNullAsAValue;e.rules.map(i=>this.getRuleFromSchema(i)).every(i=>i.schema.nullable===n)&&(e.nullable=n)}if(e.$$type){let r=e.$$type,n=this.getRuleFromSchema(r).schema;delete e.$$type;let s=Object.assign({},e);for(let i in e)delete e[i];vi(e,n,{skipIfExist:!0}),e.props=s}return e}normalize(e){let r=this.resolveType(e);if(this.aliases[r.type]&&(r=vi(r,this.normalize(this.aliases[r.type]),{skipIfExists:!0})),r=vi(r,this.defaults[r.type],{skipIfExist:!0}),r.type==="multi")return r.rules=r.rules.map(n=>this.normalize(n)),r.optional=r.rules.every(n=>n.optional===!0),r;if(r.type==="array")return r.items=this.normalize(r.items),r;if(r.type==="object"&&r.props&&Object.entries(r.props).forEach(([n,s])=>r.props[n]=this.normalize(s)),typeof e=="object")if(e.type){let n=this.normalize(e.type);vi(r,n,{skipIfExists:!0})}else Object.entries(e).forEach(([n,s])=>r[n]=this.normalize(s));return r}};fL.exports=xv});var hL=h((bHe,pL)=>{pL.exports=gL()});var Yr=h(Vt=>{Object.defineProperty(Vt,"__esModule",{value:!0});var SL=Object.prototype.toString;function fge(t){switch(SL.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return qp(t,Error)}}function Ja(t,e){return SL.call(t)===`[object ${e}]`}function gge(t){return Ja(t,"ErrorEvent")}function pge(t){return Ja(t,"DOMError")}function hge(t){return Ja(t,"DOMException")}function mge(t){return Ja(t,"String")}function vL(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function yge(t){return t===null||vL(t)||typeof t!="object"&&typeof t!="function"}function _L(t){return Ja(t,"Object")}function Ige(t){return typeof Event<"u"&&qp(t,Event)}function bge(t){return typeof Element<"u"&&qp(t,Element)}function Cge(t){return Ja(t,"RegExp")}function Sge(t){return!!(t&&t.then&&typeof t.then=="function")}function vge(t){return _L(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function _ge(t){return typeof t=="number"&&t!==t}function qp(t,e){try{return t instanceof e}catch{return!1}}function Age(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}Vt.isDOMError=pge;Vt.isDOMException=hge;Vt.isElement=bge;Vt.isError=fge;Vt.isErrorEvent=gge;Vt.isEvent=Ige;Vt.isInstanceOf=qp;Vt.isNaN=_ge;Vt.isParameterizedString=vL;Vt.isPlainObject=_L;Vt.isPrimitive=yge;Vt.isRegExp=Cge;Vt.isString=mge;Vt.isSyntheticEvent=vge;Vt.isThenable=Sge;Vt.isVueViewModel=Age});var wu=h(So=>{Object.defineProperty(So,"__esModule",{value:!0});var Mp=Yr();function Rge(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Ege(t,e){let r=t,n=r.length;if(n<=150)return r;e>n&&(e=n);let s=Math.max(e-60,0);s<5&&(s=0);let i=Math.min(s+140,n);return i>n-5&&(i=n),i===n&&(s=Math.max(i-140,0)),r=r.slice(s,i),s>0&&(r=`'{snip} ${r}`),i<n&&(r+=" {snip}"),r}function wge(t,e){if(!Array.isArray(t))return"";let r=[];for(let n=0;n<t.length;n++){let s=t[n];try{Mp.isVueViewModel(s)?r.push("[VueViewModel]"):r.push(String(s))}catch{r.push("[value cannot be serialized]")}}return r.join(e)}function AL(t,e,r=!1){return Mp.isString(t)?Mp.isRegExp(e)?e.test(t):Mp.isString(e)?r?t===e:t.includes(e):!1:!1}function Bge(t,e=[],r=!1){return e.some(n=>AL(t,n,r))}So.isMatchingPattern=AL;So.safeJoin=wge;So.snipLine=Ege;So.stringMatchesSomePattern=Bge;So.truncate=Rge});var wL=h($v=>{Object.defineProperty($v,"__esModule",{value:!0});var Dv=Yr(),Tge=wu();function Gge(t,e,r=250,n,s,i,o){if(!i.exception||!i.exception.values||!o||!Dv.isInstanceOf(o.originalException,Error))return;let a=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;a&&(i.exception.values=Zge(Xv(t,e,s,o.originalException,n,i.exception.values,a,0),r))}function Xv(t,e,r,n,s,i,o,a){if(i.length>=r+1)return i;let c=[...i];if(Dv.isInstanceOf(n[s],Error)){RL(o,a);let l=t(e,n[s]),u=c.length;EL(l,s,u,a),c=Xv(t,e,r,n[s],s,[l,...c],l,u)}return Array.isArray(n.errors)&&n.errors.forEach((l,u)=>{if(Dv.isInstanceOf(l,Error)){RL(o,a);let d=t(e,l),f=c.length;EL(d,`errors[${u}]`,f,a),c=Xv(t,e,r,l,s,[d,...c],d,f)}}),c}function RL(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function EL(t,e,r,n){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:r,parent_id:n}}function Zge(t,e){return t.map(r=>(r.value&&(r.value=Tge.truncate(r.value,e)),r))}$v.applyAggregateErrorsToEvent=Gge});var qt=h(Bu=>{Object.defineProperty(Bu,"__esModule",{value:!0});function Kp(t){return t&&t.Math==Math?t:void 0}var jv=typeof globalThis=="object"&&Kp(globalThis)||typeof window=="object"&&Kp(window)||typeof self=="object"&&Kp(self)||typeof global=="object"&&Kp(global)||function(){return this}()||{};function Nge(){return jv}function Vge(t,e,r){let n=r||jv,s=n.__SENTRY__=n.__SENTRY__||{};return s[t]||(s[t]=e())}Bu.GLOBAL_OBJ=jv;Bu.getGlobalObject=Nge;Bu.getGlobalSingleton=Vge});var qv=h(ec=>{Object.defineProperty(ec,"__esModule",{value:!0});var Hge=Yr(),Wge=qt(),Qa=Wge.getGlobalObject(),Oge=80;function Pge(t,e={}){if(!t)return"<unknown>";try{let r=t,n=5,s=[],i=0,o=0,a=" > ",c=a.length,l,u=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Oge;for(;r&&i++<n&&(l=kge(r,u),!(l==="html"||i>1&&o+s.length*c+l.length>=d));)s.push(l),o+=l.length,r=r.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function kge(t,e){let r=t,n=[],s,i,o,a,c;if(!r||!r.tagName)return"";if(Qa.HTMLElement&&r instanceof HTMLElement&&r.dataset&&r.dataset.sentryComponent)return r.dataset.sentryComponent;n.push(r.tagName.toLowerCase());let l=e&&e.length?e.filter(d=>r.getAttribute(d)).map(d=>[d,r.getAttribute(d)]):null;if(l&&l.length)l.forEach(d=>{n.push(`[${d[0]}="${d[1]}"]`)});else if(r.id&&n.push(`#${r.id}`),s=r.className,s&&Hge.isString(s))for(i=s.split(/\s+/),c=0;c<i.length;c++)n.push(`.${i[c]}`);let u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)o=u[c],a=r.getAttribute(o),a&&n.push(`[${o}="${a}"]`);return n.join("")}function Fge(){try{return Qa.document.location.href}catch{return""}}function xge(t){return Qa.document&&Qa.document.querySelector?Qa.document.querySelector(t):null}function Lge(t){if(!Qa.HTMLElement)return null;let e=t,r=5;for(let n=0;n<r;n++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}ec.getComponentName=Lge;ec.getDomElement=xge;ec.getLocationHref=Fge;ec.htmlTreeAsString=Pge});var On=h(Mv=>{Object.defineProperty(Mv,"__esModule",{value:!0});var Uge=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;Mv.DEBUG_BUILD=Uge});var fn=h(tc=>{Object.defineProperty(tc,"__esModule",{value:!0});var Yge=On(),Kv=qt(),Dge="Sentry Logger ",zv=["debug","info","warn","error","log","assert","trace"],Jv={};function BL(t){if(!("console"in Kv.GLOBAL_OBJ))return t();let e=Kv.GLOBAL_OBJ.console,r={},n=Object.keys(Jv);n.forEach(s=>{let i=Jv[s];r[s]=e[s],e[s]=i});try{return t()}finally{n.forEach(s=>{e[s]=r[s]})}}function Xge(){let t=!1,e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return Yge.DEBUG_BUILD?zv.forEach(r=>{e[r]=(...n)=>{t&&BL(()=>{Kv.GLOBAL_OBJ.console[r](`${Dge}[${r}]:`,...n)})}}):zv.forEach(r=>{e[r]=()=>{}}),e}var $ge=Xge();tc.CONSOLE_LEVELS=zv;tc.consoleSandbox=BL;tc.logger=$ge;tc.originalConsoleMethods=Jv});var Qv=h(Gu=>{Object.defineProperty(Gu,"__esModule",{value:!0});var jge=On(),Tu=fn(),qge=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Mge(t){return t==="http"||t==="https"}function Kge(t,e=!1){let{host:r,path:n,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${r}${i?`:${i}`:""}/${n&&`${n}/`}${o}`}function TL(t){let e=qge.exec(t);if(!e){Tu.consoleSandbox(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}let[r,n,s="",i,o="",a]=e.slice(1),c="",l=a,u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){let d=l.match(/^\d+/);d&&(l=d[0])}return GL({host:i,pass:s,path:c,projectId:l,port:o,protocol:r,publicKey:n})}function GL(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function zge(t){if(!jge.DEBUG_BUILD)return!0;let{port:e,projectId:r,protocol:n}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(Tu.logger.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:r.match(/^\d+$/)?Mge(n)?e&&isNaN(parseInt(e,10))?(Tu.logger.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(Tu.logger.error(`Invalid Sentry Dsn: Invalid protocol ${n}`),!1):(Tu.logger.error(`Invalid Sentry Dsn: Invalid projectId ${r}`),!1)}function Jge(t){let e=typeof t=="string"?TL(t):GL(t);if(!(!e||!zge(e)))return e}Gu.dsnFromString=TL;Gu.dsnToString=Kge;Gu.makeDsn=Jge});var r_=h(t_=>{Object.defineProperty(t_,"__esModule",{value:!0});var e_=class extends Error{constructor(e,r="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=r}};t_.SentryError=e_});var Dr=h(gn=>{Object.defineProperty(gn,"__esModule",{value:!0});var Qge=qv(),epe=On(),rc=Yr(),tpe=fn(),ZL=wu();function rpe(t,e,r){if(!(e in t))return;let n=t[e],s=r(n);typeof s=="function"&&WL(s,n),t[e]=s}function HL(t,e,r){try{Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0})}catch{epe.DEBUG_BUILD&&tpe.logger.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function WL(t,e){try{let r=e.prototype||{};t.prototype=e.prototype=r,HL(t,"__sentry_original__",e)}catch{}}function npe(t){return t.__sentry_original__}function spe(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function OL(t){if(rc.isError(t))return{message:t.message,name:t.name,stack:t.stack,...VL(t)};if(rc.isEvent(t)){let e={type:t.type,target:NL(t.target),currentTarget:NL(t.currentTarget),...VL(t)};return typeof CustomEvent<"u"&&rc.isInstanceOf(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function NL(t){try{return rc.isElement(t)?Qge.htmlTreeAsString(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function VL(t){if(typeof t=="object"&&t!==null){let e={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}else return{}}function ipe(t,e=40){let r=Object.keys(OL(t));if(r.sort(),!r.length)return"[object has no keys]";if(r[0].length>=e)return ZL.truncate(r[0],e);for(let n=r.length;n>0;n--){let s=r.slice(0,n).join(", ");if(!(s.length>e))return n===r.length?s:ZL.truncate(s,e)}return""}function ope(t){return n_(t,new Map)}function n_(t,e){if(ape(t)){let r=e.get(t);if(r!==void 0)return r;let n={};e.set(t,n);for(let s of Object.keys(t))typeof t[s]<"u"&&(n[s]=n_(t[s],e));return n}if(Array.isArray(t)){let r=e.get(t);if(r!==void 0)return r;let n=[];return e.set(t,n),t.forEach(s=>{n.push(n_(s,e))}),n}return t}function ape(t){if(!rc.isPlainObject(t))return!1;try{let e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}function cpe(t){let e;switch(!0){case t==null:e=new String(t);break;case(typeof t=="symbol"||typeof t=="bigint"):e=Object(t);break;case rc.isPrimitive(t):e=new t.constructor(t);break;default:e=t;break}return e}gn.addNonEnumerableProperty=HL;gn.convertToPlainObject=OL;gn.dropUndefinedKeys=ope;gn.extractExceptionKeysForMessage=ipe;gn.fill=rpe;gn.getOriginalFunction=npe;gn.markFunctionWrapped=WL;gn.objectify=cpe;gn.urlEncode=spe});var Jp=h(zp=>{Object.defineProperty(zp,"__esModule",{value:!0});function PL(t,e=!1){return!(e||t&&!t.startsWith("/")&&!t.match(/^[A-Z]:/)&&!t.startsWith(".")&&!t.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//))&&t!==void 0&&!t.includes("node_modules/")}function lpe(t){let e=/^\s*[-]{4,}$/,r=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return n=>{let s=n.match(r);if(s){let i,o,a,c,l;if(s[1]){a=s[1];let f=a.lastIndexOf(".");if(a[f-1]==="."&&f--,f>0){i=a.slice(0,f),o=a.slice(f+1);let g=i.indexOf(".Module");g>0&&(a=a.slice(g+1),i=i.slice(0,g))}c=void 0}o&&(c=i,l=o),o==="<anonymous>"&&(l=void 0,a=void 0),a===void 0&&(l=l||"<anonymous>",a=c?`${c}.${l}`:l);let u=s[2]&&s[2].startsWith("file://")?s[2].slice(7):s[2],d=s[5]==="native";return u&&u.match(/\/[A-Z]:/)&&(u=u.slice(1)),!u&&s[5]&&!d&&(u=s[5]),{filename:u,module:t?t(u):void 0,function:a,lineno:parseInt(s[3],10)||void 0,colno:parseInt(s[4],10)||void 0,in_app:PL(u,d)}}if(n.match(e))return{filename:n}}}zp.filenameIsInApp=PL;zp.node=lpe});var Qp=h(Ai=>{Object.defineProperty(Ai,"__esModule",{value:!0});var xL=Jp(),LL=50,kL=/\(error: (.*)\)/,FL=/captureMessage|captureException/;function UL(...t){let e=t.sort((r,n)=>r[0]-n[0]).map(r=>r[1]);return(r,n=0)=>{let s=[],i=r.split(`
`);for(let o=n;o<i.length;o++){let a=i[o];if(a.length>1024)continue;let c=kL.test(a)?a.replace(kL,"$1"):a;if(!c.match(/\S*Error: /)){for(let l of e){let u=l(c);if(u){s.push(u);break}}if(s.length>=LL)break}}return YL(s)}}function upe(t){return Array.isArray(t)?UL(...t):t}function YL(t){if(!t.length)return[];let e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),FL.test(e[e.length-1].function||"")&&(e.pop(),FL.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,LL).map(r=>({...r,filename:r.filename||e[e.length-1].filename,function:r.function||"?"}))}var s_="<anonymous>";function dpe(t){try{return!t||typeof t!="function"?s_:t.name||s_}catch{return s_}}function fpe(t){return[90,xL.node(t)]}Ai.filenameIsInApp=xL.filenameIsInApp;Ai.createStackParser=UL;Ai.getFunctionName=dpe;Ai.nodeStackLineParser=fpe;Ai.stackParserFromStackParserOptions=upe;Ai.stripSentryFramesAndReverse=YL});var _s=h(sc=>{Object.defineProperty(sc,"__esModule",{value:!0});var gpe=On(),ppe=fn(),hpe=Qp(),nc={},DL={};function mpe(t,e){nc[t]=nc[t]||[],nc[t].push(e)}function ype(){Object.keys(nc).forEach(t=>{nc[t]=void 0})}function Ipe(t,e){DL[t]||(e(),DL[t]=!0)}function bpe(t,e){let r=t&&nc[t];if(r)for(let n of r)try{n(e)}catch(s){gpe.DEBUG_BUILD&&ppe.logger.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${hpe.getFunctionName(n)}
Error:`,s)}}sc.addHandler=mpe;sc.maybeInstrument=Ipe;sc.resetInstrumentationHandlers=ype;sc.triggerHandlers=bpe});var c_=h(a_=>{Object.defineProperty(a_,"__esModule",{value:!0});var i_=fn(),Cpe=Dr(),eh=qt(),o_=_s();function Spe(t){let e="console";o_.addHandler(e,t),o_.maybeInstrument(e,vpe)}function vpe(){"console"in eh.GLOBAL_OBJ&&i_.CONSOLE_LEVELS.forEach(function(t){t in eh.GLOBAL_OBJ.console&&Cpe.fill(eh.GLOBAL_OBJ.console,t,function(e){return i_.originalConsoleMethods[t]=e,function(...r){let n={args:r,level:t};o_.triggerHandlers("console",n);let s=i_.originalConsoleMethods[t];s&&s.apply(eh.GLOBAL_OBJ.console,r)}})})}a_.addConsoleInstrumentationHandler=Spe});var Zu=h(Pn=>{Object.defineProperty(Pn,"__esModule",{value:!0});var _pe=Dr(),l_=wu(),Ape=qt();function Rpe(){let t=Ape.GLOBAL_OBJ,e=t.crypto||t.msCrypto,r=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(r=()=>{let n=new Uint8Array(1);return e.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(r()&15)>>n/4).toString(16))}function XL(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Epe(t){let{message:e,event_id:r}=t;if(e)return e;let n=XL(t);return n?n.type&&n.value?`${n.type}: ${n.value}`:n.type||n.value||r||"<unknown>":r||"<unknown>"}function wpe(t,e,r){let n=t.exception=t.exception||{},s=n.values=n.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type=r||"Error")}function Bpe(t,e){let r=XL(t);if(!r)return;let n={type:"generic",handled:!0},s=r.mechanism;if(r.mechanism={...n,...s,...e},e&&"data"in e){let i={...s&&s.data,...e.data};r.mechanism.data=i}}var Tpe=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function Gpe(t){let e=t.match(Tpe)||[],r=parseInt(e[1],10),n=parseInt(e[2],10),s=parseInt(e[3],10);return{buildmetadata:e[5],major:isNaN(r)?void 0:r,minor:isNaN(n)?void 0:n,patch:isNaN(s)?void 0:s,prerelease:e[4]}}function Zpe(t,e,r=5){if(e.lineno===void 0)return;let n=t.length,s=Math.max(Math.min(n-1,e.lineno-1),0);e.pre_context=t.slice(Math.max(0,s-r),s).map(i=>l_.snipLine(i,0)),e.context_line=l_.snipLine(t[Math.min(n-1,s)],e.colno||0),e.post_context=t.slice(Math.min(s+1,n),s+1+r).map(i=>l_.snipLine(i,0))}function Npe(t){if(t&&t.__sentry_captured__)return!0;try{_pe.addNonEnumerableProperty(t,"__sentry_captured__",!0)}catch{}return!1}function Vpe(t){return Array.isArray(t)?t:[t]}Pn.addContextToFrame=Zpe;Pn.addExceptionMechanism=Bpe;Pn.addExceptionTypeValue=wpe;Pn.arrayify=Vpe;Pn.checkOrSetAlreadyCaught=Npe;Pn.getEventDescription=Epe;Pn.parseSemver=Gpe;Pn.uuid4=Rpe});var g_=h(rh=>{Object.defineProperty(rh,"__esModule",{value:!0});var Hpe=Zu(),th=Dr(),Wpe=qt(),u_=_s(),ic=Wpe.GLOBAL_OBJ,Ope=1e3,$L,d_,f_;function Ppe(t){let e="dom";u_.addHandler(e,t),u_.maybeInstrument(e,qL)}function qL(){if(!ic.document)return;let t=u_.triggerHandlers.bind(null,"dom"),e=jL(t,!0);ic.document.addEventListener("click",e,!1),ic.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(r=>{let n=ic[r]&&ic[r].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(th.fill(n,"addEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{let c=this,l=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},u=l[i]=l[i]||{refCount:0};if(!u.handler){let d=jL(t);u.handler=d,s.call(this,i,d,a)}u.refCount++}catch{}return s.call(this,i,o,a)}}),th.fill(n,"removeEventListener",function(s){return function(i,o,a){if(i==="click"||i=="keypress")try{let c=this,l=c.__sentry_instrumentation_handlers__||{},u=l[i];u&&(u.refCount--,u.refCount<=0&&(s.call(this,i,u.handler,a),u.handler=void 0,delete l[i]),Object.keys(l).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return s.call(this,i,o,a)}}))})}function kpe(t){if(t.type!==d_)return!1;try{if(!t.target||t.target._sentryId!==f_)return!1}catch{}return!0}function Fpe(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function jL(t,e=!1){return r=>{if(!r||r._sentryCaptured)return;let n=xpe(r);if(Fpe(r.type,n))return;th.addNonEnumerableProperty(r,"_sentryCaptured",!0),n&&!n._sentryId&&th.addNonEnumerableProperty(n,"_sentryId",Hpe.uuid4());let s=r.type==="keypress"?"input":r.type;kpe(r)||(t({event:r,name:s,global:e}),d_=r.type,f_=n?n._sentryId:void 0),clearTimeout($L),$L=ic.setTimeout(()=>{f_=void 0,d_=void 0},Ope)}}function xpe(t){try{return t.target}catch{return null}}rh.addClickKeypressInstrumentationHandler=Ppe;rh.instrumentDOM=qL});var m_=h(kn=>{Object.defineProperty(kn,"__esModule",{value:!0});var Lpe=On(),Upe=fn(),Ype=qt(),nh=Ype.getGlobalObject();function Dpe(){try{return new ErrorEvent(""),!0}catch{return!1}}function Xpe(){try{return new DOMError(""),!0}catch{return!1}}function $pe(){try{return new DOMException(""),!0}catch{return!1}}function h_(){if(!("fetch"in nh))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function p_(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function jpe(){if(typeof EdgeRuntime=="string")return!0;if(!h_())return!1;if(p_(nh.fetch))return!0;let t=!1,e=nh.document;if(e&&typeof e.createElement=="function")try{let r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(t=p_(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){Lpe.DEBUG_BUILD&&Upe.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function qpe(){return"ReportingObserver"in nh}function Mpe(){if(!h_())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch{return!1}}kn.isNativeFetch=p_;kn.supportsDOMError=Xpe;kn.supportsDOMException=$pe;kn.supportsErrorEvent=Dpe;kn.supportsFetch=h_;kn.supportsNativeFetch=jpe;kn.supportsReferrerPolicy=Mpe;kn.supportsReportingObserver=qpe});var I_=h(sh=>{Object.defineProperty(sh,"__esModule",{value:!0});var Kpe=Dr(),zpe=m_(),ML=qt(),Nu=_s();function Jpe(t){let e="fetch";Nu.addHandler(e,t),Nu.maybeInstrument(e,Qpe)}function Qpe(){zpe.supportsNativeFetch()&&Kpe.fill(ML.GLOBAL_OBJ,"fetch",function(t){return function(...e){let{method:r,url:n}=zL(e),s={args:e,fetchData:{method:r,url:n},startTimestamp:Date.now()};return Nu.triggerHandlers("fetch",{...s}),t.apply(ML.GLOBAL_OBJ,e).then(i=>{let o={...s,endTimestamp:Date.now(),response:i};return Nu.triggerHandlers("fetch",o),i},i=>{let o={...s,endTimestamp:Date.now(),error:i};throw Nu.triggerHandlers("fetch",o),i})}})}function y_(t,e){return!!t&&typeof t=="object"&&!!t[e]}function KL(t){return typeof t=="string"?t:t?y_(t,"url")?t.url:t.toString?t.toString():"":""}function zL(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){let[r,n]=t;return{url:KL(r),method:y_(n,"method")?String(n.method).toUpperCase():"GET"}}let e=t[0];return{url:KL(e),method:y_(e,"method")?String(e.method).toUpperCase():"GET"}}sh.addFetchInstrumentationHandler=Jpe;sh.parseFetchArgs=zL});var v_=h(S_=>{Object.defineProperty(S_,"__esModule",{value:!0});var b_=qt(),C_=_s(),ih=null;function ehe(t){let e="error";C_.addHandler(e,t),C_.maybeInstrument(e,the)}function the(){ih=b_.GLOBAL_OBJ.onerror,b_.GLOBAL_OBJ.onerror=function(t,e,r,n,s){let i={column:n,error:s,line:r,msg:t,url:e};return C_.triggerHandlers("error",i),ih&&!ih.__SENTRY_LOADER__?ih.apply(this,arguments):!1},b_.GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=!0}S_.addGlobalErrorInstrumentationHandler=ehe});var E_=h(R_=>{Object.defineProperty(R_,"__esModule",{value:!0});var __=qt(),A_=_s(),oh=null;function rhe(t){let e="unhandledrejection";A_.addHandler(e,t),A_.maybeInstrument(e,nhe)}function nhe(){oh=__.GLOBAL_OBJ.onunhandledrejection,__.GLOBAL_OBJ.onunhandledrejection=function(t){let e=t;return A_.triggerHandlers("unhandledrejection",e),oh&&!oh.__SENTRY_LOADER__?oh.apply(this,arguments):!0},__.GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}R_.addGlobalUnhandledRejectionInstrumentationHandler=rhe});var B_=h(w_=>{Object.defineProperty(w_,"__esModule",{value:!0});var she=qt(),ah=she.getGlobalObject();function ihe(){let t=ah.chrome,e=t&&t.app&&t.app.runtime,r="history"in ah&&!!ah.history.pushState&&!!ah.history.replaceState;return!e&&r}w_.supportsHistory=ihe});var G_=h(T_=>{Object.defineProperty(T_,"__esModule",{value:!0});var JL=Dr();On();fn();var ohe=qt(),ahe=B_(),lh=_s(),Vu=ohe.GLOBAL_OBJ,ch;function che(t){let e="history";lh.addHandler(e,t),lh.maybeInstrument(e,lhe)}function lhe(){if(!ahe.supportsHistory())return;let t=Vu.onpopstate;Vu.onpopstate=function(...r){let n=Vu.location.href,s=ch;ch=n;let i={from:s,to:n};if(lh.triggerHandlers("history",i),t)try{return t.apply(this,r)}catch{}};function e(r){return function(...n){let s=n.length>2?n[2]:void 0;if(s){let i=ch,o=String(s);ch=o;let a={from:i,to:o};lh.triggerHandlers("history",a)}return r.apply(this,n)}}JL.fill(Vu.history,"pushState",e),JL.fill(Vu.history,"replaceState",e)}T_.addHistoryInstrumentationHandler=che});var Z_=h(Wu=>{Object.defineProperty(Wu,"__esModule",{value:!0});var dh=Yr(),uh=Dr(),uhe=qt(),fh=_s(),dhe=uhe.GLOBAL_OBJ,Hu="__sentry_xhr_v3__";function fhe(t){let e="xhr";fh.addHandler(e,t),fh.maybeInstrument(e,QL)}function QL(){if(!dhe.XMLHttpRequest)return;let t=XMLHttpRequest.prototype;uh.fill(t,"open",function(e){return function(...r){let n=Date.now(),s=dh.isString(r[0])?r[0].toUpperCase():void 0,i=ghe(r[1]);if(!s||!i)return e.apply(this,r);this[Hu]={method:s,url:i,request_headers:{}},s==="POST"&&i.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let o=()=>{let a=this[Hu];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}let c={args:[s,i],endTimestamp:Date.now(),startTimestamp:n,xhr:this};fh.triggerHandlers("xhr",c)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?uh.fill(this,"onreadystatechange",function(a){return function(...c){return o(),a.apply(this,c)}}):this.addEventListener("readystatechange",o),uh.fill(this,"setRequestHeader",function(a){return function(...c){let[l,u]=c,d=this[Hu];return d&&dh.isString(l)&&dh.isString(u)&&(d.request_headers[l.toLowerCase()]=u),a.apply(this,c)}}),e.apply(this,r)}}),uh.fill(t,"send",function(e){return function(...r){let n=this[Hu];if(!n)return e.apply(this,r);r[0]!==void 0&&(n.body=r[0]);let s={args:[n.method,n.url],startTimestamp:Date.now(),xhr:this};return fh.triggerHandlers("xhr",s),e.apply(this,r)}})}function ghe(t){if(dh.isString(t))return t;try{return t.toString()}catch{}}Wu.SENTRY_XHR_DATA_KEY=Hu;Wu.addXhrInstrumentationHandler=fhe;Wu.instrumentXHR=QL});var oU=h(pn=>{Object.defineProperty(pn,"__esModule",{value:!0});var phe=On(),hhe=fn(),eU=c_(),tU=g_(),rU=I_(),nU=v_(),sU=E_(),iU=G_(),N_=Z_();function mhe(t,e){switch(t){case"console":return eU.addConsoleInstrumentationHandler(e);case"dom":return tU.addClickKeypressInstrumentationHandler(e);case"xhr":return N_.addXhrInstrumentationHandler(e);case"fetch":return rU.addFetchInstrumentationHandler(e);case"history":return iU.addHistoryInstrumentationHandler(e);case"error":return nU.addGlobalErrorInstrumentationHandler(e);case"unhandledrejection":return sU.addGlobalUnhandledRejectionInstrumentationHandler(e);default:phe.DEBUG_BUILD&&hhe.logger.warn("unknown instrumentation type:",t)}}pn.addConsoleInstrumentationHandler=eU.addConsoleInstrumentationHandler;pn.addClickKeypressInstrumentationHandler=tU.addClickKeypressInstrumentationHandler;pn.addFetchInstrumentationHandler=rU.addFetchInstrumentationHandler;pn.addGlobalErrorInstrumentationHandler=nU.addGlobalErrorInstrumentationHandler;pn.addGlobalUnhandledRejectionInstrumentationHandler=sU.addGlobalUnhandledRejectionInstrumentationHandler;pn.addHistoryInstrumentationHandler=iU.addHistoryInstrumentationHandler;pn.SENTRY_XHR_DATA_KEY=N_.SENTRY_XHR_DATA_KEY;pn.addXhrInstrumentationHandler=N_.addXhrInstrumentationHandler;pn.addInstrumentationHandler=mhe});var V_=h(gh=>{Object.defineProperty(gh,"__esModule",{value:!0});function yhe(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function Ihe(){return"npm"}gh.getSDKSource=Ihe;gh.isBrowserBundle=yhe});var H_=h((Ou,hh)=>{Object.defineProperty(Ou,"__esModule",{value:!0});var bhe=V_();function Che(){return!bhe.isBrowserBundle()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function ph(t,e){return t.require(e)}function She(t){let e;try{e=ph(hh,t)}catch{}try{let{cwd:r}=ph(hh,"process");e=ph(hh,`${r()}/node_modules/${t}`)}catch{}return e}Ou.dynamicRequire=ph;Ou.isNodeEnv=Che;Ou.loadModule=She});var cU=h(W_=>{Object.defineProperty(W_,"__esModule",{value:!0});var vhe=H_(),aU=qt();function _he(){return typeof window<"u"&&(!vhe.isNodeEnv()||Ahe())}function Ahe(){return aU.GLOBAL_OBJ.process!==void 0&&aU.GLOBAL_OBJ.process.type==="renderer"}W_.isBrowser=_he});var P_=h(O_=>{Object.defineProperty(O_,"__esModule",{value:!0});function Rhe(){let t=typeof WeakSet=="function",e=t?new WeakSet:[];function r(s){if(t)return e.has(s)?!0:(e.add(s),!1);for(let i=0;i<e.length;i++)if(e[i]===s)return!0;return e.push(s),!1}function n(s){if(t)e.delete(s);else for(let i=0;i<e.length;i++)if(e[i]===s){e.splice(i,1);break}}return[r,n]}O_.memoBuilder=Rhe});var Pu=h(oc=>{Object.defineProperty(oc,"__esModule",{value:!0});var k_=Yr(),Ehe=P_(),whe=Dr(),Bhe=Qp();function lU(t,e=100,r=1/0){try{return mh("",t,e,r)}catch(n){return{ERROR:`**non-serializable** (${n})`}}}function uU(t,e=3,r=100*1024){let n=lU(t,e);return Nhe(n)>r?uU(t,e-1,r):n}function mh(t,e,r=1/0,n=1/0,s=Ehe.memoBuilder()){let[i,o]=s;if(e==null||["number","boolean","string"].includes(typeof e)&&!k_.isNaN(e))return e;let a=The(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;let c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:r;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";let l=e;if(l&&typeof l.toJSON=="function")try{let g=l.toJSON();return mh("",g,c-1,n,s)}catch{}let u=Array.isArray(e)?[]:{},d=0,f=whe.convertToPlainObject(e);for(let g in f){if(!Object.prototype.hasOwnProperty.call(f,g))continue;if(d>=n){u[g]="[MaxProperties ~]";break}let p=f[g];u[g]=mh(g,p,c-1,n,s),d++}return o(e),u}function The(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(k_.isVueViewModel(e))return"[VueViewModel]";if(k_.isSyntheticEvent(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${Bhe.getFunctionName(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;let r=Ghe(e);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(r){return`**non-serializable** (${r})`}}function Ghe(t){let e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function Zhe(t){return~-encodeURI(t).split(/%..|./).length}function Nhe(t){return Zhe(JSON.stringify(t))}function Vhe(t,e){let r=e.replace(/\\/g,"/").replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),n=t;try{n=decodeURI(t)}catch{}return n.replace(/\\/g,"/").replace(/webpack:\/?/g,"").replace(new RegExp(`(file://)?/*${r}/*`,"ig"),"app:///")}oc.normalize=lU;oc.normalizeToSize=uU;oc.normalizeUrlToBase=Vhe;oc.walk=mh});var mU=h(As=>{Object.defineProperty(As,"__esModule",{value:!0});function fU(t,e){let r=0;for(let n=t.length-1;n>=0;n--){let s=t[n];s==="."?t.splice(n,1):s===".."?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}var Hhe=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function gU(t){let e=t.length>1024?`<truncated>${t.slice(-1024)}`:t,r=Hhe.exec(e);return r?r.slice(1):[]}function F_(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let s=n>=0?t[n]:"/";s&&(e=`${s}/${e}`,r=s.charAt(0)==="/")}return e=fU(e.split("/").filter(n=>!!n),!r).join("/"),(r?"/":"")+e||"."}function dU(t){let e=0;for(;e<t.length&&t[e]==="";e++);let r=t.length-1;for(;r>=0&&t[r]==="";r--);return e>r?[]:t.slice(e,r-e+1)}function Whe(t,e){t=F_(t).slice(1),e=F_(e).slice(1);let r=dU(t.split("/")),n=dU(e.split("/")),s=Math.min(r.length,n.length),i=s;for(let a=0;a<s;a++)if(r[a]!==n[a]){i=a;break}let o=[];for(let a=i;a<r.length;a++)o.push("..");return o=o.concat(n.slice(i)),o.join("/")}function pU(t){let e=hU(t),r=t.slice(-1)==="/",n=fU(t.split("/").filter(s=>!!s),!e).join("/");return!n&&!e&&(n="."),n&&r&&(n+="/"),(e?"/":"")+n}function hU(t){return t.charAt(0)==="/"}function Ohe(...t){return pU(t.join("/"))}function Phe(t){let e=gU(t),r=e[0],n=e[1];return!r&&!n?".":(n&&(n=n.slice(0,n.length-1)),r+n)}function khe(t,e){let r=gU(t)[2];return e&&r.slice(e.length*-1)===e&&(r=r.slice(0,r.length-e.length)),r}As.basename=khe;As.dirname=Phe;As.isAbsolute=hU;As.join=Ohe;As.normalizePath=pU;As.relative=Whe;As.resolve=F_});var x_=h(Fu=>{Object.defineProperty(Fu,"__esModule",{value:!0});var Fhe=Yr(),Rs;(function(t){t[t.PENDING=0]="PENDING";let r=1;t[t.RESOLVED=r]="RESOLVED";let n=2;t[t.REJECTED=n]="REJECTED"})(Rs||(Rs={}));function xhe(t){return new ku(e=>{e(t)})}function Lhe(t){return new ku((e,r)=>{r(t)})}var ku=class t{constructor(e){t.prototype.__init.call(this),t.prototype.__init2.call(this),t.prototype.__init3.call(this),t.prototype.__init4.call(this),this._state=Rs.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(r){this._reject(r)}}then(e,r){return new t((n,s)=>{this._handlers.push([!1,i=>{if(!e)n(i);else try{n(e(i))}catch(o){s(o)}},i=>{if(!r)s(i);else try{n(r(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(r=>r,e)}finally(e){return new t((r,n)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){n(s);return}r(s)})})}__init(){this._resolve=e=>{this._setResult(Rs.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Rs.REJECTED,e)}}__init3(){this._setResult=(e,r)=>{if(this._state===Rs.PENDING){if(Fhe.isThenable(r)){r.then(this._resolve,this._reject);return}this._state=e,this._value=r,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Rs.PENDING)return;let e=this._handlers.slice();this._handlers=[],e.forEach(r=>{r[0]||(this._state===Rs.RESOLVED&&r[1](this._value),this._state===Rs.REJECTED&&r[2](this._value),r[0]=!0)})}}};Fu.SyncPromise=ku;Fu.rejectedSyncPromise=Lhe;Fu.resolvedSyncPromise=xhe});var yU=h(U_=>{Object.defineProperty(U_,"__esModule",{value:!0});var Uhe=r_(),L_=x_();function Yhe(t){let e=[];function r(){return t===void 0||e.length<t}function n(o){return e.splice(e.indexOf(o),1)[0]}function s(o){if(!r())return L_.rejectedSyncPromise(new Uhe.SentryError("Not adding Promise because buffer limit was reached."));let a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>n(a)).then(null,()=>n(a).then(null,()=>{})),a}function i(o){return new L_.SyncPromise((a,c)=>{let l=e.length;if(!l)return a(!0);let u=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{L_.resolvedSyncPromise(d).then(()=>{--l||(clearTimeout(u),a(!0))},c)})})}return{$:e,add:s,drain:i}}U_.makePromiseBuffer=Yhe});var IU=h(Y_=>{Object.defineProperty(Y_,"__esModule",{value:!0});function Dhe(t){let e={},r=0;for(;r<t.length;){let n=t.indexOf("=",r);if(n===-1)break;let s=t.indexOf(";",r);if(s===-1)s=t.length;else if(s<n){r=t.lastIndexOf(";",n-1)+1;continue}let i=t.slice(r,n).trim();if(e[i]===void 0){let o=t.slice(n+1,s).trim();o.charCodeAt(0)===34&&(o=o.slice(1,-1));try{e[i]=o.indexOf("%")!==-1?decodeURIComponent(o):o}catch{e[i]=o}}r=s+1}return e}Y_.parseCookie=Dhe});var D_=h(ac=>{Object.defineProperty(ac,"__esModule",{value:!0});function Xhe(t){if(!t)return{};let e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};let r=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:r,hash:n,relative:e[5]+r+n}}function $he(t){return t.split(/[\?#]/,1)[0]}function jhe(t){return t.split(/\\?\//).filter(e=>e.length>0&&e!==",").length}function qhe(t){let{protocol:e,host:r,path:n}=t,s=r&&r.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||"";return`${e?`${e}://`:""}${s}${n}`}ac.getNumberOfUrlSegments=jhe;ac.getSanitizedUrlString=qhe;ac.parseUrl=Xhe;ac.stripUrlQueryAndFragment=$he});var _U=h(Es=>{Object.defineProperty(Es,"__esModule",{value:!0});var Mhe=IU(),Khe=On(),bU=Yr(),zhe=fn(),Jhe=Pu(),Qhe=D_(),eme={ip:!1,request:!0,transaction:!0,user:!0},tme=["cookies","data","headers","method","query_string","url"],CU=["id","username","email"];function rme(t,e,r){if(t){if(!t.metadata.source||t.metadata.source==="url"){let[n,s]=yh(e,{path:!0,method:!0});t.updateName(n),t.setMetadata({source:s})}t.setAttribute("url",e.originalUrl||e.url),e.baseUrl&&t.setAttribute("baseUrl",e.baseUrl),t.setData("query",SU(e,r))}}function yh(t,e={}){let r=t.method&&t.method.toUpperCase(),n="",s="url";e.customRoute||t.route?(n=e.customRoute||`${t.baseUrl||""}${t.route&&t.route.path}`,s="route"):(t.originalUrl||t.url)&&(n=Qhe.stripUrlQueryAndFragment(t.originalUrl||t.url||""));let i="";return e.method&&r&&(i+=r),e.method&&e.path&&(i+=" "),e.path&&n&&(i+=n),[i,s]}function nme(t,e){switch(e){case"path":return yh(t,{path:!0})[0];case"handler":return t.route&&t.route.stack&&t.route.stack[0]&&t.route.stack[0].name||"<anonymous>";case"methodPath":default:{let r=t._reconstructedRoute?t._reconstructedRoute:void 0;return yh(t,{path:!0,method:!0,customRoute:r})[0]}}}function sme(t,e){let r={};return(Array.isArray(e)?e:CU).forEach(s=>{t&&s in t&&(r[s]=t[s])}),r}function X_(t,e){let{include:r=tme,deps:n}=e||{},s={},i=t.headers||{},o=t.method,a=i.host||t.hostname||t.host||"<no host>",c=t.protocol==="https"||t.socket&&t.socket.encrypted?"https":"http",l=t.originalUrl||t.url||"",u=l.startsWith(c)?l:`${c}://${a}${l}`;return r.forEach(d=>{switch(d){case"headers":{s.headers=i,r.includes("cookies")||delete s.headers.cookie;break}case"method":{s.method=o;break}case"url":{s.url=u;break}case"cookies":{s.cookies=t.cookies||i.cookie&&Mhe.parseCookie(i.cookie)||{};break}case"query_string":{s.query_string=SU(t,n);break}case"data":{if(o==="GET"||o==="HEAD")break;t.body!==void 0&&(s.data=bU.isString(t.body)?t.body:JSON.stringify(Jhe.normalize(t.body)));break}default:({}).hasOwnProperty.call(t,d)&&(s[d]=t[d])}}),s}function ime(t,e,r){let n={...eme,...r&&r.include};if(n.request){let s=Array.isArray(n.request)?X_(e,{include:n.request,deps:r&&r.deps}):X_(e,{deps:r&&r.deps});t.request={...t.request,...s}}if(n.user){let s=e.user&&bU.isPlainObject(e.user)?sme(e.user,n.user):{};Object.keys(s).length&&(t.user={...t.user,...s})}if(n.ip){let s=e.ip||e.socket&&e.socket.remoteAddress;s&&(t.user={...t.user,ip_address:s})}return n.transaction&&!t.transaction&&(t.transaction=nme(e,n.transaction)),t}function SU(t,e){let r=t.originalUrl||t.url||"";if(r){r.startsWith("/")&&(r=`http://dogs.are.great${r}`);try{return t.query||typeof URL<"u"&&new URL(r).search.slice(1)||e&&e.url&&e.url.parse(r).query||void 0}catch{return}}}function vU(t){let e={};try{t.forEach((r,n)=>{typeof r=="string"&&(e[n]=r)})}catch{Khe.DEBUG_BUILD&&zhe.logger.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return e}function ome(t){let e=vU(t.headers);return{method:t.method,url:t.url,headers:e}}Es.DEFAULT_USER_INCLUDES=CU;Es.addRequestDataToEvent=ime;Es.addRequestDataToTransaction=rme;Es.extractPathForTransaction=yh;Es.extractRequestData=X_;Es.winterCGHeadersToDict=vU;Es.winterCGRequestToRequestData=ome});var EU=h(xu=>{Object.defineProperty(xu,"__esModule",{value:!0});var AU=["fatal","error","warning","log","info","debug"];function ame(t){return RU(t)}function RU(t){return t==="warn"?"warning":AU.includes(t)?t:"log"}xu.severityFromString=ame;xu.severityLevelFromString=RU;xu.validSeverityLevels=AU});var $_=h(hn=>{Object.defineProperty(hn,"__esModule",{value:!0});var wU=qt(),BU=1e3;function TU(){return Date.now()/BU}function cme(){let{performance:t}=wU.GLOBAL_OBJ;if(!t||!t.now)return TU;let e=Date.now()-t.now(),r=t.timeOrigin==null?e:t.timeOrigin;return()=>(r+t.now())/BU}var GU=cme(),lme=GU;hn._browserPerformanceTimeOriginMode=void 0;var ume=(()=>{let{performance:t}=wU.GLOBAL_OBJ;if(!t||!t.now){hn._browserPerformanceTimeOriginMode="none";return}let e=3600*1e3,r=t.now(),n=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+r-n):e,i=s<e,o=t.timing&&t.timing.navigationStart,c=typeof o=="number"?Math.abs(o+r-n):e,l=c<e;return i||l?s<=c?(hn._browserPerformanceTimeOriginMode="timeOrigin",t.timeOrigin):(hn._browserPerformanceTimeOriginMode="navigationStart",o):(hn._browserPerformanceTimeOriginMode="dateNow",n)})();hn.browserPerformanceTimeOrigin=ume;hn.dateTimestampInSeconds=TU;hn.timestampInSeconds=GU;hn.timestampWithMs=lme});var q_=h(Ri=>{Object.defineProperty(Ri,"__esModule",{value:!0});var dme=On(),fme=Yr(),gme=fn(),pme="baggage",j_="sentry-",NU=/^sentry-/,VU=8192;function hme(t){if(!fme.isString(t)&&!Array.isArray(t))return;let e={};if(Array.isArray(t))e=t.reduce((n,s)=>{let i=ZU(s);for(let o of Object.keys(i))n[o]=i[o];return n},{});else{if(!t)return;e=ZU(t)}let r=Object.entries(e).reduce((n,[s,i])=>{if(s.match(NU)){let o=s.slice(j_.length);n[o]=i}return n},{});if(Object.keys(r).length>0)return r}function mme(t){if(!t)return;let e=Object.entries(t).reduce((r,[n,s])=>(s&&(r[`${j_}${n}`]=s),r),{});return yme(e)}function ZU(t){return t.split(",").map(e=>e.split("=").map(r=>decodeURIComponent(r.trim()))).reduce((e,[r,n])=>(e[r]=n,e),{})}function yme(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[r,n],s)=>{let i=`${encodeURIComponent(r)}=${encodeURIComponent(n)}`,o=s===0?i:`${e},${i}`;return o.length>VU?(dme.DEBUG_BUILD&&gme.logger.warn(`Not adding key: ${r} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):o},"")}Ri.BAGGAGE_HEADER_NAME=pme;Ri.MAX_BAGGAGE_STRING_LENGTH=VU;Ri.SENTRY_BAGGAGE_KEY_PREFIX=j_;Ri.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=NU;Ri.baggageHeaderToDynamicSamplingContext=hme;Ri.dynamicSamplingContextToSentryBaggageHeader=mme});var OU=h(cc=>{Object.defineProperty(cc,"__esModule",{value:!0});var Ime=q_(),Ih=Zu(),HU=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function WU(t){if(!t)return;let e=t.match(HU);if(!e)return;let r;return e[3]==="1"?r=!0:e[3]==="0"&&(r=!1),{traceId:e[1],parentSampled:r,parentSpanId:e[2]}}function bme(t,e){let r=WU(t),n=Ime.baggageHeaderToDynamicSamplingContext(e),{traceId:s,parentSpanId:i,parentSampled:o}=r||{},a={traceId:s||Ih.uuid4(),spanId:Ih.uuid4().substring(16),sampled:o};return i&&(a.parentSpanId=i),n&&(a.dsc=n),{traceparentData:r,dynamicSamplingContext:n,propagationContext:a}}function Cme(t=Ih.uuid4(),e=Ih.uuid4().substring(16),r){let n="";return r!==void 0&&(n=r?"-1":"-0"),`${t}-${e}${n}`}cc.TRACEPARENT_REGEXP=HU;cc.extractTraceparentData=WU;cc.generateSentryTraceHeader=Cme;cc.tracingContextFromHeaders=bme});var K_=h(Xr=>{Object.defineProperty(Xr,"__esModule",{value:!0});var Sme=Qv(),vme=Pu(),PU=Dr();function _me(t,e=[]){return[t,e]}function Ame(t,e){let[r,n]=t;return[r,[...n,e]]}function kU(t,e){let r=t[1];for(let n of r){let s=n[0].type;if(e(n,s))return!0}return!1}function Rme(t,e){return kU(t,(r,n)=>e.includes(n))}function M_(t,e){return(e||new TextEncoder).encode(t)}function Eme(t,e){let[r,n]=t,s=JSON.stringify(r);function i(o){typeof s=="string"?s=typeof o=="string"?s+o:[M_(s,e),o]:s.push(typeof o=="string"?M_(o,e):o)}for(let o of n){let[a,c]=o;if(i(`
${JSON.stringify(a)}
`),typeof c=="string"||c instanceof Uint8Array)i(c);else{let l;try{l=JSON.stringify(c)}catch{l=JSON.stringify(vme.normalize(c))}i(l)}}return typeof s=="string"?s:wme(s)}function wme(t){let e=t.reduce((s,i)=>s+i.length,0),r=new Uint8Array(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return r}function Bme(t,e,r){let n=typeof t=="string"?e.encode(t):t;function s(c){let l=n.subarray(0,c);return n=n.subarray(c+1),l}function i(){let c=n.indexOf(10);return c<0&&(c=n.length),JSON.parse(r.decode(s(c)))}let o=i(),a=[];for(;n.length;){let c=i(),l=typeof c.length=="number"?c.length:void 0;a.push([c,l?s(l):i()])}return[o,a]}function Tme(t,e){let r=typeof t.data=="string"?M_(t.data,e):t.data;return[PU.dropUndefinedKeys({type:"attachment",length:r.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),r]}var Gme={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function Zme(t){return Gme[t]}function Nme(t){if(!t||!t.sdk)return;let{name:e,version:r}=t.sdk;return{name:e,version:r}}function Vme(t,e,r,n){let s=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!r&&n&&{dsn:Sme.dsnToString(n)},...s&&{trace:PU.dropUndefinedKeys({...s})}}}Xr.addItemToEnvelope=Ame;Xr.createAttachmentEnvelopeItem=Tme;Xr.createEnvelope=_me;Xr.createEventEnvelopeHeaders=Vme;Xr.envelopeContainsItemType=Rme;Xr.envelopeItemTypeToDataCategory=Zme;Xr.forEachEnvelopeItem=kU;Xr.getSdkMetadataForEnvelopeHeader=Nme;Xr.parseEnvelope=Bme;Xr.serializeEnvelope=Eme});var FU=h(z_=>{Object.defineProperty(z_,"__esModule",{value:!0});var Hme=K_(),Wme=$_();function Ome(t,e,r){let n=[{type:"client_report"},{timestamp:r||Wme.dateTimestampInSeconds(),discarded_events:t}];return Hme.createEnvelope(e?{dsn:e}:{},[n])}z_.createClientReportEnvelope=Ome});var YU=h(vo=>{Object.defineProperty(vo,"__esModule",{value:!0});var xU=60*1e3;function LU(t,e=Date.now()){let r=parseInt(`${t}`,10);if(!isNaN(r))return r*1e3;let n=Date.parse(`${t}`);return isNaN(n)?xU:n-e}function UU(t,e){return t[e]||t.all||0}function Pme(t,e,r=Date.now()){return UU(t,e)>r}function kme(t,{statusCode:e,headers:r},n=Date.now()){let s={...t},i=r&&r["x-sentry-rate-limits"],o=r&&r["retry-after"];if(i)for(let a of i.trim().split(",")){let[c,l]=a.split(":",2),u=parseInt(c,10),d=(isNaN(u)?60:u)*1e3;if(!l)s.all=n+d;else for(let f of l.split(";"))s[f]=n+d}else o?s.all=n+LU(o,n):e===429&&(s.all=n+60*1e3);return s}vo.DEFAULT_RETRY_AFTER=xU;vo.disabledUntil=UU;vo.isRateLimited=Pme;vo.parseRetryAfterHeader=LU;vo.updateRateLimits=kme});var $U=h(J_=>{Object.defineProperty(J_,"__esModule",{value:!0});function DU(t,e,r){let n=e.match(/([a-z_]+)\.(.*)/i);if(n===null)t[e]=r;else{let s=t[n[1]];DU(s,n[2],r)}}function Fme(t,e,r={}){return Array.isArray(e)?XU(t,e,r):xme(t,e,r)}function XU(t,e,r){let n=e.find(s=>s.name===t.name);if(n){for(let[s,i]of Object.entries(r))DU(n,s,i);return e}return[...e,t]}function xme(t,e,r){return s=>{let i=e(s);return t.allowExclusionByUser&&!i.find(a=>a.name===t.name)?i:XU(t,i,r)}}J_.addOrUpdateIntegration=Fme});var jU=h(Q_=>{Object.defineProperty(Q_,"__esModule",{value:!0});function Lme(t){let e=[],r={};return{add(n,s){for(;e.length>=t;){let i=e.shift();i!==void 0&&delete r[i]}r[n]&&this.delete(n),e.push(n),r[n]=s},clear(){r={},e=[]},get(n){return r[n]},size(){return e.length},delete(n){if(!r[n])return!1;delete r[n];for(let s=0;s<e.length;s++)if(e[s]===n){e.splice(s,1);break}return!0}}}Q_.makeFifoCache=Lme});var KU=h(lc=>{Object.defineProperty(lc,"__esModule",{value:!0});var eA=Yr(),qU=Zu(),Ume=Pu(),Yme=Dr();function tA(t,e){return t(e.stack||"",1)}function MU(t,e){let r={type:e.name||e.constructor.name,value:e.message},n=tA(t,e);return n.length&&(r.stacktrace={frames:n}),r}function Dme(t){if("name"in t&&typeof t.name=="string"){let e=`'${t.name}' captured as exception`;return"message"in t&&typeof t.message=="string"&&(e+=` with message '${t.message}'`),e}else return"message"in t&&typeof t.message=="string"?t.message:`Object captured as exception with keys: ${Yme.extractExceptionKeysForMessage(t)}`}function Xme(t,e,r,n){let s=typeof t=="function"?t().getClient():t,i=r,a=n&&n.data&&n.data.mechanism||{handled:!0,type:"generic"},c;if(!eA.isError(r)){if(eA.isPlainObject(r)){let u=s&&s.getOptions().normalizeDepth;c={__serialized__:Ume.normalizeToSize(r,u)};let d=Dme(r);i=n&&n.syntheticException||new Error(d),i.message=d}else i=n&&n.syntheticException||new Error(r),i.message=r;a.synthetic=!0}let l={exception:{values:[MU(e,i)]}};return c&&(l.extra=c),qU.addExceptionTypeValue(l,void 0,void 0),qU.addExceptionMechanism(l,a),{...l,event_id:n&&n.event_id}}function $me(t,e,r="info",n,s){let i={event_id:n&&n.event_id,level:r};if(s&&n&&n.syntheticException){let o=tA(t,n.syntheticException);o.length&&(i.exception={values:[{value:e,stacktrace:{frames:o}}]})}if(eA.isParameterizedString(e)){let{__sentry_template_string__:o,__sentry_template_values__:a}=e;return i.logentry={message:o,params:a},i}return i.message=e,i}lc.eventFromMessage=$me;lc.eventFromUnknownInput=Xme;lc.exceptionFromError=MU;lc.parseStackFrames=tA});var zU=h(rA=>{Object.defineProperty(rA,"__esModule",{value:!0});function jme(t,...e){let r=new String(String.raw(t,...e));return r.__sentry_template_string__=t.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),r.__sentry_template_values__=e,r}rA.parameterize=jme});var JU=h(bh=>{Object.defineProperty(bh,"__esModule",{value:!0});var qme=Dr(),Mme=Jp();function Kme(t,e,r,n){let s=t(),i=!1,o=!0;return setInterval(()=>{let a=s.getTimeMs();i===!1&&a>e+r&&(i=!0,o&&n()),a<e+r&&(i=!1)},20),{poll:()=>{s.reset()},enabled:a=>{o=a}}}function zme(t,e,r){let n=e?e.replace(/^file:\/\//,""):void 0,s=t.location.columnNumber?t.location.columnNumber+1:void 0,i=t.location.lineNumber?t.location.lineNumber+1:void 0;return qme.dropUndefinedKeys({filename:n,module:r(n),function:t.functionName||"?",colno:s,lineno:i,in_app:n?Mme.filenameIsInApp(n):void 0})}bh.callFrameToStackFrame=zme;bh.watchdogTimer=Kme});var QU=h(sA=>{Object.defineProperty(sA,"__esModule",{value:!0});var nA=class{constructor(e){this._maxSize=e,this._cache=new Map}get size(){return this._cache.size}get(e){let r=this._cache.get(e);if(r!==void 0)return this._cache.delete(e),this._cache.set(e,r),r}set(e,r){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(e,r)}remove(e){let r=this._cache.get(e);return r&&this._cache.delete(e),r}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){let e=[];return this._cache.forEach(r=>e.push(r)),e}};sA.LRUMap=nA});var oA=h(iA=>{Object.defineProperty(iA,"__esModule",{value:!0});function Jme(t,e){return t??e()}iA._nullishCoalesce=Jme});var eY=h(aA=>{Object.defineProperty(aA,"__esModule",{value:!0});var Qme=oA();async function eye(t,e){return Qme._nullishCoalesce(t,e)}aA._asyncNullishCoalesce=eye});var lA=h(cA=>{Object.defineProperty(cA,"__esModule",{value:!0});async function tye(t){let e,r=t[0],n=1;for(;n<t.length;){let s=t[n],i=t[n+1];if(n+=2,(s==="optionalAccess"||s==="optionalCall")&&r==null)return;s==="access"||s==="optionalAccess"?(e=r,r=await i(r)):(s==="call"||s==="optionalCall")&&(r=await i((...o)=>r.call(e,...o)),e=void 0)}return r}cA._asyncOptionalChain=tye});var tY=h(uA=>{Object.defineProperty(uA,"__esModule",{value:!0});var rye=lA();async function nye(t){let e=await rye._asyncOptionalChain(t);return e??!0}uA._asyncOptionalChainDelete=nye});var fA=h(dA=>{Object.defineProperty(dA,"__esModule",{value:!0});function sye(t){let e,r=t[0],n=1;for(;n<t.length;){let s=t[n],i=t[n+1];if(n+=2,(s==="optionalAccess"||s==="optionalCall")&&r==null)return;s==="access"||s==="optionalAccess"?(e=r,r=i(r)):(s==="call"||s==="optionalCall")&&(r=i((...o)=>r.call(e,...o)),e=void 0)}return r}dA._optionalChain=sye});var rY=h(gA=>{Object.defineProperty(gA,"__esModule",{value:!0});var iye=fA();function oye(t){let e=iye._optionalChain(t);return e??!0}gA._optionalChainDelete=oye});var nY=h(pA=>{Object.defineProperty(pA,"__esModule",{value:!0});function aye(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}pA.escapeStringForRegex=aye});var O=h(G=>{Object.defineProperty(G,"__esModule",{value:!0});var cye=wL(),Ch=qv(),hA=Qv(),lye=r_(),mA=qt(),uye=oU(),Mt=Yr(),dye=cU(),Sh=fn(),fye=P_(),Ei=Zu(),yA=H_(),vh=Pu(),ws=Dr(),_o=mU(),gye=yU(),Ao=_U(),IA=EU(),Lu=Qp(),Uu=wu(),wi=m_(),bA=x_(),Yu=$_(),_h=OU(),sY=V_(),Fn=K_(),pye=FU(),Du=YU(),uc=q_(),Ah=D_(),hye=$U(),mye=jU(),Rh=KU(),yye=zU(),iY=JU(),Iye=QU(),bye=eY(),Cye=lA(),Sye=tY(),vye=oA(),_ye=fA(),Aye=rY(),Rye=c_(),Eye=g_(),oY=Z_(),wye=I_(),Bye=G_(),Tye=v_(),Gye=E_(),Zye=_s(),Nye=Jp(),Vye=nY(),Hye=B_();G.applyAggregateErrorsToEvent=cye.applyAggregateErrorsToEvent;G.getComponentName=Ch.getComponentName;G.getDomElement=Ch.getDomElement;G.getLocationHref=Ch.getLocationHref;G.htmlTreeAsString=Ch.htmlTreeAsString;G.dsnFromString=hA.dsnFromString;G.dsnToString=hA.dsnToString;G.makeDsn=hA.makeDsn;G.SentryError=lye.SentryError;G.GLOBAL_OBJ=mA.GLOBAL_OBJ;G.getGlobalObject=mA.getGlobalObject;G.getGlobalSingleton=mA.getGlobalSingleton;G.addInstrumentationHandler=uye.addInstrumentationHandler;G.isDOMError=Mt.isDOMError;G.isDOMException=Mt.isDOMException;G.isElement=Mt.isElement;G.isError=Mt.isError;G.isErrorEvent=Mt.isErrorEvent;G.isEvent=Mt.isEvent;G.isInstanceOf=Mt.isInstanceOf;G.isNaN=Mt.isNaN;G.isParameterizedString=Mt.isParameterizedString;G.isPlainObject=Mt.isPlainObject;G.isPrimitive=Mt.isPrimitive;G.isRegExp=Mt.isRegExp;G.isString=Mt.isString;G.isSyntheticEvent=Mt.isSyntheticEvent;G.isThenable=Mt.isThenable;G.isVueViewModel=Mt.isVueViewModel;G.isBrowser=dye.isBrowser;G.CONSOLE_LEVELS=Sh.CONSOLE_LEVELS;G.consoleSandbox=Sh.consoleSandbox;G.logger=Sh.logger;G.originalConsoleMethods=Sh.originalConsoleMethods;G.memoBuilder=fye.memoBuilder;G.addContextToFrame=Ei.addContextToFrame;G.addExceptionMechanism=Ei.addExceptionMechanism;G.addExceptionTypeValue=Ei.addExceptionTypeValue;G.arrayify=Ei.arrayify;G.checkOrSetAlreadyCaught=Ei.checkOrSetAlreadyCaught;G.getEventDescription=Ei.getEventDescription;G.parseSemver=Ei.parseSemver;G.uuid4=Ei.uuid4;G.dynamicRequire=yA.dynamicRequire;G.isNodeEnv=yA.isNodeEnv;G.loadModule=yA.loadModule;G.normalize=vh.normalize;G.normalizeToSize=vh.normalizeToSize;G.normalizeUrlToBase=vh.normalizeUrlToBase;G.walk=vh.walk;G.addNonEnumerableProperty=ws.addNonEnumerableProperty;G.convertToPlainObject=ws.convertToPlainObject;G.dropUndefinedKeys=ws.dropUndefinedKeys;G.extractExceptionKeysForMessage=ws.extractExceptionKeysForMessage;G.fill=ws.fill;G.getOriginalFunction=ws.getOriginalFunction;G.markFunctionWrapped=ws.markFunctionWrapped;G.objectify=ws.objectify;G.urlEncode=ws.urlEncode;G.basename=_o.basename;G.dirname=_o.dirname;G.isAbsolute=_o.isAbsolute;G.join=_o.join;G.normalizePath=_o.normalizePath;G.relative=_o.relative;G.resolve=_o.resolve;G.makePromiseBuffer=gye.makePromiseBuffer;G.DEFAULT_USER_INCLUDES=Ao.DEFAULT_USER_INCLUDES;G.addRequestDataToEvent=Ao.addRequestDataToEvent;G.addRequestDataToTransaction=Ao.addRequestDataToTransaction;G.extractPathForTransaction=Ao.extractPathForTransaction;G.extractRequestData=Ao.extractRequestData;G.winterCGHeadersToDict=Ao.winterCGHeadersToDict;G.winterCGRequestToRequestData=Ao.winterCGRequestToRequestData;G.severityFromString=IA.severityFromString;G.severityLevelFromString=IA.severityLevelFromString;G.validSeverityLevels=IA.validSeverityLevels;G.createStackParser=Lu.createStackParser;G.getFunctionName=Lu.getFunctionName;G.nodeStackLineParser=Lu.nodeStackLineParser;G.stackParserFromStackParserOptions=Lu.stackParserFromStackParserOptions;G.stripSentryFramesAndReverse=Lu.stripSentryFramesAndReverse;G.isMatchingPattern=Uu.isMatchingPattern;G.safeJoin=Uu.safeJoin;G.snipLine=Uu.snipLine;G.stringMatchesSomePattern=Uu.stringMatchesSomePattern;G.truncate=Uu.truncate;G.isNativeFetch=wi.isNativeFetch;G.supportsDOMError=wi.supportsDOMError;G.supportsDOMException=wi.supportsDOMException;G.supportsErrorEvent=wi.supportsErrorEvent;G.supportsFetch=wi.supportsFetch;G.supportsNativeFetch=wi.supportsNativeFetch;G.supportsReferrerPolicy=wi.supportsReferrerPolicy;G.supportsReportingObserver=wi.supportsReportingObserver;G.SyncPromise=bA.SyncPromise;G.rejectedSyncPromise=bA.rejectedSyncPromise;G.resolvedSyncPromise=bA.resolvedSyncPromise;Object.defineProperty(G,"_browserPerformanceTimeOriginMode",{enumerable:!0,get:()=>Yu._browserPerformanceTimeOriginMode});G.browserPerformanceTimeOrigin=Yu.browserPerformanceTimeOrigin;G.dateTimestampInSeconds=Yu.dateTimestampInSeconds;G.timestampInSeconds=Yu.timestampInSeconds;G.timestampWithMs=Yu.timestampWithMs;G.TRACEPARENT_REGEXP=_h.TRACEPARENT_REGEXP;G.extractTraceparentData=_h.extractTraceparentData;G.generateSentryTraceHeader=_h.generateSentryTraceHeader;G.tracingContextFromHeaders=_h.tracingContextFromHeaders;G.getSDKSource=sY.getSDKSource;G.isBrowserBundle=sY.isBrowserBundle;G.addItemToEnvelope=Fn.addItemToEnvelope;G.createAttachmentEnvelopeItem=Fn.createAttachmentEnvelopeItem;G.createEnvelope=Fn.createEnvelope;G.createEventEnvelopeHeaders=Fn.createEventEnvelopeHeaders;G.envelopeContainsItemType=Fn.envelopeContainsItemType;G.envelopeItemTypeToDataCategory=Fn.envelopeItemTypeToDataCategory;G.forEachEnvelopeItem=Fn.forEachEnvelopeItem;G.getSdkMetadataForEnvelopeHeader=Fn.getSdkMetadataForEnvelopeHeader;G.parseEnvelope=Fn.parseEnvelope;G.serializeEnvelope=Fn.serializeEnvelope;G.createClientReportEnvelope=pye.createClientReportEnvelope;G.DEFAULT_RETRY_AFTER=Du.DEFAULT_RETRY_AFTER;G.disabledUntil=Du.disabledUntil;G.isRateLimited=Du.isRateLimited;G.parseRetryAfterHeader=Du.parseRetryAfterHeader;G.updateRateLimits=Du.updateRateLimits;G.BAGGAGE_HEADER_NAME=uc.BAGGAGE_HEADER_NAME;G.MAX_BAGGAGE_STRING_LENGTH=uc.MAX_BAGGAGE_STRING_LENGTH;G.SENTRY_BAGGAGE_KEY_PREFIX=uc.SENTRY_BAGGAGE_KEY_PREFIX;G.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=uc.SENTRY_BAGGAGE_KEY_PREFIX_REGEX;G.baggageHeaderToDynamicSamplingContext=uc.baggageHeaderToDynamicSamplingContext;G.dynamicSamplingContextToSentryBaggageHeader=uc.dynamicSamplingContextToSentryBaggageHeader;G.getNumberOfUrlSegments=Ah.getNumberOfUrlSegments;G.getSanitizedUrlString=Ah.getSanitizedUrlString;G.parseUrl=Ah.parseUrl;G.stripUrlQueryAndFragment=Ah.stripUrlQueryAndFragment;G.addOrUpdateIntegration=hye.addOrUpdateIntegration;G.makeFifoCache=mye.makeFifoCache;G.eventFromMessage=Rh.eventFromMessage;G.eventFromUnknownInput=Rh.eventFromUnknownInput;G.exceptionFromError=Rh.exceptionFromError;G.parseStackFrames=Rh.parseStackFrames;G.parameterize=yye.parameterize;G.callFrameToStackFrame=iY.callFrameToStackFrame;G.watchdogTimer=iY.watchdogTimer;G.LRUMap=Iye.LRUMap;G._asyncNullishCoalesce=bye._asyncNullishCoalesce;G._asyncOptionalChain=Cye._asyncOptionalChain;G._asyncOptionalChainDelete=Sye._asyncOptionalChainDelete;G._nullishCoalesce=vye._nullishCoalesce;G._optionalChain=_ye._optionalChain;G._optionalChainDelete=Aye._optionalChainDelete;G.addConsoleInstrumentationHandler=Rye.addConsoleInstrumentationHandler;G.addClickKeypressInstrumentationHandler=Eye.addClickKeypressInstrumentationHandler;G.SENTRY_XHR_DATA_KEY=oY.SENTRY_XHR_DATA_KEY;G.addXhrInstrumentationHandler=oY.addXhrInstrumentationHandler;G.addFetchInstrumentationHandler=wye.addFetchInstrumentationHandler;G.addHistoryInstrumentationHandler=Bye.addHistoryInstrumentationHandler;G.addGlobalErrorInstrumentationHandler=Tye.addGlobalErrorInstrumentationHandler;G.addGlobalUnhandledRejectionInstrumentationHandler=Gye.addGlobalUnhandledRejectionInstrumentationHandler;G.resetInstrumentationHandlers=Zye.resetInstrumentationHandlers;G.filenameIsInApp=Nye.filenameIsInApp;G.escapeStringForRegex=Vye.escapeStringForRegex;G.supportsHistory=Hye.supportsHistory});var _t=h(CA=>{Object.defineProperty(CA,"__esModule",{value:!0});var Wye=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;CA.DEBUG_BUILD=Wye});var dc=h(SA=>{Object.defineProperty(SA,"__esModule",{value:!0});var Oye="production";SA.DEFAULT_ENVIRONMENT=Oye});var $u=h(Xu=>{Object.defineProperty(Xu,"__esModule",{value:!0});var Eh=O(),Pye=_t();function aY(){return Eh.getGlobalSingleton("globalEventProcessors",()=>[])}function kye(t){aY().push(t)}function vA(t,e,r,n=0){return new Eh.SyncPromise((s,i)=>{let o=t[n];if(e===null||typeof o!="function")s(e);else{let a=o({...e},r);Pye.DEBUG_BUILD&&o.id&&a===null&&Eh.logger.log(`Event processor "${o.id}" dropped event`),Eh.isThenable(a)?a.then(c=>vA(t,c,r,n+1).then(s)).then(null,i):vA(t,a,r,n+1).then(s).then(null,i)}})}Xu.addGlobalEventProcessor=kye;Xu.getGlobalEventProcessors=aY;Xu.notifyEventProcessors=vA});var fc=h(qu=>{Object.defineProperty(qu,"__esModule",{value:!0});var ju=O();function Fye(t){let e=ju.timestampInSeconds(),r={sid:ju.uuid4(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Lye(r)};return t&&_A(r,t),r}function _A(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||ju.timestampInSeconds(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:ju.uuid4()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{let r=t.timestamp-t.started;t.duration=r>=0?r:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function xye(t,e){let r={};e?r={status:e}:t.status==="ok"&&(r={status:"exited"}),_A(t,r)}function Lye(t){return ju.dropUndefinedKeys({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}qu.closeSession=xye;qu.makeSession=Fye;qu.updateSession=_A});var pr=h(Bs=>{Object.defineProperty(Bs,"__esModule",{value:!0});var AA=O(),Uye=0,lY=1;function Yye(t){let{spanId:e,traceId:r}=t.spanContext(),{data:n,op:s,parent_span_id:i,status:o,tags:a,origin:c}=uY(t);return AA.dropUndefinedKeys({data:n,op:s,parent_span_id:i,span_id:e,status:o,tags:a,trace_id:r,origin:c})}function Dye(t){let{traceId:e,spanId:r}=t.spanContext(),n=dY(t);return AA.generateSentryTraceHeader(e,r,n)}function Xye(t){return typeof t=="number"?cY(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?cY(t.getTime()):AA.timestampInSeconds()}function cY(t){return t>9999999999?t/1e3:t}function uY(t){return $ye(t)?t.getSpanJSON():typeof t.toJSON=="function"?t.toJSON():{}}function $ye(t){return typeof t.getSpanJSON=="function"}function dY(t){let{traceFlags:e}=t.spanContext();return!!(e&lY)}Bs.TRACE_FLAG_NONE=Uye;Bs.TRACE_FLAG_SAMPLED=lY;Bs.spanIsSampled=dY;Bs.spanTimeInputToSeconds=Xye;Bs.spanToJSON=uY;Bs.spanToTraceContext=Yye;Bs.spanToTraceHeader=Dye});var wh=h(gc=>{Object.defineProperty(gc,"__esModule",{value:!0});var wr=O(),jye=dc(),fY=$u(),EA=Th(),RA=Bh(),qye=pr();function Mye(t,e,r,n,s,i){let{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||r.event_id||wr.uuid4(),timestamp:e.timestamp||wr.dateTimestampInSeconds()},l=r.integrations||t.integrations.map(I=>I.name);Kye(c,t),zye(c,l),e.type===void 0&&pY(c,t.stackParser);let u=Qye(n,r.captureContext);r.mechanism&&wr.addExceptionMechanism(c,r.mechanism);let d=s&&s.getEventProcessors?s.getEventProcessors():[],f=EA.getGlobalScope().getScopeData();if(i){let I=i.getScopeData();RA.mergeScopeData(f,I)}if(u){let I=u.getScopeData();RA.mergeScopeData(f,I)}let g=[...r.attachments||[],...f.attachments];g.length&&(r.attachments=g),RA.applyScopeDataToEvent(c,f);let p=[...d,...fY.getGlobalEventProcessors(),...f.eventProcessors];return fY.notifyEventProcessors(p,c,r).then(I=>(I&&hY(I),typeof o=="number"&&o>0?Jye(I,o,a):I))}function Kye(t,e){let{environment:r,release:n,dist:s,maxValueLength:i=250}=e;"environment"in t||(t.environment="environment"in e?r:jye.DEFAULT_ENVIRONMENT),t.release===void 0&&n!==void 0&&(t.release=n),t.dist===void 0&&s!==void 0&&(t.dist=s),t.message&&(t.message=wr.truncate(t.message,i));let o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=wr.truncate(o.value,i));let a=t.request;a&&a.url&&(a.url=wr.truncate(a.url,i))}var gY=new WeakMap;function pY(t,e){let r=wr.GLOBAL_OBJ._sentryDebugIds;if(!r)return;let n,s=gY.get(e);s?n=s:(n=new Map,gY.set(e,n));let i=Object.keys(r).reduce((o,a)=>{let c,l=n.get(a);l?c=l:(c=e(a),n.set(a,c));for(let u=c.length-1;u>=0;u--){let d=c[u];if(d.filename){o[d.filename]=r[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=i[a.filename])})})}catch{}}function hY(t){let e={};try{t.exception.values.forEach(n=>{n.stacktrace.frames.forEach(s=>{s.debug_id&&(s.abs_path?e[s.abs_path]=s.debug_id:s.filename&&(e[s.filename]=s.debug_id),delete s.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];let r=t.debug_meta.images;Object.keys(e).forEach(n=>{r.push({type:"sourcemap",code_file:n,debug_id:e[n]})})}function zye(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function Jye(t,e,r){if(!t)return null;let n={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(s=>({...s,...s.data&&{data:wr.normalize(s.data,e,r)}}))},...t.user&&{user:wr.normalize(t.user,e,r)},...t.contexts&&{contexts:wr.normalize(t.contexts,e,r)},...t.extra&&{extra:wr.normalize(t.extra,e,r)}};return t.contexts&&t.contexts.trace&&n.contexts&&(n.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(n.contexts.trace.data=wr.normalize(t.contexts.trace.data,e,r))),t.spans&&(n.spans=t.spans.map(s=>{let i=qye.spanToJSON(s).data;return i&&(s.data=wr.normalize(i,e,r)),s})),n}function Qye(t,e){if(!e)return t;let r=t?t.clone():new EA.Scope;return r.update(e),r}function eIe(t){if(t)return tIe(t)?{captureContext:t}:nIe(t)?{captureContext:t}:t}function tIe(t){return t instanceof EA.Scope||typeof t=="function"}var rIe=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function nIe(t){return Object.keys(t).some(e=>rIe.includes(e))}gc.applyDebugIds=pY;gc.applyDebugMeta=hY;gc.parseEventHintOrCaptureContext=eIe;gc.prepareEvent=Mye});var mn=h(De=>{Object.defineProperty(De,"__esModule",{value:!0});var Ts=O(),sIe=dc(),Gh=_t(),gt=xn(),wA=fc(),iIe=wh();function oIe(t,e){return gt.getCurrentHub().captureException(t,iIe.parseEventHintOrCaptureContext(e))}function aIe(t,e){let r=typeof e=="string"?e:void 0,n=typeof e!="string"?{captureContext:e}:void 0;return gt.getCurrentHub().captureMessage(t,r,n)}function cIe(t,e){return gt.getCurrentHub().captureEvent(t,e)}function lIe(t){gt.getCurrentHub().configureScope(t)}function uIe(t,e){gt.getCurrentHub().addBreadcrumb(t,e)}function dIe(t,e){gt.getCurrentHub().setContext(t,e)}function fIe(t){gt.getCurrentHub().setExtras(t)}function gIe(t,e){gt.getCurrentHub().setExtra(t,e)}function pIe(t){gt.getCurrentHub().setTags(t)}function hIe(t,e){gt.getCurrentHub().setTag(t,e)}function mIe(t){gt.getCurrentHub().setUser(t)}function mY(...t){let e=gt.getCurrentHub();if(t.length===2){let[r,n]=t;return r?e.withScope(()=>(e.getStackTop().scope=r,n(r))):e.withScope(n)}return e.withScope(t[0])}function yIe(t){return gt.runWithAsyncContext(()=>t(gt.getIsolationScope()))}function IIe(t,e){return mY(r=>(r.setSpan(t),e(r)))}function bIe(t,e){return gt.getCurrentHub().startTransaction({...t},e)}function BA(t,e){let r=Mu(),n=pc();if(!n)Gh.DEBUG_BUILD&&Ts.logger.warn("Cannot capture check-in. No client defined.");else if(!n.captureCheckIn)Gh.DEBUG_BUILD&&Ts.logger.warn("Cannot capture check-in. Client does not support sending check-ins.");else return n.captureCheckIn(t,e,r);return Ts.uuid4()}function CIe(t,e,r){let n=BA({monitorSlug:t,status:"in_progress"},r),s=Ts.timestampInSeconds();function i(a){BA({monitorSlug:t,status:a,checkInId:n,duration:Ts.timestampInSeconds()-s})}let o;try{o=e()}catch(a){throw i("error"),a}return Ts.isThenable(o)?Promise.resolve(o).then(()=>{i("ok")},()=>{i("error")}):i("ok"),o}async function SIe(t){let e=pc();return e?e.flush(t):(Gh.DEBUG_BUILD&&Ts.logger.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function vIe(t){let e=pc();return e?e.close(t):(Gh.DEBUG_BUILD&&Ts.logger.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function _Ie(){return gt.getCurrentHub().lastEventId()}function pc(){return gt.getCurrentHub().getClient()}function Mu(){return gt.getCurrentHub().getScope()}function AIe(t){let e=pc(),r=gt.getIsolationScope(),n=Mu(),{release:s,environment:i=sIe.DEFAULT_ENVIRONMENT}=e&&e.getOptions()||{},{userAgent:o}=Ts.GLOBAL_OBJ.navigator||{},a=wA.makeSession({release:s,environment:i,user:n.getUser()||r.getUser(),...o&&{userAgent:o},...t}),c=r.getSession();return c&&c.status==="ok"&&wA.updateSession(c,{status:"exited"}),TA(),r.setSession(a),n.setSession(a),a}function TA(){let t=gt.getIsolationScope(),e=Mu(),r=e.getSession()||t.getSession();r&&wA.closeSession(r),yY(),t.setSession(),e.setSession()}function yY(){let t=gt.getIsolationScope(),e=Mu(),r=pc(),n=e.getSession()||t.getSession();n&&r&&r.captureSession&&r.captureSession(n)}function RIe(t=!1){if(t){TA();return}yY()}De.addBreadcrumb=uIe;De.captureCheckIn=BA;De.captureEvent=cIe;De.captureException=oIe;De.captureMessage=aIe;De.captureSession=RIe;De.close=vIe;De.configureScope=lIe;De.endSession=TA;De.flush=SIe;De.getClient=pc;De.getCurrentScope=Mu;De.lastEventId=_Ie;De.setContext=dIe;De.setExtra=gIe;De.setExtras=fIe;De.setTag=hIe;De.setTags=pIe;De.setUser=mIe;De.startSession=AIe;De.startTransaction=bIe;De.withActiveSpan=IIe;De.withIsolationScope=yIe;De.withMonitor=CIe;De.withScope=mY});var hc=h(GA=>{Object.defineProperty(GA,"__esModule",{value:!0});function EIe(t){return t.transaction}GA.getRootSpan=EIe});var mc=h(Zh=>{Object.defineProperty(Zh,"__esModule",{value:!0});var wIe=O(),BIe=dc(),IY=mn(),TIe=hc(),ZA=pr();function bY(t,e,r){let n=e.getOptions(),{publicKey:s}=e.getDsn()||{},{segment:i}=r&&r.getUser()||{},o=wIe.dropUndefinedKeys({environment:n.environment||BIe.DEFAULT_ENVIRONMENT,release:n.release,user_segment:i,public_key:s,trace_id:t});return e.emit&&e.emit("createDsc",o),o}function GIe(t){let e=IY.getClient();if(!e)return{};let r=bY(ZA.spanToJSON(t).trace_id||"",e,IY.getCurrentScope()),n=TIe.getRootSpan(t);if(!n)return r;let s=n&&n._frozenDynamicSamplingContext;if(s)return s;let{sampleRate:i,source:o}=n.metadata;i!=null&&(r.sample_rate=`${i}`);let a=ZA.spanToJSON(n);return o&&o!=="url"&&(r.transaction=a.description),r.sampled=String(ZA.spanIsSampled(n)),e.emit&&e.emit("createDsc",r),r}Zh.getDynamicSamplingContextFromClient=bY;Zh.getDynamicSamplingContextFromSpan=GIe});var Bh=h(zu=>{Object.defineProperty(zu,"__esModule",{value:!0});var Ku=O(),ZIe=mc(),NIe=hc(),CY=pr();function VIe(t,e){let{fingerprint:r,span:n,breadcrumbs:s,sdkProcessingMetadata:i,propagationContext:o}=e;WIe(t,e),n&&kIe(t,n),FIe(t,r),OIe(t,s),PIe(t,i,o)}function HIe(t,e){let{extra:r,tags:n,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:f,transactionName:g,span:p}=e;yc(t,"extra",r),yc(t,"tags",n),yc(t,"user",s),yc(t,"contexts",i),yc(t,"sdkProcessingMetadata",a),o&&(t.level=o),g&&(t.transactionName=g),p&&(t.span=p),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...f}}function yc(t,e,r){if(r&&Object.keys(r).length){t[e]={...t[e]};for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[e][n]=r[n])}}function WIe(t,e){let{extra:r,tags:n,user:s,contexts:i,level:o,transactionName:a}=e,c=Ku.dropUndefinedKeys(r);c&&Object.keys(c).length&&(t.extra={...c,...t.extra});let l=Ku.dropUndefinedKeys(n);l&&Object.keys(l).length&&(t.tags={...l,...t.tags});let u=Ku.dropUndefinedKeys(s);u&&Object.keys(u).length&&(t.user={...u,...t.user});let d=Ku.dropUndefinedKeys(i);d&&Object.keys(d).length&&(t.contexts={...d,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function OIe(t,e){let r=[...t.breadcrumbs||[],...e];t.breadcrumbs=r.length?r:void 0}function PIe(t,e,r){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e,propagationContext:r}}function kIe(t,e){t.contexts={trace:CY.spanToTraceContext(e),...t.contexts};let r=NIe.getRootSpan(e);if(r){t.sdkProcessingMetadata={dynamicSamplingContext:ZIe.getDynamicSamplingContextFromSpan(e),...t.sdkProcessingMetadata};let n=CY.spanToJSON(r).description;n&&(t.tags={transaction:n,...t.tags})}}function FIe(t,e){t.fingerprint=t.fingerprint?Ku.arrayify(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}zu.applyScopeDataToEvent=VIe;zu.mergeAndOverwriteScopeData=yc;zu.mergeScopeData=HIe});var Th=h(Ju=>{Object.defineProperty(Ju,"__esModule",{value:!0});var Ln=O(),SY=$u(),xIe=fc(),LIe=Bh(),UIe=100,Nh,Vh=class t{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=vY()}static clone(e){return e?e.clone():new t}clone(){let e=new t;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&xIe.updateSession(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,r){return this._tags={...this._tags,[e]:r},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,r){return this._extra={...this._extra,[e]:r},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,r){return r===null?delete this._contexts[e]:this._contexts[e]=r,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){let e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){let r=e(this);return r instanceof t?r:this}return e instanceof t?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):Ln.isPlainObject(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=vY(),this}addBreadcrumb(e,r){let n=typeof r=="number"?r:UIe;if(n<=0)return this;let s={timestamp:Ln.dateTimestampInSeconds(),...e},i=this._breadcrumbs;return i.push(s),this._breadcrumbs=i.length>n?i.slice(-n):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){let{_breadcrumbs:e,_attachments:r,_contexts:n,_tags:s,_extra:i,_user:o,_level:a,_fingerprint:c,_eventProcessors:l,_propagationContext:u,_sdkProcessingMetadata:d,_transactionName:f,_span:g}=this;return{breadcrumbs:e,attachments:r,contexts:n,tags:s,extra:i,user:o,level:a,fingerprint:c||[],eventProcessors:l,propagationContext:u,sdkProcessingMetadata:d,transactionName:f,span:g}}applyToEvent(e,r={},n=[]){LIe.applyScopeDataToEvent(e,this.getScopeData());let s=[...n,...SY.getGlobalEventProcessors(),...this._eventProcessors];return SY.notifyEventProcessors(s,e,r)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,r){let n=r&&r.event_id?r.event_id:Ln.uuid4();if(!this._client)return Ln.logger.warn("No client configured on scope - will not capture exception!"),n;let s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...r,event_id:n},this),n}captureMessage(e,r,n){let s=n&&n.event_id?n.event_id:Ln.uuid4();if(!this._client)return Ln.logger.warn("No client configured on scope - will not capture message!"),s;let i=new Error(e);return this._client.captureMessage(e,r,{originalException:e,syntheticException:i,...n,event_id:s},this),s}captureEvent(e,r){let n=r&&r.event_id?r.event_id:Ln.uuid4();return this._client?(this._client.captureEvent(e,{...r,event_id:n},this),n):(Ln.logger.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}};function YIe(){return Nh||(Nh=new Vh),Nh}function DIe(t){Nh=t}function vY(){return{traceId:Ln.uuid4(),spanId:Ln.uuid4().substring(16)}}Ju.Scope=Vh;Ju.getGlobalScope=YIe;Ju.setGlobalScope=DIe});var VA=h(NA=>{Object.defineProperty(NA,"__esModule",{value:!0});var XIe="7.94.1";NA.SDK_VERSION=XIe});var xn=h(Br=>{Object.defineProperty(Br,"__esModule",{value:!0});var ar=O(),$Ie=dc(),HA=_t(),_Y=Th(),WA=fc(),jIe=VA(),Hh=parseFloat(jIe.SDK_VERSION),qIe=100,Ic=class{constructor(e,r,n,s=Hh){this._version=s;let i;r?i=r:(i=new _Y.Scope,i.setClient(e));let o;n?o=n:(o=new _Y.Scope,o.setClient(e)),this._stack=[{scope:i}],e&&this.bindClient(e),this._isolationScope=o}isOlderThan(e){return this._version<e}bindClient(e){let r=this.getStackTop();r.client=e,r.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){let e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){let r=this.pushScope(),n;try{n=e(r)}catch(s){throw this.popScope(),s}return ar.isThenable(n)?n.then(s=>(this.popScope(),s),s=>{throw this.popScope(),s}):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,r){let n=this._lastEventId=r&&r.event_id?r.event_id:ar.uuid4(),s=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:s,...r,event_id:n}),n}captureMessage(e,r,n){let s=this._lastEventId=n&&n.event_id?n.event_id:ar.uuid4(),i=new Error(e);return this.getScope().captureMessage(e,r,{originalException:e,syntheticException:i,...n,event_id:s}),s}captureEvent(e,r){let n=r&&r.event_id?r.event_id:ar.uuid4();return e.type||(this._lastEventId=n),this.getScope().captureEvent(e,{...r,event_id:n}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,r){let{scope:n,client:s}=this.getStackTop();if(!s)return;let{beforeBreadcrumb:i=null,maxBreadcrumbs:o=qIe}=s.getOptions&&s.getOptions()||{};if(o<=0)return;let c={timestamp:ar.dateTimestampInSeconds(),...e},l=i?ar.consoleSandbox(()=>i(c,r)):c;l!==null&&(s.emit&&s.emit("beforeAddBreadcrumb",l,r),n.addBreadcrumb(l,o))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,r){this.getScope().setTag(e,r),this.getIsolationScope().setTag(e,r)}setExtra(e,r){this.getScope().setExtra(e,r),this.getIsolationScope().setExtra(e,r)}setContext(e,r){this.getScope().setContext(e,r),this.getIsolationScope().setContext(e,r)}configureScope(e){let{scope:r,client:n}=this.getStackTop();n&&e(r)}run(e){let r=OA(this);try{e(this)}finally{OA(r)}}getIntegration(e){let r=this.getClient();if(!r)return null;try{return r.getIntegration(e)}catch{return HA.DEBUG_BUILD&&ar.logger.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,r){let n=this._callExtensionMethod("startTransaction",e,r);return HA.DEBUG_BUILD&&!n&&(this.getClient()?ar.logger.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):ar.logger.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){let r=this.getStackTop().scope,n=r.getSession();n&&WA.closeSession(n),this._sendSessionUpdate(),r.setSession()}startSession(e){let{scope:r,client:n}=this.getStackTop(),{release:s,environment:i=$Ie.DEFAULT_ENVIRONMENT}=n&&n.getOptions()||{},{userAgent:o}=ar.GLOBAL_OBJ.navigator||{},a=WA.makeSession({release:s,environment:i,user:r.getUser(),...o&&{userAgent:o},...e}),c=r.getSession&&r.getSession();return c&&c.status==="ok"&&WA.updateSession(c,{status:"exited"}),this.endSession(),r.setSession(a),a}shouldSendDefaultPii(){let e=this.getClient(),r=e&&e.getOptions();return!!(r&&r.sendDefaultPii)}_sendSessionUpdate(){let{scope:e,client:r}=this.getStackTop(),n=e.getSession();n&&r&&r.captureSession&&r.captureSession(n)}_callExtensionMethod(e,...r){let s=Ro().__SENTRY__;if(s&&s.extensions&&typeof s.extensions[e]=="function")return s.extensions[e].apply(this,r);HA.DEBUG_BUILD&&ar.logger.warn(`Extension method ${e} couldn't be found, doing nothing.`)}};function Ro(){return ar.GLOBAL_OBJ.__SENTRY__=ar.GLOBAL_OBJ.__SENTRY__||{extensions:{},hub:void 0},ar.GLOBAL_OBJ}function OA(t){let e=Ro(),r=Qu(e);return Wh(e,t),r}function AY(){let t=Ro();if(t.__SENTRY__&&t.__SENTRY__.acs){let e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return RY(t)}function MIe(){return AY().getIsolationScope()}function RY(t=Ro()){return(!EY(t)||Qu(t).isOlderThan(Hh))&&Wh(t,new Ic),Qu(t)}function KIe(t,e=RY()){if(!EY(t)||Qu(t).isOlderThan(Hh)){let r=e.getClient(),n=e.getScope(),s=e.getIsolationScope();Wh(t,new Ic(r,n.clone(),s.clone()))}}function zIe(t){let e=Ro();e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.acs=t}function JIe(t,e={}){let r=Ro();return r.__SENTRY__&&r.__SENTRY__.acs?r.__SENTRY__.acs.runWithAsyncContext(t,e):t()}function EY(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function Qu(t){return ar.getGlobalSingleton("hub",()=>new Ic,t)}function Wh(t,e){if(!t)return!1;let r=t.__SENTRY__=t.__SENTRY__||{};return r.hub=e,!0}Br.API_VERSION=Hh;Br.Hub=Ic;Br.ensureHubOnCarrier=KIe;Br.getCurrentHub=AY;Br.getHubFromCarrier=Qu;Br.getIsolationScope=MIe;Br.getMainCarrier=Ro;Br.makeMain=OA;Br.runWithAsyncContext=JIe;Br.setAsyncContextStrategy=zIe;Br.setHubOnCarrier=Wh});var Oh=h(ed=>{Object.defineProperty(ed,"__esModule",{value:!0});var wY=O(),QIe=xn();function ebe(t){return(t||QIe.getCurrentHub()).getScope().getTransaction()}var tbe=wY.extractTraceparentData;ed.stripUrlQueryAndFragment=wY.stripUrlQueryAndFragment;ed.extractTraceparentData=tbe;ed.getActiveTransaction=ebe});var TY=h(FA=>{Object.defineProperty(FA,"__esModule",{value:!0});var PA=O(),rbe=_t(),nbe=Oh(),BY=!1;function sbe(){BY||(BY=!0,PA.addGlobalErrorInstrumentationHandler(kA),PA.addGlobalUnhandledRejectionInstrumentationHandler(kA))}function kA(){let t=nbe.getActiveTransaction();if(t){let e="internal_error";rbe.DEBUG_BUILD&&PA.logger.log(`[Tracing] Transaction: ${e} -> Global error occured`),t.setStatus(e)}}kA.tag="sentry_tracingErrorCallback";FA.registerErrorInstrumentation=sbe});var rd=h(td=>{Object.defineProperty(td,"__esModule",{value:!0});var ibe="sentry.source",obe="sentry.sample_rate",abe="sentry.op";td.SEMANTIC_ATTRIBUTE_SENTRY_OP=abe;td.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=obe;td.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=ibe});var kh=h(nd=>{Object.defineProperty(nd,"__esModule",{value:!0});var Eo=O(),GY=_t(),Ph=rd(),ZY=hc(),bc=pr(),xA=class{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}},LA=class t{constructor(e={}){this._traceId=e.traceId||Eo.uuid4(),this._spanId=e.spanId||Eo.uuid4().substring(16),this._startTime=e.startTimestamp||Eo.timestampInSeconds(),this.tags=e.tags?{...e.tags}:{},this.data=e.data?{...e.data}:{},this._attributes=e.attributes?{...e.attributes}:{},this.instrumenter=e.instrumenter||"sentry",this.origin=e.origin||"manual",this._name=e.name||e.description,e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.op&&this.setAttribute(Ph.SEMANTIC_ATTRIBUTE_SENTRY_OP,e.op),e.status&&(this._status=e.status),e.endTimestamp&&(this._endTime=e.endTimestamp)}get name(){return this._name||""}set name(e){this.updateName(e)}get description(){return this._name}set description(e){this._name=e}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get spanId(){return this._spanId}set spanId(e){this._spanId=e}get sampled(){return this._sampled}set sampled(e){this._sampled=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get startTimestamp(){return this._startTime}set startTimestamp(e){this._startTime=e}get endTimestamp(){return this._endTime}set endTimestamp(e){this._endTime=e}get status(){return this._status}set status(e){this._status=e}get op(){return this._attributes[Ph.SEMANTIC_ATTRIBUTE_SENTRY_OP]}set op(e){this.setAttribute(Ph.SEMANTIC_ATTRIBUTE_SENTRY_OP,e)}spanContext(){let{_spanId:e,_traceId:r,_sampled:n}=this;return{spanId:e,traceId:r,traceFlags:n?bc.TRACE_FLAG_SAMPLED:bc.TRACE_FLAG_NONE}}startChild(e){let r=new t({...e,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});r.spanRecorder=this.spanRecorder,r.spanRecorder&&r.spanRecorder.add(r);let n=ZY.getRootSpan(this);if(r.transaction=n,GY.DEBUG_BUILD&&n){let s=e&&e.op||"< unknown op >",i=bc.spanToJSON(r).description||"< unknown name >",o=n.spanContext().spanId,a=`[Tracing] Starting '${s}' span on transaction '${i}' (${o}).`;Eo.logger.log(a),this._logMessage=a}return r}setTag(e,r){return this.tags={...this.tags,[e]:r},this}setData(e,r){return this.data={...this.data,[e]:r},this}setAttribute(e,r){r===void 0?delete this._attributes[e]:this._attributes[e]=r}setAttributes(e){Object.keys(e).forEach(r=>this.setAttribute(r,e[r]))}setStatus(e){return this._status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e)),this.setData("http.response.status_code",e);let r=NY(e);return r!=="unknown_error"&&this.setStatus(r),this}setName(e){this.updateName(e)}updateName(e){return this._name=e,this}isSuccess(){return this._status==="ok"}finish(e){return this.end(e)}end(e){if(this._endTime)return;let r=ZY.getRootSpan(this);if(GY.DEBUG_BUILD&&r&&r.spanContext().spanId!==this._spanId){let n=this._logMessage;n&&Eo.logger.log(n.replace("Starting","Finishing"))}this._endTime=bc.spanTimeInputToSeconds(e)}toTraceparent(){return bc.spanToTraceHeader(this)}toContext(){return Eo.dropUndefinedKeys({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this.parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(e){return this.data=e.data||{},this._name=e.name||e.description,this._endTime=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this._sampled=e.sampled,this._spanId=e.spanId||this._spanId,this._startTime=e.startTimestamp||this._startTime,this._status=e.status,this.tags=e.tags||{},this._traceId=e.traceId||this._traceId,this}getTraceContext(){return bc.spanToTraceContext(this)}getSpanJSON(){return Eo.dropUndefinedKeys({data:this._getData(),description:this._name,op:this._attributes[Ph.SEMANTIC_ATTRIBUTE_SENTRY_OP],parent_span_id:this.parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this.origin})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){let{data:e,_attributes:r}=this,n=Object.keys(e).length>0,s=Object.keys(r).length>0;if(!(!n&&!s))return n&&s?{...e,...r}:n?e:r}};function NY(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}nd.Span=LA;nd.SpanRecorder=xA;nd.spanStatusfromHttpCode=NY});var Lh=h(YA=>{Object.defineProperty(YA,"__esModule",{value:!0});var sd=O(),Fh=_t(),cbe=xn(),id=rd(),xh=pr(),VY=mc(),HY=kh(),UA=class extends HY.Span{constructor(e,r){super(e),this._measurements={},this._contexts={},this._hub=r||cbe.getCurrentHub(),this._name=e.name||"",this._metadata={...e.metadata},this._trimEnd=e.trimEnd,this.transaction=this;let n=this._metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[id.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]&&{source:this._attributes[id.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]},...this._attributes[id.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]&&{sampleRate:this._attributes[id.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]}}}set metadata(e){this._metadata=e}setName(e,r="custom"){this._name=e,this.setAttribute(id.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,r)}updateName(e){return this._name=e,this}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new HY.SpanRecorder(e)),this.spanRecorder.add(this)}setContext(e,r){r===null?delete this._contexts[e]:this._contexts[e]=r}setMeasurement(e,r,n=""){this._measurements[e]={value:r,unit:n}}setMetadata(e){this._metadata={...this._metadata,...e}}end(e){let r=xh.spanTimeInputToSeconds(e),n=this._finishTransaction(r);if(n)return this._hub.captureEvent(n)}toContext(){let e=super.toContext();return sd.dropUndefinedKeys({...e,name:this._name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this._name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){return VY.getDynamicSamplingContextFromSpan(this)}setHub(e){this._hub=e}_finishTransaction(e){if(this._endTime!==void 0)return;this._name||(Fh.DEBUG_BUILD&&sd.logger.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(e);let r=this._hub.getClient();if(r&&r.emit&&r.emit("finishTransaction",this),this._sampled!==!0){Fh.DEBUG_BUILD&&sd.logger.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),r&&r.recordDroppedEvent("sample_rate","transaction");return}let n=this.spanRecorder?this.spanRecorder.spans.filter(c=>c!==this&&xh.spanToJSON(c).timestamp):[];if(this._trimEnd&&n.length>0){let c=n.map(l=>xh.spanToJSON(l).timestamp).filter(Boolean);this._endTime=c.reduce((l,u)=>l>u?l:u)}let{metadata:s}=this,{source:i}=s,o={contexts:{...this._contexts,trace:xh.spanToTraceContext(this)},spans:n,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...s,dynamicSamplingContext:VY.getDynamicSamplingContextFromSpan(this)},...i&&{transaction_info:{source:i}}};return Object.keys(this._measurements).length>0&&(Fh.DEBUG_BUILD&&sd.logger.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),o.measurements=this._measurements),Fh.DEBUG_BUILD&&sd.logger.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),o}};YA.Transaction=UA});var XA=h(od=>{Object.defineProperty(od,"__esModule",{value:!0});var Kt=O(),hr=_t(),Uh=pr(),lbe=kh(),ube=Lh(),Yh={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},dbe="finishReason",Cc=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"],Dh=class extends lbe.SpanRecorder{constructor(e,r,n,s){super(s),this._pushActivity=e,this._popActivity=r,this.transactionSpanId=n}add(e){if(e.spanContext().spanId!==this.transactionSpanId){let r=e.end;e.end=(...n)=>(this._popActivity(e.spanContext().spanId),r.apply(e,n)),Uh.spanToJSON(e).timestamp===void 0&&this._pushActivity(e.spanContext().spanId)}super.add(e)}},DA=class extends ube.Transaction{constructor(e,r,n=Yh.idleTimeout,s=Yh.finalTimeout,i=Yh.heartbeatInterval,o=!1,a=!1){super(e,r),this._idleHub=r,this._idleTimeout=n,this._finalTimeout=s,this._heartbeatInterval=i,this._onScope=o,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Cc[4],this._autoFinishAllowed=!a,o&&(hr.DEBUG_BUILD&&Kt.logger.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),r.getScope().setSpan(this)),a||this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Cc[3],this.end())},this._finalTimeout)}end(e){let r=Uh.spanTimeInputToSeconds(e);if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setAttribute(dbe,this._finishReason),this.spanRecorder){hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] finishing IdleTransaction",new Date(r*1e3).toISOString(),this.op);for(let n of this._beforeFinishCallbacks)n(this,r);this.spanRecorder.spans=this.spanRecorder.spans.filter(n=>{if(n.spanContext().spanId===this.spanContext().spanId)return!0;Uh.spanToJSON(n).timestamp||(n.setStatus("cancelled"),n.end(r),hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(n,void 0,2)));let{start_timestamp:s,timestamp:i}=Uh.spanToJSON(n),o=s&&s<r,a=(this._finalTimeout+this._idleTimeout)/1e3,c=i&&s&&i-s<a;if(hr.DEBUG_BUILD){let l=JSON.stringify(n,void 0,2);o?c||Kt.logger.log("[Tracing] discarding Span since it finished after Transaction final timeout",l):Kt.logger.log("[Tracing] discarding Span since it happened after Transaction was finished",l)}return o&&c}),hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] flushing IdleTransaction")}else hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] No active IdleTransaction");if(this._onScope){let n=this._idleHub.getScope();n.getTransaction()===this&&n.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){let r=s=>{this._finished||this._pushActivity(s)},n=s=>{this._finished||this._popActivity(s)};this.spanRecorder=new Dh(r,n,this.spanContext().spanId,e),hr.DEBUG_BUILD&&Kt.logger.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:r}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=r===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Cc[5],this.end(e)))}setFinishReason(e){this._finishReason=e}sendAutoFinishSignal(){this._autoFinishAllowed||(hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Cc[1],this.end(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),hr.DEBUG_BUILD&&Kt.logger.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(hr.DEBUG_BUILD&&Kt.logger.log(`[Tracing] popActivity ${e}`),delete this.activities[e],hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){let r=Kt.timestampInSeconds();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=Cc[5],this.end(r)):this._restartIdleTimeout(r+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;let e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?this._autoFinishAllowed&&(hr.DEBUG_BUILD&&Kt.logger.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Cc[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){hr.DEBUG_BUILD&&Kt.logger.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}};od.IdleTransaction=DA;od.IdleTransactionSpanRecorder=Dh;od.TRACING_DEFAULTS=Yh});var Xh=h($A=>{Object.defineProperty($A,"__esModule",{value:!0});var fbe=mn();function gbe(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;let e=fbe.getClient(),r=t||e&&e.getOptions();return!!r&&(r.enableTracing||"tracesSampleRate"in r||"tracesSampler"in r)}$A.hasTracingEnabled=gbe});var WY=h(jA=>{Object.defineProperty(jA,"__esModule",{value:!0});var wo=O(),Sc=_t(),$h=rd(),pbe=Xh(),hbe=pr();function mbe(t,e,r){if(!pbe.hasTracingEnabled(e))return t.sampled=!1,t;if(t.sampled!==void 0)return t.setAttribute($h.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(t.sampled)),t;let n;return typeof e.tracesSampler=="function"?(n=e.tracesSampler(r),t.setAttribute($h.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(n))):r.parentSampled!==void 0?n=r.parentSampled:typeof e.tracesSampleRate<"u"?(n=e.tracesSampleRate,t.setAttribute($h.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(n))):(n=1,t.setAttribute($h.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,n)),ybe(n)?n?(t.sampled=Math.random()<n,t.sampled?(Sc.DEBUG_BUILD&&wo.logger.log(`[Tracing] starting ${t.op} transaction - ${hbe.spanToJSON(t).description}`),t):(Sc.DEBUG_BUILD&&wo.logger.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(n)})`),t)):(Sc.DEBUG_BUILD&&wo.logger.log(`[Tracing] Discarding transaction because ${typeof e.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),t.sampled=!1,t):(Sc.DEBUG_BUILD&&wo.logger.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)}function ybe(t){return wo.isNaN(t)||!(typeof t=="number"||typeof t=="boolean")?(Sc.DEBUG_BUILD&&wo.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`),!1):t<0||t>1?(Sc.DEBUG_BUILD&&wo.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${t}.`),!1):!0}jA.sampleTransaction=mbe});var qA=h(jh=>{Object.defineProperty(jh,"__esModule",{value:!0});var Ibe=O(),bbe=_t(),Cbe=xn(),Sbe=pr(),vbe=TY(),_be=XA(),OY=WY(),Abe=Lh();function Rbe(){let e=this.getScope().getSpan();return e?{"sentry-trace":Sbe.spanToTraceHeader(e)}:{}}function Ebe(t,e){let r=this.getClient(),n=r&&r.getOptions()||{},s=n.instrumenter||"sentry",i=t.instrumenter||"sentry";s!==i&&(bbe.DEBUG_BUILD&&Ibe.logger.error(`A transaction was started with instrumenter=\`${i}\`, but the SDK is configured with the \`${s}\` instrumenter.
The transaction will not be sampled. Please use the ${s} instrumentation to start transactions.`),t.sampled=!1);let o=new Abe.Transaction(t,this);return o=OY.sampleTransaction(o,n,{parentSampled:t.parentSampled,transactionContext:t,...e}),o.isRecording()&&o.initSpanRecorder(n._experiments&&n._experiments.maxSpans),r&&r.emit&&r.emit("startTransaction",o),o}function wbe(t,e,r,n,s,i,o,a=!1){let c=t.getClient(),l=c&&c.getOptions()||{},u=new _be.IdleTransaction(e,t,r,n,o,s,a);return u=OY.sampleTransaction(u,l,{parentSampled:e.parentSampled,transactionContext:e,...i}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function Bbe(){let t=Cbe.getMainCarrier();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=Ebe),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=Rbe),vbe.registerErrorInstrumentation())}jh.addTracingExtensions=Bbe;jh.startIdleTransaction=wbe});var MA=h(ad=>{Object.defineProperty(ad,"__esModule",{value:!0});ad.SpanStatus=void 0;(function(t){let e="ok";t.Ok=e;let r="deadline_exceeded";t.DeadlineExceeded=r;let n="unauthenticated";t.Unauthenticated=n;let s="permission_denied";t.PermissionDenied=s;let i="not_found";t.NotFound=i;let o="resource_exhausted";t.ResourceExhausted=o;let a="invalid_argument";t.InvalidArgument=a;let c="unimplemented";t.Unimplemented=c;let l="unavailable";t.Unavailable=l;let u="internal_error";t.InternalError=u;let d="unknown_error";t.UnknownError=d;let f="cancelled";t.Cancelled=f;let g="already_exists";t.AlreadyExists=g;let p="failed_precondition";t.FailedPrecondition=p;let m="aborted";t.Aborted=m;let I="out_of_range";t.OutOfRange=I;let C="data_loss";t.DataLoss=C})(ad.SpanStatus||(ad.SpanStatus={}))});var zA=h(KA=>{Object.defineProperty(KA,"__esModule",{value:!0});var Tbe=O();function Gbe(t,e,r=()=>{}){let n;try{n=t()}catch(s){throw e(s),r(),s}return Zbe(n,e,r)}function Zbe(t,e,r){return Tbe.isThenable(t)?t.then(n=>(r(),n),n=>{throw e(n),r(),n}):(r(),t)}KA.handleCallbackErrors=Gbe});var xY=h(Gs=>{Object.defineProperty(Gs,"__esModule",{value:!0});var JA=O(),Nbe=_t(),cd=mn(),qh=xn(),QA=zA(),PY=Xh(),eR=pr();function Vbe(t,e,r=()=>{},n=()=>{}){let s=qh.getCurrentHub(),i=cd.getCurrentScope(),o=i.getSpan(),a=Mh(t),c=tR(s,o,a);return i.setSpan(c),QA.handleCallbackErrors(()=>e(c),l=>{c&&c.setStatus("internal_error"),r(l,c)},()=>{c&&c.end(),i.setSpan(o),n()})}function kY(t,e){let r=Mh(t);return cd.withScope(t.scope,n=>{let s=qh.getCurrentHub(),i=n.getSpan(),o=tR(s,i,r);return n.setSpan(o),QA.handleCallbackErrors(()=>e(o),()=>{if(o){let{status:a}=eR.spanToJSON(o);(!a||a==="ok")&&o.setStatus("internal_error")}},()=>o&&o.end())})}var Hbe=kY;function Wbe(t,e){let r=Mh(t);return cd.withScope(t.scope,n=>{let s=qh.getCurrentHub(),i=n.getSpan(),o=tR(s,i,r);n.setSpan(o);function a(){o&&o.end()}return QA.handleCallbackErrors(()=>e(o,a),()=>{if(o&&o.isRecording()){let{status:c}=eR.spanToJSON(o);(!c||c==="ok")&&o.setStatus("internal_error")}})})}function Obe(t){if(!PY.hasTracingEnabled())return;let e=Mh(t),r=qh.getCurrentHub(),n=t.scope?t.scope.getSpan():FY();return n?n.startChild(e):r.startTransaction(e)}function FY(){return cd.getCurrentScope().getSpan()}function Pbe({sentryTrace:t,baggage:e},r){let n=cd.getCurrentScope(),{traceparentData:s,dynamicSamplingContext:i,propagationContext:o}=JA.tracingContextFromHeaders(t,e);n.setPropagationContext(o),Nbe.DEBUG_BUILD&&s&&JA.logger.log(`[Tracing] Continuing trace ${s.traceId}.`);let a={...s,metadata:JA.dropUndefinedKeys({dynamicSamplingContext:s&&!i?{}:i})};return r?r(a):a}function tR(t,e,r){if(PY.hasTracingEnabled())return e?e.startChild(r):t.startTransaction(r)}function Mh(t){if(t.startTime){let e={...t};return e.startTimestamp=eR.spanTimeInputToSeconds(t.startTime),delete e.startTime,e}return t}Gs.continueTrace=Pbe;Gs.getActiveSpan=FY;Gs.startActiveSpan=Hbe;Gs.startInactiveSpan=Obe;Gs.startSpan=kY;Gs.startSpanManual=Wbe;Gs.trace=Vbe});var LY=h(rR=>{Object.defineProperty(rR,"__esModule",{value:!0});var kbe=Oh();function Fbe(t,e,r){let n=kbe.getActiveTransaction();n&&n.setMeasurement(t,e,r)}rR.setMeasurement=Fbe});var nR=h(Kh=>{Object.defineProperty(Kh,"__esModule",{value:!0});var vc=O();function xbe(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function Lbe(t,e,r,n){let s=vc.getSdkMetadataForEnvelopeHeader(r),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!n&&e&&{dsn:vc.dsnToString(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return vc.createEnvelope(i,[o])}function Ube(t,e,r,n){let s=vc.getSdkMetadataForEnvelopeHeader(r),i=t.type&&t.type!=="replay_event"?t.type:"event";xbe(t,r&&r.sdk);let o=vc.createEventEnvelopeHeaders(t,s,n,e);delete t.sdkProcessingMetadata;let a=[{type:i},t];return vc.createEnvelope(o,[a])}Kh.createEventEnvelope=Ube;Kh.createSessionEnvelope=Lbe});var oR=h(iR=>{Object.defineProperty(iR,"__esModule",{value:!0});var Ybe=O(),Dbe=mn(),sR=class{constructor(e,r){this._client=e,this.flushTimeout=60,this._pendingAggregates={},this._isEnabled=!0,this._intervalId=setInterval(()=>this.flush(),this.flushTimeout*1e3),this._sessionAttrs=r}flush(){let e=this.getSessionAggregates();e.aggregates.length!==0&&(this._pendingAggregates={},this._client.sendSession(e))}getSessionAggregates(){let e=Object.keys(this._pendingAggregates).map(n=>this._pendingAggregates[parseInt(n)]),r={attrs:this._sessionAttrs,aggregates:e};return Ybe.dropUndefinedKeys(r)}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;let e=Dbe.getCurrentScope(),r=e.getRequestSession();r&&r.status&&(this._incrementSessionStatusCount(r.status,new Date),e.setRequestSession(void 0))}_incrementSessionStatusCount(e,r){let n=new Date(r).setSeconds(0,0);this._pendingAggregates[n]=this._pendingAggregates[n]||{};let s=this._pendingAggregates[n];switch(s.started||(s.started=new Date(n).toISOString()),e){case"errored":return s.errored=(s.errored||0)+1,s.errored;case"ok":return s.exited=(s.exited||0)+1,s.exited;default:return s.crashed=(s.crashed||0)+1,s.crashed}}};iR.SessionFlusher=sR});var Jh=h(zh=>{Object.defineProperty(zh,"__esModule",{value:!0});var aR=O(),Xbe="7";function UY(t){let e=t.protocol?`${t.protocol}:`:"",r=t.port?`:${t.port}`:"";return`${e}//${t.host}${r}${t.path?`/${t.path}`:""}/api/`}function $be(t){return`${UY(t)}${t.projectId}/envelope/`}function jbe(t,e){return aR.urlEncode({sentry_key:t.publicKey,sentry_version:Xbe,...e&&{sentry_client:`${e.name}/${e.version}`}})}function qbe(t,e={}){let r=typeof e=="string"?e:e.tunnel,n=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return r||`${$be(t)}?${jbe(t,n)}`}function Mbe(t,e){let r=aR.makeDsn(t);if(!r)return"";let n=`${UY(r)}embed/error-page/`,s=`dsn=${aR.dsnToString(r)}`;for(let i in e)if(i!=="dsn"&&i!=="onClose")if(i==="user"){let o=e.user;if(!o)continue;o.name&&(s+=`&name=${encodeURIComponent(o.name)}`),o.email&&(s+=`&email=${encodeURIComponent(o.email)}`)}else s+=`&${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`;return`${n}?${s}`}zh.getEnvelopeEndpointWithUrlEncodedAuth=qbe;zh.getReportDialogEndpoint=Mbe});var Ns=h(Zs=>{Object.defineProperty(Zs,"__esModule",{value:!0});var Qh=O(),cR=_t(),Kbe=$u(),zbe=mn(),Jbe=xn(),lR=[];function Qbe(t){let e={};return t.forEach(r=>{let{name:n}=r,s=e[n];s&&!s.isDefaultInstance&&r.isDefaultInstance||(e[n]=r)}),Object.keys(e).map(r=>e[r])}function eCe(t){let e=t.defaultIntegrations||[],r=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let n;Array.isArray(r)?n=[...e,...r]:typeof r=="function"?n=Qh.arrayify(r(e)):n=e;let s=Qbe(n),i=nCe(s,o=>o.name==="Debug");if(i!==-1){let[o]=s.splice(i,1);s.push(o)}return s}function tCe(t,e){let r={};return e.forEach(n=>{n&&YY(t,n,r)}),r}function YY(t,e,r){if(r[e.name]){cR.DEBUG_BUILD&&Qh.logger.log(`Integration skipped because it was already installed: ${e.name}`);return}if(r[e.name]=e,lR.indexOf(e.name)===-1&&(e.setupOnce(Kbe.addGlobalEventProcessor,Jbe.getCurrentHub),lR.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){let n=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>n(s,i,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){let n=e.processEvent.bind(e),s=Object.assign((i,o)=>n(i,o,t),{id:e.name});t.addEventProcessor(s)}cR.DEBUG_BUILD&&Qh.logger.log(`Integration installed: ${e.name}`)}function rCe(t){let e=zbe.getClient();if(!e||!e.addIntegration){cR.DEBUG_BUILD&&Qh.logger.warn(`Cannot add integration "${t.name}" because no SDK Client is available.`);return}e.addIntegration(t)}function nCe(t,e){for(let r=0;r<t.length;r++)if(e(t[r])===!0)return r;return-1}function sCe(t,e){return Object.assign(function(...n){return e(...n)},{id:t})}function iCe(t){return t}Zs.addIntegration=rCe;Zs.convertIntegrationFnToClass=sCe;Zs.defineIntegration=iCe;Zs.getIntegrationsToSetup=eCe;Zs.installedIntegrations=lR;Zs.setupIntegration=YY;Zs.setupIntegrations=tCe});var _c=h(yn=>{Object.defineProperty(yn,"__esModule",{value:!0});var oCe="c",aCe="g",cCe="s",lCe="d",uCe=/[^a-zA-Z0-9_/.-]+/g,dCe=/[^\w\d_:/@.{}[\]$-]+/g,fCe=5e3,gCe=1e4,pCe=1e4;yn.COUNTER_METRIC_TYPE=oCe;yn.DEFAULT_BROWSER_FLUSH_INTERVAL=fCe;yn.DEFAULT_FLUSH_INTERVAL=gCe;yn.DISTRIBUTION_METRIC_TYPE=lCe;yn.GAUGE_METRIC_TYPE=aCe;yn.MAX_WEIGHT=pCe;yn.NAME_AND_TAG_KEY_NORMALIZATION_REGEX=uCe;yn.SET_METRIC_TYPE=cCe;yn.TAG_VALUE_NORMALIZATION_REGEX=dCe});var ld=h(Ac=>{Object.defineProperty(Ac,"__esModule",{value:!0});var hCe=O(),DY=_c();function mCe(t,e,r,n){let s=Object.entries(hCe.dropUndefinedKeys(n)).sort((i,o)=>i[0].localeCompare(o[0]));return`${t}${e}${r}${s}`}function yCe(t){let e=0;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);e=(e<<5)-e+n,e&=e}return e>>>0}function ICe(t){let e="";for(let r of t){let n=Object.entries(r.tags),s=n.length>0?`|#${n.map(([i,o])=>`${i}:${o}`).join(",")}`:"";e+=`${r.name}@${r.unit}:${r.metric}|${r.metricType}${s}|T${r.timestamp}
`}return e}function bCe(t){let e={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){let n=r.replace(DY.NAME_AND_TAG_KEY_NORMALIZATION_REGEX,"_");e[n]=String(t[r]).replace(DY.TAG_VALUE_NORMALIZATION_REGEX,"_")}return e}Ac.getBucketKey=mCe;Ac.sanitizeTags=bCe;Ac.serializeMetricBuckets=ICe;Ac.simpleHash=yCe});var $Y=h(uR=>{Object.defineProperty(uR,"__esModule",{value:!0});var XY=O(),CCe=ld();function SCe(t,e,r,n){let s={sent_at:new Date().toISOString()};r&&r.sdk&&(s.sdk={name:r.sdk.name,version:r.sdk.version}),n&&e&&(s.dsn=XY.dsnToString(e));let i=vCe(t);return XY.createEnvelope(s,[i])}function vCe(t){let e=CCe.serializeMetricBuckets(t);return[{type:"statsd",length:e.length},e]}uR.createMetricEnvelope=SCe});var fR=h(em=>{Object.defineProperty(em,"__esModule",{value:!0});var Ze=O(),_Ce=Jh(),Un=_t(),jY=nR(),ACe=mn(),RCe=xn(),qY=Ns(),ECe=$Y(),MY=fc(),wCe=mc(),BCe=wh(),KY="Not capturing exception because it's already been captured.",dR=class{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Ze.makeDsn(e.dsn):Un.DEBUG_BUILD&&Ze.logger.warn("No DSN provided, client will not send events."),this._dsn){let r=_Ce.getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:r})}}captureException(e,r,n){if(Ze.checkOrSetAlreadyCaught(e)){Un.DEBUG_BUILD&&Ze.logger.log(KY);return}let s=r&&r.event_id;return this._process(this.eventFromException(e,r).then(i=>this._captureEvent(i,r,n)).then(i=>{s=i})),s}captureMessage(e,r,n,s){let i=n&&n.event_id,o=Ze.isParameterizedString(e)?e:String(e),a=Ze.isPrimitive(e)?this.eventFromMessage(o,r,n):this.eventFromException(e,n);return this._process(a.then(c=>this._captureEvent(c,n,s)).then(c=>{i=c})),i}captureEvent(e,r,n){if(r&&r.originalException&&Ze.checkOrSetAlreadyCaught(r.originalException)){Un.DEBUG_BUILD&&Ze.logger.log(KY);return}let s=r&&r.event_id;return this._process(this._captureEvent(e,r,n).then(i=>{s=i})),s}captureSession(e){typeof e.release!="string"?Un.DEBUG_BUILD&&Ze.logger.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),MY.updateSession(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){let r=this._transport;return r?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(n=>r.flush(e).then(s=>n&&s))):Ze.resolvedSyncPromise(!0)}close(e){return this.flush(e).then(r=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),r))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return Un.DEBUG_BUILD&&Ze.logger.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){qY.setupIntegration(this,e,this._integrations)}sendEvent(e,r={}){this.emit("beforeSendEvent",e,r);let n=jY.createEventEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);for(let i of r.attachments||[])n=Ze.addItemToEnvelope(n,Ze.createAttachmentEnvelopeItem(i,this._options.transportOptions&&this._options.transportOptions.textEncoder));let s=this._sendEnvelope(n);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){let r=jY.createSessionEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(r)}recordDroppedEvent(e,r,n){if(this._options.sendClientReports){let s=`${e}:${r}`;Un.DEBUG_BUILD&&Ze.logger.log(`Adding outcome: "${s}"`),this._outcomes[s]=this._outcomes[s]+1||1}}captureAggregateMetrics(e){Un.DEBUG_BUILD&&Ze.logger.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);let r=ECe.createMetricEnvelope(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(r)}on(e,r){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(r)}emit(e,...r){this._hooks[e]&&this._hooks[e].forEach(n=>n(...r))}_setupIntegrations(){this._integrations=qY.setupIntegrations(this,this._options.integrations),this._integrationsInitialized=!0}_updateSessionFromEvent(e,r){let n=!1,s=!1,i=r.exception&&r.exception.values;if(i){s=!0;for(let c of i){let l=c.mechanism;if(l&&l.handled===!1){n=!0;break}}}let o=e.status==="ok";(o&&e.errors===0||o&&n)&&(MY.updateSession(e,{...n&&{status:"crashed"},errors:e.errors||Number(s||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Ze.SyncPromise(r=>{let n=0,s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),r(!0)):(n+=s,e&&n>=e&&(clearInterval(i),r(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,r,n,s=RCe.getIsolationScope()){let i=this.getOptions(),o=Object.keys(this._integrations);return!r.integrations&&o.length>0&&(r.integrations=o),this.emit("preprocessEvent",e,r),BCe.prepareEvent(i,e,r,n,this,s).then(a=>{if(a===null)return a;let{propagationContext:c}=a.sdkProcessingMetadata||{};if(!(a.contexts&&a.contexts.trace)&&c){let{traceId:u,spanId:d,parentSpanId:f,dsc:g}=c;a.contexts={trace:{trace_id:u,span_id:d,parent_span_id:f},...a.contexts};let p=g||wCe.getDynamicSamplingContextFromClient(u,this,n);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,r={},n){return this._processEvent(e,r,n).then(s=>s.event_id,s=>{if(Un.DEBUG_BUILD){let i=s;i.logLevel==="log"?Ze.logger.log(i.message):Ze.logger.warn(i)}})}_processEvent(e,r,n){let s=this.getOptions(),{sampleRate:i}=s,o=JY(e),a=zY(e),c=e.type||"error",l=`before send for type \`${c}\``;if(a&&typeof i=="number"&&Math.random()>i)return this.recordDroppedEvent("sample_rate","error",e),Ze.rejectedSyncPromise(new Ze.SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));let u=c==="replay_event"?"replay":c;return this._prepareEvent(e,r,n).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",u,e),new Ze.SentryError("An event processor returned `null`, will not send event.","log");if(r.data&&r.data.__sentry__===!0)return d;let g=GCe(s,d,r);return TCe(g,l)}).then(d=>{if(d===null)throw this.recordDroppedEvent("before_send",u,e),new Ze.SentryError(`${l} returned \`null\`, will not send event.`,"log");let f=n&&n.getSession();!o&&f&&this._updateSessionFromEvent(f,d);let g=d.transaction_info;if(o&&g&&d.transaction!==e.transaction){let p="custom";d.transaction_info={...g,source:p}}return this.sendEvent(d,r),d}).then(null,d=>{throw d instanceof Ze.SentryError?d:(this.captureException(d,{data:{__sentry__:!0},originalException:d}),new Ze.SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(e){this._numProcessing++,e.then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,r=>{Un.DEBUG_BUILD&&Ze.logger.error("Error while sending event:",r)});Un.DEBUG_BUILD&&Ze.logger.error("Transport disabled")}_clearOutcomes(){let e=this._outcomes;return this._outcomes={},Object.keys(e).map(r=>{let[n,s]=r.split(":");return{reason:n,category:s,quantity:e[r]}})}};function TCe(t,e){let r=`${e} must return \`null\` or a valid event.`;if(Ze.isThenable(t))return t.then(n=>{if(!Ze.isPlainObject(n)&&n!==null)throw new Ze.SentryError(r);return n},n=>{throw new Ze.SentryError(`${e} rejected with ${n}`)});if(!Ze.isPlainObject(t)&&t!==null)throw new Ze.SentryError(r);return t}function GCe(t,e,r){let{beforeSend:n,beforeSendTransaction:s}=t;return zY(e)&&n?n(e,r):JY(e)&&s?s(e,r):e}function zY(t){return t.type===void 0}function JY(t){return t.type==="transaction"}function ZCe(t){let e=ACe.getClient();!e||!e.addEventProcessor||e.addEventProcessor(t)}em.BaseClient=dR;em.addEventProcessor=ZCe});var hR=h(pR=>{Object.defineProperty(pR,"__esModule",{value:!0});var gR=O();function NCe(t,e,r,n,s){let i={sent_at:new Date().toISOString()};r&&r.sdk&&(i.sdk={name:r.sdk.name,version:r.sdk.version}),n&&s&&(i.dsn=gR.dsnToString(s)),e&&(i.trace=gR.dropUndefinedKeys(e));let o=VCe(t);return gR.createEnvelope(i,[o])}function VCe(t){return[{type:"check_in"},t]}pR.createCheckInEnvelope=NCe});var mR=h(Bo=>{Object.defineProperty(Bo,"__esModule",{value:!0});var tm=_c(),HCe=ld(),rm=class{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}},nm=class{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}},sm=class{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}},im=class{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map(e=>typeof e=="string"?HCe.simpleHash(e):e).join(":")}},WCe={[tm.COUNTER_METRIC_TYPE]:rm,[tm.GAUGE_METRIC_TYPE]:nm,[tm.DISTRIBUTION_METRIC_TYPE]:sm,[tm.SET_METRIC_TYPE]:im};Bo.CounterMetric=rm;Bo.DistributionMetric=sm;Bo.GaugeMetric=nm;Bo.METRIC_MAP=WCe;Bo.SetMetric=im});var tD=h(IR=>{Object.defineProperty(IR,"__esModule",{value:!0});var QY=O(),ud=_c(),OCe=mR(),eD=ld(),yR=class{constructor(e){this._client=e,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval(()=>this._flush(),ud.DEFAULT_FLUSH_INTERVAL),this._flushShift=Math.floor(Math.random()*ud.DEFAULT_FLUSH_INTERVAL/1e3),this._forceFlush=!1}add(e,r,n,s="none",i={},o=QY.timestampInSeconds()){let a=Math.floor(o),c=r.replace(ud.NAME_AND_TAG_KEY_NORMALIZATION_REGEX,"_"),l=eD.sanitizeTags(i),u=eD.getBucketKey(e,c,s,l),d=this._buckets.get(u);d?(d.metric.add(n),d.timestamp<a&&(d.timestamp=a)):(d={metric:new OCe.METRIC_MAP[e](n),timestamp:a,metricType:e,name:c,unit:s,tags:l},this._buckets.set(u,d)),this._bucketsTotalWeight+=d.metric.weight,this._bucketsTotalWeight>=ud.MAX_WEIGHT&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush){this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),this._buckets.clear();return}let e=Math.floor(QY.timestampInSeconds())-ud.DEFAULT_FLUSH_INTERVAL/1e3-this._flushShift,r=new Map;for(let[n,s]of this._buckets)s.timestamp<=e&&(r.set(n,s),this._bucketsTotalWeight-=s.metric.weight);for(let[n]of r)this._buckets.delete(n);this._captureMetrics(r)}_captureMetrics(e){if(e.size>0&&this._client.captureAggregateMetrics){let r=Array.from(e).map(([,n])=>n);this._client.captureAggregateMetrics(r)}}};IR.MetricsAggregator=yR});var nD=h(CR=>{Object.defineProperty(CR,"__esModule",{value:!0});var Vs=O(),PCe=fR(),kCe=hR(),om=_t(),FCe=mn(),xCe=tD(),LCe=oR(),UCe=qA(),YCe=pr(),DCe=hc(),rD=mc();MA();var bR=class extends PCe.BaseClient{constructor(e){UCe.addTracingExtensions(),super(e),e._experiments&&e._experiments.metricsAggregator&&(this.metricsAggregator=new xCe.MetricsAggregator(this))}eventFromException(e,r){return Vs.resolvedSyncPromise(Vs.eventFromUnknownInput(FCe.getClient(),this._options.stackParser,e,r))}eventFromMessage(e,r="info",n){return Vs.resolvedSyncPromise(Vs.eventFromMessage(this._options.stackParser,e,r,n,this._options.attachStacktrace))}captureException(e,r,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n){let s=n.getRequestSession();s&&s.status==="ok"&&(s.status="errored")}return super.captureException(e,r,n)}captureEvent(e,r,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n&&(e.type||"exception")==="exception"&&e.exception&&e.exception.values&&e.exception.values.length>0){let o=n.getRequestSession();o&&o.status==="ok"&&(o.status="errored")}return super.captureEvent(e,r,n)}close(e){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(e)}initSessionFlusher(){let{release:e,environment:r}=this._options;e?this._sessionFlusher=new LCe.SessionFlusher(this,{release:e,environment:r}):om.DEBUG_BUILD&&Vs.logger.warn("Cannot initialise an instance of SessionFlusher if no release is provided!")}captureCheckIn(e,r,n){let s="checkInId"in e&&e.checkInId?e.checkInId:Vs.uuid4();if(!this._isEnabled())return om.DEBUG_BUILD&&Vs.logger.warn("SDK not enabled, will not capture checkin."),s;let i=this.getOptions(),{release:o,environment:a,tunnel:c}=i,l={check_in_id:s,monitor_slug:e.monitorSlug,status:e.status,release:o,environment:a};"duration"in e&&(l.duration=e.duration),r&&(l.monitor_config={schedule:r.schedule,checkin_margin:r.checkinMargin,max_runtime:r.maxRuntime,timezone:r.timezone});let[u,d]=this._getTraceInfoFromScope(n);d&&(l.contexts={trace:d});let f=kCe.createCheckInEnvelope(l,u,this.getSdkMetadata(),c,this.getDsn());return om.DEBUG_BUILD&&Vs.logger.info("Sending checkin:",e.monitorSlug,e.status),this._sendEnvelope(f),s}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():om.DEBUG_BUILD&&Vs.logger.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(e,r,n,s){return this._options.platform&&(e.platform=e.platform||this._options.platform),this._options.runtime&&(e.contexts={...e.contexts,runtime:(e.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(e.server_name=e.server_name||this._options.serverName),super._prepareEvent(e,r,n,s)}_getTraceInfoFromScope(e){if(!e)return[void 0,void 0];let r=e.getSpan();if(r)return[DCe.getRootSpan(r)?rD.getDynamicSamplingContextFromSpan(r):void 0,YCe.spanToTraceContext(r)];let{traceId:n,spanId:s,parentSpanId:i,dsc:o}=e.getPropagationContext(),a={trace_id:n,span_id:s,parent_span_id:i};return o?[o,a]:[rD.getDynamicSamplingContextFromClient(n,this,e),a]}};CR.ServerRuntimeClient=bR});var oD=h(am=>{Object.defineProperty(am,"__esModule",{value:!0});var sD=O(),XCe=_t(),$Ce=mn(),jCe=xn();function qCe(t,e){e.debug===!0&&(XCe.DEBUG_BUILD?sD.logger.enable():sD.consoleSandbox(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),$Ce.getCurrentScope().update(e.initialScope);let n=new t(e);iD(n),MCe(n)}function iD(t){let r=jCe.getCurrentHub().getStackTop();r.client=t,r.scope.setClient(t)}function MCe(t){t.init?t.init():t.setupIntegrations&&t.setupIntegrations()}am.initAndBind=qCe;am.setCurrentClient=iD});var uD=h(cm=>{Object.defineProperty(cm,"__esModule",{value:!0});var mr=O(),aD=_t(),lD=30;function KCe(t,e,r=mr.makePromiseBuffer(t.bufferSize||lD)){let n={},s=o=>r.drain(o);function i(o){let a=[];if(mr.forEachEnvelopeItem(o,(d,f)=>{let g=mr.envelopeItemTypeToDataCategory(f);if(mr.isRateLimited(n,g)){let p=cD(d,f);t.recordDroppedEvent("ratelimit_backoff",g,p)}else a.push(d)}),a.length===0)return mr.resolvedSyncPromise();let c=mr.createEnvelope(o[0],a),l=d=>{mr.forEachEnvelopeItem(c,(f,g)=>{let p=cD(f,g);t.recordDroppedEvent(d,mr.envelopeItemTypeToDataCategory(g),p)})},u=()=>e({body:mr.serializeEnvelope(c,t.textEncoder)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&aD.DEBUG_BUILD&&mr.logger.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),n=mr.updateRateLimits(n,d),d),d=>{throw l("network_error"),d});return r.add(u).then(d=>d,d=>{if(d instanceof mr.SentryError)return aD.DEBUG_BUILD&&mr.logger.error("Skipped sending event because buffer is full."),l("queue_overflow"),mr.resolvedSyncPromise();throw d})}return i.__sentry__baseTransport__=!0,{send:i,flush:s}}function cD(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}cm.DEFAULT_TRANSPORT_BUFFER_SIZE=lD;cm.createTransport=KCe});var fD=h(dd=>{Object.defineProperty(dd,"__esModule",{value:!0});var vR=O(),zCe=_t(),dD=100,_R=5e3,JCe=36e5;function SR(t,e){zCe.DEBUG_BUILD&&vR.logger.info(`[Offline]: ${t}`,e)}function QCe(t){return e=>{let r=t(e),n=e.createStore?e.createStore(e):void 0,s=_R,i;function o(u,d,f){return vR.envelopeContainsItemType(u,["replay_event","replay_recording","client_report"])?!1:e.shouldStore?e.shouldStore(u,d,f):!0}function a(u){n&&(i&&clearTimeout(i),i=setTimeout(async()=>{i=void 0;let d=await n.pop();d&&(SR("Attempting to send previously queued event"),l(d).catch(f=>{SR("Failed to retry sending",f)}))},u),typeof i!="number"&&i.unref&&i.unref())}function c(){i||(a(s),s=Math.min(s*2,JCe))}async function l(u){try{let d=await r.send(u),f=dD;if(d){if(d.headers&&d.headers["retry-after"])f=vR.parseRetryAfterHeader(d.headers["retry-after"]);else if((d.statusCode||0)>=400)return d}return a(f),s=_R,d}catch(d){if(n&&await o(u,d,s))return await n.insert(u),c(),SR("Error sending. Event queued",d),{};throw d}}return e.flushAtStartup&&c(),{send:l,flush:u=>r.flush(u)}}}dd.MIN_DELAY=dD;dd.START_DELAY=_R;dd.makeOfflineTransport=QCe});var pD=h(lm=>{Object.defineProperty(lm,"__esModule",{value:!0});var gD=O(),e0e=Jh();function AR(t,e){let r;return gD.forEachEnvelopeItem(t,(n,s)=>(e.includes(s)&&(r=Array.isArray(n)?n[1]:void 0),!!r)),r}function t0e(t,e){return r=>{let n=t(r);return{send:async s=>{let i=AR(s,["event","transaction","profile","replay_event"]);return i&&(i.release=e),n.send(s)},flush:s=>n.flush(s)}}}function r0e(t,e){return r=>{let n=t(r),s={};function i(c,l){let u=l?`${c}:${l}`:c;if(!s[u]){let d=gD.dsnFromString(c);if(!d)return;let f=e0e.getEnvelopeEndpointWithUrlEncodedAuth(d);s[u]=l?t0e(t,l)({...r,url:f}):t({...r,url:f})}return s[u]}async function o(c){function l(f){let g=f&&f.length?f:["event"];return AR(c,g)}let u=e({envelope:c,getEvent:l}).map(f=>typeof f=="string"?i(f,void 0):i(f.dsn,f.release)).filter(f=>!!f);return u.length===0&&u.push(n),(await Promise.all(u.map(f=>f.send(c))))[0]}async function a(c){let l=[...Object.keys(s).map(d=>s[d]),n];return(await Promise.all(l.map(d=>d.flush(c)))).every(d=>d)}return{send:o,flush:a}}}lm.eventFromEnvelope=AR;lm.makeMultiplexedTransport=r0e});var mD=h(RR=>{Object.defineProperty(RR,"__esModule",{value:!0});function n0e(t,e){let r=e&&o0e(e)?e.getClient():e,n=r&&r.getDsn(),s=r&&r.getOptions().tunnel;return i0e(t,n)||s0e(t,s)}function s0e(t,e){return e?hD(t)===hD(e):!1}function i0e(t,e){return e?t.includes(e.host):!1}function hD(t){return t[t.length-1]==="/"?t.slice(0,-1):t}function o0e(t){return t.getClient!==void 0}RR.isSentryRequestUrl=n0e});var CD=h(fd=>{Object.defineProperty(fd,"__esModule",{value:!0});var ER=O(),ID=new Map,yD=new Set;function a0e(t){if(ER.GLOBAL_OBJ._sentryModuleMetadata)for(let e of Object.keys(ER.GLOBAL_OBJ._sentryModuleMetadata)){let r=ER.GLOBAL_OBJ._sentryModuleMetadata[e];if(yD.has(e))continue;yD.add(e);let n=t(e);for(let s of n.reverse())if(s.filename){ID.set(s.filename,r);break}}}function bD(t,e){return a0e(t),ID.get(e)}function c0e(t,e){try{e.exception.values.forEach(r=>{if(r.stacktrace)for(let n of r.stacktrace.frames||[]){if(!n.filename)continue;let s=bD(t,n.filename);s&&(n.module_metadata=s)}})}catch{}}function l0e(t){try{t.exception.values.forEach(e=>{if(e.stacktrace)for(let r of e.stacktrace.frames||[])delete r.module_metadata})}catch{}}fd.addMetadataToStackFrames=c0e;fd.getMetadataForUrl=bD;fd.stripMetadataFromStackFrames=l0e});var RD=h(um=>{Object.defineProperty(um,"__esModule",{value:!0});var u0e=O(),vD=Ns(),SD=CD(),_D="ModuleMetadata",d0e=()=>({name:_D,setupOnce(){},setup(t){typeof t.on=="function"&&t.on("beforeEnvelope",e=>{u0e.forEachEnvelopeItem(e,(r,n)=>{if(n==="event"){let s=Array.isArray(r)?r[1]:void 0;s&&(SD.stripMetadataFromStackFrames(s),r[1]=s)}})})},processEvent(t,e,r){let n=r.getOptions().stackParser;return SD.addMetadataToStackFrames(n,t),t}}),AD=vD.defineIntegration(d0e),f0e=vD.convertIntegrationFnToClass(_D,AD);um.ModuleMetadata=f0e;um.moduleMetadataIntegration=AD});var GD=h(dm=>{Object.defineProperty(dm,"__esModule",{value:!0});var ED=O(),wD=Ns(),g0e=pr(),wR={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},BD="RequestData",p0e=(t={})=>{let e=ED.addRequestDataToEvent,r={...wR,...t,include:{method:!0,...wR.include,...t.include,user:t.include&&typeof t.include.user=="boolean"?t.include.user:{...wR.include.user,...(t.include||{}).user}}};return{name:BD,setupOnce(){},processEvent(n,s,i){let{transactionNamingScheme:o}=r,{sdkProcessingMetadata:a={}}=n,c=a.request;if(!c)return n;let l=a.requestDataOptionsFromExpressHandler||a.requestDataOptionsFromGCPWrapper||m0e(r),u=e(n,c,l);if(n.type==="transaction"||o==="handler")return u;let f=c._sentryTransaction;if(f){let g=g0e.spanToJSON(f).description||"",p=y0e(i)==="sentry.javascript.nextjs"?g.startsWith("/api"):o!=="path",[m]=ED.extractPathForTransaction(c,{path:!0,method:p,customRoute:g});u.transaction=m}return u}}},TD=wD.defineIntegration(p0e),h0e=wD.convertIntegrationFnToClass(BD,TD);function m0e(t){let{transactionNamingScheme:e,include:{ip:r,user:n,...s}}=t,i=[];for(let[a,c]of Object.entries(s))c&&i.push(a);let o;if(n===void 0)o=!0;else if(typeof n=="boolean")o=n;else{let a=[];for(let[c,l]of Object.entries(n))l&&a.push(c);o=a}return{include:{ip:r,user:o,request:i.length!==0?i:void 0,transaction:e}}}function y0e(t){try{return t.getOptions()._metadata.sdk.name}catch{return}}dm.RequestData=h0e;dm.requestDataIntegration=TD});var BR=h(gm=>{Object.defineProperty(gm,"__esModule",{value:!0});var Ht=O(),To=_t(),ZD=Ns(),I0e=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],b0e=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],ND="InboundFilters",C0e=(t={})=>({name:ND,setupOnce(){},processEvent(e,r,n){let s=n.getOptions(),i=v0e(t,s);return _0e(e,i)?null:e}}),VD=ZD.defineIntegration(C0e),S0e=ZD.convertIntegrationFnToClass(ND,VD);function v0e(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:I0e],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:b0e],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function _0e(t,e){return e.ignoreInternal&&T0e(t)?(To.DEBUG_BUILD&&Ht.logger.warn(`Event dropped due to being internal Sentry Error.
Event: ${Ht.getEventDescription(t)}`),!0):A0e(t,e.ignoreErrors)?(To.DEBUG_BUILD&&Ht.logger.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Ht.getEventDescription(t)}`),!0):R0e(t,e.ignoreTransactions)?(To.DEBUG_BUILD&&Ht.logger.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Ht.getEventDescription(t)}`),!0):E0e(t,e.denyUrls)?(To.DEBUG_BUILD&&Ht.logger.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Ht.getEventDescription(t)}.
Url: ${fm(t)}`),!0):w0e(t,e.allowUrls)?!1:(To.DEBUG_BUILD&&Ht.logger.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Ht.getEventDescription(t)}.
Url: ${fm(t)}`),!0)}function A0e(t,e){return t.type||!e||!e.length?!1:B0e(t).some(r=>Ht.stringMatchesSomePattern(r,e))}function R0e(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;let r=t.transaction;return r?Ht.stringMatchesSomePattern(r,e):!1}function E0e(t,e){if(!e||!e.length)return!1;let r=fm(t);return r?Ht.stringMatchesSomePattern(r,e):!1}function w0e(t,e){if(!e||!e.length)return!0;let r=fm(t);return r?Ht.stringMatchesSomePattern(r,e):!0}function B0e(t){let e=[];t.message&&e.push(t.message);let r;try{r=t.exception.values[t.exception.values.length-1]}catch{}return r&&r.value&&(e.push(r.value),r.type&&e.push(`${r.type}: ${r.value}`)),To.DEBUG_BUILD&&e.length===0&&Ht.logger.error(`Could not extract message for event ${Ht.getEventDescription(t)}`),e}function T0e(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function G0e(t=[]){for(let e=t.length-1;e>=0;e--){let r=t[e];if(r&&r.filename!=="<anonymous>"&&r.filename!=="[native code]")return r.filename||null}return null}function fm(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?G0e(e):null}catch{return To.DEBUG_BUILD&&Ht.logger.error(`Cannot extract url for event ${Ht.getEventDescription(t)}`),null}}gm.InboundFilters=S0e;gm.inboundFiltersIntegration=VD});var TR=h(pm=>{Object.defineProperty(pm,"__esModule",{value:!0});var Z0e=O(),WD=Ns(),HD,OD="FunctionToString",N0e=()=>({name:OD,setupOnce(){HD=Function.prototype.toString;try{Function.prototype.toString=function(...t){let e=Z0e.getOriginalFunction(this)||this;return HD.apply(e,t)}}catch{}}}),PD=WD.defineIntegration(N0e),V0e=WD.convertIntegrationFnToClass(OD,PD);pm.FunctionToString=V0e;pm.functionToStringIntegration=PD});var GR=h(hm=>{Object.defineProperty(hm,"__esModule",{value:!0});var kD=O(),FD=Ns(),H0e="cause",W0e=5,xD="LinkedErrors",O0e=(t={})=>{let e=t.limit||W0e,r=t.key||H0e;return{name:xD,setupOnce(){},preprocessEvent(n,s,i){let o=i.getOptions();kD.applyAggregateErrorsToEvent(kD.exceptionFromError,o.stackParser,o.maxValueLength,r,e,n,s)}}},LD=FD.defineIntegration(O0e),P0e=FD.convertIntegrationFnToClass(xD,LD);hm.LinkedErrors=P0e;hm.linkedErrorsIntegration=LD});var UD=h(gd=>{Object.defineProperty(gd,"__esModule",{value:!0});var k0e=TR(),F0e=BR(),x0e=GR();gd.FunctionToString=k0e.FunctionToString;gd.InboundFilters=F0e.InboundFilters;gd.LinkedErrors=x0e.LinkedErrors});var XD=h(NR=>{Object.defineProperty(NR,"__esModule",{value:!0});var L0e=O(),YD=_c(),U0e=mR(),DD=ld(),ZR=class{constructor(e){this._client=e,this._buckets=new Map,this._interval=setInterval(()=>this.flush(),YD.DEFAULT_BROWSER_FLUSH_INTERVAL)}add(e,r,n,s="none",i={},o=L0e.timestampInSeconds()){let a=Math.floor(o),c=r.replace(YD.NAME_AND_TAG_KEY_NORMALIZATION_REGEX,"_"),l=DD.sanitizeTags(i),u=DD.getBucketKey(e,c,s,l),d=this._buckets.get(u);d?(d.metric.add(n),d.timestamp<a&&(d.timestamp=a)):this._buckets.set(u,{metric:new U0e.METRIC_MAP[e](n),timestamp:a,metricType:e,name:c,unit:s,tags:l})}flush(){if(this._buckets.size!==0){if(this._client.captureAggregateMetrics){let e=Array.from(this._buckets).map(([,r])=>r);this._client.captureAggregateMetrics(e)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}};NR.BrowserMetricsAggregator=ZR});var MD=h(mm=>{Object.defineProperty(mm,"__esModule",{value:!0});var $D=Ns(),Y0e=XD(),jD="MetricsAggregator",D0e=()=>({name:jD,setupOnce(){},setup(t){t.metricsAggregator=new Y0e.BrowserMetricsAggregator(t)}}),qD=$D.defineIntegration(D0e),X0e=$D.convertIntegrationFnToClass(jD,qD);mm.MetricsAggregator=X0e;mm.metricsAggregatorIntegration=qD});var sX=h(Go=>{Object.defineProperty(Go,"__esModule",{value:!0});var KD=O(),zD=_t(),JD=mn(),$0e=pr(),ym=_c(),QD=MD();function Im(t,e,r,n={}){let s=JD.getClient(),i=JD.getCurrentScope();if(s){if(!s.metricsAggregator){zD.DEBUG_BUILD&&KD.logger.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs");return}let{unit:o,tags:a,timestamp:c}=n,{release:l,environment:u}=s.getOptions(),d=i.getTransaction(),f={};l&&(f.release=l),u&&(f.environment=u),d&&(f.transaction=$0e.spanToJSON(d).description||""),zD.DEBUG_BUILD&&KD.logger.log(`Adding value of ${r} to ${t} metric ${e}`),s.metricsAggregator.add(t,e,r,o,{...f,...a},c)}}function eX(t,e=1,r){Im(ym.COUNTER_METRIC_TYPE,t,e,r)}function tX(t,e,r){Im(ym.DISTRIBUTION_METRIC_TYPE,t,e,r)}function rX(t,e,r){Im(ym.SET_METRIC_TYPE,t,e,r)}function nX(t,e,r){Im(ym.GAUGE_METRIC_TYPE,t,e,r)}var j0e={increment:eX,distribution:tX,set:rX,gauge:nX,MetricsAggregator:QD.MetricsAggregator,metricsAggregatorIntegration:QD.metricsAggregatorIntegration};Go.distribution=tX;Go.gauge=nX;Go.increment=eX;Go.metrics=j0e;Go.set=rX});var ge=h(k=>{Object.defineProperty(k,"__esModule",{value:!0});var iX=qA(),oX=XA(),aX=kh(),q0e=Lh(),cX=Oh(),M0e=MA(),Zo=xY(),lX=mc(),K0e=LY(),VR=rd(),uX=nR(),Ke=mn(),Yn=xn(),HR=fc(),z0e=oR(),WR=Th(),dX=$u(),fX=Jh(),gX=fR(),J0e=nD(),pX=oD(),Q0e=uD(),eSe=fD(),tSe=pD(),rSe=VA(),bm=Ns(),hX=Bh(),nSe=wh(),sSe=hR(),iSe=Xh(),oSe=mD(),aSe=zA(),OR=pr(),cSe=hc(),lSe=dc(),mX=RD(),yX=GD(),IX=BR(),bX=TR(),CX=GR(),uSe=UD(),dSe=sX(),fSe=uSe;k.addTracingExtensions=iX.addTracingExtensions;k.startIdleTransaction=iX.startIdleTransaction;k.IdleTransaction=oX.IdleTransaction;k.TRACING_DEFAULTS=oX.TRACING_DEFAULTS;k.Span=aX.Span;k.spanStatusfromHttpCode=aX.spanStatusfromHttpCode;k.Transaction=q0e.Transaction;k.extractTraceparentData=cX.extractTraceparentData;k.getActiveTransaction=cX.getActiveTransaction;Object.defineProperty(k,"SpanStatus",{enumerable:!0,get:()=>M0e.SpanStatus});k.continueTrace=Zo.continueTrace;k.getActiveSpan=Zo.getActiveSpan;k.startActiveSpan=Zo.startActiveSpan;k.startInactiveSpan=Zo.startInactiveSpan;k.startSpan=Zo.startSpan;k.startSpanManual=Zo.startSpanManual;k.trace=Zo.trace;k.getDynamicSamplingContextFromClient=lX.getDynamicSamplingContextFromClient;k.getDynamicSamplingContextFromSpan=lX.getDynamicSamplingContextFromSpan;k.setMeasurement=K0e.setMeasurement;k.SEMANTIC_ATTRIBUTE_SENTRY_OP=VR.SEMANTIC_ATTRIBUTE_SENTRY_OP;k.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=VR.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;k.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=VR.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;k.createEventEnvelope=uX.createEventEnvelope;k.createSessionEnvelope=uX.createSessionEnvelope;k.addBreadcrumb=Ke.addBreadcrumb;k.captureCheckIn=Ke.captureCheckIn;k.captureEvent=Ke.captureEvent;k.captureException=Ke.captureException;k.captureMessage=Ke.captureMessage;k.captureSession=Ke.captureSession;k.close=Ke.close;k.configureScope=Ke.configureScope;k.endSession=Ke.endSession;k.flush=Ke.flush;k.getClient=Ke.getClient;k.getCurrentScope=Ke.getCurrentScope;k.lastEventId=Ke.lastEventId;k.setContext=Ke.setContext;k.setExtra=Ke.setExtra;k.setExtras=Ke.setExtras;k.setTag=Ke.setTag;k.setTags=Ke.setTags;k.setUser=Ke.setUser;k.startSession=Ke.startSession;k.startTransaction=Ke.startTransaction;k.withActiveSpan=Ke.withActiveSpan;k.withIsolationScope=Ke.withIsolationScope;k.withMonitor=Ke.withMonitor;k.withScope=Ke.withScope;k.Hub=Yn.Hub;k.ensureHubOnCarrier=Yn.ensureHubOnCarrier;k.getCurrentHub=Yn.getCurrentHub;k.getHubFromCarrier=Yn.getHubFromCarrier;k.getIsolationScope=Yn.getIsolationScope;k.getMainCarrier=Yn.getMainCarrier;k.makeMain=Yn.makeMain;k.runWithAsyncContext=Yn.runWithAsyncContext;k.setAsyncContextStrategy=Yn.setAsyncContextStrategy;k.setHubOnCarrier=Yn.setHubOnCarrier;k.closeSession=HR.closeSession;k.makeSession=HR.makeSession;k.updateSession=HR.updateSession;k.SessionFlusher=z0e.SessionFlusher;k.Scope=WR.Scope;k.getGlobalScope=WR.getGlobalScope;k.setGlobalScope=WR.setGlobalScope;k.addGlobalEventProcessor=dX.addGlobalEventProcessor;k.notifyEventProcessors=dX.notifyEventProcessors;k.getEnvelopeEndpointWithUrlEncodedAuth=fX.getEnvelopeEndpointWithUrlEncodedAuth;k.getReportDialogEndpoint=fX.getReportDialogEndpoint;k.BaseClient=gX.BaseClient;k.addEventProcessor=gX.addEventProcessor;k.ServerRuntimeClient=J0e.ServerRuntimeClient;k.initAndBind=pX.initAndBind;k.setCurrentClient=pX.setCurrentClient;k.createTransport=Q0e.createTransport;k.makeOfflineTransport=eSe.makeOfflineTransport;k.makeMultiplexedTransport=tSe.makeMultiplexedTransport;k.SDK_VERSION=rSe.SDK_VERSION;k.addIntegration=bm.addIntegration;k.convertIntegrationFnToClass=bm.convertIntegrationFnToClass;k.defineIntegration=bm.defineIntegration;k.getIntegrationsToSetup=bm.getIntegrationsToSetup;k.applyScopeDataToEvent=hX.applyScopeDataToEvent;k.mergeScopeData=hX.mergeScopeData;k.prepareEvent=nSe.prepareEvent;k.createCheckInEnvelope=sSe.createCheckInEnvelope;k.hasTracingEnabled=iSe.hasTracingEnabled;k.isSentryRequestUrl=oSe.isSentryRequestUrl;k.handleCallbackErrors=aSe.handleCallbackErrors;k.spanIsSampled=OR.spanIsSampled;k.spanToJSON=OR.spanToJSON;k.spanToTraceHeader=OR.spanToTraceHeader;k.getRootSpan=cSe.getRootSpan;k.DEFAULT_ENVIRONMENT=lSe.DEFAULT_ENVIRONMENT;k.ModuleMetadata=mX.ModuleMetadata;k.moduleMetadataIntegration=mX.moduleMetadataIntegration;k.RequestData=yX.RequestData;k.requestDataIntegration=yX.requestDataIntegration;k.InboundFilters=IX.InboundFilters;k.inboundFiltersIntegration=IX.inboundFiltersIntegration;k.FunctionToString=bX.FunctionToString;k.functionToStringIntegration=bX.functionToStringIntegration;k.LinkedErrors=CX.LinkedErrors;k.linkedErrorsIntegration=CX.linkedErrorsIntegration;k.metrics=dSe.metrics;k.Integrations=fSe});var Tr=h(PR=>{Object.defineProperty(PR,"__esModule",{value:!0});var gSe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;PR.DEBUG_BUILD=gSe});var Bi=h(kR=>{var{_optionalChain:SX}=O();Object.defineProperty(kR,"__esModule",{value:!0});function pSe(t){let e=SX([t,"call",n=>n(),"access",n=>n.getClient,"call",n=>n(),"optionalAccess",n=>n.getOptions,"call",n=>n()]);return(SX([e,"optionalAccess",n=>n.instrumenter])||"sentry")!=="sentry"}kR.shouldDisableAutoInstrumentation=pSe});var RX=h(pd=>{var{_optionalChain:Dn}=O();Object.defineProperty(pd,"__esModule",{value:!0});var FR=ge(),yr=O(),Cm=Tr(),hSe=Bi(),Sm=class t{static __initStatic(){this.id="Express"}constructor(e={}){this.name=t.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}setupOnce(e,r){if(!this._router){Cm.DEBUG_BUILD&&yr.logger.error("ExpressIntegration is missing an Express instance");return}if(hSe.shouldDisableAutoInstrumentation(r)){Cm.DEBUG_BUILD&&yr.logger.log("Express Integration is skipped because of instrumenter configuration.");return}ISe(this._router,this._methods),bSe(this._router)}};Sm.__initStatic();function vX(t,e){let r=t.length;switch(r){case 2:return function(n,s){let i=s.__sentry_transaction;if(i){let o=i.startChild({description:t.name,op:`middleware.express.${e}`,origin:"auto.middleware.express"});s.once("finish",()=>{o.end()})}return t.call(this,n,s)};case 3:return function(n,s,i){let o=s.__sentry_transaction,a=Dn([o,"optionalAccess",c=>c.startChild,"call",c=>c({description:t.name,op:`middleware.express.${e}`,origin:"auto.middleware.express"})]);t.call(this,n,s,function(...c){Dn([a,"optionalAccess",l=>l.end,"call",l=>l()]),i.call(this,...c)})};case 4:return function(n,s,i,o){let a=i.__sentry_transaction,c=Dn([a,"optionalAccess",l=>l.startChild,"call",l=>l({description:t.name,op:`middleware.express.${e}`,origin:"auto.middleware.express"})]);t.call(this,n,s,i,function(...l){Dn([c,"optionalAccess",u=>u.end,"call",u=>u()]),o.call(this,...l)})};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${r}`)}}function mSe(t,e){return t.map(r=>typeof r=="function"?vX(r,e):Array.isArray(r)?r.map(n=>typeof n=="function"?vX(n,e):n):r)}function ySe(t,e){let r=t[e];return t[e]=function(...n){return r.call(this,...mSe(n,e))},t}function ISe(t,e=[]){e.forEach(r=>ySe(t,r))}function bSe(t){let e="settings"in t;e&&t._router===void 0&&t.lazyrouter&&t.lazyrouter();let r=e?t._router:t;if(!r){Cm.DEBUG_BUILD&&yr.logger.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),Cm.DEBUG_BUILD&&yr.logger.debug("Routing instrumentation is currently only supported in Express 4.");return}let n=Object.getPrototypeOf(r),s=n.process_params;n.process_params=function(o,a,c,l,u){c._reconstructedRoute||(c._reconstructedRoute="");let{layerRoutePath:d,isRegex:f,isArray:g,numExtraSegments:p}=CSe(o);(d||f||g)&&(c._hasParameters=!0);let m;d?m=d:m=AX(c.originalUrl,c._reconstructedRoute,o.path)||"";let I=m.split("/").filter(b=>b.length>0&&(f||g||!b.includes("*"))).join("/");I&&I.length>0&&(c._reconstructedRoute+=`/${I}${f?"/":""}`);let C=yr.getNumberOfUrlSegments(yr.stripUrlQueryAndFragment(c.originalUrl||""))+p,S=yr.getNumberOfUrlSegments(c._reconstructedRoute);if(C===S){c._hasParameters||c._reconstructedRoute!==c.originalUrl&&(c._reconstructedRoute=c.originalUrl?yr.stripUrlQueryAndFragment(c.originalUrl):c.originalUrl);let b=l.__sentry_transaction,y=b&&FR.spanToJSON(b).data||{};if(b&&y[FR.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]!=="custom"){let A=c._reconstructedRoute||"/",[E,v]=yr.extractPathForTransaction(c,{path:!0,method:!0,customRoute:A});b.updateName(E),b.setAttribute(FR.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,v)}}return s.call(this,o,a,c,l,u)}}var _X=(t,e,r)=>{if(!t||!e||!r||Object.keys(r).length===0||!Dn([r,"access",l=>l[0],"optionalAccess",l=>l.offset]))return;let n=r.sort((l,u)=>l.offset-u.offset),i=new RegExp(e,`${e.flags}d`).exec(t);if(!i||!i.indices)return;let[,...o]=i.indices;if(o.length!==n.length)return;let a=t,c=0;return o.forEach((l,u)=>{if(l){let[d,f]=l,g=a.substring(0,d-c),p=`:${n[u].name}`,m=a.substring(f-c);a=g+p+m,c=c+(f-d-p.length)}}),a};function CSe(t){let e=Dn([t,"access",o=>o.route,"optionalAccess",o=>o.path]),r=yr.isRegExp(e),n=Array.isArray(e);if(!e){let[o]=yr.GLOBAL_OBJ.process.versions.node.split(".").map(Number);o>=16&&(e=_X(t.path,t.regexp,t.keys))}if(!e)return{isRegex:r,isArray:n,numExtraSegments:0};let s=n?Math.max(SSe(e)-yr.getNumberOfUrlSegments(t.path||""),0):0;return{layerRoutePath:vSe(n,e),isRegex:r,isArray:n,numExtraSegments:s}}function SSe(t){return t.reduce((e,r)=>e+yr.getNumberOfUrlSegments(r.toString()),0)}function vSe(t,e){return t?e.map(r=>r.toString()).join(","):e&&e.toString()}function AX(t,e,r){let n=yr.stripUrlQueryAndFragment(t||""),s=Dn([n,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>!!l)]),i=0,o=Dn([e,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>!!l),"access",c=>c.length])||0;return Dn([r,"optionalAccess",c=>c.split,"call",c=>c("/"),"access",c=>c.filter,"call",c=>c(l=>Dn([s,"optionalAccess",u=>u[o+i]])===l?(i+=1,!0):!1),"access",c=>c.join,"call",c=>c("/")])}pd.Express=Sm;pd.extractOriginalRoute=_X;pd.preventDuplicateSegments=AX});var EX=h(LR=>{var{_optionalChain:Rc}=O();Object.defineProperty(LR,"__esModule",{value:!0});var Ec=O(),xR=Tr(),_Se=Bi(),vm=class t{static __initStatic(){this.id="Postgres"}constructor(e={}){this.name=t.id,this._usePgNative=!!e.usePgNative,this._module=e.module}loadDependency(){return this._module=this._module||Ec.loadModule("pg")}setupOnce(e,r){if(_Se.shouldDisableAutoInstrumentation(r)){xR.DEBUG_BUILD&&Ec.logger.log("Postgres Integration is skipped because of instrumenter configuration.");return}let n=this.loadDependency();if(!n){xR.DEBUG_BUILD&&Ec.logger.error("Postgres Integration was unable to require `pg` package.");return}let s=this._usePgNative?Rc([n,"access",i=>i.native,"optionalAccess",i=>i.Client]):n.Client;if(!s){xR.DEBUG_BUILD&&Ec.logger.error("Postgres Integration was unable to access 'pg-native' bindings.");return}Ec.fill(s.prototype,"query",function(i){return function(o,a,c){let u=r().getScope().getSpan(),d={"db.system":"postgresql"};try{this.database&&(d["db.name"]=this.database),this.host&&(d["server.address"]=this.host),this.port&&(d["server.port"]=this.port),this.user&&(d["db.user"]=this.user)}catch{}let f=Rc([u,"optionalAccess",p=>p.startChild,"call",p=>p({description:typeof o=="string"?o:o.text,op:"db",origin:"auto.db.postgres",data:d})]);if(typeof c=="function")return i.call(this,o,a,function(p,m){Rc([f,"optionalAccess",I=>I.end,"call",I=>I()]),c(p,m)});if(typeof a=="function")return i.call(this,o,function(p,m){Rc([f,"optionalAccess",I=>I.end,"call",I=>I()]),a(p,m)});let g=typeof a<"u"?i.call(this,o,a):i.call(this,o);return Ec.isThenable(g)?g.then(p=>(Rc([f,"optionalAccess",m=>m.end,"call",m=>m()]),p)):(Rc([f,"optionalAccess",p=>p.end,"call",p=>p()]),g)}})}};vm.__initStatic();LR.Postgres=vm});var wX=h(YR=>{var{_optionalChain:ASe}=O();Object.defineProperty(YR,"__esModule",{value:!0});var hd=O(),UR=Tr(),RSe=Bi(),_m=class t{static __initStatic(){this.id="Mysql"}constructor(){this.name=t.id}loadDependency(){return this._module=this._module||hd.loadModule("mysql/lib/Connection.js")}setupOnce(e,r){if(RSe.shouldDisableAutoInstrumentation(r)){UR.DEBUG_BUILD&&hd.logger.log("Mysql Integration is skipped because of instrumenter configuration.");return}let n=this.loadDependency();if(!n){UR.DEBUG_BUILD&&hd.logger.error("Mysql Integration was unable to require `mysql` package.");return}let s;try{n.prototype.connect=new Proxy(n.prototype.connect,{apply(a,c,l){return s||(s=c.config),a.apply(c,l)}})}catch{UR.DEBUG_BUILD&&hd.logger.error("Mysql Integration was unable to instrument `mysql` config.")}function i(){return s?{"server.address":s.host,"server.port":s.port,"db.user":s.user}:{}}function o(a){if(!a)return;let c=i();Object.keys(c).forEach(l=>{a.setAttribute(l,c[l])}),a.end()}hd.fill(n,"createQuery",function(a){return function(c,l,u){let f=r().getScope().getSpan(),g=ASe([f,"optionalAccess",m=>m.startChild,"call",m=>m({description:typeof c=="string"?c:c.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if(typeof u=="function")return a.call(this,c,l,function(m,I,C){o(g),u(m,I,C)});if(typeof l=="function")return a.call(this,c,function(m,I,C){o(g),l(m,I,C)});let p=a.call(this,c,l);return p.on("end",()=>{o(g)}),p}})}};_m.__initStatic();YR.Mysql=_m});var TX=h(DR=>{var{_optionalChain:Ti}=O();Object.defineProperty(DR,"__esModule",{value:!0});var md=O(),BX=Tr(),ESe=Bi(),wSe=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],BSe={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};function TSe(t){return t&&typeof t=="object"&&t.once&&typeof t.once=="function"}var Am=class t{static __initStatic(){this.id="Mongo"}constructor(e={}){this.name=t.id,this._operations=Array.isArray(e.operations)?e.operations:wSe,this._describeOperations="describeOperations"in e?e.describeOperations:!0,this._useMongoose=!!e.useMongoose}loadDependency(){let e=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||md.loadModule(e)}setupOnce(e,r){if(ESe.shouldDisableAutoInstrumentation(r)){BX.DEBUG_BUILD&&md.logger.log("Mongo Integration is skipped because of instrumenter configuration.");return}let n=this.loadDependency();if(!n){let s=this._useMongoose?"mongoose":"mongodb";BX.DEBUG_BUILD&&md.logger.error(`Mongo Integration was unable to require \`${s}\` package.`);return}this._instrumentOperations(n.Collection,this._operations,r)}_instrumentOperations(e,r,n){r.forEach(s=>this._patchOperation(e,s,n))}_patchOperation(e,r,n){if(!(r in e.prototype))return;let s=this._getSpanContextFromOperationArguments.bind(this);md.fill(e.prototype,r,function(i){return function(...o){let a=o[o.length-1],c=n(),l=c.getScope(),u=c.getClient(),d=l.getSpan(),f=Ti([u,"optionalAccess",p=>p.getOptions,"call",p=>p(),"access",p=>p.sendDefaultPii]);if(typeof a!="function"||r==="mapReduce"&&o.length===2){let p=Ti([d,"optionalAccess",I=>I.startChild,"call",I=>I(s(this,r,o,f))]),m=i.call(this,...o);if(md.isThenable(m))return m.then(I=>(Ti([p,"optionalAccess",C=>C.end,"call",C=>C()]),I));if(TSe(m)){let I=m;try{I.once("close",()=>{Ti([p,"optionalAccess",C=>C.end,"call",C=>C()])})}catch{Ti([p,"optionalAccess",S=>S.end,"call",S=>S()])}return I}else return Ti([p,"optionalAccess",I=>I.end,"call",I=>I()]),m}let g=Ti([d,"optionalAccess",p=>p.startChild,"call",p=>p(s(this,r,o.slice(0,-1)))]);return i.call(this,...o.slice(0,-1),function(p,m){Ti([g,"optionalAccess",I=>I.end,"call",I=>I()]),a(p,m)})}})}_getSpanContextFromOperationArguments(e,r,n,s=!1){let i={"db.system":"mongodb","db.name":e.dbName,"db.operation":r,"db.mongodb.collection":e.collectionName},o={op:"db",origin:"auto.db.mongo",description:r,data:i},a=BSe[r],c=Array.isArray(this._describeOperations)?this._describeOperations.includes(r):this._describeOperations;if(!a||!c||!s)return o;try{if(r==="mapReduce"){let[l,u]=n;i[a[0]]=typeof l=="string"?l:l.name||"<anonymous>",i[a[1]]=typeof u=="string"?u:u.name||"<anonymous>"}else for(let l=0;l<a.length;l++)i[`db.mongodb.${a[l]}`]=JSON.stringify(n[l])}catch{}return o}};Am.__initStatic();DR.Mongo=Am});var NX=h(XR=>{Object.defineProperty(XR,"__esModule",{value:!0});var GX=ge(),ZX=O(),GSe=Tr(),ZSe=Bi();function NSe(t){return!!t&&!!t.$use}var Rm=class t{static __initStatic(){this.id="Prisma"}constructor(e={}){if(this.name=t.id,NSe(e.client)&&!e.client._sentryInstrumented){ZX.addNonEnumerableProperty(e.client,"_sentryInstrumented",!0);let r={};try{let n=e.client._engineConfig;if(n){let{activeProvider:s,clientVersion:i}=n;s&&(r["db.system"]=s),i&&(r["db.prisma.version"]=i)}}catch{}e.client.$use((n,s)=>{if(ZSe.shouldDisableAutoInstrumentation(GX.getCurrentHub))return s(n);let i=n.action,o=n.model;return GX.startSpan({name:o?`${o} ${i}`:i,op:"db.prisma",origin:"auto.db.prisma",data:{...r,"db.operation":i}},()=>s(n))})}else GSe.DEBUG_BUILD&&ZX.logger.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",e.client)}setupOnce(){}};Rm.__initStatic();XR.Prisma=Rm});var HX=h($R=>{var{_optionalChain:wc}=O();Object.defineProperty($R,"__esModule",{value:!0});var yd=O(),VX=Tr(),VSe=Bi(),Em=class t{static __initStatic(){this.id="GraphQL"}constructor(){this.name=t.id}loadDependency(){return this._module=this._module||yd.loadModule("graphql/execution/execute.js")}setupOnce(e,r){if(VSe.shouldDisableAutoInstrumentation(r)){VX.DEBUG_BUILD&&yd.logger.log("GraphQL Integration is skipped because of instrumenter configuration.");return}let n=this.loadDependency();if(!n){VX.DEBUG_BUILD&&yd.logger.error("GraphQL Integration was unable to require graphql/execution package.");return}yd.fill(n,"execute",function(s){return function(...i){let o=r().getScope(),a=o.getSpan(),c=wc([a,"optionalAccess",u=>u.startChild,"call",u=>u({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);wc([o,"optionalAccess",u=>u.setSpan,"call",u=>u(c)]);let l=s.call(this,...i);return yd.isThenable(l)?l.then(u=>(wc([c,"optionalAccess",d=>d.end,"call",d=>d()]),wc([o,"optionalAccess",d=>d.setSpan,"call",d=>d(a)]),u)):(wc([c,"optionalAccess",u=>u.end,"call",u=>u()]),wc([o,"optionalAccess",u=>u.setSpan,"call",u=>u(a)]),l)}})}};Em.__initStatic();$R.GraphQL=Em});var OX=h(qR=>{var{_optionalChain:jR}=O();Object.defineProperty(qR,"__esModule",{value:!0});var zt=O(),wm=Tr(),HSe=Bi(),Bm=class t{static __initStatic(){this.id="Apollo"}constructor(e={useNestjs:!1}){this.name=t.id,this._useNest=!!e.useNestjs}loadDependency(){return this._useNest?this._module=this._module||zt.loadModule("@nestjs/graphql"):this._module=this._module||zt.loadModule("apollo-server-core"),this._module}setupOnce(e,r){if(HSe.shouldDisableAutoInstrumentation(r)){wm.DEBUG_BUILD&&zt.logger.log("Apollo Integration is skipped because of instrumenter configuration.");return}if(this._useNest){let n=this.loadDependency();if(!n){wm.DEBUG_BUILD&&zt.logger.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package.");return}zt.fill(n.GraphQLFactory.prototype,"mergeWithSchema",function(s){return function(...i){return zt.fill(this.resolversExplorerService,"explore",function(o){return function(){let a=zt.arrayify(o.call(this));return WX(a,r)}}),s.call(this,...i)}})}else{let n=this.loadDependency();if(!n){wm.DEBUG_BUILD&&zt.logger.error("Apollo Integration was unable to require apollo-server-core package.");return}zt.fill(n.ApolloServerBase.prototype,"constructSchema",function(s){return function(){if(!this.config.resolvers)return wm.DEBUG_BUILD&&(this.config.schema?(zt.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),zt.logger.warn()):this.config.modules&&zt.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),zt.logger.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),s.call(this);let i=zt.arrayify(this.config.resolvers);return this.config.resolvers=WX(i,r),s.call(this)}})}}};Bm.__initStatic();function WX(t,e){return t.map(r=>(Object.keys(r).forEach(n=>{Object.keys(r[n]).forEach(s=>{typeof r[n][s]=="function"&&WSe(r,n,s,e)})}),r))}function WSe(t,e,r,n){zt.fill(t[e],r,function(s){return function(...i){let a=n().getScope().getSpan(),c=jR([a,"optionalAccess",u=>u.startChild,"call",u=>u({description:`${e}.${r}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),l=s.call(this,...i);return zt.isThenable(l)?l.then(u=>(jR([c,"optionalAccess",d=>d.end,"call",d=>d()]),u)):(jR([c,"optionalAccess",u=>u.end,"call",u=>u()]),l)}})}qR.Apollo=Bm});var PX=h((MR,Gi)=>{Object.defineProperty(MR,"__esModule",{value:!0});var No=O(),OSe=[()=>{let t=No.dynamicRequire(Gi,"./apollo");return new t.Apollo},()=>{let t=No.dynamicRequire(Gi,"./apollo");return new t.Apollo({useNestjs:!0})},()=>{let t=No.dynamicRequire(Gi,"./graphql");return new t.GraphQL},()=>{let t=No.dynamicRequire(Gi,"./mongo");return new t.Mongo},()=>{let t=No.dynamicRequire(Gi,"./mongo");return new t.Mongo({mongoose:!0})},()=>{let t=No.dynamicRequire(Gi,"./mysql");return new t.Mysql},()=>{let t=No.dynamicRequire(Gi,"./postgres");return new t.Postgres}];MR.lazyLoadedNodePerformanceMonitoringIntegrations=OSe});var Hs=h(KR=>{Object.defineProperty(KR,"__esModule",{value:!0});var PSe=O(),kSe=PSe.GLOBAL_OBJ;KR.WINDOW=kSe});var LX=h(zR=>{Object.defineProperty(zR,"__esModule",{value:!0});var kX=ge(),FX=O(),xX=Tr(),Tm=Hs();function FSe(){Tm.WINDOW&&Tm.WINDOW.document?Tm.WINDOW.document.addEventListener("visibilitychange",()=>{let t=kX.getActiveTransaction();if(Tm.WINDOW.document.hidden&&t){let e="cancelled",{op:r,status:n}=kX.spanToJSON(t);xX.DEBUG_BUILD&&FX.logger.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${r}`),n||t.setStatus(e),t.setTag("visibilitychange","document.hidden"),t.end()}}):xX.DEBUG_BUILD&&FX.logger.warn("[Tracing] Could not set up background tab detection due to lack of global document")}zR.registerBackgroundTabDetection=FSe});var Gm=h(JR=>{Object.defineProperty(JR,"__esModule",{value:!0});var xSe=(t,e,r)=>{let n,s;return i=>{e.value>=0&&(i||r)&&(s=e.value-(n||0),(s||n===void 0)&&(n=e.value,e.delta=s,t(e)))}};JR.bindReporter=xSe});var UX=h(QR=>{Object.defineProperty(QR,"__esModule",{value:!0});var LSe=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`;QR.generateUniqueID=LSe});var tE=h(eE=>{Object.defineProperty(eE,"__esModule",{value:!0});var Id=Hs(),USe=()=>{let t=Id.WINDOW.performance.timing,e=Id.WINDOW.performance.navigation.type,r={entryType:"navigation",startTime:0,type:e==2?"back_forward":e===1?"reload":"navigate"};for(let n in t)n!=="navigationStart"&&n!=="toJSON"&&(r[n]=Math.max(t[n]-t.navigationStart,0));return r},YSe=()=>Id.WINDOW.__WEB_VITALS_POLYFILL__?Id.WINDOW.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||USe()):Id.WINDOW.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];eE.getNavigationEntry=YSe});var nE=h(rE=>{Object.defineProperty(rE,"__esModule",{value:!0});var DSe=tE(),XSe=()=>{let t=DSe.getNavigationEntry();return t&&t.activationStart||0};rE.getActivationStart=XSe});var Zm=h(sE=>{Object.defineProperty(sE,"__esModule",{value:!0});var $Se=Hs(),jSe=UX(),qSe=nE(),MSe=tE(),KSe=(t,e)=>{let r=MSe.getNavigationEntry(),n="navigate";return r&&($Se.WINDOW.document.prerendering||qSe.getActivationStart()>0?n="prerender":n=r.type.replace(/_/g,"-")),{name:t,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:jSe.generateUniqueID(),navigationType:n}};sE.initMetric=KSe});var bd=h(iE=>{Object.defineProperty(iE,"__esModule",{value:!0});var zSe=(t,e,r)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){let n=new PerformanceObserver(s=>{e(s.getEntries())});return n.observe(Object.assign({type:t,buffered:!0},r||{})),n}}catch{}};iE.observe=zSe});var Cd=h(oE=>{Object.defineProperty(oE,"__esModule",{value:!0});var JSe=Hs(),QSe=(t,e)=>{let r=n=>{(n.type==="pagehide"||JSe.WINDOW.document.visibilityState==="hidden")&&(t(n),e&&(removeEventListener("visibilitychange",r,!0),removeEventListener("pagehide",r,!0)))};addEventListener("visibilitychange",r,!0),addEventListener("pagehide",r,!0)};oE.onHidden=QSe});var YX=h(aE=>{Object.defineProperty(aE,"__esModule",{value:!0});var eve=Gm(),tve=Zm(),rve=bd(),nve=Cd(),sve=t=>{let e=tve.initMetric("CLS",0),r,n=0,s=[],i=a=>{a.forEach(c=>{if(!c.hadRecentInput){let l=s[0],u=s[s.length-1];n&&s.length!==0&&c.startTime-u.startTime<1e3&&c.startTime-l.startTime<5e3?(n+=c.value,s.push(c)):(n=c.value,s=[c]),n>e.value&&(e.value=n,e.entries=s,r&&r())}})},o=rve.observe("layout-shift",i);if(o){r=eve.bindReporter(t,e);let a=()=>{i(o.takeRecords()),r(!0)};return nve.onHidden(a),a}};aE.onCLS=sve});var Vm=h(cE=>{Object.defineProperty(cE,"__esModule",{value:!0});var DX=Hs(),ive=Cd(),Nm=-1,ove=()=>DX.WINDOW.document.visibilityState==="hidden"&&!DX.WINDOW.document.prerendering?0:1/0,ave=()=>{ive.onHidden(({timeStamp:t})=>{Nm=t},!0)},cve=()=>(Nm<0&&(Nm=ove(),ave()),{get firstHiddenTime(){return Nm}});cE.getVisibilityWatcher=cve});var XX=h(lE=>{Object.defineProperty(lE,"__esModule",{value:!0});var lve=Gm(),uve=Vm(),dve=Zm(),fve=bd(),gve=Cd(),pve=t=>{let e=uve.getVisibilityWatcher(),r=dve.initMetric("FID"),n,s=a=>{a.startTime<e.firstHiddenTime&&(r.value=a.processingStart-a.startTime,r.entries.push(a),n(!0))},i=a=>{a.forEach(s)},o=fve.observe("first-input",i);n=lve.bindReporter(t,r),o&&gve.onHidden(()=>{i(o.takeRecords()),o.disconnect()},!0)};lE.onFID=pve});var jX=h(uE=>{Object.defineProperty(uE,"__esModule",{value:!0});var hve=Gm(),mve=nE(),yve=Vm(),Ive=Zm(),bve=bd(),Cve=Cd(),$X={},Sve=t=>{let e=yve.getVisibilityWatcher(),r=Ive.initMetric("LCP"),n,s=o=>{let a=o[o.length-1];if(a){let c=Math.max(a.startTime-mve.getActivationStart(),0);c<e.firstHiddenTime&&(r.value=c,r.entries=[a],n())}},i=bve.observe("largest-contentful-paint",s);if(i){n=hve.bindReporter(t,r);let o=()=>{$X[r.id]||(s(i.takeRecords()),i.disconnect(),$X[r.id]=!0,n(!0))};return["keydown","click"].forEach(a=>{addEventListener(a,o,{once:!0,capture:!0})}),Cve.onHidden(o,!0),o}};uE.onLCP=Sve});var Om=h(Bc=>{Object.defineProperty(Bc,"__esModule",{value:!0});var qX=O(),vve=Tr(),_ve=YX(),Ave=XX(),Rve=jX(),Eve=bd(),Sd={},Hm={},MX,KX,zX;function wve(t){return dE("cls",t,Zve,MX)}function Bve(t){return dE("lcp",t,Vve,zX)}function Tve(t){return dE("fid",t,Nve,KX)}function Gve(t,e){return JX(t,e),Hm[t]||(Hve(t),Hm[t]=!0),QX(t,e)}function Wm(t,e){let r=Sd[t];if(!(!r||!r.length))for(let n of r)try{n(e)}catch(s){vve.DEBUG_BUILD&&qX.logger.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${qX.getFunctionName(n)}
Error:`,s)}}function Zve(){_ve.onCLS(t=>{Wm("cls",{metric:t}),MX=t})}function Nve(){Ave.onFID(t=>{Wm("fid",{metric:t}),KX=t})}function Vve(){Rve.onLCP(t=>{Wm("lcp",{metric:t}),zX=t})}function dE(t,e,r,n){return JX(t,e),Hm[t]||(r(),Hm[t]=!0),n&&e({metric:n}),QX(t,e)}function Hve(t){let e={};t==="event"&&(e.durationThreshold=0),Eve.observe(t,r=>{Wm(t,{entries:r})},e)}function JX(t,e){Sd[t]=Sd[t]||[],Sd[t].push(e)}function QX(t,e){return()=>{let r=Sd[t];if(!r)return;let n=r.indexOf(e);n!==-1&&r.splice(n,1)}}Bc.addClsInstrumentationHandler=wve;Bc.addFidInstrumentationHandler=Tve;Bc.addLcpInstrumentationHandler=Bve;Bc.addPerformanceInstrumentationHandler=Gve});var e$=h(Pm=>{Object.defineProperty(Pm,"__esModule",{value:!0});function Wve(t){return typeof t=="number"&&isFinite(t)}function Ove(t,{startTimestamp:e,...r}){return e&&t.startTimestamp>e&&(t.startTimestamp=e),t.startChild({startTimestamp:e,...r})}Pm._startChild=Ove;Pm.isMeasurementValue=Wve});var i$=h(Ni=>{Object.defineProperty(Ni,"__esModule",{value:!0});var Fm=ge(),pt=O(),$n=Tr(),_d=Om(),Zi=Hs(),Pve=Vm(),Ws=e$(),kve=2147483647;function At(t){return t/1e3}function r$(){return Zi.WINDOW&&Zi.WINDOW.addEventListener&&Zi.WINDOW.performance}var t$=0,at={},Xn,vd;function Fve(){let t=r$();if(t&&pt.browserPerformanceTimeOrigin){t.mark&&Zi.WINDOW.performance.mark("sentry-tracing-init");let e=Dve(),r=Uve(),n=Yve();return()=>{e(),r(),n()}}return()=>{}}function xve(){_d.addPerformanceInstrumentationHandler("longtask",({entries:t})=>{for(let e of t){let r=Fm.getActiveTransaction();if(!r)return;let n=At(pt.browserPerformanceTimeOrigin+e.startTime),s=At(e.duration);r.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+s})}})}function Lve(){_d.addPerformanceInstrumentationHandler("event",({entries:t})=>{for(let e of t){let r=Fm.getActiveTransaction();if(!r)return;if(e.name==="click"){let n=At(pt.browserPerformanceTimeOrigin+e.startTime),s=At(e.duration),i={description:pt.htmlTreeAsString(e.target),op:`ui.interaction.${e.name}`,origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+s},o=pt.getComponentName(e.target);o&&(i.attributes={"ui.component_name":o}),r.startChild(i)}}})}function Uve(){return _d.addClsInstrumentationHandler(({metric:t})=>{let e=t.entries.pop();e&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding CLS"),at.cls={value:t.value,unit:""},vd=e)})}function Yve(){return _d.addLcpInstrumentationHandler(({metric:t})=>{let e=t.entries.pop();e&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding LCP"),at.lcp={value:t.value,unit:"millisecond"},Xn=e)})}function Dve(){return _d.addFidInstrumentationHandler(({metric:t})=>{let e=t.entries.pop();if(!e)return;let r=At(pt.browserPerformanceTimeOrigin),n=At(e.startTime);$n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding FID"),at.fid={value:t.value,unit:"millisecond"},at["mark.fid"]={value:r+n,unit:"second"}})}function Xve(t){let e=r$();if(!e||!Zi.WINDOW.performance.getEntries||!pt.browserPerformanceTimeOrigin)return;$n.DEBUG_BUILD&&pt.logger.log("[Tracing] Adding & adjusting spans using Performance API");let r=At(pt.browserPerformanceTimeOrigin),n=e.getEntries(),s,i,{op:o,start_timestamp:a}=Fm.spanToJSON(t);if(n.slice(t$).forEach(c=>{let l=At(c.startTime),u=At(c.duration);if(!(t.op==="navigation"&&a&&r+l<a))switch(c.entryType){case"navigation":{$ve(t,c,r),s=r+At(c.responseStart),i=r+At(c.requestStart);break}case"mark":case"paint":case"measure":{n$(t,c,l,u,r);let d=Pve.getVisibilityWatcher(),f=c.startTime<d.firstHiddenTime;c.name==="first-paint"&&f&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding FP"),at.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&f&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding FCP"),at.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{s$(t,c,c.name,l,u,r);break}}}),t$=Math.max(n.length-1,0),qve(t),o==="pageload"){typeof s=="number"&&a&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding TTFB"),at.ttfb={value:(s-a)*1e3,unit:"millisecond"},typeof i=="number"&&i<=s&&(at["ttfb.requestTime"]={value:(s-i)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(l=>{if(!at[l]||!a||r>=a)return;let u=at[l].value,d=r+At(u),f=Math.abs((d-a)*1e3),g=f-u;$n.DEBUG_BUILD&&pt.logger.log(`[Measurements] Normalized ${l} from ${u} to ${f} (${g})`),at[l].value=f});let c=at["mark.fid"];c&&at.fid&&(Ws._startChild(t,{description:"first input delay",endTimestamp:c.value+At(at.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:c.value}),delete at["mark.fid"]),"fcp"in at||delete at.cls,Object.keys(at).forEach(l=>{Fm.setMeasurement(l,at[l].value,at[l].unit)}),Mve(t)}Xn=void 0,vd=void 0,at={}}function n$(t,e,r,n,s){let i=s+r,o=i+n;return Ws._startChild(t,{description:e.name,endTimestamp:o,op:e.entryType,origin:"auto.resource.browser.metrics",startTimestamp:i}),i}function $ve(t,e,r){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(n=>{km(t,e,n,r)}),km(t,e,"secureConnection",r,"TLS/SSL","connectEnd"),km(t,e,"fetch",r,"cache","domainLookupStart"),km(t,e,"domainLookup",r,"DNS"),jve(t,e,r)}function km(t,e,r,n,s,i){let o=i?e[i]:e[`${r}End`],a=e[`${r}Start`];!a||!o||Ws._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:s||r,startTimestamp:n+At(a),endTimestamp:n+At(o)})}function jve(t,e,r){e.responseEnd&&(Ws._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:r+At(e.requestStart),endTimestamp:r+At(e.responseEnd)}),Ws._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:r+At(e.responseStart),endTimestamp:r+At(e.responseEnd)}))}function s$(t,e,r,n,s,i){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;let o=pt.parseUrl(r),a={};fE(a,e,"transferSize","http.response_transfer_size"),fE(a,e,"encodedBodySize","http.response_content_length"),fE(a,e,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in e&&(a["resource.render_blocking_status"]=e.renderBlockingStatus),o.protocol&&(a["url.scheme"]=o.protocol.split(":").pop()),o.host&&(a["server.address"]=o.host),a["url.same_origin"]=r.includes(Zi.WINDOW.location.origin);let c=i+n,l=c+s;Ws._startChild(t,{description:r.replace(Zi.WINDOW.location.origin,""),endTimestamp:l,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:a})}function qve(t){let e=Zi.WINDOW.navigator;if(!e)return;let r=e.connection;r&&(r.effectiveType&&t.setTag("effectiveConnectionType",r.effectiveType),r.type&&t.setTag("connectionType",r.type),Ws.isMeasurementValue(r.rtt)&&(at["connection.rtt"]={value:r.rtt,unit:"millisecond"})),Ws.isMeasurementValue(e.deviceMemory)&&t.setTag("deviceMemory",`${e.deviceMemory} GB`),Ws.isMeasurementValue(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}function Mve(t){Xn&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding LCP Data"),Xn.element&&t.setTag("lcp.element",pt.htmlTreeAsString(Xn.element)),Xn.id&&t.setTag("lcp.id",Xn.id),Xn.url&&t.setTag("lcp.url",Xn.url.trim().slice(0,200)),t.setTag("lcp.size",Xn.size)),vd&&vd.sources&&($n.DEBUG_BUILD&&pt.logger.log("[Measurements] Adding CLS Data"),vd.sources.forEach((e,r)=>t.setTag(`cls.source.${r+1}`,pt.htmlTreeAsString(e.node))))}function fE(t,e,r,n){let s=e[r];s!=null&&s<kve&&(t[n]=s)}Ni._addMeasureSpans=n$;Ni._addResourceSpans=s$;Ni.addPerformanceEntries=Xve;Ni.startTrackingInteractions=Lve;Ni.startTrackingLongTasks=xve;Ni.startTrackingWebVitals=Fve});var gE=h(xm=>{Object.defineProperty(xm,"__esModule",{value:!0});var Vi=ge(),Tc=O();function Kve(t,e,r,n,s="auto.http.browser"){if(!Vi.hasTracingEnabled()||!t.fetchData)return;let i=e(t.fetchData.url);if(t.endTimestamp&&i){let f=t.fetchData.__span;if(!f)return;let g=n[f];if(g){if(t.response){g.setHttpStatus(t.response.status);let p=t.response&&t.response.headers&&t.response.headers.get("content-length");if(p){let m=parseInt(p);m>0&&g.setAttribute("http.response_content_length",m)}}else t.error&&g.setStatus("internal_error");g.end(),delete n[f]}return}let o=Vi.getCurrentScope(),a=Vi.getClient(),c=Vi.getActiveSpan(),{method:l,url:u}=t.fetchData,d=i&&c?c.startChild({data:{url:u,type:"fetch","http.method":l},description:`${l} ${u}`,op:"http.client",origin:s}):void 0;if(d&&(t.fetchData.__span=d.spanContext().spanId,n[d.spanContext().spanId]=d),r(t.fetchData.url)&&a){let f=t.args[0];t.args[1]=t.args[1]||{};let g=t.args[1];g.headers=o$(f,a,o,g,d)}return d}function o$(t,e,r,n,s){let i=s||r.getSpan(),o=i&&Vi.getRootSpan(i),{traceId:a,sampled:c,dsc:l}=r.getPropagationContext(),u=i?Vi.spanToTraceHeader(i):Tc.generateSentryTraceHeader(a,void 0,c),d=o?Vi.getDynamicSamplingContextFromSpan(o):l||Vi.getDynamicSamplingContextFromClient(a,e,r),f=Tc.dynamicSamplingContextToSentryBaggageHeader(d),g=n.headers||(typeof Request<"u"&&Tc.isInstanceOf(t,Request)?t.headers:void 0);if(g)if(typeof Headers<"u"&&Tc.isInstanceOf(g,Headers)){let p=new Headers(g);return p.append("sentry-trace",u),f&&p.append(Tc.BAGGAGE_HEADER_NAME,f),p}else if(Array.isArray(g)){let p=[...g,["sentry-trace",u]];return f&&p.push([Tc.BAGGAGE_HEADER_NAME,f]),p}else{let p="baggage"in g?g.baggage:void 0,m=[];return Array.isArray(p)?m.push(...p):p&&m.push(p),f&&m.push(f),{...g,"sentry-trace":u,baggage:m.length>0?m.join(","):void 0}}else return{"sentry-trace":u,baggage:f}}xm.addTracingHeadersToFetchRequest=o$;xm.instrumentFetchRequest=Kve});var hE=h(Hi=>{Object.defineProperty(Hi,"__esModule",{value:!0});var Os=ge(),qn=O(),zve=gE(),Jve=Om(),Lm=["localhost",/^\/(?!\/)/],pE={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Lm,tracePropagationTargets:Lm};function Qve(t){let{traceFetch:e,traceXHR:r,tracePropagationTargets:n,tracingOrigins:s,shouldCreateSpanForRequest:i,enableHTTPTimings:o}={traceFetch:pE.traceFetch,traceXHR:pE.traceXHR,...t},a=typeof i=="function"?i:u=>!0,c=u=>u$(u,n||s),l={};e&&qn.addFetchInstrumentationHandler(u=>{let d=zve.instrumentFetchRequest(u,a,c,l);o&&d&&a$(d)}),r&&qn.addXhrInstrumentationHandler(u=>{let d=d$(u,a,c,l);o&&d&&a$(d)})}function e_e(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function a$(t){let{url:e}=Os.spanToJSON(t).data||{};if(!e||typeof e!="string")return;let r=Jve.addPerformanceInstrumentationHandler("resource",({entries:n})=>{n.forEach(s=>{e_e(s)&&s.name.endsWith(e)&&(t_e(s).forEach(o=>t.setAttribute(...o)),setTimeout(r))})})}function l$(t){let e="unknown",r="unknown",n="";for(let s of t){if(s==="/"){[e,r]=t.split("/");break}if(!isNaN(Number(s))){e=n==="h"?"http":n,r=t.split(n)[1];break}n+=s}return n===t&&(e=n),{name:e,version:r}}function jn(t=0){return((qn.browserPerformanceTimeOrigin||performance.timeOrigin)+t)/1e3}function t_e(t){let{name:e,version:r}=l$(t.nextHopProtocol),n=[];return n.push(["network.protocol.version",r],["network.protocol.name",e]),qn.browserPerformanceTimeOrigin?[...n,["http.request.redirect_start",jn(t.redirectStart)],["http.request.fetch_start",jn(t.fetchStart)],["http.request.domain_lookup_start",jn(t.domainLookupStart)],["http.request.domain_lookup_end",jn(t.domainLookupEnd)],["http.request.connect_start",jn(t.connectStart)],["http.request.secure_connection_start",jn(t.secureConnectionStart)],["http.request.connection_end",jn(t.connectEnd)],["http.request.request_start",jn(t.requestStart)],["http.request.response_start",jn(t.responseStart)],["http.request.response_end",jn(t.responseEnd)]]:n}function u$(t,e){return qn.stringMatchesSomePattern(t,e||Lm)}function d$(t,e,r,n){let s=t.xhr,i=s&&s[qn.SENTRY_XHR_DATA_KEY];if(!Os.hasTracingEnabled()||!s||s.__sentry_own_request__||!i)return;let o=e(i.url);if(t.endTimestamp&&o){let u=s.__sentry_xhr_span_id__;if(!u)return;let d=n[u];d&&i.status_code!==void 0&&(d.setHttpStatus(i.status_code),d.end(),delete n[u]);return}let a=Os.getCurrentScope(),c=Os.getActiveSpan(),l=o&&c?c.startChild({data:{type:"xhr","http.method":i.method,url:i.url},description:`${i.method} ${i.url}`,op:"http.client",origin:"auto.http.browser"}):void 0;if(l&&(s.__sentry_xhr_span_id__=l.spanContext().spanId,n[s.__sentry_xhr_span_id__]=l),s.setRequestHeader&&r(i.url))if(l){let u=l&&Os.getRootSpan(l),d=u&&Os.getDynamicSamplingContextFromSpan(u),f=qn.dynamicSamplingContextToSentryBaggageHeader(d);c$(s,Os.spanToTraceHeader(l),f)}else{let u=Os.getClient(),{traceId:d,sampled:f,dsc:g}=a.getPropagationContext(),p=qn.generateSentryTraceHeader(d,void 0,f),m=g||(u?Os.getDynamicSamplingContextFromClient(d,u,a):void 0),I=qn.dynamicSamplingContextToSentryBaggageHeader(m);c$(s,p,I)}return l}function c$(t,e,r){try{t.setRequestHeader("sentry-trace",e),r&&t.setRequestHeader(qn.BAGGAGE_HEADER_NAME,r)}catch{}}Hi.DEFAULT_TRACE_PROPAGATION_TARGETS=Lm;Hi.defaultRequestInstrumentationOptions=pE;Hi.extractNetworkProtocol=l$;Hi.instrumentOutgoingRequests=Qve;Hi.shouldAttachHeaders=u$;Hi.xhrCallback=d$});var g$=h(mE=>{Object.defineProperty(mE,"__esModule",{value:!0});var Ad=O(),f$=Tr(),Rd=Hs();function r_e(t,e=!0,r=!0){if(!Rd.WINDOW||!Rd.WINDOW.location){f$.DEBUG_BUILD&&Ad.logger.warn("Could not initialize routing instrumentation due to invalid location");return}let n=Rd.WINDOW.location.href,s;e&&(s=t({name:Rd.WINDOW.location.pathname,startTimestamp:Ad.browserPerformanceTimeOrigin?Ad.browserPerformanceTimeOrigin/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),r&&Ad.addHistoryInstrumentationHandler(({to:i,from:o})=>{if(o===void 0&&n&&n.indexOf(i)!==-1){n=void 0;return}o!==i&&(n=void 0,s&&(f$.DEBUG_BUILD&&Ad.logger.log(`[Tracing] Finishing current transaction with op: ${s.op}`),s.end()),s=t({name:Rd.WINDOW.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}mE.instrumentRoutingWithDefaults=r_e});var m$=h(wd=>{Object.defineProperty(wd,"__esModule",{value:!0});var Oi=ge(),Ps=O(),Wi=Tr(),n_e=LX(),Um=i$(),p$=hE(),s_e=g$(),Ed=Hs(),h$="BrowserTracing",i_e={...Oi.TRACING_DEFAULTS,markBackgroundTransactions:!0,routingInstrumentation:s_e.instrumentRoutingWithDefaults,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...p$.defaultRequestInstrumentationOptions},yE=class{constructor(e){this.name=h$,this._hasSetTracePropagationTargets=!1,Oi.addTracingExtensions(),Wi.DEBUG_BUILD&&(this._hasSetTracePropagationTargets=!!(e&&(e.tracePropagationTargets||e.tracingOrigins))),this.options={...i_e,...e},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=Um.startTrackingWebVitals(),this.options.enableLongTask&&Um.startTrackingLongTasks(),this.options._experiments.enableInteractions&&Um.startTrackingInteractions()}setupOnce(e,r){this._getCurrentHub=r;let s=r().getClient(),i=s&&s.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:a,startTransactionOnPageLoad:c,markBackgroundTransactions:l,traceFetch:u,traceXHR:d,shouldCreateSpanForRequest:f,enableHTTPTimings:g,_experiments:p}=this.options,m=i&&i.tracePropagationTargets,I=m||this.options.tracePropagationTargets;Wi.DEBUG_BUILD&&this._hasSetTracePropagationTargets&&m&&Ps.logger.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o(C=>{let S=this._createRouteTransaction(C);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(S,C,r),S},c,a),l&&n_e.registerBackgroundTabDetection(),p.enableInteractions&&this._registerInteractionListener(),p$.instrumentOutgoingRequests({traceFetch:u,traceXHR:d,tracePropagationTargets:I,shouldCreateSpanForRequest:f,enableHTTPTimings:g})}_createRouteTransaction(e){if(!this._getCurrentHub){Wi.DEBUG_BUILD&&Ps.logger.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}let r=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:s,finalTimeout:i,heartbeatInterval:o}=this.options,a=e.op==="pageload",c=a?IE("sentry-trace"):"",l=a?IE("baggage"):"",{traceparentData:u,dynamicSamplingContext:d,propagationContext:f}=Ps.tracingContextFromHeaders(c,l),g={...e,...u,metadata:{...e.metadata,dynamicSamplingContext:u&&!d?{}:d},trimEnd:!0},p=typeof n=="function"?n(g):g,m=p===void 0?{...g,sampled:!1}:p;m.metadata=m.name!==g.name?{...m.metadata,source:"custom"}:m.metadata,this._latestRouteName=m.name;let I=e.data&&e.data[Oi.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],C=m.metadata&&m.metadata.source;this._latestRouteSource=I||C,m.sampled===!1&&Wi.DEBUG_BUILD&&Ps.logger.log(`[Tracing] Will not send ${m.op} transaction because of beforeNavigate.`),Wi.DEBUG_BUILD&&Ps.logger.log(`[Tracing] Starting ${m.op} transaction on scope`);let{location:S}=Ed.WINDOW,b=Oi.startIdleTransaction(r,m,s,i,!0,{location:S},o,a);a&&(Ed.WINDOW.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(Ed.WINDOW.document.readyState)&&b.sendAutoFinishSignal()}),["interactive","complete"].includes(Ed.WINDOW.document.readyState)&&b.sendAutoFinishSignal());let y=r.getScope();return a&&u?y.setPropagationContext(f):y.setPropagationContext({traceId:b.spanContext().traceId,spanId:b.spanContext().spanId,parentSpanId:b.parentSpanId,sampled:Oi.spanIsSampled(b)}),b.registerBeforeFinishCallback(A=>{this._collectWebVitals(),Um.addPerformanceEntries(A)}),b}_registerInteractionListener(){let e,r=()=>{let{idleTimeout:n,finalTimeout:s,heartbeatInterval:i}=this.options,o="ui.action.click",a=Oi.getActiveTransaction();if(a&&a.op&&["navigation","pageload"].includes(a.op)){Wi.DEBUG_BUILD&&Ps.logger.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub){Wi.DEBUG_BUILD&&Ps.logger.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){Wi.DEBUG_BUILD&&Ps.logger.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`);return}let c=this._getCurrentHub(),{location:l}=Ed.WINDOW,u={name:this._latestRouteName,op:o,trimEnd:!0,data:{[Oi.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:this._latestRouteSource||"url"}};e=Oi.startIdleTransaction(c,u,n,s,!0,{location:l},i)};["click"].forEach(n=>{addEventListener(n,r,{once:!1,capture:!0})})}};function IE(t){let e=Ps.getDomElement(`meta[name=${t}]`);return e?e.getAttribute("content"):void 0}wd.BROWSER_TRACING_INTEGRATION_ID=h$;wd.BrowserTracing=yE;wd.getMetaContent=IE});var I$=h((bE,Bd)=>{Object.defineProperty(bE,"__esModule",{value:!0});var y$=ge(),Gc=O();function o_e(){let t=y$.getMainCarrier();if(!t.__SENTRY__)return;let e={mongodb(){let n=Gc.dynamicRequire(Bd,"./node/integrations/mongo");return new n.Mongo},mongoose(){let n=Gc.dynamicRequire(Bd,"./node/integrations/mongo");return new n.Mongo},mysql(){let n=Gc.dynamicRequire(Bd,"./node/integrations/mysql");return new n.Mysql},pg(){let n=Gc.dynamicRequire(Bd,"./node/integrations/postgres");return new n.Postgres}},r=Object.keys(e).filter(n=>!!Gc.loadModule(n)).map(n=>{try{return e[n]()}catch{return}}).filter(n=>n);r.length>0&&(t.__SENTRY__.integrations=[...t.__SENTRY__.integrations||[],...r])}function a_e(){y$.addTracingExtensions(),Gc.isNodeEnv()&&o_e()}bE.addExtensionMethods=a_e});var CE=h(Ne=>{Object.defineProperty(Ne,"__esModule",{value:!0});var ks=ge(),b$=O(),c_e=RX(),l_e=EX(),u_e=wX(),d_e=TX(),f_e=NX(),g_e=HX(),p_e=OX(),h_e=PX(),C$=m$(),S$=hE(),Ym=Om(),v$=gE(),m_e=I$();Ne.IdleTransaction=ks.IdleTransaction;Ne.Span=ks.Span;Ne.SpanStatus=ks.SpanStatus;Ne.Transaction=ks.Transaction;Ne.extractTraceparentData=ks.extractTraceparentData;Ne.getActiveTransaction=ks.getActiveTransaction;Ne.hasTracingEnabled=ks.hasTracingEnabled;Ne.spanStatusfromHttpCode=ks.spanStatusfromHttpCode;Ne.startIdleTransaction=ks.startIdleTransaction;Ne.TRACEPARENT_REGEXP=b$.TRACEPARENT_REGEXP;Ne.stripUrlQueryAndFragment=b$.stripUrlQueryAndFragment;Ne.Express=c_e.Express;Ne.Postgres=l_e.Postgres;Ne.Mysql=u_e.Mysql;Ne.Mongo=d_e.Mongo;Ne.Prisma=f_e.Prisma;Ne.GraphQL=g_e.GraphQL;Ne.Apollo=p_e.Apollo;Ne.lazyLoadedNodePerformanceMonitoringIntegrations=h_e.lazyLoadedNodePerformanceMonitoringIntegrations;Ne.BROWSER_TRACING_INTEGRATION_ID=C$.BROWSER_TRACING_INTEGRATION_ID;Ne.BrowserTracing=C$.BrowserTracing;Ne.defaultRequestInstrumentationOptions=S$.defaultRequestInstrumentationOptions;Ne.instrumentOutgoingRequests=S$.instrumentOutgoingRequests;Ne.addClsInstrumentationHandler=Ym.addClsInstrumentationHandler;Ne.addFidInstrumentationHandler=Ym.addFidInstrumentationHandler;Ne.addLcpInstrumentationHandler=Ym.addLcpInstrumentationHandler;Ne.addPerformanceInstrumentationHandler=Ym.addPerformanceInstrumentationHandler;Ne.addTracingHeadersToFetchRequest=v$.addTracingHeadersToFetchRequest;Ne.instrumentFetchRequest=v$.instrumentFetchRequest;Ne.addExtensionMethods=m_e.addExtensionMethods});var _$=h(SE=>{Object.defineProperty(SE,"__esModule",{value:!0});var y_e=CE(),I_e=O();function b_e(){let t=y_e.lazyLoadedNodePerformanceMonitoringIntegrations.map(e=>{try{return e()}catch{return}}).filter(e=>!!e);return t.length===0&&I_e.logger.warn("Performance monitoring integrations could not be automatically loaded."),t.filter(e=>!!e.loadDependency())}SE.autoDiscoverNodePerformanceMonitoringIntegrations=b_e});var RE=h(AE=>{Object.defineProperty(AE,"__esModule",{value:!0});var C_e=require("os"),S_e=require("util"),vE=ge(),_E=class extends vE.ServerRuntimeClient{constructor(e){e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.node",packages:[{name:"npm:@sentry/node",version:vE.SDK_VERSION}],version:vE.SDK_VERSION},e.transportOptions={textEncoder:new S_e.TextEncoder,...e.transportOptions};let r={...e,platform:"node",runtime:{name:"node",version:global.process.version},serverName:e.serverName||global.process.env.SENTRY_NAME||C_e.hostname()};super(r)}};AE.NodeClient=_E});var E$=h(wE=>{var{_nullishCoalesce:A$}=O();Object.defineProperty(wE,"__esModule",{value:!0});var R$=require("http");require("https");var Mn=Symbol("AgentBaseInternalState"),EE=class extends R$.Agent{constructor(e){super(e),this[Mn]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:r}=new Error;return typeof r!="string"?!1:r.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}createSocket(e,r,n){let s={...r,secureEndpoint:this.isSecureEndpoint(r)};Promise.resolve().then(()=>this.connect(e,s)).then(i=>{if(i instanceof R$.Agent)return i.addRequest(e,s);this[Mn].currentSocket=i,super.createSocket(e,r,n)},n)}createConnection(){let e=this[Mn].currentSocket;if(this[Mn].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return A$(this[Mn].defaultPort,()=>this.protocol==="https:"?443:80)}set defaultPort(e){this[Mn]&&(this[Mn].defaultPort=e)}get protocol(){return A$(this[Mn].protocol,()=>this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[Mn]&&(this[Mn].protocol=e)}};wE.Agent=EE});var w$=h(BE=>{Object.defineProperty(BE,"__esModule",{value:!0});var v_e=O();function Dm(...t){v_e.logger.log("[https-proxy-agent:parse-proxy-response]",...t)}function __e(t){return new Promise((e,r)=>{let n=0,s=[];function i(){let u=t.read();u?l(u):t.once("readable",i)}function o(){t.removeListener("end",a),t.removeListener("error",c),t.removeListener("readable",i)}function a(){o(),Dm("onend"),r(new Error("Proxy connection ended before receiving CONNECT response"))}function c(u){o(),Dm("onerror %o",u),r(u)}function l(u){s.push(u),n+=u.length;let d=Buffer.concat(s,n),f=d.indexOf(`\r
\r
`);if(f===-1){Dm("have not received end of HTTP headers yet..."),i();return}let g=d.slice(0,f).toString("ascii").split(`\r
`),p=g.shift();if(!p)return t.destroy(),r(new Error("No header received from proxy CONNECT response"));let m=p.split(" "),I=+m[1],C=m.slice(2).join(" "),S={};for(let b of g){if(!b)continue;let y=b.indexOf(":");if(y===-1)return t.destroy(),r(new Error(`Invalid header from proxy CONNECT response: "${b}"`));let A=b.slice(0,y).toLowerCase(),E=b.slice(y+1).trimStart(),v=S[A];typeof v=="string"?S[A]=[v,E]:Array.isArray(v)?v.push(E):S[A]=E}Dm("got proxy server response: %o %o",p,S),o(),e({connect:{statusCode:I,statusText:C,headers:S},buffered:d})}t.on("error",c),t.on("end",a),i()})}BE.parseProxyResponse=__e});var G$=h(TE=>{var{_nullishCoalesce:A_e,_optionalChain:R_e}=O();Object.defineProperty(TE,"__esModule",{value:!0});var E_e=require("assert"),Td=require("net"),B$=require("tls"),w_e=require("url"),B_e=O(),T_e=E$(),G_e=w$();function Gd(...t){B_e.logger.log("[https-proxy-agent]",...t)}var Xm=class extends T_e.Agent{static __initStatic(){this.protocols=["http","https"]}constructor(e,r){super(r),this.options={},this.proxy=typeof e=="string"?new w_e.URL(e):e,this.proxyHeaders=A_e(R_e([r,"optionalAccess",i=>i.headers]),()=>({})),Gd("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),s=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...r?T$(r,"headers"):null,host:n,port:s}}async connect(e,r){let{proxy:n}=this;if(!r.host)throw new TypeError('No "host" provided');let s;if(n.protocol==="https:"){Gd("Creating `tls.Socket`: %o",this.connectOpts);let f=this.connectOpts.servername||this.connectOpts.host;s=B$.connect({...this.connectOpts,servername:f&&Td.isIP(f)?void 0:f})}else Gd("Creating `net.Socket`: %o",this.connectOpts),s=Td.connect(this.connectOpts);let i=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},o=Td.isIPv6(r.host)?`[${r.host}]`:r.host,a=`CONNECT ${o}:${r.port} HTTP/1.1\r
`;if(n.username||n.password){let f=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;i["Proxy-Authorization"]=`Basic ${Buffer.from(f).toString("base64")}`}i.Host=`${o}:${r.port}`,i["Proxy-Connection"]||(i["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let f of Object.keys(i))a+=`${f}: ${i[f]}\r
`;let c=G_e.parseProxyResponse(s);s.write(`${a}\r
`);let{connect:l,buffered:u}=await c;if(e.emit("proxyConnect",l),this.emit("proxyConnect",l,e),l.statusCode===200){if(e.once("socket",Z_e),r.secureEndpoint){Gd("Upgrading socket connection to TLS");let f=r.servername||r.host;return B$.connect({...T$(r,"host","path","port"),socket:s,servername:Td.isIP(f)?void 0:f})}return s}s.destroy();let d=new Td.Socket({writable:!1});return d.readable=!0,e.once("socket",f=>{Gd("Replaying proxy buffer for failed request"),E_e.default(f.listenerCount("data")>0),f.push(u),f.push(null)}),d}};Xm.__initStatic();function Z_e(t){t.resume()}function T$(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}TE.HttpsProxyAgent=Xm});var NE=h(ZE=>{var{_nullishCoalesce:GE}=O();Object.defineProperty(ZE,"__esModule",{value:!0});var N_e=require("http"),V_e=require("https"),H_e=require("stream"),N$=require("url"),W_e=require("zlib"),Z$=ge(),O_e=O(),P_e=G$(),k_e=1024*32;function F_e(t){return new H_e.Readable({read(){this.push(t),this.push(null)}})}function x_e(t){let e;try{e=new N$.URL(t.url)}catch{return O_e.consoleSandbox(()=>{console.warn("[@sentry/node]: Invalid dsn or tunnel option, will not send any events. The tunnel option must be a full URL when used.")}),Z$.createTransport(t,()=>Promise.resolve({}))}let r=e.protocol==="https:",n=L_e(e,t.proxy||(r?process.env.https_proxy:void 0)||process.env.http_proxy),s=r?V_e:N_e,i=t.keepAlive===void 0?!1:t.keepAlive,o=n?new P_e.HttpsProxyAgent(n):new s.Agent({keepAlive:i,maxSockets:30,timeout:2e3}),a=U_e(t,GE(t.httpModule,()=>s),o);return Z$.createTransport(t,a)}function L_e(t,e){let{no_proxy:r}=process.env;if(!(r&&r.split(",").some(s=>t.host.endsWith(s)||t.hostname.endsWith(s))))return e}function U_e(t,e,r){let{hostname:n,pathname:s,port:i,protocol:o,search:a}=new N$.URL(t.url);return function(l){return new Promise((u,d)=>{let f=F_e(l.body),g={...t.headers};l.body.length>k_e&&(g["content-encoding"]="gzip",f=f.pipe(W_e.createGzip()));let p=e.request({method:"POST",agent:r,headers:g,hostname:n,path:`${s}${a}`,port:i,protocol:o,ca:t.caCerts},m=>{m.on("data",()=>{}),m.on("end",()=>{}),m.setEncoding("utf8");let I=GE(m.headers["retry-after"],()=>null),C=GE(m.headers["x-sentry-rate-limits"],()=>null);u({statusCode:m.statusCode,headers:{"retry-after":I,"x-sentry-rate-limits":Array.isArray(C)?C[0]:C}})});p.on("error",d),f.pipe(p)})}}ZE.makeNodeTransport=x_e});var Vo=h(VE=>{Object.defineProperty(VE,"__esModule",{value:!0});var Y_e=O(),D_e=Y_e.parseSemver(process.versions.node);VE.NODE_VERSION=D_e});var W$=h(HE=>{var{_optionalChain:X_e}=O();Object.defineProperty(HE,"__esModule",{value:!0});var V$=require("domain"),Ho=ge();function H$(){return V$.active}function $_e(){let t=H$();if(t)return Ho.ensureHubOnCarrier(t),Ho.getHubFromCarrier(t)}function j_e(t){let e={};return Ho.ensureHubOnCarrier(e,t),Ho.getHubFromCarrier(e)}function q_e(t,e){let r=H$();if(r&&X_e([e,"optionalAccess",o=>o.reuseExisting]))return t();let n=V$.create(),s=r?Ho.getHubFromCarrier(r):void 0,i=j_e(s);return Ho.setHubOnCarrier(n,i),n.bind(()=>t())()}function M_e(){Ho.setAsyncContextStrategy({getCurrentHub:$_e,runWithAsyncContext:q_e})}HE.setDomainAsyncContextStrategy=M_e});var O$=h(OE=>{var{_optionalChain:K_e}=O();Object.defineProperty(OE,"__esModule",{value:!0});var WE=ge(),z_e=require("async_hooks"),$m;function J_e(){$m||($m=new z_e.AsyncLocalStorage);function t(){return $m.getStore()}function e(n){let s={};return WE.ensureHubOnCarrier(s,n),WE.getHubFromCarrier(s)}function r(n,s){let i=t();if(i&&K_e([s,"optionalAccess",a=>a.reuseExisting]))return n();let o=e(i);return $m.run(o,()=>n())}WE.setAsyncContextStrategy({getCurrentHub:t,runWithAsyncContext:r})}OE.setHooksAsyncContextStrategy=J_e});var P$=h(PE=>{Object.defineProperty(PE,"__esModule",{value:!0});var Q_e=Vo(),eAe=W$(),tAe=O$();function rAe(){Q_e.NODE_VERSION.major>=14?tAe.setHooksAsyncContextStrategy():eAe.setDomainAsyncContextStrategy()}PE.setNodeAsyncContextStrategy=rAe});var xE=h(FE=>{Object.defineProperty(FE,"__esModule",{value:!0});var nAe=require("util"),kE=ge(),k$=O(),F$="Console",sAe=()=>({name:F$,setupOnce(){},setup(t){k$.addConsoleInstrumentationHandler(({args:e,level:r})=>{kE.getClient()===t&&kE.addBreadcrumb({category:"console",level:k$.severityLevelFromString(r),message:nAe.format.apply(void 0,e)},{input:[...e],level:r})})}}),iAe=kE.convertIntegrationFnToClass(F$,sAe);FE.Console=iAe});var Zd=h(LE=>{Object.defineProperty(LE,"__esModule",{value:!0});var oAe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;LE.DEBUG_BUILD=oAe});var U$=h(Wo=>{var{_optionalChain:Kn}=O();Object.defineProperty(Wo,"__esModule",{value:!0});var UE=require("url"),aAe=Vo();function cAe(t){let{protocol:e,hostname:r,port:n}=L$(t),s=t.path?t.path:"/";return`${e}//${r}${n}${s}`}function x$(t){let{protocol:e,hostname:r,port:n}=L$(t),s=t.pathname||"/",i=t.auth?lAe(t.auth):"";return`${e}//${i}${r}${n}${s}`}function lAe(t){let[e,r]=t.split(":");return`${e?"[Filtered]":""}:${r?"[Filtered]":""}@`}function uAe(t,e,r){if(!t)return t;let[n,s]=t.split(" ");return e.host&&!e.protocol&&(e.protocol=Kn([r,"optionalAccess",i=>i.agent,"optionalAccess",i=>i.protocol]),s=x$(e)),Kn([s,"optionalAccess",i=>i.startsWith,"call",i=>i("///")])&&(s=s.slice(2)),`${n} ${s}`}function YE(t){let e={protocol:t.protocol,hostname:typeof t.hostname=="string"&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,hash:t.hash,search:t.search,pathname:t.pathname,path:`${t.pathname||""}${t.search||""}`,href:t.href};return t.port!==""&&(e.port=Number(t.port)),(t.username||t.password)&&(e.auth=`${t.username}:${t.password}`),e}function dAe(t,e){let r,n;if(typeof e[e.length-1]=="function"&&(r=e.pop()),typeof e[0]=="string")n=YE(new UE.URL(e[0]));else if(e[0]instanceof UE.URL)n=YE(e[0]);else{n=e[0];try{let s=new UE.URL(n.path||"",`${n.protocol||"http:"}//${n.hostname}`);n={pathname:s.pathname,search:s.search,hash:s.hash,...n}}catch{}}return e.length===2&&(n={...n,...e[1]}),n.protocol===void 0&&(aAe.NODE_VERSION.major>8?n.protocol=Kn([Kn([t,"optionalAccess",s=>s.globalAgent]),"optionalAccess",s=>s.protocol])||Kn([n.agent,"optionalAccess",s=>s.protocol])||Kn([n._defaultAgent,"optionalAccess",s=>s.protocol]):n.protocol=Kn([n.agent,"optionalAccess",s=>s.protocol])||Kn([n._defaultAgent,"optionalAccess",s=>s.protocol])||Kn([Kn([t,"optionalAccess",s=>s.globalAgent]),"optionalAccess",s=>s.protocol])),r?[n,r]:[n]}function L$(t){let e=t.protocol||"",r=t.hostname||t.host||"",n=!t.port||t.port===80||t.port===443||/^(.*):(\d+)$/.test(r)?"":`:${t.port}`;return{protocol:e,hostname:r,port:n}}Wo.cleanSpanDescription=uAe;Wo.extractRawUrl=cAe;Wo.extractUrl=x$;Wo.normalizeRequestArgs=dAe;Wo.urlToOptions=YE});var $E=h(XE=>{var{_optionalChain:Zc}=O();Object.defineProperty(XE,"__esModule",{value:!0});var $r=ge(),jr=O(),DE=Zd(),fAe=Vo(),Nd=U$(),Vd=class t{static __initStatic(){this.id="Http"}__init(){this.name=t.id}constructor(e={}){t.prototype.__init.call(this),this._breadcrumbs=typeof e.breadcrumbs>"u"?!0:e.breadcrumbs,this._tracing=e.tracing?e.tracing===!0?{}:e.tracing:void 0}setupOnce(e,r){if(!this._breadcrumbs&&!this._tracing)return;let n=Zc([r,"call",c=>c(),"access",c=>c.getClient,"call",c=>c(),"optionalAccess",c=>c.getOptions,"call",c=>c()]);if(n&&n.instrumenter!=="sentry"){DE.DEBUG_BUILD&&jr.logger.log("HTTP Integration is skipped because of instrumenter configuration.");return}let s=Zc([this,"access",c=>c._tracing,"optionalAccess",c=>c.shouldCreateSpanForRequest])||Zc([n,"optionalAccess",c=>c.shouldCreateSpanForRequest]),i=Zc([n,"optionalAccess",c=>c.tracePropagationTargets])||Zc([this,"access",c=>c._tracing,"optionalAccess",c=>c.tracePropagationTargets]),o=require("http"),a=Y$(o,this._breadcrumbs,s,i);if(jr.fill(o,"get",a),jr.fill(o,"request",a),fAe.NODE_VERSION.major>8){let c=require("https"),l=Y$(c,this._breadcrumbs,s,i);jr.fill(c,"get",l),jr.fill(c,"request",l)}}};Vd.__initStatic();function Y$(t,e,r,n){let s=new jr.LRUMap(100),i=new jr.LRUMap(100),o=l=>{if(r===void 0)return!0;let u=s.get(l);if(u!==void 0)return u;let d=r(l);return s.set(l,d),d},a=l=>{if(n===void 0)return!0;let u=i.get(l);if(u!==void 0)return u;let d=jr.stringMatchesSomePattern(l,n);return i.set(l,d),d};function c(l,u,d,f){$r.getCurrentHub().getIntegration(Vd)&&$r.addBreadcrumb({category:"http",data:{status_code:f&&f.statusCode,...u},type:"http"},{event:l,request:d,response:f})}return function(u){return function(...f){let g=Nd.normalizeRequestArgs(t,f),p=g[0],m=Nd.extractRawUrl(p),I=Nd.extractUrl(p);if($r.isSentryRequestUrl(I,$r.getClient()))return u.apply(t,g);let C=$r.getCurrentScope(),S=$r.getActiveSpan(),b=gAe(I,p),y=o(m)?Zc([S,"optionalAccess",A=>A.startChild,"call",A=>A({op:"http.client",origin:"auto.http.node.http",description:`${b["http.method"]} ${b.url}`,data:b})]):void 0;if(a(m))if(y){let A=$r.spanToTraceHeader(y),E=$r.getDynamicSamplingContextFromSpan(y);D$(p,I,A,E)}else{let A=$r.getClient(),{traceId:E,sampled:v,dsc:B}=C.getPropagationContext(),H=jr.generateSentryTraceHeader(E,void 0,v),R=B||(A?$r.getDynamicSamplingContextFromClient(E,A,C):void 0);D$(p,I,H,R)}else DE.DEBUG_BUILD&&jr.logger.log(`[Tracing] Not adding sentry-trace header to outgoing request (${I}) due to mismatching tracePropagationTargets option.`);return u.apply(t,g).once("response",function(A){let E=this;e&&c("response",b,E,A),y&&(A.statusCode&&y.setHttpStatus(A.statusCode),y.updateName(Nd.cleanSpanDescription($r.spanToJSON(y).description||"",p,E)||""),y.end())}).once("error",function(){let A=this;e&&c("error",b,A),y&&(y.setHttpStatus(500),y.updateName(Nd.cleanSpanDescription($r.spanToJSON(y).description||"",p,A)||""),y.end())})}}}function D$(t,e,r,n){if((t.headers||{})["sentry-trace"])return;DE.DEBUG_BUILD&&jr.logger.log(`[Tracing] Adding sentry-trace header ${r} to outgoing request to "${e}": `);let i=jr.dynamicSamplingContextToSentryBaggageHeader(n),o=i&&i.length>0?pAe(t,i):void 0;t.headers={...t.headers,"sentry-trace":r,...o&&{baggage:o}}}function gAe(t,e){let r=e.method||"GET",n={url:t,"http.method":r};return e.hash&&(n["http.fragment"]=e.hash.substring(1)),e.search&&(n["http.query"]=e.search.substring(1)),n}function pAe(t,e){if(!t.headers||!t.headers.baggage)return e;if(e){if(Array.isArray(t.headers.baggage))return[...t.headers.baggage,e]}else return t.headers.baggage;return[t.headers.baggage,e]}XE.Http=Vd});var ME=h(qE=>{Object.defineProperty(qE,"__esModule",{value:!0});var hAe=ge(),jm=O(),jE=Zd(),mAe=2e3;function yAe(t){jm.consoleSandbox(()=>{console.error(t)});let e=hAe.getClient();e===void 0&&(jE.DEBUG_BUILD&&jm.logger.warn("No NodeClient was defined, we are exiting the process now."),global.process.exit(1));let r=e.getOptions(),n=r&&r.shutdownTimeout&&r.shutdownTimeout>0&&r.shutdownTimeout||mAe;e.close(n).then(s=>{s||jE.DEBUG_BUILD&&jm.logger.warn("We reached the timeout for emptying the request buffer, still exiting now!"),global.process.exit(1)},s=>{jE.DEBUG_BUILD&&jm.logger.error(s)})}qE.logAndExitProcess=yAe});var zE=h(qm=>{Object.defineProperty(qm,"__esModule",{value:!0});var KE=ge(),IAe=O(),bAe=Zd(),X$=ME(),$$="OnUncaughtException",CAe=(t={})=>{let e={exitEvenIfOtherHandlersAreRegistered:!0,...t};return{name:$$,setupOnce(){},setup(r){global.process.on("uncaughtException",j$(r,e))}}},SAe=KE.convertIntegrationFnToClass($$,CAe);function j$(t,e){let n=!1,s=!1,i=!1,o,a=t.getOptions();return Object.assign(c=>{let l=X$.logAndExitProcess;e.onFatalError?l=e.onFatalError:a.onFatalError&&(l=a.onFatalError);let d=global.process.listeners("uncaughtException").reduce((g,p)=>p.name==="domainUncaughtExceptionClear"||p.tag&&p.tag==="sentry_tracingErrorCallback"||p._errorHandler?g:g+1,0)===0,f=e.exitEvenIfOtherHandlersAreRegistered||d;n?f&&(i?(bAe.DEBUG_BUILD&&IAe.logger.warn("uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown"),X$.logAndExitProcess(c)):s||(s=!0,setTimeout(()=>{i||(i=!0,l(o,c))},2e3))):(o=c,n=!0,KE.getClient()===t&&KE.captureException(c,{originalException:c,captureContext:{level:"fatal"},mechanism:{handled:!1,type:"onuncaughtexception"}}),!i&&f&&(i=!0,l(c)))},{_errorHandler:!0})}qm.OnUncaughtException=SAe;qm.makeErrorHandler=j$});var QE=h(Mm=>{Object.defineProperty(Mm,"__esModule",{value:!0});var JE=ge(),q$=O(),vAe=ME(),M$="OnUnhandledRejection",_Ae=(t={})=>{let e=t.mode||"warn";return{name:M$,setupOnce(){},setup(r){global.process.on("unhandledRejection",K$(r,{mode:e}))}}},AAe=JE.convertIntegrationFnToClass(M$,_Ae);function K$(t,e){return function(n,s){JE.getClient()===t&&(JE.captureException(n,{originalException:s,captureContext:{extra:{unhandledPromiseRejection:!0}},mechanism:{handled:!1,type:"onunhandledrejection"}}),RAe(n,e))}}function RAe(t,e){let r="This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:";e.mode==="warn"?q$.consoleSandbox(()=>{console.warn(r),console.error(t&&t.stack?t.stack:t)}):e.mode==="strict"&&(q$.consoleSandbox(()=>{console.warn(r)}),vAe.logAndExitProcess(t))}Mm.OnUnhandledRejection=AAe;Mm.makeUnhandledPromiseHandler=K$});var rw=h(tw=>{Object.defineProperty(tw,"__esModule",{value:!0});var z$=require("fs"),J$=require("path"),EAe=ge(),ew,Q$="Modules";function wAe(){try{return require.cache?Object.keys(require.cache):[]}catch{return[]}}function BAe(){let t=require.main&&require.main.paths||[],e=wAe(),r={},n={};return e.forEach(s=>{let i=s,o=()=>{let a=i;if(i=J$.dirname(a),!i||a===i||n[a])return;if(t.indexOf(i)<0)return o();let c=J$.join(a,"package.json");if(n[a]=!0,!z$.existsSync(c))return o();try{let l=JSON.parse(z$.readFileSync(c,"utf8"));r[l.name]=l.version}catch{}};o()}),r}function TAe(){return ew||(ew=BAe()),ew}var GAe=()=>({name:Q$,setupOnce(){},processEvent(t){return t.modules={...t.modules,...TAe()},t}}),ZAe=EAe.convertIntegrationFnToClass(Q$,GAe);tw.Modules=ZAe});var iw=h(sw=>{var{_optionalChain:nw}=O();Object.defineProperty(sw,"__esModule",{value:!0});var NAe=require("fs"),VAe=ge(),ej=O(),Km=new ej.LRUMap(100),HAe=7,tj="ContextLines";function WAe(t){return new Promise((e,r)=>{NAe.readFile(t,"utf8",(n,s)=>{n?r(n):e(s)})})}var OAe=(t={})=>{let e=t.frameContextLines!==void 0?t.frameContextLines:HAe;return{name:tj,setupOnce(){},processEvent(r){return kAe(r,e)}}},PAe=VAe.convertIntegrationFnToClass(tj,OAe);async function kAe(t,e){let r={},n=[];if(e>0&&nw([t,"access",s=>s.exception,"optionalAccess",s=>s.values])){for(let s of t.exception.values)if(nw([s,"access",i=>i.stacktrace,"optionalAccess",i=>i.frames]))for(let i=s.stacktrace.frames.length-1;i>=0;i--){let o=s.stacktrace.frames[i];o.filename&&!r[o.filename]&&!Km.get(o.filename)&&(n.push(xAe(o.filename)),r[o.filename]=1)}}if(n.length>0&&await Promise.all(n),e>0&&nw([t,"access",s=>s.exception,"optionalAccess",s=>s.values]))for(let s of t.exception.values)s.stacktrace&&s.stacktrace.frames&&await FAe(s.stacktrace.frames,e);return t}function FAe(t,e){for(let r of t)if(r.filename&&r.context_line===void 0){let n=Km.get(r.filename);if(n)try{ej.addContextToFrame(n,r,e)}catch{}}}async function xAe(t){let e=Km.get(t);if(e===null)return null;if(e!==void 0)return e;let r=null;try{r=(await WAe(t)).split(`
`)}catch{}return Km.set(t,r),r}sw.ContextLines=PAe});var ow=h(Nc=>{var{_optionalChain:Oo}=O();Object.defineProperty(Nc,"__esModule",{value:!0});var LAe=require("child_process"),nj=require("fs"),qr=require("os"),UAe=require("path"),sj=require("util"),YAe=ge(),ij=sj.promisify(nj.readFile),oj=sj.promisify(nj.readdir),aj="Context",DAe=(t={})=>{let e,r={app:!0,os:!0,device:!0,culture:!0,cloudResource:!0,...t};async function n(i){e===void 0&&(e=s());let o=$Ae(await e);return i.contexts={...i.contexts,app:{...o.app,...Oo([i,"access",a=>a.contexts,"optionalAccess",a=>a.app])},os:{...o.os,...Oo([i,"access",a=>a.contexts,"optionalAccess",a=>a.os])},device:{...o.device,...Oo([i,"access",a=>a.contexts,"optionalAccess",a=>a.device])},culture:{...o.culture,...Oo([i,"access",a=>a.contexts,"optionalAccess",a=>a.culture])},cloud_resource:{...o.cloud_resource,...Oo([i,"access",a=>a.contexts,"optionalAccess",a=>a.cloud_resource])}},i}async function s(){let i={};if(r.os&&(i.os=await jAe()),r.app&&(i.app=MAe()),r.device&&(i.device=cj(r.device)),r.culture){let o=qAe();o&&(i.culture=o)}return r.cloudResource&&(i.cloud_resource=tRe()),i}return{name:aj,setupOnce(){},processEvent(i){return n(i)}}},XAe=YAe.convertIntegrationFnToClass(aj,DAe);function $Ae(t){return Oo([t,"optionalAccess",e=>e.app,"optionalAccess",e=>e.app_memory])&&(t.app.app_memory=process.memoryUsage().rss),Oo([t,"optionalAccess",e=>e.device,"optionalAccess",e=>e.free_memory])&&(t.device.free_memory=qr.freemem()),t}async function jAe(){let t=qr.platform();switch(t){case"darwin":return QAe();case"linux":return eRe();default:return{name:KAe[t]||t,version:qr.release()}}}function qAe(){try{if(typeof process.versions.icu!="string")return;let t=new Date(9e8);if(new Intl.DateTimeFormat("es",{month:"long"}).format(t)==="enero"){let r=Intl.DateTimeFormat().resolvedOptions();return{locale:r.locale,timezone:r.timeZone}}}catch{}}function MAe(){let t=process.memoryUsage().rss;return{app_start_time:new Date(Date.now()-process.uptime()*1e3).toISOString(),app_memory:t}}function cj(t){let e={},r;try{r=qr.uptime&&qr.uptime()}catch{}if(typeof r=="number"&&(e.boot_time=new Date(Date.now()-r*1e3).toISOString()),e.arch=qr.arch(),(t===!0||t.memory)&&(e.memory_size=qr.totalmem(),e.free_memory=qr.freemem()),t===!0||t.cpu){let n=qr.cpus();if(n&&n.length){let s=n[0];e.processor_count=n.length,e.cpu_description=s.model,e.processor_frequency=s.speed}}return e}var KAe={aix:"IBM AIX",freebsd:"FreeBSD",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"},zAe=[{name:"fedora-release",distros:["Fedora"]},{name:"redhat-release",distros:["Red Hat Linux","Centos"]},{name:"redhat_version",distros:["Red Hat Linux"]},{name:"SuSE-release",distros:["SUSE Linux"]},{name:"lsb-release",distros:["Ubuntu Linux","Arch Linux"]},{name:"debian_version",distros:["Debian"]},{name:"debian_release",distros:["Debian"]},{name:"arch-release",distros:["Arch Linux"]},{name:"gentoo-release",distros:["Gentoo Linux"]},{name:"novell-release",distros:["SUSE Linux"]},{name:"alpine-release",distros:["Alpine Linux"]}],JAe={alpine:t=>t,arch:t=>zn(/distrib_release=(.*)/,t),centos:t=>zn(/release ([^ ]+)/,t),debian:t=>t,fedora:t=>zn(/release (..)/,t),mint:t=>zn(/distrib_release=(.*)/,t),red:t=>zn(/release ([^ ]+)/,t),suse:t=>zn(/VERSION = (.*)\n/,t),ubuntu:t=>zn(/distrib_release=(.*)/,t)};function zn(t,e){let r=t.exec(e);return r?r[1]:void 0}async function QAe(){let t={kernel_version:qr.release(),name:"Mac OS X",version:`10.${Number(qr.release().split(".")[0])-4}`};try{let e=await new Promise((r,n)=>{LAe.execFile("/usr/bin/sw_vers",(s,i)=>{if(s){n(s);return}r(i)})});t.name=zn(/^ProductName:\s+(.*)$/m,e),t.version=zn(/^ProductVersion:\s+(.*)$/m,e),t.build=zn(/^BuildVersion:\s+(.*)$/m,e)}catch{}return t}function rj(t){return t.split(" ")[0].toLowerCase()}async function eRe(){let t={kernel_version:qr.release(),name:"Linux"};try{let e=await oj("/etc"),r=zAe.find(a=>e.includes(a.name));if(!r)return t;let n=UAe.join("/etc",r.name),s=(await ij(n,{encoding:"utf-8"})).toLowerCase(),{distros:i}=r;t.name=i.find(a=>s.indexOf(rj(a))>=0)||i[0];let o=rj(t.name);t.version=JAe[o](s)}catch{}return t}function tRe(){return process.env.VERCEL?{"cloud.provider":"vercel","cloud.region":process.env.VERCEL_REGION}:process.env.AWS_REGION?{"cloud.provider":"aws","cloud.region":process.env.AWS_REGION,"cloud.platform":process.env.AWS_EXECUTION_ENV}:process.env.GCP_PROJECT?{"cloud.provider":"gcp"}:process.env.ALIYUN_REGION_ID?{"cloud.provider":"alibaba_cloud","cloud.region":process.env.ALIYUN_REGION_ID}:process.env.WEBSITE_SITE_NAME&&process.env.REGION_NAME?{"cloud.provider":"azure","cloud.region":process.env.REGION_NAME}:process.env.IBM_CLOUD_REGION?{"cloud.provider":"ibm_cloud","cloud.region":process.env.IBM_CLOUD_REGION}:process.env.TENCENTCLOUD_REGION?{"cloud.provider":"tencent_cloud","cloud.region":process.env.TENCENTCLOUD_REGION,"cloud.account.id":process.env.TENCENTCLOUD_APPID,"cloud.availability_zone":process.env.TENCENTCLOUD_ZONE}:process.env.NETLIFY?{"cloud.provider":"netlify"}:process.env.FLY_REGION?{"cloud.provider":"fly.io","cloud.region":process.env.FLY_REGION}:process.env.DYNO?{"cloud.provider":"heroku"}:void 0}Nc.Context=XAe;Nc.getDeviceContext=cj;Nc.readDirAsync=oj;Nc.readFileAsync=ij});var uj=h(Po=>{Object.defineProperty(Po,"__esModule",{value:!0});function rRe(t,e,r){let n=0,s=5,i=0;return setInterval(()=>{i===0?n>t&&(s*=2,r(s),s>86400&&(s=86400),i=s):(i-=1,i===0&&e()),n=0},1e3).unref(),()=>{n+=1}}function aw(t){return t!==void 0&&(t.length===0||t==="?"||t==="<anonymous>")}function nRe(t,e){return t===e||aw(t)&&aw(e)}function lj(t){if(t!==void 0)return t.slice(-10).reduce((e,r)=>`${e},${r.function},${r.lineno},${r.colno}`,"")}function sRe(t,e){if(e!==void 0)return lj(t(e,1))}Po.createRateLimiter=rRe;Po.functionNamesMatch=nRe;Po.hashFrames=lj;Po.hashFromStack=sRe;Po.isAnonymous=aw});var fj=h(Qm=>{var{_optionalChain:ht}=O();Object.defineProperty(Qm,"__esModule",{value:!0});var iRe=ge(),zm=O(),oRe=Vo(),Jm=uj();function lw(t){let e=[],r=!1;function n(o){e=[],!r&&(r=!0,t(o))}e.push(n);function s(o){e.push(o)}function i(o){let a=e.pop()||n;try{a(o)}catch{n(o)}}return{add:s,next:i}}var cw=class{constructor(){let{Session:e}=require("inspector");this._session=new e}configureAndConnect(e,r){this._session.connect(),this._session.on("Debugger.paused",n=>{e(n,()=>{this._session.post("Debugger.resume")})}),this._session.post("Debugger.enable"),this._session.post("Debugger.setPauseOnExceptions",{state:r?"all":"uncaught"})}setPauseOnExceptions(e){this._session.post("Debugger.setPauseOnExceptions",{state:e?"all":"uncaught"})}getLocalVariables(e,r){this._getProperties(e,n=>{let{add:s,next:i}=lw(r);for(let o of n)if(ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.objectId])&&ht([o,"optionalAccess",a=>a.value,"access",a=>a.className])==="Array"){let a=o.value.objectId;s(c=>this._unrollArray(a,o.name,c,i))}else if(ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.objectId])&&ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.className])==="Object"){let a=o.value.objectId;s(c=>this._unrollObject(a,o.name,c,i))}else(ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])||ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.description]))&&s(a=>this._unrollOther(o,a,i));i({})})}_getProperties(e,r){this._session.post("Runtime.getProperties",{objectId:e,ownProperties:!0},(n,s)=>{r(n?[]:s.result)})}_unrollArray(e,r,n,s){this._getProperties(e,i=>{n[r]=i.filter(o=>o.name!=="length"&&!isNaN(parseInt(o.name,10))).sort((o,a)=>parseInt(o.name,10)-parseInt(a.name,10)).map(o=>ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])),s(n)})}_unrollObject(e,r,n,s){this._getProperties(e,i=>{n[r]=i.map(o=>[o.name,ht([o,"optionalAccess",a=>a.value,"optionalAccess",a=>a.value])]).reduce((o,[a,c])=>(o[a]=c,o),{}),s(n)})}_unrollOther(e,r,n){ht([e,"optionalAccess",s=>s.value,"optionalAccess",s=>s.value])?r[e.name]=e.value.value:ht([e,"optionalAccess",s=>s.value,"optionalAccess",s=>s.description])&&ht([e,"optionalAccess",s=>s.value,"optionalAccess",s=>s.type])!=="function"&&(r[e.name]=`<${e.value.description}>`),n(r)}};function aRe(){try{return new cw}catch{return}}var dj="LocalVariables",cRe=(t={},e=aRe())=>{let r=new zm.LRUMap(20),n,s=!1;function i(c,{params:{reason:l,data:u,callFrames:d}},f){if(l!=="exception"&&l!=="promiseRejection"){f();return}ht([n,"optionalCall",I=>I()]);let g=Jm.hashFromStack(c,ht([u,"optionalAccess",I=>I.description]));if(g==null){f();return}let{add:p,next:m}=lw(I=>{r.set(g,I),f()});for(let I=0;I<Math.min(d.length,5);I++){let{scopeChain:C,functionName:S,this:b}=d[I],y=C.find(E=>E.type==="local"),A=b.className==="global"||!b.className?S:`${b.className}.${S}`;if(ht([y,"optionalAccess",E=>E.object,"access",E=>E.objectId])===void 0)p(E=>{E[I]={function:A},m(E)});else{let E=y.object.objectId;p(v=>ht([e,"optionalAccess",B=>B.getLocalVariables,"call",B=>B(E,H=>{v[I]={function:A,vars:H},m(v)})]))}}m([])}function o(c){let l=Jm.hashFrames(ht([c,"optionalAccess",f=>f.stacktrace,"optionalAccess",f=>f.frames]));if(l===void 0)return;let u=r.remove(l);if(u===void 0)return;let d=ht([c,"access",f=>f.stacktrace,"optionalAccess",f=>f.frames,"optionalAccess",f=>f.length])||0;for(let f=0;f<d;f++){let g=d-f-1;if(!ht([c,"optionalAccess",p=>p.stacktrace,"optionalAccess",p=>p.frames,"optionalAccess",p=>p[g]])||!u[f])break;u[f].vars===void 0||c.stacktrace.frames[g].in_app===!1||!Jm.functionNamesMatch(c.stacktrace.frames[g].function,u[f].function)||(c.stacktrace.frames[g].vars=u[f].vars)}}function a(c){for(let l of ht([c,"optionalAccess",u=>u.exception,"optionalAccess",u=>u.values])||[])o(l);return c}return{name:dj,setupOnce(){},setup(c){let l=c.getOptions();if(e&&l.includeLocalVariables){if(oRe.NODE_VERSION.major<18){zm.logger.log("The `LocalVariables` integration is only supported on Node >= v18.");return}let d=t.captureAllExceptions!==!1;if(e.configureAndConnect((f,g)=>i(l.stackParser,f,g),d),d){let f=t.maxExceptionsPerSecond||50;n=Jm.createRateLimiter(f,()=>{zm.logger.log("Local variables rate-limit lifted."),ht([e,"optionalAccess",g=>g.setPauseOnExceptions,"call",g=>g(!0)])},g=>{zm.logger.log(`Local variables rate-limit exceeded. Disabling capturing of caught exceptions for ${g} seconds.`),ht([e,"optionalAccess",p=>p.setPauseOnExceptions,"call",p=>p(!1)])})}s=!0}},processEvent(c){return s?a(c):c},_getCachedFramesCount(){return r.size},_getFirstCachedFrame(){return r.values()[0]}}},lRe=iRe.convertIntegrationFnToClass(dj,cRe);Qm.LocalVariablesSync=lRe;Qm.createCallbackList=lw});var dw=h(uw=>{Object.defineProperty(uw,"__esModule",{value:!0});var uRe=fj(),dRe=uRe.LocalVariablesSync;uw.LocalVariables=dRe});var fw=h((xs,pj)=>{var{_optionalChain:ey}=O();Object.defineProperty(xs,"__esModule",{value:!0});var Jt=ge(),Fs=O(),fRe=Vo();xs.ChannelName=void 0;(function(t){let e="undici:request:create";t.RequestCreate=e;let r="undici:request:headers";t.RequestEnd=r;let n="undici:request:error";t.RequestError=n})(xs.ChannelName||(xs.ChannelName={}));var ty=class t{static __initStatic(){this.id="Undici"}__init(){this.name=t.id}__init2(){this._createSpanUrlMap=new Fs.LRUMap(100)}__init3(){this._headersUrlMap=new Fs.LRUMap(100)}constructor(e={}){t.prototype.__init.call(this),t.prototype.__init2.call(this),t.prototype.__init3.call(this),t.prototype.__init4.call(this),t.prototype.__init5.call(this),t.prototype.__init6.call(this),this._options={breadcrumbs:e.breadcrumbs===void 0?!0:e.breadcrumbs,shouldCreateSpanForRequest:e.shouldCreateSpanForRequest}}setupOnce(e){if(fRe.NODE_VERSION.major<16)return;let r;try{r=Fs.dynamicRequire(pj,"diagnostics_channel")}catch{}!r||!r.subscribe||(r.subscribe(xs.ChannelName.RequestCreate,this._onRequestCreate),r.subscribe(xs.ChannelName.RequestEnd,this._onRequestEnd),r.subscribe(xs.ChannelName.RequestError,this._onRequestError))}_shouldCreateSpan(e){if(this._options.shouldCreateSpanForRequest===void 0)return!0;let r=this._createSpanUrlMap.get(e);if(r!==void 0)return r;let n=this._options.shouldCreateSpanForRequest(e);return this._createSpanUrlMap.set(e,n),n}__init4(){this._onRequestCreate=e=>{if(!ey([Jt.getClient,"call",u=>u(),"optionalAccess",u=>u.getIntegration,"call",u=>u(t)]))return;let{request:r}=e,n=r.origin?r.origin.toString()+r.path:r.path,s=Jt.getClient();if(!s||Jt.isSentryRequestUrl(n,s)||r.__sentry_span__!==void 0)return;let i=s.getOptions(),o=Jt.getCurrentScope(),a=Jt.getActiveSpan(),c=this._shouldCreateSpan(n)?gRe(a,r,n):void 0;if(c&&(r.__sentry_span__=c),(u=>{if(i.tracePropagationTargets===void 0)return!0;let d=this._headersUrlMap.get(u);if(d!==void 0)return d;let f=Fs.stringMatchesSomePattern(u,i.tracePropagationTargets);return this._headersUrlMap.set(u,f),f})(n))if(c){let u=Jt.getDynamicSamplingContextFromSpan(c),d=Fs.dynamicSamplingContextToSentryBaggageHeader(u);gj(r,Jt.spanToTraceHeader(c),d)}else{let{traceId:u,sampled:d,dsc:f}=o.getPropagationContext(),g=Fs.generateSentryTraceHeader(u,void 0,d),p=f||Jt.getDynamicSamplingContextFromClient(u,s,o),m=Fs.dynamicSamplingContextToSentryBaggageHeader(p);gj(r,g,m)}}}__init5(){this._onRequestEnd=e=>{if(!ey([Jt.getClient,"call",o=>o(),"optionalAccess",o=>o.getIntegration,"call",o=>o(t)]))return;let{request:r,response:n}=e,s=r.origin?r.origin.toString()+r.path:r.path;if(Jt.isSentryRequestUrl(s,Jt.getClient()))return;let i=r.__sentry_span__;i&&(i.setHttpStatus(n.statusCode),i.end()),this._options.breadcrumbs&&Jt.addBreadcrumb({category:"http",data:{method:r.method,status_code:n.statusCode,url:s},type:"http"},{event:"response",request:r,response:n})}}__init6(){this._onRequestError=e=>{if(!ey([Jt.getClient,"call",i=>i(),"optionalAccess",i=>i.getIntegration,"call",i=>i(t)]))return;let{request:r}=e,n=r.origin?r.origin.toString()+r.path:r.path;if(Jt.isSentryRequestUrl(n,Jt.getClient()))return;let s=r.__sentry_span__;s&&(s.setStatus("internal_error"),s.end()),this._options.breadcrumbs&&Jt.addBreadcrumb({category:"http",data:{method:r.method,url:n},level:"error",type:"http"},{event:"error",request:r})}}};ty.__initStatic();function gj(t,e,r){t.headers.split(`\r
`).some(i=>i.startsWith("sentry-trace:"))||(t.addHeader("sentry-trace",e),r&&t.addHeader("baggage",r))}function gRe(t,e,r){let n=Fs.parseUrl(r),s=e.method||"GET",i={"http.method":s};return n.search&&(i["http.query"]=n.search),n.hash&&(i["http.fragment"]=n.hash),ey([t,"optionalAccess",o=>o.startChild,"call",o=>o({op:"http.client",origin:"auto.http.node.undici",description:`${s} ${Fs.getSanitizedUrlString(n)}`,data:i})])}xs.Undici=ty});var pw=h(gw=>{Object.defineProperty(gw,"__esModule",{value:!0});var pRe=require("http"),hRe=require("url"),mRe=ge(),Vc=O(),hj="Spotlight",yRe=(t={})=>{let e={sidecarUrl:t.sidecarUrl||"http://localhost:8969/stream"};return{name:hj,setupOnce(){},setup(r){typeof process=="object"&&process.env&&process.env.NODE_ENV!=="development"&&Vc.logger.warn("[Spotlight] It seems you're not in dev mode. Do you really want to have Spotlight enabled?"),bRe(r,e)}}},IRe=mRe.convertIntegrationFnToClass(hj,yRe);function bRe(t,e){let r=CRe(e.sidecarUrl);if(!r)return;let n=0;if(typeof t.on!="function"){Vc.logger.warn("[Spotlight] Cannot connect to spotlight due to missing method on SDK client (`client.on`)");return}t.on("beforeEnvelope",s=>{if(n>3){Vc.logger.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests");return}let i=Vc.serializeEnvelope(s),o=pRe.request({method:"POST",path:r.pathname,hostname:r.hostname,port:r.port,headers:{"Content-Type":"application/x-sentry-envelope"}},a=>{a.on("data",()=>{}),a.on("end",()=>{}),a.setEncoding("utf8")});o.on("error",()=>{n++,Vc.logger.warn("[Spotlight] Failed to send envelope to Spotlight Sidecar")}),o.write(i),o.end()})}function CRe(t){try{return new hRe.URL(`${t}`)}catch{Vc.logger.warn(`[Spotlight] Invalid sidecar URL: ${t}`);return}}gw.Spotlight=IRe});var yj=h(mj=>{mj.base64WorkerScript="aW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJ2luc3BlY3Rvcic7CmltcG9ydCB7IHdvcmtlckRhdGEsIHBhcmVudFBvcnQgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7CmltcG9ydCB7IHBvc2l4LCBzZXAgfSBmcm9tICdwYXRoJzsKaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJzsKaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnOwppbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7CmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7CmltcG9ydCB7IGNyZWF0ZUd6aXAgfSBmcm9tICd6bGliJzsKaW1wb3J0IGFzc2VydCBmcm9tICdhc3NlcnQnOwppbXBvcnQgKiBhcyBuZXQgZnJvbSAnbmV0JzsKaW1wb3J0ICogYXMgdGxzIGZyb20gJ3Rscyc7CgovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kCmNvbnN0IG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgb25lIG9mIGEgZmV3IEVycm9yIG9yIEVycm9yLWxpa2UKICoge0BsaW5rIGlzRXJyb3J9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNFcnJvcih3YXQpIHsKICBzd2l0Y2ggKG9iamVjdFRvU3RyaW5nLmNhbGwod2F0KSkgewogICAgY2FzZSAnW29iamVjdCBFcnJvcl0nOgogICAgY2FzZSAnW29iamVjdCBFeGNlcHRpb25dJzoKICAgIGNhc2UgJ1tvYmplY3QgRE9NRXhjZXB0aW9uXSc6CiAgICAgIHJldHVybiB0cnVlOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGlzSW5zdGFuY2VPZih3YXQsIEVycm9yKTsKICB9Cn0KLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlIGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlbiBidWlsdC1pbiBjbGFzcy4KICoKICogQHBhcmFtIHdhdCBUaGUgdmFsdWUgdG8gYmUgY2hlY2tlZAogKiBAcGFyYW0gY2xhc3NOYW1lCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzQnVpbHRpbih3YXQsIGNsYXNzTmFtZSkgewogIHJldHVybiBvYmplY3RUb1N0cmluZy5jYWxsKHdhdCkgPT09IGBbb2JqZWN0ICR7Y2xhc3NOYW1lfV1gOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGEgc3RyaW5nCiAqIHtAbGluayBpc1N0cmluZ30uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1N0cmluZyh3YXQpIHsKICByZXR1cm4gaXNCdWlsdGluKHdhdCwgJ1N0cmluZycpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIG9iamVjdCBsaXRlcmFsLCBvciBhIGNsYXNzIGluc3RhbmNlLgogKiB7QGxpbmsgaXNQbGFpbk9iamVjdH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1BsYWluT2JqZWN0KHdhdCkgewogIHJldHVybiBpc0J1aWx0aW4od2F0LCAnT2JqZWN0Jyk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYW4gRXZlbnQgaW5zdGFuY2UKICoge0BsaW5rIGlzRXZlbnR9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNFdmVudCh3YXQpIHsKICByZXR1cm4gdHlwZW9mIEV2ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2Yod2F0LCBFdmVudCk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYW4gRWxlbWVudCBpbnN0YW5jZQogKiB7QGxpbmsgaXNFbGVtZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRWxlbWVudCh3YXQpIHsKICByZXR1cm4gdHlwZW9mIEVsZW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGlzSW5zdGFuY2VPZih3YXQsIEVsZW1lbnQpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUgaGFzIGEgdGhlbiBmdW5jdGlvbi4KICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqLwpmdW5jdGlvbiBpc1RoZW5hYmxlKHdhdCkgewogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MKICByZXR1cm4gQm9vbGVhbih3YXQgJiYgd2F0LnRoZW4gJiYgdHlwZW9mIHdhdC50aGVuID09PSAnZnVuY3Rpb24nKTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIFN5bnRoZXRpY0V2ZW50CiAqIHtAbGluayBpc1N5bnRoZXRpY0V2ZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzU3ludGhldGljRXZlbnQod2F0KSB7CiAgcmV0dXJuIGlzUGxhaW5PYmplY3Qod2F0KSAmJiAnbmF0aXZlRXZlbnQnIGluIHdhdCAmJiAncHJldmVudERlZmF1bHQnIGluIHdhdCAmJiAnc3RvcFByb3BhZ2F0aW9uJyBpbiB3YXQ7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSBpcyBOYU4KICoge0BsaW5rIGlzTmFOfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzTmFOJDEod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiB3YXQgPT09ICdudW1iZXInICYmIHdhdCAhPT0gd2F0Owp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIGluc3RhbmNlIG9mIHByb3ZpZGVkIGNvbnN0cnVjdG9yLgogKiB7QGxpbmsgaXNJbnN0YW5jZU9mfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEBwYXJhbSBiYXNlIEEgY29uc3RydWN0b3IgdG8gYmUgdXNlZCBpbiBhIGNoZWNrLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0luc3RhbmNlT2Yod2F0LCBiYXNlKSB7CiAgdHJ5IHsKICAgIHJldHVybiB3YXQgaW5zdGFuY2VvZiBiYXNlOwogIH0gY2F0Y2ggKF9lKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGEgVnVlIFZpZXdNb2RlbC4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzVnVlVmlld01vZGVsKHdhdCkgewogIC8vIE5vdCB1c2luZyBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nIGJlY2F1c2UgaW4gVnVlIDMgaXQgd291bGQgcmVhZCB0aGUgaW5zdGFuY2UncyBTeW1ib2woU3ltYm9sLnRvU3RyaW5nVGFnKSBwcm9wZXJ0eS4KICByZXR1cm4gISEodHlwZW9mIHdhdCA9PT0gJ29iamVjdCcgJiYgd2F0ICE9PSBudWxsICYmICgod2F0ICkuX19pc1Z1ZSB8fCAod2F0ICkuX2lzVnVlKSk7Cn0KCi8qKiBJbnRlcm5hbCBnbG9iYWwgd2l0aCBjb21tb24gcHJvcGVydGllcyBhbmQgU2VudHJ5IGV4dGVuc2lvbnMgICovCgovLyBUaGUgY29kZSBiZWxvdyBmb3IgJ2lzR2xvYmFsT2JqJyBhbmQgJ0dMT0JBTF9PQkonIHdhcyBjb3BpZWQgZnJvbSBjb3JlLWpzIGJlZm9yZSBtb2RpZmljYXRpb24KLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvYmxvYi8xYjk0NGRmNTUyODJjZGM5OWM5MGRiNWY0OWViMGI2ZWRhMmNjMGEzL3BhY2thZ2VzL2NvcmUtanMvaW50ZXJuYWxzL2dsb2JhbC5qcwovLyBjb3JlLWpzIGhhcyB0aGUgZm9sbG93aW5nIGxpY2VuY2U6Ci8vCi8vIENvcHlyaWdodCAoYykgMjAxNC0yMDIyIERlbmlzIFB1c2hrYXJldgovLwovLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5Ci8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAovLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKLy8KLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCi8vCi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAovLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgovLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAovLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCi8vIFRIRSBTT0ZUV0FSRS4KCi8qKiBSZXR1cm5zICdvYmonIGlmIGl0J3MgdGhlIGdsb2JhbCBvYmplY3QsIG90aGVyd2lzZSByZXR1cm5zIHVuZGVmaW5lZCAqLwpmdW5jdGlvbiBpc0dsb2JhbE9iaihvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5NYXRoID09IE1hdGggPyBvYmogOiB1bmRlZmluZWQ7Cn0KCi8qKiBHZXQncyB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgdGhlIGN1cnJlbnQgSmF2YVNjcmlwdCBydW50aW1lICovCmNvbnN0IEdMT0JBTF9PQkogPQogICh0eXBlb2YgZ2xvYmFsVGhpcyA9PSAnb2JqZWN0JyAmJiBpc0dsb2JhbE9iaihnbG9iYWxUaGlzKSkgfHwKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgKHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmood2luZG93KSkgfHwKICAodHlwZW9mIHNlbGYgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooc2VsZikpIHx8CiAgKHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooZ2xvYmFsKSkgfHwKICAoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfSkoKSB8fAogIHt9OwoKLyoqCiAqIEBkZXByZWNhdGVkIFVzZSBHTE9CQUxfT0JKIGluc3RlYWQgb3IgV0lORE9XIGZyb20gQHNlbnRyeS9icm93c2VyLiBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OAogKi8KZnVuY3Rpb24gZ2V0R2xvYmFsT2JqZWN0KCkgewogIHJldHVybiBHTE9CQUxfT0JKIDsKfQoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmNvbnN0IFdJTkRPVyA9IGdldEdsb2JhbE9iamVjdCgpOwoKY29uc3QgREVGQVVMVF9NQVhfU1RSSU5HX0xFTkdUSCA9IDgwOwoKLyoqCiAqIEdpdmVuIGEgY2hpbGQgRE9NIGVsZW1lbnQsIHJldHVybnMgYSBxdWVyeS1zZWxlY3RvciBzdGF0ZW1lbnQgZGVzY3JpYmluZyB0aGF0CiAqIGFuZCBpdHMgYW5jZXN0b3JzCiAqIGUuZy4gW0hUTUxFbGVtZW50XSA9PiBib2R5ID4gZGl2ID4gaW5wdXQjZm9vLmJ0bltuYW1lPWJhel0KICogQHJldHVybnMgZ2VuZXJhdGVkIERPTSBwYXRoCiAqLwpmdW5jdGlvbiBodG1sVHJlZUFzU3RyaW5nKAogIGVsZW0sCiAgb3B0aW9ucyA9IHt9LAopIHsKICBpZiAoIWVsZW0pIHsKICAgIHJldHVybiAnPHVua25vd24+JzsKICB9CgogIC8vIHRyeS9jYXRjaCBib3RoOgogIC8vIC0gYWNjZXNzaW5nIGV2ZW50LnRhcmdldCAoc2VlIGdldHNlbnRyeS9yYXZlbi1qcyM4MzgsICM3NjgpCiAgLy8gLSBgaHRtbFRyZWVBc1N0cmluZ2AgYmVjYXVzZSBpdCdzIGNvbXBsZXgsIGFuZCBqdXN0IGFjY2Vzc2luZyB0aGUgRE9NIGluY29ycmVjdGx5CiAgLy8gLSBjYW4gdGhyb3cgYW4gZXhjZXB0aW9uIGluIHNvbWUgY2lyY3Vtc3RhbmNlcy4KICB0cnkgewogICAgbGV0IGN1cnJlbnRFbGVtID0gZWxlbSA7CiAgICBjb25zdCBNQVhfVFJBVkVSU0VfSEVJR0hUID0gNTsKICAgIGNvbnN0IG91dCA9IFtdOwogICAgbGV0IGhlaWdodCA9IDA7CiAgICBsZXQgbGVuID0gMDsKICAgIGNvbnN0IHNlcGFyYXRvciA9ICcgPiAnOwogICAgY29uc3Qgc2VwTGVuZ3RoID0gc2VwYXJhdG9yLmxlbmd0aDsKICAgIGxldCBuZXh0U3RyOwogICAgY29uc3Qga2V5QXR0cnMgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMpID8gb3B0aW9ucyA6IG9wdGlvbnMua2V5QXR0cnM7CiAgICBjb25zdCBtYXhTdHJpbmdMZW5ndGggPSAoIUFycmF5LmlzQXJyYXkob3B0aW9ucykgJiYgb3B0aW9ucy5tYXhTdHJpbmdMZW5ndGgpIHx8IERFRkFVTFRfTUFYX1NUUklOR19MRU5HVEg7CgogICAgd2hpbGUgKGN1cnJlbnRFbGVtICYmIGhlaWdodCsrIDwgTUFYX1RSQVZFUlNFX0hFSUdIVCkgewogICAgICBuZXh0U3RyID0gX2h0bWxFbGVtZW50QXNTdHJpbmcoY3VycmVudEVsZW0sIGtleUF0dHJzKTsKICAgICAgLy8gYmFpbCBvdXQgaWYKICAgICAgLy8gLSBuZXh0U3RyIGlzIHRoZSAnaHRtbCcgZWxlbWVudAogICAgICAvLyAtIHRoZSBsZW5ndGggb2YgdGhlIHN0cmluZyB0aGF0IHdvdWxkIGJlIGNyZWF0ZWQgZXhjZWVkcyBtYXhTdHJpbmdMZW5ndGgKICAgICAgLy8gICAoaWdub3JlIHRoaXMgbGltaXQgaWYgd2UgYXJlIG9uIHRoZSBmaXJzdCBpdGVyYXRpb24pCiAgICAgIGlmIChuZXh0U3RyID09PSAnaHRtbCcgfHwgKGhlaWdodCA+IDEgJiYgbGVuICsgb3V0Lmxlbmd0aCAqIHNlcExlbmd0aCArIG5leHRTdHIubGVuZ3RoID49IG1heFN0cmluZ0xlbmd0aCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgb3V0LnB1c2gobmV4dFN0cik7CgogICAgICBsZW4gKz0gbmV4dFN0ci5sZW5ndGg7CiAgICAgIGN1cnJlbnRFbGVtID0gY3VycmVudEVsZW0ucGFyZW50Tm9kZTsKICAgIH0KCiAgICByZXR1cm4gb3V0LnJldmVyc2UoKS5qb2luKHNlcGFyYXRvcik7CiAgfSBjYXRjaCAoX29PKSB7CiAgICByZXR1cm4gJzx1bmtub3duPic7CiAgfQp9CgovKioKICogUmV0dXJucyBhIHNpbXBsZSwgcXVlcnktc2VsZWN0b3IgcmVwcmVzZW50YXRpb24gb2YgYSBET00gZWxlbWVudAogKiBlLmcuIFtIVE1MRWxlbWVudF0gPT4gaW5wdXQjZm9vLmJ0bltuYW1lPWJhel0KICogQHJldHVybnMgZ2VuZXJhdGVkIERPTSBwYXRoCiAqLwpmdW5jdGlvbiBfaHRtbEVsZW1lbnRBc1N0cmluZyhlbCwga2V5QXR0cnMpIHsKICBjb25zdCBlbGVtID0gZWwKCjsKCiAgY29uc3Qgb3V0ID0gW107CiAgbGV0IGNsYXNzTmFtZTsKICBsZXQgY2xhc3NlczsKICBsZXQga2V5OwogIGxldCBhdHRyOwogIGxldCBpOwoKICBpZiAoIWVsZW0gfHwgIWVsZW0udGFnTmFtZSkgewogICAgcmV0dXJuICcnOwogIH0KCiAgLy8gQHRzLWV4cGVjdC1lcnJvciBXSU5ET1cgaGFzIEhUTUxFbGVtZW50CiAgaWYgKFdJTkRPVy5IVE1MRWxlbWVudCkgewogICAgLy8gSWYgdXNpbmcgdGhlIGNvbXBvbmVudCBuYW1lIGFubm90YXRpb24gcGx1Z2luLCB0aGlzIHZhbHVlIG1heSBiZSBhdmFpbGFibGUgb24gdGhlIERPTSBub2RlCiAgICBpZiAoZWxlbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIGVsZW0uZGF0YXNldCAmJiBlbGVtLmRhdGFzZXRbJ3NlbnRyeUNvbXBvbmVudCddKSB7CiAgICAgIHJldHVybiBlbGVtLmRhdGFzZXRbJ3NlbnRyeUNvbXBvbmVudCddOwogICAgfQogIH0KCiAgb3V0LnB1c2goZWxlbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpOwoKICAvLyBQYWlycyBvZiBhdHRyaWJ1dGUga2V5cyBkZWZpbmVkIGluIGBzZXJpYWxpemVBdHRyaWJ1dGVgIGFuZCB0aGVpciB2YWx1ZXMgb24gZWxlbWVudC4KICBjb25zdCBrZXlBdHRyUGFpcnMgPQogICAga2V5QXR0cnMgJiYga2V5QXR0cnMubGVuZ3RoCiAgICAgID8ga2V5QXR0cnMuZmlsdGVyKGtleUF0dHIgPT4gZWxlbS5nZXRBdHRyaWJ1dGUoa2V5QXR0cikpLm1hcChrZXlBdHRyID0+IFtrZXlBdHRyLCBlbGVtLmdldEF0dHJpYnV0ZShrZXlBdHRyKV0pCiAgICAgIDogbnVsbDsKCiAgaWYgKGtleUF0dHJQYWlycyAmJiBrZXlBdHRyUGFpcnMubGVuZ3RoKSB7CiAgICBrZXlBdHRyUGFpcnMuZm9yRWFjaChrZXlBdHRyUGFpciA9PiB7CiAgICAgIG91dC5wdXNoKGBbJHtrZXlBdHRyUGFpclswXX09IiR7a2V5QXR0clBhaXJbMV19Il1gKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBpZiAoZWxlbS5pZCkgewogICAgICBvdXQucHVzaChgIyR7ZWxlbS5pZH1gKTsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0CiAgICBjbGFzc05hbWUgPSBlbGVtLmNsYXNzTmFtZTsKICAgIGlmIChjbGFzc05hbWUgJiYgaXNTdHJpbmcoY2xhc3NOYW1lKSkgewogICAgICBjbGFzc2VzID0gY2xhc3NOYW1lLnNwbGl0KC9ccysvKTsKICAgICAgZm9yIChpID0gMDsgaSA8IGNsYXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBvdXQucHVzaChgLiR7Y2xhc3Nlc1tpXX1gKTsKICAgICAgfQogICAgfQogIH0KICBjb25zdCBhbGxvd2VkQXR0cnMgPSBbJ2FyaWEtbGFiZWwnLCAndHlwZScsICduYW1lJywgJ3RpdGxlJywgJ2FsdCddOwogIGZvciAoaSA9IDA7IGkgPCBhbGxvd2VkQXR0cnMubGVuZ3RoOyBpKyspIHsKICAgIGtleSA9IGFsbG93ZWRBdHRyc1tpXTsKICAgIGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZShrZXkpOwogICAgaWYgKGF0dHIpIHsKICAgICAgb3V0LnB1c2goYFske2tleX09IiR7YXR0cn0iXWApOwogICAgfQogIH0KICByZXR1cm4gb3V0LmpvaW4oJycpOwp9CgovKioKICogVGhpcyBzZXJ2ZXMgYXMgYSBidWlsZCB0aW1lIGZsYWcgdGhhdCB3aWxsIGJlIHRydWUgYnkgZGVmYXVsdCwgYnV0IGZhbHNlIGluIG5vbi1kZWJ1ZyBidWlsZHMgb3IgaWYgdXNlcnMgcmVwbGFjZSBgX19TRU5UUllfREVCVUdfX2AgaW4gdGhlaXIgZ2VuZXJhdGVkIGNvZGUuCiAqCiAqIEFUVEVOVElPTjogVGhpcyBjb25zdGFudCBtdXN0IG5ldmVyIGNyb3NzIHBhY2thZ2UgYm91bmRhcmllcyAoaS5lLiBiZSBleHBvcnRlZCkgdG8gZ3VhcmFudGVlIHRoYXQgaXQgY2FuIGJlIHVzZWQgZm9yIHRyZWUgc2hha2luZy4KICovCmNvbnN0IERFQlVHX0JVSUxEJDEgPSAodHlwZW9mIF9fU0VOVFJZX0RFQlVHX18gPT09ICd1bmRlZmluZWQnIHx8IF9fU0VOVFJZX0RFQlVHX18pOwoKLyoqIFByZWZpeCBmb3IgbG9nZ2luZyBzdHJpbmdzICovCmNvbnN0IFBSRUZJWCA9ICdTZW50cnkgTG9nZ2VyICc7Cgpjb25zdCBDT05TT0xFX0xFVkVMUyA9IFsKICAnZGVidWcnLAogICdpbmZvJywKICAnd2FybicsCiAgJ2Vycm9yJywKICAnbG9nJywKICAnYXNzZXJ0JywKICAndHJhY2UnLApdIDsKCi8qKiBUaGlzIG1heSBiZSBtdXRhdGVkIGJ5IHRoZSBjb25zb2xlIGluc3RydW1lbnRhdGlvbi4gKi8KY29uc3Qgb3JpZ2luYWxDb25zb2xlTWV0aG9kcwoKID0ge307CgovKiogSlNEb2MgKi8KCi8qKgogKiBUZW1wb3JhcmlseSBkaXNhYmxlIHNlbnRyeSBjb25zb2xlIGluc3RydW1lbnRhdGlvbnMuCiAqCiAqIEBwYXJhbSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gcnVuIGFnYWluc3QgdGhlIG9yaWdpbmFsIGBjb25zb2xlYCBtZXNzYWdlcwogKiBAcmV0dXJucyBUaGUgcmVzdWx0cyBvZiB0aGUgY2FsbGJhY2sKICovCmZ1bmN0aW9uIGNvbnNvbGVTYW5kYm94KGNhbGxiYWNrKSB7CiAgaWYgKCEoJ2NvbnNvbGUnIGluIEdMT0JBTF9PQkopKSB7CiAgICByZXR1cm4gY2FsbGJhY2soKTsKICB9CgogIGNvbnN0IGNvbnNvbGUgPSBHTE9CQUxfT0JKLmNvbnNvbGUgOwogIGNvbnN0IHdyYXBwZWRGdW5jcyA9IHt9OwoKICBjb25zdCB3cmFwcGVkTGV2ZWxzID0gT2JqZWN0LmtleXMob3JpZ2luYWxDb25zb2xlTWV0aG9kcykgOwoKICAvLyBSZXN0b3JlIGFsbCB3cmFwcGVkIGNvbnNvbGUgbWV0aG9kcwogIHdyYXBwZWRMZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7CiAgICBjb25zdCBvcmlnaW5hbENvbnNvbGVNZXRob2QgPSBvcmlnaW5hbENvbnNvbGVNZXRob2RzW2xldmVsXSA7CiAgICB3cmFwcGVkRnVuY3NbbGV2ZWxdID0gY29uc29sZVtsZXZlbF0gOwogICAgY29uc29sZVtsZXZlbF0gPSBvcmlnaW5hbENvbnNvbGVNZXRob2Q7CiAgfSk7CgogIHRyeSB7CiAgICByZXR1cm4gY2FsbGJhY2soKTsKICB9IGZpbmFsbHkgewogICAgLy8gUmV2ZXJ0IHJlc3RvcmF0aW9uIHRvIHdyYXBwZWQgc3RhdGUKICAgIHdyYXBwZWRMZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7CiAgICAgIGNvbnNvbGVbbGV2ZWxdID0gd3JhcHBlZEZ1bmNzW2xldmVsXSA7CiAgICB9KTsKICB9Cn0KCmZ1bmN0aW9uIG1ha2VMb2dnZXIoKSB7CiAgbGV0IGVuYWJsZWQgPSBmYWxzZTsKICBjb25zdCBsb2dnZXIgPSB7CiAgICBlbmFibGU6ICgpID0+IHsKICAgICAgZW5hYmxlZCA9IHRydWU7CiAgICB9LAogICAgZGlzYWJsZTogKCkgPT4gewogICAgICBlbmFibGVkID0gZmFsc2U7CiAgICB9LAogICAgaXNFbmFibGVkOiAoKSA9PiBlbmFibGVkLAogIH07CgogIGlmIChERUJVR19CVUlMRCQxKSB7CiAgICBDT05TT0xFX0xFVkVMUy5mb3JFYWNoKG5hbWUgPT4gewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgICBsb2dnZXJbbmFtZV0gPSAoLi4uYXJncykgPT4gewogICAgICAgIGlmIChlbmFibGVkKSB7CiAgICAgICAgICBjb25zb2xlU2FuZGJveCgoKSA9PiB7CiAgICAgICAgICAgIEdMT0JBTF9PQkouY29uc29sZVtuYW1lXShgJHtQUkVGSVh9WyR7bmFtZX1dOmAsIC4uLmFyZ3MpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfSk7CiAgfSBlbHNlIHsKICAgIENPTlNPTEVfTEVWRUxTLmZvckVhY2gobmFtZSA9PiB7CiAgICAgIGxvZ2dlcltuYW1lXSA9ICgpID0+IHVuZGVmaW5lZDsKICAgIH0pOwogIH0KCiAgcmV0dXJuIGxvZ2dlciA7Cn0KCmNvbnN0IGxvZ2dlciA9IG1ha2VMb2dnZXIoKTsKCi8qKgogKiBSZW5kZXJzIHRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBEc24uCiAqCiAqIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCByZW5kZXIgdGhlIHB1YmxpYyByZXByZXNlbnRhdGlvbiB3aXRob3V0IHRoZSBwYXNzd29yZAogKiBjb21wb25lbnQuIFRvIGdldCB0aGUgZGVwcmVjYXRlZCBwcml2YXRlIHJlcHJlc2VudGF0aW9uLCBzZXQgYHdpdGhQYXNzd29yZGAKICogdG8gdHJ1ZS4KICoKICogQHBhcmFtIHdpdGhQYXNzd29yZCBXaGVuIHNldCB0byB0cnVlLCB0aGUgcGFzc3dvcmQgd2lsbCBiZSBpbmNsdWRlZC4KICovCmZ1bmN0aW9uIGRzblRvU3RyaW5nKGRzbiwgd2l0aFBhc3N3b3JkID0gZmFsc2UpIHsKICBjb25zdCB7IGhvc3QsIHBhdGgsIHBhc3MsIHBvcnQsIHByb2plY3RJZCwgcHJvdG9jb2wsIHB1YmxpY0tleSB9ID0gZHNuOwogIHJldHVybiAoCiAgICBgJHtwcm90b2NvbH06Ly8ke3B1YmxpY0tleX0ke3dpdGhQYXNzd29yZCAmJiBwYXNzID8gYDoke3Bhc3N9YCA6ICcnfWAgKwogICAgYEAke2hvc3R9JHtwb3J0ID8gYDoke3BvcnR9YCA6ICcnfS8ke3BhdGggPyBgJHtwYXRofS9gIDogcGF0aH0ke3Byb2plY3RJZH1gCiAgKTsKfQoKLyoqIEFuIGVycm9yIGVtaXR0ZWQgYnkgU2VudHJ5IFNES3MgYW5kIHJlbGF0ZWQgdXRpbGl0aWVzLiAqLwpjbGFzcyBTZW50cnlFcnJvciBleHRlbmRzIEVycm9yIHsKICAvKiogRGlzcGxheSBuYW1lIG9mIHRoaXMgZXJyb3IgaW5zdGFuY2UuICovCgogICBjb25zdHJ1Y3RvciggbWVzc2FnZSwgbG9nTGV2ZWwgPSAnd2FybicpIHsKICAgIHN1cGVyKG1lc3NhZ2UpO3RoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB0aGlzLm5hbWUgPSBuZXcudGFyZ2V0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5uYW1lOwogICAgLy8gVGhpcyBzZXRzIHRoZSBwcm90b3R5cGUgdG8gYmUgYEVycm9yYCwgbm90IGBTZW50cnlFcnJvcmAuIEl0J3MgdW5jbGVhciB3aHkgd2UgZG8gdGhpcywgYnV0IGNvbW1lbnRpbmcgdGhpcyBsaW5lCiAgICAvLyBvdXQgY2F1c2VzIHZhcmlvdXMgKHNlZW1pbmdseSB0b3RhbGx5IHVucmVsYXRlZCkgcGxheXdyaWdodCB0ZXN0cyBjb25zaXN0ZW50bHkgdGltZSBvdXQuIEZZSSwgdGhpcyBtYWtlcwogICAgLy8gaW5zdGFuY2VzIG9mIGBTZW50cnlFcnJvcmAgZmFpbCBgb2JqIGluc3RhbmNlb2YgU2VudHJ5RXJyb3JgIGNoZWNrcy4KICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBuZXcudGFyZ2V0LnByb3RvdHlwZSk7CiAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7CiAgfQp9CgovKioKICogRW5jb2RlcyBnaXZlbiBvYmplY3QgaW50byB1cmwtZnJpZW5kbHkgZm9ybWF0CiAqCiAqIEBwYXJhbSBvYmplY3QgQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgc2VyaWFsaXphYmxlIHZhbHVlcwogKiBAcmV0dXJucyBzdHJpbmcgRW5jb2RlZAogKi8KZnVuY3Rpb24gdXJsRW5jb2RlKG9iamVjdCkgewogIHJldHVybiBPYmplY3Qua2V5cyhvYmplY3QpCiAgICAubWFwKGtleSA9PiBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQob2JqZWN0W2tleV0pfWApCiAgICAuam9pbignJicpOwp9CgovKioKICogVHJhbnNmb3JtcyBhbnkgYEVycm9yYCBvciBgRXZlbnRgIGludG8gYSBwbGFpbiBvYmplY3Qgd2l0aCBhbGwgb2YgdGhlaXIgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLCBhbmQgc29tZSBvZiB0aGVpcgogKiBub24tZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGF0dGFjaGVkLgogKgogKiBAcGFyYW0gdmFsdWUgSW5pdGlhbCBzb3VyY2UgdGhhdCB3ZSBoYXZlIHRvIHRyYW5zZm9ybSBpbiBvcmRlciBmb3IgaXQgdG8gYmUgdXNhYmxlIGJ5IHRoZSBzZXJpYWxpemVyCiAqIEByZXR1cm5zIEFuIEV2ZW50IG9yIEVycm9yIHR1cm5lZCBpbnRvIGFuIG9iamVjdCAtIG9yIHRoZSB2YWx1ZSBhcmd1cm1lbnQgaXRzZWxmLCB3aGVuIHZhbHVlIGlzIG5laXRoZXIgYW4gRXZlbnQgbm9yCiAqICBhbiBFcnJvci4KICovCmZ1bmN0aW9uIGNvbnZlcnRUb1BsYWluT2JqZWN0KAogIHZhbHVlLAopCgogewogIGlmIChpc0Vycm9yKHZhbHVlKSkgewogICAgcmV0dXJuIHsKICAgICAgbWVzc2FnZTogdmFsdWUubWVzc2FnZSwKICAgICAgbmFtZTogdmFsdWUubmFtZSwKICAgICAgc3RhY2s6IHZhbHVlLnN0YWNrLAogICAgICAuLi5nZXRPd25Qcm9wZXJ0aWVzKHZhbHVlKSwKICAgIH07CiAgfSBlbHNlIGlmIChpc0V2ZW50KHZhbHVlKSkgewogICAgY29uc3QgbmV3T2JqCgogPSB7CiAgICAgIHR5cGU6IHZhbHVlLnR5cGUsCiAgICAgIHRhcmdldDogc2VyaWFsaXplRXZlbnRUYXJnZXQodmFsdWUudGFyZ2V0KSwKICAgICAgY3VycmVudFRhcmdldDogc2VyaWFsaXplRXZlbnRUYXJnZXQodmFsdWUuY3VycmVudFRhcmdldCksCiAgICAgIC4uLmdldE93blByb3BlcnRpZXModmFsdWUpLAogICAgfTsKCiAgICBpZiAodHlwZW9mIEN1c3RvbUV2ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2YodmFsdWUsIEN1c3RvbUV2ZW50KSkgewogICAgICBuZXdPYmouZGV0YWlsID0gdmFsdWUuZGV0YWlsOwogICAgfQoKICAgIHJldHVybiBuZXdPYmo7CiAgfSBlbHNlIHsKICAgIHJldHVybiB2YWx1ZTsKICB9Cn0KCi8qKiBDcmVhdGVzIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB0YXJnZXQgb2YgYW4gYEV2ZW50YCBvYmplY3QgKi8KZnVuY3Rpb24gc2VyaWFsaXplRXZlbnRUYXJnZXQodGFyZ2V0KSB7CiAgdHJ5IHsKICAgIHJldHVybiBpc0VsZW1lbnQodGFyZ2V0KSA/IGh0bWxUcmVlQXNTdHJpbmcodGFyZ2V0KSA6IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0YXJnZXQpOwogIH0gY2F0Y2ggKF9vTykgewogICAgcmV0dXJuICc8dW5rbm93bj4nOwogIH0KfQoKLyoqIEZpbHRlcnMgb3V0IGFsbCBidXQgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgKi8KZnVuY3Rpb24gZ2V0T3duUHJvcGVydGllcyhvYmopIHsKICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSB7CiAgICBjb25zdCBleHRyYWN0ZWRQcm9wcyA9IHt9OwogICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBvYmopIHsKICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3BlcnR5KSkgewogICAgICAgIGV4dHJhY3RlZFByb3BzW3Byb3BlcnR5XSA9IChvYmogKVtwcm9wZXJ0eV07CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBleHRyYWN0ZWRQcm9wczsKICB9IGVsc2UgewogICAgcmV0dXJuIHt9OwogIH0KfQoKLyoqCiAqIEdpdmVuIGFueSBvYmplY3QsIHJldHVybiBhIG5ldyBvYmplY3QgaGF2aW5nIHJlbW92ZWQgYWxsIGZpZWxkcyB3aG9zZSB2YWx1ZSB3YXMgYHVuZGVmaW5lZGAuCiAqIFdvcmtzIHJlY3Vyc2l2ZWx5IG9uIG9iamVjdHMgYW5kIGFycmF5cy4KICoKICogQXR0ZW50aW9uOiBUaGlzIGZ1bmN0aW9uIGtlZXBzIGNpcmN1bGFyIHJlZmVyZW5jZXMgaW4gdGhlIHJldHVybmVkIG9iamVjdC4KICovCmZ1bmN0aW9uIGRyb3BVbmRlZmluZWRLZXlzKGlucHV0VmFsdWUpIHsKICAvLyBUaGlzIG1hcCBrZWVwcyB0cmFjayBvZiB3aGF0IGFscmVhZHkgdmlzaXRlZCBub2RlcyBtYXAgdG8uCiAgLy8gT3VyIFNldCAtIGJhc2VkIG1lbW9CdWlsZGVyIGRvZXNuJ3Qgd29yayBoZXJlIGJlY2F1c2Ugd2Ugd2FudCB0byB0aGUgb3V0cHV0IG9iamVjdCB0byBoYXZlIHRoZSBzYW1lIGNpcmN1bGFyCiAgLy8gcmVmZXJlbmNlcyBhcyB0aGUgaW5wdXQgb2JqZWN0LgogIGNvbnN0IG1lbW9pemF0aW9uTWFwID0gbmV3IE1hcCgpOwoKICAvLyBUaGlzIGZ1bmN0aW9uIGp1c3QgcHJveGllcyBgX2Ryb3BVbmRlZmluZWRLZXlzYCB0byBrZWVwIHRoZSBgbWVtb0J1aWxkZXJgIG91dCBvZiB0aGlzIGZ1bmN0aW9uJ3MgQVBJCiAgcmV0dXJuIF9kcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlLCBtZW1vaXphdGlvbk1hcCk7Cn0KCmZ1bmN0aW9uIF9kcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlLCBtZW1vaXphdGlvbk1hcCkgewogIGlmIChpc1Bvam8oaW5wdXRWYWx1ZSkpIHsKICAgIC8vIElmIHRoaXMgbm9kZSBoYXMgYWxyZWFkeSBiZWVuIHZpc2l0ZWQgZHVlIHRvIGEgY2lyY3VsYXIgcmVmZXJlbmNlLCByZXR1cm4gdGhlIG9iamVjdCBpdCB3YXMgbWFwcGVkIHRvIGluIHRoZSBuZXcgb2JqZWN0CiAgICBjb25zdCBtZW1vVmFsID0gbWVtb2l6YXRpb25NYXAuZ2V0KGlucHV0VmFsdWUpOwogICAgaWYgKG1lbW9WYWwgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbWVtb1ZhbCA7CiAgICB9CgogICAgY29uc3QgcmV0dXJuVmFsdWUgPSB7fTsKICAgIC8vIFN0b3JlIHRoZSBtYXBwaW5nIG9mIHRoaXMgdmFsdWUgaW4gY2FzZSB3ZSB2aXNpdCBpdCBhZ2FpbiwgaW4gY2FzZSBvZiBjaXJjdWxhciBkYXRhCiAgICBtZW1vaXphdGlvbk1hcC5zZXQoaW5wdXRWYWx1ZSwgcmV0dXJuVmFsdWUpOwoKICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGlucHV0VmFsdWUpKSB7CiAgICAgIGlmICh0eXBlb2YgaW5wdXRWYWx1ZVtrZXldICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIHJldHVyblZhbHVlW2tleV0gPSBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZVtrZXldLCBtZW1vaXphdGlvbk1hcCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmV0dXJuVmFsdWUgOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXRWYWx1ZSkpIHsKICAgIC8vIElmIHRoaXMgbm9kZSBoYXMgYWxyZWFkeSBiZWVuIHZpc2l0ZWQgZHVlIHRvIGEgY2lyY3VsYXIgcmVmZXJlbmNlLCByZXR1cm4gdGhlIGFycmF5IGl0IHdhcyBtYXBwZWQgdG8gaW4gdGhlIG5ldyBvYmplY3QKICAgIGNvbnN0IG1lbW9WYWwgPSBtZW1vaXphdGlvbk1hcC5nZXQoaW5wdXRWYWx1ZSk7CiAgICBpZiAobWVtb1ZhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBtZW1vVmFsIDsKICAgIH0KCiAgICBjb25zdCByZXR1cm5WYWx1ZSA9IFtdOwogICAgLy8gU3RvcmUgdGhlIG1hcHBpbmcgb2YgdGhpcyB2YWx1ZSBpbiBjYXNlIHdlIHZpc2l0IGl0IGFnYWluLCBpbiBjYXNlIG9mIGNpcmN1bGFyIGRhdGEKICAgIG1lbW9pemF0aW9uTWFwLnNldChpbnB1dFZhbHVlLCByZXR1cm5WYWx1ZSk7CgogICAgaW5wdXRWYWx1ZS5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgIHJldHVyblZhbHVlLnB1c2goX2Ryb3BVbmRlZmluZWRLZXlzKGl0ZW0sIG1lbW9pemF0aW9uTWFwKSk7CiAgICB9KTsKCiAgICByZXR1cm4gcmV0dXJuVmFsdWUgOwogIH0KCiAgcmV0dXJuIGlucHV0VmFsdWU7Cn0KCmZ1bmN0aW9uIGlzUG9qbyhpbnB1dCkgewogIGlmICghaXNQbGFpbk9iamVjdChpbnB1dCkpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHRyeSB7CiAgICBjb25zdCBuYW1lID0gKE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnB1dCkgKS5jb25zdHJ1Y3Rvci5uYW1lOwogICAgcmV0dXJuICFuYW1lIHx8IG5hbWUgPT09ICdPYmplY3QnOwogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqCiAqIERvZXMgdGhpcyBmaWxlbmFtZSBsb29rIGxpa2UgaXQncyBwYXJ0IG9mIHRoZSBhcHAgY29kZT8KICovCmZ1bmN0aW9uIGZpbGVuYW1lSXNJbkFwcChmaWxlbmFtZSwgaXNOYXRpdmUgPSBmYWxzZSkgewogIGNvbnN0IGlzSW50ZXJuYWwgPQogICAgaXNOYXRpdmUgfHwKICAgIChmaWxlbmFtZSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiBpdCdzIGFuIGFic29sdXRlIGxpbnV4IHBhdGgKICAgICAgIWZpbGVuYW1lLnN0YXJ0c1dpdGgoJy8nKSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiBpdCdzIGFuIGFic29sdXRlIHdpbmRvd3MgcGF0aAogICAgICAhZmlsZW5hbWUubWF0Y2goL15bQS1aXTovKSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiB0aGUgcGF0aCBpcyBzdGFydGluZyB3aXRoIGEgZG90CiAgICAgICFmaWxlbmFtZS5zdGFydHNXaXRoKCcuJykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgdGhlIGZyYW1lIGhhcyBhIHByb3RvY29sLiBJbiBub2RlLCB0aGlzIGlzIHVzdWFsbHkgdGhlIGNhc2UgaWYgdGhlIGZpbGUgZ290IHByZS1wcm9jZXNzZWQgd2l0aCBhIGJ1bmRsZXIgbGlrZSB3ZWJwYWNrCiAgICAgICFmaWxlbmFtZS5tYXRjaCgvXlthLXpBLVpdKFthLXpBLVowLTkuXC0rXSkqOlwvXC8vKSk7IC8vIFNjaGVtYSBmcm9tOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzY0MTc4MgoKICAvLyBpbl9hcHAgaXMgYWxsIHRoYXQncyBub3QgYW4gaW50ZXJuYWwgTm9kZSBmdW5jdGlvbiBvciBhIG1vZHVsZSB3aXRoaW4gbm9kZV9tb2R1bGVzCiAgLy8gbm90ZSB0aGF0IGlzTmF0aXZlIGFwcGVhcnMgdG8gcmV0dXJuIHRydWUgZXZlbiBmb3Igbm9kZSBjb3JlIGxpYnJhcmllcwogIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3JhdmVuLW5vZGUvaXNzdWVzLzE3NgoKICByZXR1cm4gIWlzSW50ZXJuYWwgJiYgZmlsZW5hbWUgIT09IHVuZGVmaW5lZCAmJiAhZmlsZW5hbWUuaW5jbHVkZXMoJ25vZGVfbW9kdWxlcy8nKTsKfQoKY29uc3QgU1RBQ0tUUkFDRV9GUkFNRV9MSU1JVCA9IDUwOwpjb25zdCBTVFJJUF9GUkFNRV9SRUdFWFAgPSAvY2FwdHVyZU1lc3NhZ2V8Y2FwdHVyZUV4Y2VwdGlvbi87CgovKioKICogUmVtb3ZlcyBTZW50cnkgZnJhbWVzIGZyb20gdGhlIHRvcCBhbmQgYm90dG9tIG9mIHRoZSBzdGFjayBpZiBwcmVzZW50IGFuZCBlbmZvcmNlcyBhIGxpbWl0IG9mIG1heCBudW1iZXIgb2YgZnJhbWVzLgogKiBBc3N1bWVzIHN0YWNrIGlucHV0IGlzIG9yZGVyZWQgZnJvbSB0b3AgdG8gYm90dG9tIGFuZCByZXR1cm5zIHRoZSByZXZlcnNlIHJlcHJlc2VudGF0aW9uIHNvIGNhbGwgc2l0ZSBvZiB0aGUKICogZnVuY3Rpb24gdGhhdCBjYXVzZWQgdGhlIGNyYXNoIGlzIHRoZSBsYXN0IGZyYW1lIGluIHRoZSBhcnJheS4KICogQGhpZGRlbgogKi8KZnVuY3Rpb24gc3RyaXBTZW50cnlGcmFtZXNBbmRSZXZlcnNlKHN0YWNrKSB7CiAgaWYgKCFzdGFjay5sZW5ndGgpIHsKICAgIHJldHVybiBbXTsKICB9CgogIGNvbnN0IGxvY2FsU3RhY2sgPSBBcnJheS5mcm9tKHN0YWNrKTsKCiAgLy8gSWYgc3RhY2sgc3RhcnRzIHdpdGggb25lIG9mIG91ciBBUEkgY2FsbHMsIHJlbW92ZSBpdCAoc3RhcnRzLCBtZWFuaW5nIGl0J3MgdGhlIHRvcCBvZiB0aGUgc3RhY2sgLSBha2EgbGFzdCBjYWxsKQogIGlmICgvc2VudHJ5V3JhcHBlZC8udGVzdChsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZnVuY3Rpb24gfHwgJycpKSB7CiAgICBsb2NhbFN0YWNrLnBvcCgpOwogIH0KCiAgLy8gUmV2ZXJzaW5nIGluIHRoZSBtaWRkbGUgb2YgdGhlIHByb2NlZHVyZSBhbGxvd3MgdXMgdG8ganVzdCBwb3AgdGhlIHZhbHVlcyBvZmYgdGhlIHN0YWNrCiAgbG9jYWxTdGFjay5yZXZlcnNlKCk7CgogIC8vIElmIHN0YWNrIGVuZHMgd2l0aCBvbmUgb2Ygb3VyIGludGVybmFsIEFQSSBjYWxscywgcmVtb3ZlIGl0IChlbmRzLCBtZWFuaW5nIGl0J3MgdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2sgLSBha2EgdG9wLW1vc3QgY2FsbCkKICBpZiAoU1RSSVBfRlJBTUVfUkVHRVhQLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgbG9jYWxTdGFjay5wb3AoKTsKCiAgICAvLyBXaGVuIHVzaW5nIHN5bnRoZXRpYyBldmVudHMsIHdlIHdpbGwgaGF2ZSBhIDIgbGV2ZWxzIGRlZXAgc3RhY2ssIGFzIGBuZXcgRXJyb3IoJ1NlbnRyeSBzeW50aGV0aWNFeGNlcHRpb24nKWAKICAgIC8vIGlzIHByb2R1Y2VkIHdpdGhpbiB0aGUgaHViIGl0c2VsZiwgbWFraW5nIGl0OgogICAgLy8KICAgIC8vICAgU2VudHJ5LmNhcHR1cmVFeGNlcHRpb24oKQogICAgLy8gICBnZXRDdXJyZW50SHViKCkuY2FwdHVyZUV4Y2VwdGlvbigpCiAgICAvLwogICAgLy8gaW5zdGVhZCBvZiBqdXN0IHRoZSB0b3AgYFNlbnRyeWAgY2FsbCBpdHNlbGYuCiAgICAvLyBUaGlzIGZvcmNlcyB1cyB0byBwb3NzaWJseSBzdHJpcCBhbiBhZGRpdGlvbmFsIGZyYW1lIGluIHRoZSBleGFjdCBzYW1lIHdhcyBhcyBhYm92ZS4KICAgIGlmIChTVFJJUF9GUkFNRV9SRUdFWFAudGVzdChsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZnVuY3Rpb24gfHwgJycpKSB7CiAgICAgIGxvY2FsU3RhY2sucG9wKCk7CiAgICB9CiAgfQoKICByZXR1cm4gbG9jYWxTdGFjay5zbGljZSgwLCBTVEFDS1RSQUNFX0ZSQU1FX0xJTUlUKS5tYXAoZnJhbWUgPT4gKHsKICAgIC4uLmZyYW1lLAogICAgZmlsZW5hbWU6IGZyYW1lLmZpbGVuYW1lIHx8IGxvY2FsU3RhY2tbbG9jYWxTdGFjay5sZW5ndGggLSAxXS5maWxlbmFtZSwKICAgIGZ1bmN0aW9uOiBmcmFtZS5mdW5jdGlvbiB8fCAnPycsCiAgfSkpOwp9Cgpjb25zdCBkZWZhdWx0RnVuY3Rpb25OYW1lID0gJzxhbm9ueW1vdXM+JzsKCi8qKgogKiBTYWZlbHkgZXh0cmFjdCBmdW5jdGlvbiBuYW1lIGZyb20gaXRzZWxmCiAqLwpmdW5jdGlvbiBnZXRGdW5jdGlvbk5hbWUoZm4pIHsKICB0cnkgewogICAgaWYgKCFmbiB8fCB0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIGRlZmF1bHRGdW5jdGlvbk5hbWU7CiAgICB9CiAgICByZXR1cm4gZm4ubmFtZSB8fCBkZWZhdWx0RnVuY3Rpb25OYW1lOwogIH0gY2F0Y2ggKGUpIHsKICAgIC8vIEp1c3QgYWNjZXNzaW5nIGN1c3RvbSBwcm9wcyBpbiBzb21lIFNlbGVuaXVtIGVudmlyb25tZW50cwogICAgLy8gY2FuIGNhdXNlIGEgIlBlcm1pc3Npb24gZGVuaWVkIiBleGNlcHRpb24gKHNlZSByYXZlbi1qcyM0OTUpLgogICAgcmV0dXJuIGRlZmF1bHRGdW5jdGlvbk5hbWU7CiAgfQp9CgovKioKICogVVVJRDQgZ2VuZXJhdG9yCiAqCiAqIEByZXR1cm5zIHN0cmluZyBHZW5lcmF0ZWQgVVVJRDQuCiAqLwpmdW5jdGlvbiB1dWlkNCgpIHsKICBjb25zdCBnYmwgPSBHTE9CQUxfT0JKIDsKICBjb25zdCBjcnlwdG8gPSBnYmwuY3J5cHRvIHx8IGdibC5tc0NyeXB0bzsKCiAgbGV0IGdldFJhbmRvbUJ5dGUgPSAoKSA9PiBNYXRoLnJhbmRvbSgpICogMTY7CiAgdHJ5IHsKICAgIGlmIChjcnlwdG8gJiYgY3J5cHRvLnJhbmRvbVVVSUQpIHsKICAgICAgcmV0dXJuIGNyeXB0by5yYW5kb21VVUlEKCkucmVwbGFjZSgvLS9nLCAnJyk7CiAgICB9CiAgICBpZiAoY3J5cHRvICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHsKICAgICAgZ2V0UmFuZG9tQnl0ZSA9ICgpID0+IHsKICAgICAgICAvLyBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIG1pZ2h0IHJldHVybiB1bmRlZmluZWQgaW5zdGVhZCBvZiB0aGUgdHlwZWQgYXJyYXkKICAgICAgICAvLyBpbiBvbGQgQ2hyb21pdW0gdmVyc2lvbnMgKGUuZy4gMjMuMC4xMjM1LjAgKDE1MTQyMikpCiAgICAgICAgLy8gSG93ZXZlciwgYHR5cGVkQXJyYXlgIGlzIHN0aWxsIGZpbGxlZCBpbi1wbGFjZS4KICAgICAgICAvLyBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DcnlwdG8vZ2V0UmFuZG9tVmFsdWVzI3R5cGVkYXJyYXkKICAgICAgICBjb25zdCB0eXBlZEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoMSk7CiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyh0eXBlZEFycmF5KTsKICAgICAgICByZXR1cm4gdHlwZWRBcnJheVswXTsKICAgICAgfTsKICAgIH0KICB9IGNhdGNoIChfKSB7CiAgICAvLyBzb21lIHJ1bnRpbWVzIGNhbiBjcmFzaCBpbnZva2luZyBjcnlwdG8KICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzg5MzUKICB9CgogIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MDM0L2hvdy10by1jcmVhdGUtYS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdC8yMTE3NTIzIzIxMTc1MjMKICAvLyBDb25jYXRlbmF0aW5nIHRoZSBmb2xsb3dpbmcgbnVtYmVycyBhcyBzdHJpbmdzIHJlc3VsdHMgaW4gJzEwMDAwMDAwMTAwMDQwMDA4MDAwMTAwMDAwMDAwMDAwJwogIHJldHVybiAoKFsxZTddICkgKyAxZTMgKyA0ZTMgKyA4ZTMgKyAxZTExKS5yZXBsYWNlKC9bMDE4XS9nLCBjID0+CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZQogICAgKChjICkgXiAoKGdldFJhbmRvbUJ5dGUoKSAmIDE1KSA+PiAoKGMgKSAvIDQpKSkudG9TdHJpbmcoMTYpLAogICk7Cn0KCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2VzcyAqLwovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovCgovKioKICogSGVscGVyIHRvIGRlY3ljbGUganNvbiBvYmplY3RzCiAqLwpmdW5jdGlvbiBtZW1vQnVpbGRlcigpIHsKICBjb25zdCBoYXNXZWFrU2V0ID0gdHlwZW9mIFdlYWtTZXQgPT09ICdmdW5jdGlvbic7CiAgY29uc3QgaW5uZXIgPSBoYXNXZWFrU2V0ID8gbmV3IFdlYWtTZXQoKSA6IFtdOwogIGZ1bmN0aW9uIG1lbW9pemUob2JqKSB7CiAgICBpZiAoaGFzV2Vha1NldCkgewogICAgICBpZiAoaW5uZXIuaGFzKG9iaikpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICBpbm5lci5hZGQob2JqKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVmZXItZm9yLW9mCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlubmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaW5uZXJbaV07CiAgICAgIGlmICh2YWx1ZSA9PT0gb2JqKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICAgIGlubmVyLnB1c2gob2JqKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIHVubWVtb2l6ZShvYmopIHsKICAgIGlmIChoYXNXZWFrU2V0KSB7CiAgICAgIGlubmVyLmRlbGV0ZShvYmopOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbm5lci5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChpbm5lcltpXSA9PT0gb2JqKSB7CiAgICAgICAgICBpbm5lci5zcGxpY2UoaSwgMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIFttZW1vaXplLCB1bm1lbW9pemVdOwp9CgovKioKICogUmVjdXJzaXZlbHkgbm9ybWFsaXplcyB0aGUgZ2l2ZW4gb2JqZWN0LgogKgogKiAtIENyZWF0ZXMgYSBjb3B5IHRvIHByZXZlbnQgb3JpZ2luYWwgaW5wdXQgbXV0YXRpb24KICogLSBTa2lwcyBub24tZW51bWVyYWJsZSBwcm9wZXJ0aWVzCiAqIC0gV2hlbiBzdHJpbmdpZnlpbmcsIGNhbGxzIGB0b0pTT05gIGlmIGltcGxlbWVudGVkCiAqIC0gUmVtb3ZlcyBjaXJjdWxhciByZWZlcmVuY2VzCiAqIC0gVHJhbnNsYXRlcyBub24tc2VyaWFsaXphYmxlIHZhbHVlcyAoYHVuZGVmaW5lZGAvYE5hTmAvZnVuY3Rpb25zKSB0byBzZXJpYWxpemFibGUgZm9ybWF0CiAqIC0gVHJhbnNsYXRlcyBrbm93biBnbG9iYWwgb2JqZWN0cy9jbGFzc2VzIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9ucwogKiAtIFRha2VzIGNhcmUgb2YgYEVycm9yYCBvYmplY3Qgc2VyaWFsaXphdGlvbgogKiAtIE9wdGlvbmFsbHkgbGltaXRzIGRlcHRoIG9mIGZpbmFsIG91dHB1dAogKiAtIE9wdGlvbmFsbHkgbGltaXRzIG51bWJlciBvZiBwcm9wZXJ0aWVzL2VsZW1lbnRzIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgb2JqZWN0L2FycmF5CiAqCiAqIEBwYXJhbSBpbnB1dCBUaGUgb2JqZWN0IHRvIGJlIG5vcm1hbGl6ZWQuCiAqIEBwYXJhbSBkZXB0aCBUaGUgbWF4IGRlcHRoIHRvIHdoaWNoIHRvIG5vcm1hbGl6ZSB0aGUgb2JqZWN0LiAoQW55dGhpbmcgZGVlcGVyIHN0cmluZ2lmaWVkIHdob2xlLikKICogQHBhcmFtIG1heFByb3BlcnRpZXMgVGhlIG1heCBudW1iZXIgb2YgZWxlbWVudHMgb3IgcHJvcGVydGllcyB0byBiZSBpbmNsdWRlZCBpbiBhbnkgc2luZ2xlIGFycmF5IG9yCiAqIG9iamVjdCBpbiB0aGUgbm9ybWFsbGl6ZWQgb3V0cHV0LgogKiBAcmV0dXJucyBBIG5vcm1hbGl6ZWQgdmVyc2lvbiBvZiB0aGUgb2JqZWN0LCBvciBgIioqbm9uLXNlcmlhbGl6YWJsZSoqImAgaWYgYW55IGVycm9ycyBhcmUgdGhyb3duIGR1cmluZyBub3JtYWxpemF0aW9uLgogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKZnVuY3Rpb24gbm9ybWFsaXplKGlucHV0LCBkZXB0aCA9IDEwMCwgbWF4UHJvcGVydGllcyA9ICtJbmZpbml0eSkgewogIHRyeSB7CiAgICAvLyBzaW5jZSB3ZSdyZSBhdCB0aGUgb3V0ZXJtb3N0IGxldmVsLCB3ZSBkb24ndCBwcm92aWRlIGEga2V5CiAgICByZXR1cm4gdmlzaXQoJycsIGlucHV0LCBkZXB0aCwgbWF4UHJvcGVydGllcyk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXR1cm4geyBFUlJPUjogYCoqbm9uLXNlcmlhbGl6YWJsZSoqICgke2Vycn0pYCB9OwogIH0KfQoKLyoqCiAqIFZpc2l0cyBhIG5vZGUgdG8gcGVyZm9ybSBub3JtYWxpemF0aW9uIG9uIGl0CiAqCiAqIEBwYXJhbSBrZXkgVGhlIGtleSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBub2RlCiAqIEBwYXJhbSB2YWx1ZSBUaGUgbm9kZSB0byBiZSB2aXNpdGVkCiAqIEBwYXJhbSBkZXB0aCBPcHRpb25hbCBudW1iZXIgaW5kaWNhdGluZyB0aGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGgKICogQHBhcmFtIG1heFByb3BlcnRpZXMgT3B0aW9uYWwgbWF4aW11bSBudW1iZXIgb2YgcHJvcGVydGllcy9lbGVtZW50cyBpbmNsdWRlZCBpbiBhbnkgc2luZ2xlIG9iamVjdC9hcnJheQogKiBAcGFyYW0gbWVtbyBPcHRpb25hbCBNZW1vIGNsYXNzIGhhbmRsaW5nIGRlY3ljbGluZwogKi8KZnVuY3Rpb24gdmlzaXQoCiAga2V5LAogIHZhbHVlLAogIGRlcHRoID0gK0luZmluaXR5LAogIG1heFByb3BlcnRpZXMgPSArSW5maW5pdHksCiAgbWVtbyA9IG1lbW9CdWlsZGVyKCksCikgewogIGNvbnN0IFttZW1vaXplLCB1bm1lbW9pemVdID0gbWVtbzsKCiAgLy8gR2V0IHRoZSBzaW1wbGUgY2FzZXMgb3V0IG9mIHRoZSB3YXkgZmlyc3QKICBpZiAoCiAgICB2YWx1ZSA9PSBudWxsIHx8IC8vIHRoaXMgbWF0Y2hlcyBudWxsIGFuZCB1bmRlZmluZWQgLT4gZXFlcSBub3QgZXFlcWVxCiAgICAoWydudW1iZXInLCAnYm9vbGVhbicsICdzdHJpbmcnXS5pbmNsdWRlcyh0eXBlb2YgdmFsdWUpICYmICFpc05hTiQxKHZhbHVlKSkKICApIHsKICAgIHJldHVybiB2YWx1ZSA7CiAgfQoKICBjb25zdCBzdHJpbmdpZmllZCA9IHN0cmluZ2lmeVZhbHVlKGtleSwgdmFsdWUpOwoKICAvLyBBbnl0aGluZyB3ZSBjb3VsZCBwb3RlbnRpYWxseSBkaWcgaW50byBtb3JlIChvYmplY3RzIG9yIGFycmF5cykgd2lsbCBoYXZlIGNvbWUgYmFjayBhcyBgIltvYmplY3QgWFhYWF0iYC4KICAvLyBFdmVyeXRoaW5nIGVsc2Ugd2lsbCBoYXZlIGFscmVhZHkgYmVlbiBzZXJpYWxpemVkLCBzbyBpZiB3ZSBkb24ndCBzZWUgdGhhdCBwYXR0ZXJuLCB3ZSdyZSBkb25lLgogIGlmICghc3RyaW5naWZpZWQuc3RhcnRzV2l0aCgnW29iamVjdCAnKSkgewogICAgcmV0dXJuIHN0cmluZ2lmaWVkOwogIH0KCiAgLy8gRnJvbSBoZXJlIG9uLCB3ZSBjYW4gYXNzZXJ0IHRoYXQgYHZhbHVlYCBpcyBlaXRoZXIgYW4gb2JqZWN0IG9yIGFuIGFycmF5LgoKICAvLyBEbyBub3Qgbm9ybWFsaXplIG9iamVjdHMgdGhhdCB3ZSBrbm93IGhhdmUgYWxyZWFkeSBiZWVuIG5vcm1hbGl6ZWQuIEFzIGEgZ2VuZXJhbCBydWxlLCB0aGUKICAvLyAiX19zZW50cnlfc2tpcF9ub3JtYWxpemF0aW9uX18iIHByb3BlcnR5IHNob3VsZCBvbmx5IGJlIHVzZWQgc3BhcmluZ2x5IGFuZCBvbmx5IHNob3VsZCBvbmx5IGJlIHNldCBvbiBvYmplY3RzIHRoYXQKICAvLyBoYXZlIGFscmVhZHkgYmVlbiBub3JtYWxpemVkLgogIGlmICgodmFsdWUgKVsnX19zZW50cnlfc2tpcF9ub3JtYWxpemF0aW9uX18nXSkgewogICAgcmV0dXJuIHZhbHVlIDsKICB9CgogIC8vIFdlIGNhbiBzZXQgYF9fc2VudHJ5X292ZXJyaWRlX25vcm1hbGl6YXRpb25fZGVwdGhfX2Agb24gYW4gb2JqZWN0IHRvIGVuc3VyZSB0aGF0IGZyb20gdGhlcmUKICAvLyBXZSBrZWVwIGEgY2VydGFpbiBhbW91bnQgb2YgZGVwdGguCiAgLy8gVGhpcyBzaG91bGQgYmUgdXNlZCBzcGFyaW5nbHksIGUuZy4gd2UgdXNlIGl0IGZvciB0aGUgcmVkdXggaW50ZWdyYXRpb24gdG8gZW5zdXJlIHdlIGdldCBhIGNlcnRhaW4gYW1vdW50IG9mIHN0YXRlLgogIGNvbnN0IHJlbWFpbmluZ0RlcHRoID0KICAgIHR5cGVvZiAodmFsdWUgKVsnX19zZW50cnlfb3ZlcnJpZGVfbm9ybWFsaXphdGlvbl9kZXB0aF9fJ10gPT09ICdudW1iZXInCiAgICAgID8gKCh2YWx1ZSApWydfX3NlbnRyeV9vdmVycmlkZV9ub3JtYWxpemF0aW9uX2RlcHRoX18nXSApCiAgICAgIDogZGVwdGg7CgogIC8vIFdlJ3JlIGFsc28gZG9uZSBpZiB3ZSd2ZSByZWFjaGVkIHRoZSBtYXggZGVwdGgKICBpZiAocmVtYWluaW5nRGVwdGggPT09IDApIHsKICAgIC8vIEF0IHRoaXMgcG9pbnQgd2Uga25vdyBgc2VyaWFsaXplZGAgaXMgYSBzdHJpbmcgb2YgdGhlIGZvcm0gYCJbb2JqZWN0IFhYWFhdImAuIENsZWFuIGl0IHVwIHNvIGl0J3MganVzdCBgIltYWFhYXSJgLgogICAgcmV0dXJuIHN0cmluZ2lmaWVkLnJlcGxhY2UoJ29iamVjdCAnLCAnJyk7CiAgfQoKICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IHZpc2l0ZWQgdGhpcyBicmFuY2gsIGJhaWwgb3V0LCBhcyBpdCdzIGNpcmN1bGFyIHJlZmVyZW5jZS4gSWYgbm90LCBub3RlIHRoYXQgd2UncmUgc2VlaW5nIGl0IG5vdy4KICBpZiAobWVtb2l6ZSh2YWx1ZSkpIHsKICAgIHJldHVybiAnW0NpcmN1bGFyIH5dJzsKICB9CgogIC8vIElmIHRoZSB2YWx1ZSBoYXMgYSBgdG9KU09OYCBtZXRob2QsIHdlIGNhbGwgaXQgdG8gZXh0cmFjdCBtb3JlIGluZm9ybWF0aW9uCiAgY29uc3QgdmFsdWVXaXRoVG9KU09OID0gdmFsdWUgOwogIGlmICh2YWx1ZVdpdGhUb0pTT04gJiYgdHlwZW9mIHZhbHVlV2l0aFRvSlNPTi50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGpzb25WYWx1ZSA9IHZhbHVlV2l0aFRvSlNPTi50b0pTT04oKTsKICAgICAgLy8gV2UgbmVlZCB0byBub3JtYWxpemUgdGhlIHJldHVybiB2YWx1ZSBvZiBgLnRvSlNPTigpYCBpbiBjYXNlIGl0IGhhcyBjaXJjdWxhciByZWZlcmVuY2VzCiAgICAgIHJldHVybiB2aXNpdCgnJywganNvblZhbHVlLCByZW1haW5pbmdEZXB0aCAtIDEsIG1heFByb3BlcnRpZXMsIG1lbW8pOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIC8vIHBhc3MgKFRoZSBidWlsdC1pbiBgdG9KU09OYCBmYWlsZWQsIGJ1dCB3ZSBjYW4gc3RpbGwgdHJ5IHRvIGRvIGl0IG91cnNlbHZlcykKICAgIH0KICB9CgogIC8vIEF0IHRoaXMgcG9pbnQgd2Uga25vdyB3ZSBlaXRoZXIgaGF2ZSBhbiBvYmplY3Qgb3IgYW4gYXJyYXksIHdlIGhhdmVuJ3Qgc2VlbiBpdCBiZWZvcmUsIGFuZCB3ZSdyZSBnb2luZyB0byByZWN1cnNlCiAgLy8gYmVjYXVzZSB3ZSBoYXZlbid0IHlldCByZWFjaGVkIHRoZSBtYXggZGVwdGguIENyZWF0ZSBhbiBhY2N1bXVsYXRvciB0byBob2xkIHRoZSByZXN1bHRzIG9mIHZpc2l0aW5nIGVhY2gKICAvLyBwcm9wZXJ0eS9lbnRyeSwgYW5kIGtlZXAgdHJhY2sgb2YgdGhlIG51bWJlciBvZiBpdGVtcyB3ZSBhZGQgdG8gaXQuCiAgY29uc3Qgbm9ybWFsaXplZCA9IChBcnJheS5pc0FycmF5KHZhbHVlKSA/IFtdIDoge30pIDsKICBsZXQgbnVtQWRkZWQgPSAwOwoKICAvLyBCZWZvcmUgd2UgYmVnaW4sIGNvbnZlcnRgRXJyb3JgIGFuZGBFdmVudGAgaW5zdGFuY2VzIGludG8gcGxhaW4gb2JqZWN0cywgc2luY2Ugc29tZSBvZiBlYWNoIG9mIHRoZWlyIHJlbGV2YW50CiAgLy8gcHJvcGVydGllcyBhcmUgbm9uLWVudW1lcmFibGUgYW5kIG90aGVyd2lzZSB3b3VsZCBnZXQgbWlzc2VkLgogIGNvbnN0IHZpc2l0YWJsZSA9IGNvbnZlcnRUb1BsYWluT2JqZWN0KHZhbHVlICk7CgogIGZvciAoY29uc3QgdmlzaXRLZXkgaW4gdmlzaXRhYmxlKSB7CiAgICAvLyBBdm9pZCBpdGVyYXRpbmcgb3ZlciBmaWVsZHMgaW4gdGhlIHByb3RvdHlwZSBpZiB0aGV5J3ZlIHNvbWVob3cgYmVlbiBleHBvc2VkIHRvIGVudW1lcmF0aW9uLgogICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodmlzaXRhYmxlLCB2aXNpdEtleSkpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKG51bUFkZGVkID49IG1heFByb3BlcnRpZXMpIHsKICAgICAgbm9ybWFsaXplZFt2aXNpdEtleV0gPSAnW01heFByb3BlcnRpZXMgfl0nOwogICAgICBicmVhazsKICAgIH0KCiAgICAvLyBSZWN1cnNpdmVseSB2aXNpdCBhbGwgdGhlIGNoaWxkIG5vZGVzCiAgICBjb25zdCB2aXNpdFZhbHVlID0gdmlzaXRhYmxlW3Zpc2l0S2V5XTsKICAgIG5vcm1hbGl6ZWRbdmlzaXRLZXldID0gdmlzaXQodmlzaXRLZXksIHZpc2l0VmFsdWUsIHJlbWFpbmluZ0RlcHRoIC0gMSwgbWF4UHJvcGVydGllcywgbWVtbyk7CgogICAgbnVtQWRkZWQrKzsKICB9CgogIC8vIE9uY2Ugd2UndmUgdmlzaXRlZCBhbGwgdGhlIGJyYW5jaGVzLCByZW1vdmUgdGhlIHBhcmVudCBmcm9tIG1lbW8gc3RvcmFnZQogIHVubWVtb2l6ZSh2YWx1ZSk7CgogIC8vIFJldHVybiBhY2N1bXVsYXRlZCB2YWx1ZXMKICByZXR1cm4gbm9ybWFsaXplZDsKfQoKLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqLwovKioKICogU3RyaW5naWZ5IHRoZSBnaXZlbiB2YWx1ZS4gSGFuZGxlcyB2YXJpb3VzIGtub3duIHNwZWNpYWwgdmFsdWVzIGFuZCB0eXBlcy4KICoKICogTm90IG1lYW50IHRvIGJlIHVzZWQgb24gc2ltcGxlIHByaW1pdGl2ZXMgd2hpY2ggYWxyZWFkeSBoYXZlIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLCBhcyBpdCB3aWxsLCBmb3IgZXhhbXBsZSwgdHVybgogKiB0aGUgbnVtYmVyIDEyMzEgaW50byAiW09iamVjdCBOdW1iZXJdIiwgbm9yIG9uIGBudWxsYCwgYXMgaXQgd2lsbCB0aHJvdy4KICoKICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byBzdHJpbmdpZnkKICogQHJldHVybnMgQSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gdmFsdWUKICovCmZ1bmN0aW9uIHN0cmluZ2lmeVZhbHVlKAogIGtleSwKICAvLyB0aGlzIHR5cGUgaXMgYSB0aW55IGJpdCBvZiBhIGNoZWF0LCBzaW5jZSB0aGlzIGZ1bmN0aW9uIGRvZXMgaGFuZGxlIE5hTiAod2hpY2ggaXMgdGVjaG5pY2FsbHkgYSBudW1iZXIpLCBidXQgZm9yCiAgLy8gb3VyIGludGVybmFsIHVzZSwgaXQnbGwgZG8KICB2YWx1ZSwKKSB7CiAgdHJ5IHsKICAgIGlmIChrZXkgPT09ICdkb21haW4nICYmIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgKHZhbHVlICkuX2V2ZW50cykgewogICAgICByZXR1cm4gJ1tEb21haW5dJzsKICAgIH0KCiAgICBpZiAoa2V5ID09PSAnZG9tYWluRW1pdHRlcicpIHsKICAgICAgcmV0dXJuICdbRG9tYWluRW1pdHRlcl0nOwogICAgfQoKICAgIC8vIEl0J3Mgc2FmZSB0byB1c2UgYGdsb2JhbGAsIGB3aW5kb3dgLCBhbmQgYGRvY3VtZW50YCBoZXJlIGluIHRoaXMgbWFubmVyLCBhcyB3ZSBhcmUgYXNzZXJ0aW5nIHVzaW5nIGB0eXBlb2ZgIGZpcnN0CiAgICAvLyB3aGljaCB3b24ndCB0aHJvdyBpZiB0aGV5IGFyZSBub3QgcHJlc2VudC4KCiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgPT09IGdsb2JhbCkgewogICAgICByZXR1cm4gJ1tHbG9iYWxdJzsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgPT09IHdpbmRvdykgewogICAgICByZXR1cm4gJ1tXaW5kb3ddJzsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gZG9jdW1lbnQpIHsKICAgICAgcmV0dXJuICdbRG9jdW1lbnRdJzsKICAgIH0KCiAgICBpZiAoaXNWdWVWaWV3TW9kZWwodmFsdWUpKSB7CiAgICAgIHJldHVybiAnW1Z1ZVZpZXdNb2RlbF0nOwogICAgfQoKICAgIC8vIFJlYWN0J3MgU3ludGhldGljRXZlbnQgdGhpbmd5CiAgICBpZiAoaXNTeW50aGV0aWNFdmVudCh2YWx1ZSkpIHsKICAgICAgcmV0dXJuICdbU3ludGhldGljRXZlbnRdJzsKICAgIH0KCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB2YWx1ZSAhPT0gdmFsdWUpIHsKICAgICAgcmV0dXJuICdbTmFOXSc7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICByZXR1cm4gYFtGdW5jdGlvbjogJHtnZXRGdW5jdGlvbk5hbWUodmFsdWUpfV1gOwogICAgfQoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzeW1ib2wnKSB7CiAgICAgIHJldHVybiBgWyR7U3RyaW5nKHZhbHVlKX1dYDsKICAgIH0KCiAgICAvLyBzdHJpbmdpZmllZCBCaWdJbnRzIGFyZSBpbmRpc3Rpbmd1aXNoYWJsZSBmcm9tIHJlZ3VsYXIgbnVtYmVycywgc28gd2UgbmVlZCB0byBsYWJlbCB0aGVtIHRvIGF2b2lkIGNvbmZ1c2lvbgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2JpZ2ludCcpIHsKICAgICAgcmV0dXJuIGBbQmlnSW50OiAke1N0cmluZyh2YWx1ZSl9XWA7CiAgICB9CgogICAgLy8gTm93IHRoYXQgd2UndmUga25vY2tlZCBvdXQgYWxsIHRoZSBzcGVjaWFsIGNhc2VzIGFuZCB0aGUgcHJpbWl0aXZlcywgYWxsIHdlIGhhdmUgbGVmdCBhcmUgb2JqZWN0cy4gU2ltcGx5IGNhc3RpbmcKICAgIC8vIHRoZW0gdG8gc3RyaW5ncyBtZWFucyB0aGF0IGluc3RhbmNlcyBvZiBjbGFzc2VzIHdoaWNoIGhhdmVuJ3QgZGVmaW5lZCB0aGVpciBgdG9TdHJpbmdUYWdgIHdpbGwganVzdCBjb21lIG91dCBhcwogICAgLy8gYCJbb2JqZWN0IE9iamVjdF0iYC4gSWYgd2UgaW5zdGVhZCBsb29rIGF0IHRoZSBjb25zdHJ1Y3RvcidzIG5hbWUgKHdoaWNoIGlzIHRoZSBzYW1lIGFzIHRoZSBuYW1lIG9mIHRoZSBjbGFzcyksCiAgICAvLyB3ZSBjYW4gbWFrZSBzdXJlIHRoYXQgb25seSBwbGFpbiBvYmplY3RzIGNvbWUgb3V0IHRoYXQgd2F5LgogICAgY29uc3Qgb2JqTmFtZSA9IGdldENvbnN0cnVjdG9yTmFtZSh2YWx1ZSk7CgogICAgLy8gSGFuZGxlIEhUTUwgRWxlbWVudHMKICAgIGlmICgvXkhUTUwoXHcqKUVsZW1lbnQkLy50ZXN0KG9iak5hbWUpKSB7CiAgICAgIHJldHVybiBgW0hUTUxFbGVtZW50OiAke29iak5hbWV9XWA7CiAgICB9CgogICAgcmV0dXJuIGBbb2JqZWN0ICR7b2JqTmFtZX1dYDsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiBgKipub24tc2VyaWFsaXphYmxlKiogKCR7ZXJyfSlgOwogIH0KfQovKiBlc2xpbnQtZW5hYmxlIGNvbXBsZXhpdHkgKi8KCmZ1bmN0aW9uIGdldENvbnN0cnVjdG9yTmFtZSh2YWx1ZSkgewogIGNvbnN0IHByb3RvdHlwZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih2YWx1ZSk7CgogIHJldHVybiBwcm90b3R5cGUgPyBwcm90b3R5cGUuY29uc3RydWN0b3IubmFtZSA6ICdudWxsIHByb3RvdHlwZSc7Cn0KCi8qKgogKiBOb3JtYWxpemVzIFVSTHMgaW4gZXhjZXB0aW9ucyBhbmQgc3RhY2t0cmFjZXMgdG8gYSBiYXNlIHBhdGggc28gU2VudHJ5IGNhbiBmaW5nZXJwcmludAogKiBhY3Jvc3MgcGxhdGZvcm1zIGFuZCB3b3JraW5nIGRpcmVjdG9yeS4KICoKICogQHBhcmFtIHVybCBUaGUgVVJMIHRvIGJlIG5vcm1hbGl6ZWQuCiAqIEBwYXJhbSBiYXNlUGF0aCBUaGUgYXBwbGljYXRpb24gYmFzZSBwYXRoLgogKiBAcmV0dXJucyBUaGUgbm9ybWFsaXplZCBVUkwuCiAqLwpmdW5jdGlvbiBub3JtYWxpemVVcmxUb0Jhc2UodXJsLCBiYXNlUGF0aCkgewogIGNvbnN0IGVzY2FwZWRCYXNlID0gYmFzZVBhdGgKICAgIC8vIEJhY2tzbGFzaCB0byBmb3J3YXJkCiAgICAucmVwbGFjZSgvXFwvZywgJy8nKQogICAgLy8gRXNjYXBlIFJlZ0V4cCBzcGVjaWFsIGNoYXJhY3RlcnMKICAgIC5yZXBsYWNlKC9bfFxce30oKVtcXV4kKyo/Ll0vZywgJ1xcJCYnKTsKCiAgbGV0IG5ld1VybCA9IHVybDsKICB0cnkgewogICAgbmV3VXJsID0gZGVjb2RlVVJJKHVybCk7CiAgfSBjYXRjaCAoX09vKSB7CiAgICAvLyBTb21ldGltZSB0aGlzIGJyZWFrcwogIH0KICByZXR1cm4gKAogICAgbmV3VXJsCiAgICAgIC5yZXBsYWNlKC9cXC9nLCAnLycpCiAgICAgIC5yZXBsYWNlKC93ZWJwYWNrOlwvPy9nLCAnJykgLy8gUmVtb3ZlIGludGVybWVkaWF0ZSBiYXNlIHBhdGgKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBzZW50cnktaW50ZXJuYWwvc2RrL25vLXJlZ2V4cC1jb25zdHJ1Y3RvcgogICAgICAucmVwbGFjZShuZXcgUmVnRXhwKGAoZmlsZTovLyk/Lyoke2VzY2FwZWRCYXNlfS8qYCwgJ2lnJyksICdhcHA6Ly8vJykKICApOwp9CgovLyBTbGlnaHRseSBtb2RpZmllZCAobm8gSUU4IHN1cHBvcnQsIEVTNikgYW5kIHRyYW5zY3JpYmVkIHRvIFR5cGVTY3JpcHQKCi8vIFNwbGl0IGEgZmlsZW5hbWUgaW50byBbcm9vdCwgZGlyLCBiYXNlbmFtZSwgZXh0XSwgdW5peCB2ZXJzaW9uCi8vICdyb290JyBpcyBqdXN0IGEgc2xhc2gsIG9yIG5vdGhpbmcuCmNvbnN0IHNwbGl0UGF0aFJlID0gL14oXFMrOlxcfFwvPykoW1xzXFNdKj8pKCg/OlwuezEsMn18W14vXFxdKz98KShcLlteLi9cXF0qfCkpKD86Wy9cXF0qKSQvOwovKiogSlNEb2MgKi8KZnVuY3Rpb24gc3BsaXRQYXRoKGZpbGVuYW1lKSB7CiAgLy8gVHJ1bmNhdGUgZmlsZXMgbmFtZXMgZ3JlYXRlciB0aGFuIDEwMjQgY2hhcmFjdGVycyB0byBhdm9pZCByZWdleCBkb3MKICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L3B1bGwvODczNyNkaXNjdXNzaW9uX3IxMjg1NzE5MTcyCiAgY29uc3QgdHJ1bmNhdGVkID0gZmlsZW5hbWUubGVuZ3RoID4gMTAyNCA/IGA8dHJ1bmNhdGVkPiR7ZmlsZW5hbWUuc2xpY2UoLTEwMjQpfWAgOiBmaWxlbmFtZTsKICBjb25zdCBwYXJ0cyA9IHNwbGl0UGF0aFJlLmV4ZWModHJ1bmNhdGVkKTsKICByZXR1cm4gcGFydHMgPyBwYXJ0cy5zbGljZSgxKSA6IFtdOwp9CgovKiogSlNEb2MgKi8KZnVuY3Rpb24gZGlybmFtZShwYXRoKSB7CiAgY29uc3QgcmVzdWx0ID0gc3BsaXRQYXRoKHBhdGgpOwogIGNvbnN0IHJvb3QgPSByZXN1bHRbMF07CiAgbGV0IGRpciA9IHJlc3VsdFsxXTsKCiAgaWYgKCFyb290ICYmICFkaXIpIHsKICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgogICAgcmV0dXJuICcuJzsKICB9CgogIGlmIChkaXIpIHsKICAgIC8vIEl0IGhhcyBhIGRpcm5hbWUsIHN0cmlwIHRyYWlsaW5nIHNsYXNoCiAgICBkaXIgPSBkaXIuc2xpY2UoMCwgZGlyLmxlbmd0aCAtIDEpOwogIH0KCiAgcmV0dXJuIHJvb3QgKyBkaXI7Cn0KCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZSAqLwoKLyoqIFN5bmNQcm9taXNlIGludGVybmFsIHN0YXRlcyAqLwp2YXIgU3RhdGVzOyAoZnVuY3Rpb24gKFN0YXRlcykgewogIC8qKiBQZW5kaW5nICovCiAgY29uc3QgUEVORElORyA9IDA7IFN0YXRlc1tTdGF0ZXNbIlBFTkRJTkciXSA9IFBFTkRJTkddID0gIlBFTkRJTkciOwogIC8qKiBSZXNvbHZlZCAvIE9LICovCiAgY29uc3QgUkVTT0xWRUQgPSAxOyBTdGF0ZXNbU3RhdGVzWyJSRVNPTFZFRCJdID0gUkVTT0xWRURdID0gIlJFU09MVkVEIjsKICAvKiogUmVqZWN0ZWQgLyBFcnJvciAqLwogIGNvbnN0IFJFSkVDVEVEID0gMjsgU3RhdGVzW1N0YXRlc1siUkVKRUNURUQiXSA9IFJFSkVDVEVEXSA9ICJSRUpFQ1RFRCI7Cn0pKFN0YXRlcyB8fCAoU3RhdGVzID0ge30pKTsKCi8vIE92ZXJsb2FkcyBzbyB3ZSBjYW4gY2FsbCByZXNvbHZlZFN5bmNQcm9taXNlIHdpdGhvdXQgYXJndW1lbnRzIGFuZCBnZW5lcmljIGFyZ3VtZW50CgovKioKICogQ3JlYXRlcyBhIHJlc29sdmVkIHN5bmMgcHJvbWlzZS4KICoKICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byByZXNvbHZlIHRoZSBwcm9taXNlIHdpdGgKICogQHJldHVybnMgdGhlIHJlc29sdmVkIHN5bmMgcHJvbWlzZQogKi8KZnVuY3Rpb24gcmVzb2x2ZWRTeW5jUHJvbWlzZSh2YWx1ZSkgewogIHJldHVybiBuZXcgU3luY1Byb21pc2UocmVzb2x2ZSA9PiB7CiAgICByZXNvbHZlKHZhbHVlKTsKICB9KTsKfQoKLyoqCiAqIENyZWF0ZXMgYSByZWplY3RlZCBzeW5jIHByb21pc2UuCiAqCiAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgdG8gcmVqZWN0IHRoZSBwcm9taXNlIHdpdGgKICogQHJldHVybnMgdGhlIHJlamVjdGVkIHN5bmMgcHJvbWlzZQogKi8KZnVuY3Rpb24gcmVqZWN0ZWRTeW5jUHJvbWlzZShyZWFzb24pIHsKICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChfLCByZWplY3QpID0+IHsKICAgIHJlamVjdChyZWFzb24pOwogIH0pOwp9CgovKioKICogVGhlbmFibGUgY2xhc3MgdGhhdCBiZWhhdmVzIGxpa2UgYSBQcm9taXNlIGFuZCBmb2xsb3dzIGl0J3MgaW50ZXJmYWNlCiAqIGJ1dCBpcyBub3QgYXN5bmMgaW50ZXJuYWxseQogKi8KY2xhc3MgU3luY1Byb21pc2UgewoKICAgY29uc3RydWN0b3IoCiAgICBleGVjdXRvciwKICApIHtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0LmNhbGwodGhpcyk7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdDIuY2FsbCh0aGlzKTtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0My5jYWxsKHRoaXMpO1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQ0LmNhbGwodGhpcyk7CiAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlcy5QRU5ESU5HOwogICAgdGhpcy5faGFuZGxlcnMgPSBbXTsKCiAgICB0cnkgewogICAgICBleGVjdXRvcih0aGlzLl9yZXNvbHZlLCB0aGlzLl9yZWplY3QpOwogICAgfSBjYXRjaCAoZSkgewogICAgICB0aGlzLl9yZWplY3QoZSk7CiAgICB9CiAgfQoKICAvKiogSlNEb2MgKi8KICAgdGhlbigKICAgIG9uZnVsZmlsbGVkLAogICAgb25yZWplY3RlZCwKICApIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKFsKICAgICAgICBmYWxzZSwKICAgICAgICByZXN1bHQgPT4gewogICAgICAgICAgaWYgKCFvbmZ1bGZpbGxlZCkgewogICAgICAgICAgICAvLyBUT0RPOiDCr1xfKOODhClfL8KvCiAgICAgICAgICAgIC8vIFRPRE86IEZJWE1FCiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0ICk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlc29sdmUob25mdWxmaWxsZWQocmVzdWx0KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlYXNvbiA9PiB7CiAgICAgICAgICBpZiAoIW9ucmVqZWN0ZWQpIHsKICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlc29sdmUob25yZWplY3RlZChyZWFzb24pKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgIF0pOwogICAgICB0aGlzLl9leGVjdXRlSGFuZGxlcnMoKTsKICAgIH0pOwogIH0KCiAgLyoqIEpTRG9jICovCiAgIGNhdGNoKAogICAgb25yZWplY3RlZCwKICApIHsKICAgIHJldHVybiB0aGlzLnRoZW4odmFsID0+IHZhbCwgb25yZWplY3RlZCk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgZmluYWxseShvbmZpbmFsbHkpIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgdmFsOwogICAgICBsZXQgaXNSZWplY3RlZDsKCiAgICAgIHJldHVybiB0aGlzLnRoZW4oCiAgICAgICAgdmFsdWUgPT4gewogICAgICAgICAgaXNSZWplY3RlZCA9IGZhbHNlOwogICAgICAgICAgdmFsID0gdmFsdWU7CiAgICAgICAgICBpZiAob25maW5hbGx5KSB7CiAgICAgICAgICAgIG9uZmluYWxseSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVhc29uID0+IHsKICAgICAgICAgIGlzUmVqZWN0ZWQgPSB0cnVlOwogICAgICAgICAgdmFsID0gcmVhc29uOwogICAgICAgICAgaWYgKG9uZmluYWxseSkgewogICAgICAgICAgICBvbmZpbmFsbHkoKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICApLnRoZW4oKCkgPT4gewogICAgICAgIGlmIChpc1JlamVjdGVkKSB7CiAgICAgICAgICByZWplY3QodmFsKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc29sdmUodmFsICk7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdCgpIHt0aGlzLl9yZXNvbHZlID0gKHZhbHVlKSA9PiB7CiAgICB0aGlzLl9zZXRSZXN1bHQoU3RhdGVzLlJFU09MVkVELCB2YWx1ZSk7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0MigpIHt0aGlzLl9yZWplY3QgPSAocmVhc29uKSA9PiB7CiAgICB0aGlzLl9zZXRSZXN1bHQoU3RhdGVzLlJFSkVDVEVELCByZWFzb24pOwogIH07fQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdDMoKSB7dGhpcy5fc2V0UmVzdWx0ID0gKHN0YXRlLCB2YWx1ZSkgPT4gewogICAgaWYgKHRoaXMuX3N0YXRlICE9PSBTdGF0ZXMuUEVORElORykgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzVGhlbmFibGUodmFsdWUpKSB7CiAgICAgIHZvaWQgKHZhbHVlICkudGhlbih0aGlzLl9yZXNvbHZlLCB0aGlzLl9yZWplY3QpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7CgogICAgdGhpcy5fZXhlY3V0ZUhhbmRsZXJzKCk7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0NCgpIHt0aGlzLl9leGVjdXRlSGFuZGxlcnMgPSAoKSA9PiB7CiAgICBpZiAodGhpcy5fc3RhdGUgPT09IFN0YXRlcy5QRU5ESU5HKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjYWNoZWRIYW5kbGVycyA9IHRoaXMuX2hhbmRsZXJzLnNsaWNlKCk7CiAgICB0aGlzLl9oYW5kbGVycyA9IFtdOwoKICAgIGNhY2hlZEhhbmRsZXJzLmZvckVhY2goaGFuZGxlciA9PiB7CiAgICAgIGlmIChoYW5kbGVyWzBdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5fc3RhdGUgPT09IFN0YXRlcy5SRVNPTFZFRCkgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXMKICAgICAgICBoYW5kbGVyWzFdKHRoaXMuX3ZhbHVlICk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlJFSkVDVEVEKSB7CiAgICAgICAgaGFuZGxlclsyXSh0aGlzLl92YWx1ZSk7CiAgICAgIH0KCiAgICAgIGhhbmRsZXJbMF0gPSB0cnVlOwogICAgfSk7CiAgfTt9Cn0KCi8qKgogKiBDcmVhdGVzIGFuIG5ldyBQcm9taXNlQnVmZmVyIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgbGltaXQKICogQHBhcmFtIGxpbWl0IG1heCBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBjYW4gYmUgc3RvcmVkIGluIHRoZSBidWZmZXIKICovCmZ1bmN0aW9uIG1ha2VQcm9taXNlQnVmZmVyKGxpbWl0KSB7CiAgY29uc3QgYnVmZmVyID0gW107CgogIGZ1bmN0aW9uIGlzUmVhZHkoKSB7CiAgICByZXR1cm4gbGltaXQgPT09IHVuZGVmaW5lZCB8fCBidWZmZXIubGVuZ3RoIDwgbGltaXQ7CiAgfQoKICAvKioKICAgKiBSZW1vdmUgYSBwcm9taXNlIGZyb20gdGhlIHF1ZXVlLgogICAqCiAgICogQHBhcmFtIHRhc2sgQ2FuIGJlIGFueSBQcm9taXNlTGlrZTxUPgogICAqIEByZXR1cm5zIFJlbW92ZWQgcHJvbWlzZS4KICAgKi8KICBmdW5jdGlvbiByZW1vdmUodGFzaykgewogICAgcmV0dXJuIGJ1ZmZlci5zcGxpY2UoYnVmZmVyLmluZGV4T2YodGFzayksIDEpWzBdOwogIH0KCiAgLyoqCiAgICogQWRkIGEgcHJvbWlzZSAocmVwcmVzZW50aW5nIGFuIGluLWZsaWdodCBhY3Rpb24pIHRvIHRoZSBxdWV1ZSwgYW5kIHNldCBpdCB0byByZW1vdmUgaXRzZWxmIG9uIGZ1bGZpbGxtZW50LgogICAqCiAgICogQHBhcmFtIHRhc2tQcm9kdWNlciBBIGZ1bmN0aW9uIHByb2R1Y2luZyBhbnkgUHJvbWlzZUxpa2U8VD47IEluIHByZXZpb3VzIHZlcnNpb25zIHRoaXMgdXNlZCB0byBiZSBgdGFzazoKICAgKiAgICAgICAgUHJvbWlzZUxpa2U8VD5gLCBidXQgdW5kZXIgdGhhdCBtb2RlbCwgUHJvbWlzZXMgd2VyZSBpbnN0YW50bHkgY3JlYXRlZCBvbiB0aGUgY2FsbC1zaXRlIGFuZCB0aGVpciBleGVjdXRvcgogICAqICAgICAgICBmdW5jdGlvbnMgdGhlcmVmb3JlIHJhbiBpbW1lZGlhdGVseS4gVGh1cywgZXZlbiBpZiB0aGUgYnVmZmVyIHdhcyBmdWxsLCB0aGUgYWN0aW9uIHN0aWxsIGhhcHBlbmVkLiBCeQogICAqICAgICAgICByZXF1aXJpbmcgdGhlIHByb21pc2UgdG8gYmUgd3JhcHBlZCBpbiBhIGZ1bmN0aW9uLCB3ZSBjYW4gZGVmZXIgcHJvbWlzZSBjcmVhdGlvbiB1bnRpbCBhZnRlciB0aGUgYnVmZmVyCiAgICogICAgICAgIGxpbWl0IGNoZWNrLgogICAqIEByZXR1cm5zIFRoZSBvcmlnaW5hbCBwcm9taXNlLgogICAqLwogIGZ1bmN0aW9uIGFkZCh0YXNrUHJvZHVjZXIpIHsKICAgIGlmICghaXNSZWFkeSgpKSB7CiAgICAgIHJldHVybiByZWplY3RlZFN5bmNQcm9taXNlKG5ldyBTZW50cnlFcnJvcignTm90IGFkZGluZyBQcm9taXNlIGJlY2F1c2UgYnVmZmVyIGxpbWl0IHdhcyByZWFjaGVkLicpKTsKICAgIH0KCiAgICAvLyBzdGFydCB0aGUgdGFzayBhbmQgYWRkIGl0cyBwcm9taXNlIHRvIHRoZSBxdWV1ZQogICAgY29uc3QgdGFzayA9IHRhc2tQcm9kdWNlcigpOwogICAgaWYgKGJ1ZmZlci5pbmRleE9mKHRhc2spID09PSAtMSkgewogICAgICBidWZmZXIucHVzaCh0YXNrKTsKICAgIH0KICAgIHZvaWQgdGFzawogICAgICAudGhlbigoKSA9PiByZW1vdmUodGFzaykpCiAgICAgIC8vIFVzZSBgdGhlbihudWxsLCByZWplY3Rpb25IYW5kbGVyKWAgcmF0aGVyIHRoYW4gYGNhdGNoKHJlamVjdGlvbkhhbmRsZXIpYCBzbyB0aGF0IHdlIGNhbiB1c2UgYFByb21pc2VMaWtlYAogICAgICAvLyByYXRoZXIgdGhhbiBgUHJvbWlzZWAuIGBQcm9taXNlTGlrZWAgZG9lc24ndCBoYXZlIGEgYC5jYXRjaGAgbWV0aG9kLCBtYWtpbmcgaXRzIHBvbHlmaWxsIHNtYWxsZXIuIChFUzUgZGlkbid0CiAgICAgIC8vIGhhdmUgcHJvbWlzZXMsIHNvIFRTIGhhcyB0byBwb2x5ZmlsbCB3aGVuIGRvd24tY29tcGlsaW5nLikKICAgICAgLnRoZW4obnVsbCwgKCkgPT4KICAgICAgICByZW1vdmUodGFzaykudGhlbihudWxsLCAoKSA9PiB7CiAgICAgICAgICAvLyBXZSBoYXZlIHRvIGFkZCBhbm90aGVyIGNhdGNoIGhlcmUgYmVjYXVzZSBgcmVtb3ZlKClgIHN0YXJ0cyBhIG5ldyBwcm9taXNlIGNoYWluLgogICAgICAgIH0pLAogICAgICApOwogICAgcmV0dXJuIHRhc2s7CiAgfQoKICAvKioKICAgKiBXYWl0IGZvciBhbGwgcHJvbWlzZXMgaW4gdGhlIHF1ZXVlIHRvIHJlc29sdmUgb3IgZm9yIHRpbWVvdXQgdG8gZXhwaXJlLCB3aGljaGV2ZXIgY29tZXMgZmlyc3QuCiAgICoKICAgKiBAcGFyYW0gdGltZW91dCBUaGUgdGltZSwgaW4gbXMsIGFmdGVyIHdoaWNoIHRvIHJlc29sdmUgdG8gYGZhbHNlYCBpZiB0aGUgcXVldWUgaXMgc3RpbGwgbm9uLWVtcHR5LiBQYXNzaW5nIGAwYCAob3IKICAgKiBub3QgcGFzc2luZyBhbnl0aGluZykgd2lsbCBtYWtlIHRoZSBwcm9taXNlIHdhaXQgYXMgbG9uZyBhcyBpdCB0YWtlcyBmb3IgdGhlIHF1ZXVlIHRvIGRyYWluIGJlZm9yZSByZXNvbHZpbmcgdG8KICAgKiBgdHJ1ZWAuCiAgICogQHJldHVybnMgQSBwcm9taXNlIHdoaWNoIHdpbGwgcmVzb2x2ZSB0byBgdHJ1ZWAgaWYgdGhlIHF1ZXVlIGlzIGFscmVhZHkgZW1wdHkgb3IgZHJhaW5zIGJlZm9yZSB0aGUgdGltZW91dCwgYW5kCiAgICogYGZhbHNlYCBvdGhlcndpc2UKICAgKi8KICBmdW5jdGlvbiBkcmFpbih0aW1lb3V0KSB7CiAgICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbGV0IGNvdW50ZXIgPSBidWZmZXIubGVuZ3RoOwoKICAgICAgaWYgKCFjb3VudGVyKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7CiAgICAgIH0KCiAgICAgIC8vIHdhaXQgZm9yIGB0aW1lb3V0YCBtcyBhbmQgdGhlbiByZXNvbHZlIHRvIGBmYWxzZWAgKGlmIG5vdCBjYW5jZWxsZWQgZmlyc3QpCiAgICAgIGNvbnN0IGNhcHR1cmVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmICh0aW1lb3V0ICYmIHRpbWVvdXQgPiAwKSB7CiAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0sIHRpbWVvdXQpOwoKICAgICAgLy8gaWYgYWxsIHByb21pc2VzIHJlc29sdmUgaW4gdGltZSwgY2FuY2VsIHRoZSB0aW1lciBhbmQgcmVzb2x2ZSB0byBgdHJ1ZWAKICAgICAgYnVmZmVyLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgdm9pZCByZXNvbHZlZFN5bmNQcm9taXNlKGl0ZW0pLnRoZW4oKCkgPT4gewogICAgICAgICAgaWYgKCEtLWNvdW50ZXIpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNhcHR1cmVkU2V0VGltZW91dCk7CiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJldHVybiB7CiAgICAkOiBidWZmZXIsCiAgICBhZGQsCiAgICBkcmFpbiwKICB9Owp9Cgpjb25zdCBPTkVfU0VDT05EX0lOX01TID0gMTAwMDsKCi8qKgogKiBBIHBhcnRpYWwgZGVmaW5pdGlvbiBvZiB0aGUgW1BlcmZvcm1hbmNlIFdlYiBBUElde0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9QZXJmb3JtYW5jZX0KICogZm9yIGFjY2Vzc2luZyBhIGhpZ2gtcmVzb2x1dGlvbiBtb25vdG9uaWMgY2xvY2suCiAqLwoKLyoqCiAqIFJldHVybnMgYSB0aW1lc3RhbXAgaW4gc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaCB1c2luZyB0aGUgRGF0ZSBBUEkuCiAqCiAqIFRPRE8odjgpOiBSZXR1cm4gdHlwZSBzaG91bGQgYmUgcm91bmRlZC4KICovCmZ1bmN0aW9uIGRhdGVUaW1lc3RhbXBJblNlY29uZHMoKSB7CiAgcmV0dXJuIERhdGUubm93KCkgLyBPTkVfU0VDT05EX0lOX01TOwp9CgovKioKICogUmV0dXJucyBhIHdyYXBwZXIgYXJvdW5kIHRoZSBuYXRpdmUgUGVyZm9ybWFuY2UgQVBJIGJyb3dzZXIgaW1wbGVtZW50YXRpb24sIG9yIHVuZGVmaW5lZCBmb3IgYnJvd3NlcnMgdGhhdCBkbyBub3QKICogc3VwcG9ydCB0aGUgQVBJLgogKgogKiBXcmFwcGluZyB0aGUgbmF0aXZlIEFQSSB3b3JrcyBhcm91bmQgZGlmZmVyZW5jZXMgaW4gYmVoYXZpb3IgZnJvbSBkaWZmZXJlbnQgYnJvd3NlcnMuCiAqLwpmdW5jdGlvbiBjcmVhdGVVbml4VGltZXN0YW1wSW5TZWNvbmRzRnVuYygpIHsKICBjb25zdCB7IHBlcmZvcm1hbmNlIH0gPSBHTE9CQUxfT0JKIDsKICBpZiAoIXBlcmZvcm1hbmNlIHx8ICFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIHJldHVybiBkYXRlVGltZXN0YW1wSW5TZWNvbmRzOwogIH0KCiAgLy8gU29tZSBicm93c2VyIGFuZCBlbnZpcm9ubWVudHMgZG9uJ3QgaGF2ZSBhIHRpbWVPcmlnaW4sIHNvIHdlIGZhbGxiYWNrIHRvCiAgLy8gdXNpbmcgRGF0ZS5ub3coKSB0byBjb21wdXRlIHRoZSBzdGFydGluZyB0aW1lLgogIGNvbnN0IGFwcHJveFN0YXJ0aW5nVGltZU9yaWdpbiA9IERhdGUubm93KCkgLSBwZXJmb3JtYW5jZS5ub3coKTsKICBjb25zdCB0aW1lT3JpZ2luID0gcGVyZm9ybWFuY2UudGltZU9yaWdpbiA9PSB1bmRlZmluZWQgPyBhcHByb3hTdGFydGluZ1RpbWVPcmlnaW4gOiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luOwoKICAvLyBwZXJmb3JtYW5jZS5ub3coKSBpcyBhIG1vbm90b25pYyBjbG9jaywgd2hpY2ggbWVhbnMgaXQgc3RhcnRzIGF0IDAgd2hlbiB0aGUgcHJvY2VzcyBiZWdpbnMuIFRvIGdldCB0aGUgY3VycmVudAogIC8vIHdhbGwgY2xvY2sgdGltZSAoYWN0dWFsIFVOSVggdGltZXN0YW1wKSwgd2UgbmVlZCB0byBhZGQgdGhlIHN0YXJ0aW5nIHRpbWUgb3JpZ2luIGFuZCB0aGUgY3VycmVudCB0aW1lIGVsYXBzZWQuCiAgLy8KICAvLyBUT0RPOiBUaGlzIGRvZXMgbm90IGFjY291bnQgZm9yIHRoZSBjYXNlIHdoZXJlIHRoZSBtb25vdG9uaWMgY2xvY2sgdGhhdCBwb3dlcnMgcGVyZm9ybWFuY2Uubm93KCkgZHJpZnRzIGZyb20gdGhlCiAgLy8gd2FsbCBjbG9jayB0aW1lLCB3aGljaCBjYXVzZXMgdGhlIHJldHVybmVkIHRpbWVzdGFtcCB0byBiZSBpbmFjY3VyYXRlLiBXZSBzaG91bGQgaW52ZXN0aWdhdGUgaG93IHRvIGRldGVjdCBhbmQKICAvLyBjb3JyZWN0IGZvciB0aGlzLgogIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9pc3N1ZXMvMjU5MAogIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL21kbi9jb250ZW50L2lzc3Vlcy80NzEzCiAgLy8gU2VlOiBodHRwczovL2Rldi50by9ub2Ftci93aGVuLWEtbWlsbGlzZWNvbmQtaXMtbm90LWEtbWlsbGlzZWNvbmQtM2g2CiAgcmV0dXJuICgpID0+IHsKICAgIHJldHVybiAodGltZU9yaWdpbiArIHBlcmZvcm1hbmNlLm5vdygpKSAvIE9ORV9TRUNPTkRfSU5fTVM7CiAgfTsKfQoKLyoqCiAqIFJldHVybnMgYSB0aW1lc3RhbXAgaW4gc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaCB1c2luZyBlaXRoZXIgdGhlIFBlcmZvcm1hbmNlIG9yIERhdGUgQVBJcywgZGVwZW5kaW5nIG9uIHRoZQogKiBhdmFpbGFiaWxpdHkgb2YgdGhlIFBlcmZvcm1hbmNlIEFQSS4KICoKICogQlVHOiBOb3RlIHRoYXQgYmVjYXVzZSBvZiBob3cgYnJvd3NlcnMgaW1wbGVtZW50IHRoZSBQZXJmb3JtYW5jZSBBUEksIHRoZSBjbG9jayBtaWdodCBzdG9wIHdoZW4gdGhlIGNvbXB1dGVyIGlzCiAqIGFzbGVlcC4gVGhpcyBjcmVhdGVzIGEgc2tldyBiZXR3ZWVuIGBkYXRlVGltZXN0YW1wSW5TZWNvbmRzYCBhbmQgYHRpbWVzdGFtcEluU2Vjb25kc2AuIFRoZQogKiBza2V3IGNhbiBncm93IHRvIGFyYml0cmFyeSBhbW91bnRzIGxpa2UgZGF5cywgd2Vla3Mgb3IgbW9udGhzLgogKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9pc3N1ZXMvMjU5MC4KICovCmNvbnN0IHRpbWVzdGFtcEluU2Vjb25kcyA9IGNyZWF0ZVVuaXhUaW1lc3RhbXBJblNlY29uZHNGdW5jKCk7CgovKioKICogVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2guIFRoaXMgdmFsdWUgaXMgb25seSB1c2FibGUgaW4gYSBicm93c2VyLCBhbmQgb25seSB3aGVuIHRoZQogKiBwZXJmb3JtYW5jZSBBUEkgaXMgYXZhaWxhYmxlLgogKi8KKCgpID0+IHsKICAvLyBVbmZvcnR1bmF0ZWx5IGJyb3dzZXJzIG1heSByZXBvcnQgYW4gaW5hY2N1cmF0ZSB0aW1lIG9yaWdpbiBkYXRhLCB0aHJvdWdoIGVpdGhlciBwZXJmb3JtYW5jZS50aW1lT3JpZ2luIG9yCiAgLy8gcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCwgd2hpY2ggcmVzdWx0cyBpbiBwb29yIHJlc3VsdHMgaW4gcGVyZm9ybWFuY2UgZGF0YS4gV2Ugb25seSB0cmVhdCB0aW1lIG9yaWdpbgogIC8vIGRhdGEgYXMgcmVsaWFibGUgaWYgdGhleSBhcmUgd2l0aGluIGEgcmVhc29uYWJsZSB0aHJlc2hvbGQgb2YgdGhlIGN1cnJlbnQgdGltZS4KCiAgY29uc3QgeyBwZXJmb3JtYW5jZSB9ID0gR0xPQkFMX09CSiA7CiAgaWYgKCFwZXJmb3JtYW5jZSB8fCAhcGVyZm9ybWFuY2Uubm93KSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgY29uc3QgdGhyZXNob2xkID0gMzYwMCAqIDEwMDA7CiAgY29uc3QgcGVyZm9ybWFuY2VOb3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKICBjb25zdCBkYXRlTm93ID0gRGF0ZS5ub3coKTsKCiAgLy8gaWYgdGltZU9yaWdpbiBpc24ndCBhdmFpbGFibGUgc2V0IGRlbHRhIHRvIHRocmVzaG9sZCBzbyBpdCBpc24ndCB1c2VkCiAgY29uc3QgdGltZU9yaWdpbkRlbHRhID0gcGVyZm9ybWFuY2UudGltZU9yaWdpbgogICAgPyBNYXRoLmFicyhwZXJmb3JtYW5jZS50aW1lT3JpZ2luICsgcGVyZm9ybWFuY2VOb3cgLSBkYXRlTm93KQogICAgOiB0aHJlc2hvbGQ7CiAgY29uc3QgdGltZU9yaWdpbklzUmVsaWFibGUgPSB0aW1lT3JpZ2luRGVsdGEgPCB0aHJlc2hvbGQ7CgogIC8vIFdoaWxlIHBlcmZvcm1hbmNlLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQgaXMgZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luLCBwZXJmb3JtYW5jZS50aW1lT3JpZ2luCiAgLy8gaXMgbm90IGFzIHdpZGVseSBzdXBwb3J0ZWQuIE5hbWVseSwgcGVyZm9ybWFuY2UudGltZU9yaWdpbiBpcyB1bmRlZmluZWQgaW4gU2FmYXJpIGFzIG9mIHdyaXRpbmcuCiAgLy8gQWxzbyBhcyBvZiB3cml0aW5nLCBwZXJmb3JtYW5jZS50aW1pbmcgaXMgbm90IGF2YWlsYWJsZSBpbiBXZWIgV29ya2VycyBpbiBtYWluc3RyZWFtIGJyb3dzZXJzLCBzbyBpdCBpcyBub3QgYWx3YXlzCiAgLy8gYSB2YWxpZCBmYWxsYmFjay4gSW4gdGhlIGFic2VuY2Ugb2YgYW4gaW5pdGlhbCB0aW1lIHByb3ZpZGVkIGJ5IHRoZSBicm93c2VyLCBmYWxsYmFjayB0byB0aGUgY3VycmVudCB0aW1lIGZyb20gdGhlCiAgLy8gRGF0ZSBBUEkuCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgY29uc3QgbmF2aWdhdGlvblN0YXJ0ID0gcGVyZm9ybWFuY2UudGltaW5nICYmIHBlcmZvcm1hbmNlLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQ7CiAgY29uc3QgaGFzTmF2aWdhdGlvblN0YXJ0ID0gdHlwZW9mIG5hdmlnYXRpb25TdGFydCA9PT0gJ251bWJlcic7CiAgLy8gaWYgbmF2aWdhdGlvblN0YXJ0IGlzbid0IGF2YWlsYWJsZSBzZXQgZGVsdGEgdG8gdGhyZXNob2xkIHNvIGl0IGlzbid0IHVzZWQKICBjb25zdCBuYXZpZ2F0aW9uU3RhcnREZWx0YSA9IGhhc05hdmlnYXRpb25TdGFydCA/IE1hdGguYWJzKG5hdmlnYXRpb25TdGFydCArIHBlcmZvcm1hbmNlTm93IC0gZGF0ZU5vdykgOiB0aHJlc2hvbGQ7CiAgY29uc3QgbmF2aWdhdGlvblN0YXJ0SXNSZWxpYWJsZSA9IG5hdmlnYXRpb25TdGFydERlbHRhIDwgdGhyZXNob2xkOwoKICBpZiAodGltZU9yaWdpbklzUmVsaWFibGUgfHwgbmF2aWdhdGlvblN0YXJ0SXNSZWxpYWJsZSkgewogICAgLy8gVXNlIHRoZSBtb3JlIHJlbGlhYmxlIHRpbWUgb3JpZ2luCiAgICBpZiAodGltZU9yaWdpbkRlbHRhIDw9IG5hdmlnYXRpb25TdGFydERlbHRhKSB7CiAgICAgIHJldHVybiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5hdmlnYXRpb25TdGFydDsKICAgIH0KICB9CiAgcmV0dXJuIGRhdGVOb3c7Cn0pKCk7CgovKioKICogQ3JlYXRlcyBhbiBlbnZlbG9wZS4KICogTWFrZSBzdXJlIHRvIGFsd2F5cyBleHBsaWNpdGx5IHByb3ZpZGUgdGhlIGdlbmVyaWMgdG8gdGhpcyBmdW5jdGlvbgogKiBzbyB0aGF0IHRoZSBlbnZlbG9wZSB0eXBlcyByZXNvbHZlIGNvcnJlY3RseS4KICovCmZ1bmN0aW9uIGNyZWF0ZUVudmVsb3BlKGhlYWRlcnMsIGl0ZW1zID0gW10pIHsKICByZXR1cm4gW2hlYWRlcnMsIGl0ZW1zXSA7Cn0KCi8qKgogKiBDb252ZW5pZW5jZSBmdW5jdGlvbiB0byBsb29wIHRocm91Z2ggdGhlIGl0ZW1zIGFuZCBpdGVtIHR5cGVzIG9mIGFuIGVudmVsb3BlLgogKiAoVGhpcyBmdW5jdGlvbiB3YXMgbW9zdGx5IGNyZWF0ZWQgYmVjYXVzZSB3b3JraW5nIHdpdGggZW52ZWxvcGUgdHlwZXMgaXMgcGFpbmZ1bCBhdCB0aGUgbW9tZW50KQogKgogKiBJZiB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVlLCB0aGUgcmVzdCBvZiB0aGUgaXRlbXMgd2lsbCBiZSBza2lwcGVkLgogKi8KZnVuY3Rpb24gZm9yRWFjaEVudmVsb3BlSXRlbSgKICBlbnZlbG9wZSwKICBjYWxsYmFjaywKKSB7CiAgY29uc3QgZW52ZWxvcGVJdGVtcyA9IGVudmVsb3BlWzFdOwoKICBmb3IgKGNvbnN0IGVudmVsb3BlSXRlbSBvZiBlbnZlbG9wZUl0ZW1zKSB7CiAgICBjb25zdCBlbnZlbG9wZUl0ZW1UeXBlID0gZW52ZWxvcGVJdGVtWzBdLnR5cGU7CiAgICBjb25zdCByZXN1bHQgPSBjYWxsYmFjayhlbnZlbG9wZUl0ZW0sIGVudmVsb3BlSXRlbVR5cGUpOwoKICAgIGlmIChyZXN1bHQpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0KCi8qKgogKiBFbmNvZGUgYSBzdHJpbmcgdG8gVVRGOC4KICovCmZ1bmN0aW9uIGVuY29kZVVURjgoaW5wdXQsIHRleHRFbmNvZGVyKSB7CiAgY29uc3QgdXRmOCA9IHRleHRFbmNvZGVyIHx8IG5ldyBUZXh0RW5jb2RlcigpOwogIHJldHVybiB1dGY4LmVuY29kZShpbnB1dCk7Cn0KCi8qKgogKiBTZXJpYWxpemVzIGFuIGVudmVsb3BlLgogKi8KZnVuY3Rpb24gc2VyaWFsaXplRW52ZWxvcGUoZW52ZWxvcGUsIHRleHRFbmNvZGVyKSB7CiAgY29uc3QgW2VudkhlYWRlcnMsIGl0ZW1zXSA9IGVudmVsb3BlOwoKICAvLyBJbml0aWFsbHkgd2UgY29uc3RydWN0IG91ciBlbnZlbG9wZSBhcyBhIHN0cmluZyBhbmQgb25seSBjb252ZXJ0IHRvIGJpbmFyeSBjaHVua3MgaWYgd2UgZW5jb3VudGVyIGJpbmFyeSBkYXRhCiAgbGV0IHBhcnRzID0gSlNPTi5zdHJpbmdpZnkoZW52SGVhZGVycyk7CgogIGZ1bmN0aW9uIGFwcGVuZChuZXh0KSB7CiAgICBpZiAodHlwZW9mIHBhcnRzID09PSAnc3RyaW5nJykgewogICAgICBwYXJ0cyA9IHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJyA/IHBhcnRzICsgbmV4dCA6IFtlbmNvZGVVVEY4KHBhcnRzLCB0ZXh0RW5jb2RlciksIG5leHRdOwogICAgfSBlbHNlIHsKICAgICAgcGFydHMucHVzaCh0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycgPyBlbmNvZGVVVEY4KG5leHQsIHRleHRFbmNvZGVyKSA6IG5leHQpOwogICAgfQogIH0KCiAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7CiAgICBjb25zdCBbaXRlbUhlYWRlcnMsIHBheWxvYWRdID0gaXRlbTsKCiAgICBhcHBlbmQoYFxuJHtKU09OLnN0cmluZ2lmeShpdGVtSGVhZGVycyl9XG5gKTsKCiAgICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnIHx8IHBheWxvYWQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICAgIGFwcGVuZChwYXlsb2FkKTsKICAgIH0gZWxzZSB7CiAgICAgIGxldCBzdHJpbmdpZmllZFBheWxvYWQ7CiAgICAgIHRyeSB7CiAgICAgICAgc3RyaW5naWZpZWRQYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkocGF5bG9hZCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBJbiBjYXNlLCBkZXNwaXRlIGFsbCBvdXIgZWZmb3J0cyB0byBrZWVwIGBwYXlsb2FkYCBjaXJjdWxhci1kZXBlbmRlbmN5LWZyZWUsIGBKU09OLnN0cmluaWZ5KClgIHN0aWxsCiAgICAgICAgLy8gZmFpbHMsIHdlIHRyeSBhZ2FpbiBhZnRlciBub3JtYWxpemluZyBpdCBhZ2FpbiB3aXRoIGluZmluaXRlIG5vcm1hbGl6YXRpb24gZGVwdGguIFRoaXMgb2YgY291cnNlIGhhcyBhCiAgICAgICAgLy8gcGVyZm9ybWFuY2UgaW1wYWN0IGJ1dCBpbiB0aGlzIGNhc2UgYSBwZXJmb3JtYW5jZSBoaXQgaXMgYmV0dGVyIHRoYW4gdGhyb3dpbmcuCiAgICAgICAgc3RyaW5naWZpZWRQYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkobm9ybWFsaXplKHBheWxvYWQpKTsKICAgICAgfQogICAgICBhcHBlbmQoc3RyaW5naWZpZWRQYXlsb2FkKTsKICAgIH0KICB9CgogIHJldHVybiB0eXBlb2YgcGFydHMgPT09ICdzdHJpbmcnID8gcGFydHMgOiBjb25jYXRCdWZmZXJzKHBhcnRzKTsKfQoKZnVuY3Rpb24gY29uY2F0QnVmZmVycyhidWZmZXJzKSB7CiAgY29uc3QgdG90YWxMZW5ndGggPSBidWZmZXJzLnJlZHVjZSgoYWNjLCBidWYpID0+IGFjYyArIGJ1Zi5sZW5ndGgsIDApOwoKICBjb25zdCBtZXJnZWQgPSBuZXcgVWludDhBcnJheSh0b3RhbExlbmd0aCk7CiAgbGV0IG9mZnNldCA9IDA7CiAgZm9yIChjb25zdCBidWZmZXIgb2YgYnVmZmVycykgewogICAgbWVyZ2VkLnNldChidWZmZXIsIG9mZnNldCk7CiAgICBvZmZzZXQgKz0gYnVmZmVyLmxlbmd0aDsKICB9CgogIHJldHVybiBtZXJnZWQ7Cn0KCmNvbnN0IElURU1fVFlQRV9UT19EQVRBX0NBVEVHT1JZX01BUCA9IHsKICBzZXNzaW9uOiAnc2Vzc2lvbicsCiAgc2Vzc2lvbnM6ICdzZXNzaW9uJywKICBhdHRhY2htZW50OiAnYXR0YWNobWVudCcsCiAgdHJhbnNhY3Rpb246ICd0cmFuc2FjdGlvbicsCiAgZXZlbnQ6ICdlcnJvcicsCiAgY2xpZW50X3JlcG9ydDogJ2ludGVybmFsJywKICB1c2VyX3JlcG9ydDogJ2RlZmF1bHQnLAogIHByb2ZpbGU6ICdwcm9maWxlJywKICByZXBsYXlfZXZlbnQ6ICdyZXBsYXknLAogIHJlcGxheV9yZWNvcmRpbmc6ICdyZXBsYXknLAogIGNoZWNrX2luOiAnbW9uaXRvcicsCiAgZmVlZGJhY2s6ICdmZWVkYmFjaycsCiAgLy8gVE9ETzogVGhpcyBpcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kIHVudGlsIHdlIGhhdmUgYSBwcm9wZXIgZGF0YSBjYXRlZ29yeSBmb3IgbWV0cmljcwogIHN0YXRzZDogJ3Vua25vd24nLAp9OwoKLyoqCiAqIE1hcHMgdGhlIHR5cGUgb2YgYW4gZW52ZWxvcGUgaXRlbSB0byBhIGRhdGEgY2F0ZWdvcnkuCiAqLwpmdW5jdGlvbiBlbnZlbG9wZUl0ZW1UeXBlVG9EYXRhQ2F0ZWdvcnkodHlwZSkgewogIHJldHVybiBJVEVNX1RZUEVfVE9fREFUQV9DQVRFR09SWV9NQVBbdHlwZV07Cn0KCi8qKiBFeHRyYWN0cyB0aGUgbWluaW1hbCBTREsgaW5mbyBmcm9tIGZyb20gdGhlIG1ldGFkYXRhIG9yIGFuIGV2ZW50cyAqLwpmdW5jdGlvbiBnZXRTZGtNZXRhZGF0YUZvckVudmVsb3BlSGVhZGVyKG1ldGFkYXRhT3JFdmVudCkgewogIGlmICghbWV0YWRhdGFPckV2ZW50IHx8ICFtZXRhZGF0YU9yRXZlbnQuc2RrKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHsgbmFtZSwgdmVyc2lvbiB9ID0gbWV0YWRhdGFPckV2ZW50LnNkazsKICByZXR1cm4geyBuYW1lLCB2ZXJzaW9uIH07Cn0KCi8qKgogKiBDcmVhdGVzIGV2ZW50IGVudmVsb3BlIGhlYWRlcnMsIGJhc2VkIG9uIGV2ZW50LCBzZGsgaW5mbyBhbmQgdHVubmVsCiAqIE5vdGU6IFRoaXMgZnVuY3Rpb24gd2FzIGV4dHJhY3RlZCBmcm9tIHRoZSBjb3JlIHBhY2thZ2UgdG8gbWFrZSBpdCBhdmFpbGFibGUgaW4gUmVwbGF5CiAqLwpmdW5jdGlvbiBjcmVhdGVFdmVudEVudmVsb3BlSGVhZGVycygKICBldmVudCwKICBzZGtJbmZvLAogIHR1bm5lbCwKICBkc24sCikgewogIGNvbnN0IGR5bmFtaWNTYW1wbGluZ0NvbnRleHQgPSBldmVudC5zZGtQcm9jZXNzaW5nTWV0YWRhdGEgJiYgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQ7CiAgcmV0dXJuIHsKICAgIGV2ZW50X2lkOiBldmVudC5ldmVudF9pZCAsCiAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAuLi4oc2RrSW5mbyAmJiB7IHNkazogc2RrSW5mbyB9KSwKICAgIC4uLighIXR1bm5lbCAmJiBkc24gJiYgeyBkc246IGRzblRvU3RyaW5nKGRzbikgfSksCiAgICAuLi4oZHluYW1pY1NhbXBsaW5nQ29udGV4dCAmJiB7CiAgICAgIHRyYWNlOiBkcm9wVW5kZWZpbmVkS2V5cyh7IC4uLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQgfSksCiAgICB9KSwKICB9Owp9CgovLyBJbnRlbnRpb25hbGx5IGtlZXBpbmcgdGhlIGtleSBicm9hZCwgYXMgd2UgZG9uJ3Qga25vdyBmb3Igc3VyZSB3aGF0IHJhdGUgbGltaXQgaGVhZGVycyBnZXQgcmV0dXJuZWQgZnJvbSBiYWNrZW5kCgpjb25zdCBERUZBVUxUX1JFVFJZX0FGVEVSID0gNjAgKiAxMDAwOyAvLyA2MCBzZWNvbmRzCgovKioKICogRXh0cmFjdHMgUmV0cnktQWZ0ZXIgdmFsdWUgZnJvbSB0aGUgcmVxdWVzdCBoZWFkZXIgb3IgcmV0dXJucyBkZWZhdWx0IHZhbHVlCiAqIEBwYXJhbSBoZWFkZXIgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mICdSZXRyeS1BZnRlcicgaGVhZGVyCiAqIEBwYXJhbSBub3cgY3VycmVudCB1bml4IHRpbWVzdGFtcAogKgogKi8KZnVuY3Rpb24gcGFyc2VSZXRyeUFmdGVySGVhZGVyKGhlYWRlciwgbm93ID0gRGF0ZS5ub3coKSkgewogIGNvbnN0IGhlYWRlckRlbGF5ID0gcGFyc2VJbnQoYCR7aGVhZGVyfWAsIDEwKTsKICBpZiAoIWlzTmFOKGhlYWRlckRlbGF5KSkgewogICAgcmV0dXJuIGhlYWRlckRlbGF5ICogMTAwMDsKICB9CgogIGNvbnN0IGhlYWRlckRhdGUgPSBEYXRlLnBhcnNlKGAke2hlYWRlcn1gKTsKICBpZiAoIWlzTmFOKGhlYWRlckRhdGUpKSB7CiAgICByZXR1cm4gaGVhZGVyRGF0ZSAtIG5vdzsKICB9CgogIHJldHVybiBERUZBVUxUX1JFVFJZX0FGVEVSOwp9CgovKioKICogR2V0cyB0aGUgdGltZSB0aGF0IHRoZSBnaXZlbiBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBmb3IgcmF0ZSBsaW1pdGluZy4KICogSW4gY2FzZSBubyBjYXRlZ29yeS1zcGVjaWZpYyBsaW1pdCBpcyBzZXQgYnV0IGEgZ2VuZXJhbCByYXRlIGxpbWl0IGFjcm9zcyBhbGwgY2F0ZWdvcmllcyBpcyBhY3RpdmUsCiAqIHRoYXQgdGltZSBpcyByZXR1cm5lZC4KICoKICogQHJldHVybiB0aGUgdGltZSBpbiBtcyB0aGF0IHRoZSBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBvciAwIGlmIHRoZXJlJ3Mgbm8gYWN0aXZlIHJhdGUgbGltaXQuCiAqLwpmdW5jdGlvbiBkaXNhYmxlZFVudGlsKGxpbWl0cywgY2F0ZWdvcnkpIHsKICByZXR1cm4gbGltaXRzW2NhdGVnb3J5XSB8fCBsaW1pdHMuYWxsIHx8IDA7Cn0KCi8qKgogKiBDaGVja3MgaWYgYSBjYXRlZ29yeSBpcyByYXRlIGxpbWl0ZWQKICovCmZ1bmN0aW9uIGlzUmF0ZUxpbWl0ZWQobGltaXRzLCBjYXRlZ29yeSwgbm93ID0gRGF0ZS5ub3coKSkgewogIHJldHVybiBkaXNhYmxlZFVudGlsKGxpbWl0cywgY2F0ZWdvcnkpID4gbm93Owp9CgovKioKICogVXBkYXRlIHJhdGVsaW1pdHMgZnJvbSBpbmNvbWluZyBoZWFkZXJzLgogKgogKiBAcmV0dXJuIHRoZSB1cGRhdGVkIFJhdGVMaW1pdHMgb2JqZWN0LgogKi8KZnVuY3Rpb24gdXBkYXRlUmF0ZUxpbWl0cygKICBsaW1pdHMsCiAgeyBzdGF0dXNDb2RlLCBoZWFkZXJzIH0sCiAgbm93ID0gRGF0ZS5ub3coKSwKKSB7CiAgY29uc3QgdXBkYXRlZFJhdGVMaW1pdHMgPSB7CiAgICAuLi5saW1pdHMsCiAgfTsKCiAgLy8gIlRoZSBuYW1lIGlzIGNhc2UtaW5zZW5zaXRpdmUuIgogIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9IZWFkZXJzL2dldAogIGNvbnN0IHJhdGVMaW1pdEhlYWRlciA9IGhlYWRlcnMgJiYgaGVhZGVyc1sneC1zZW50cnktcmF0ZS1saW1pdHMnXTsKICBjb25zdCByZXRyeUFmdGVySGVhZGVyID0gaGVhZGVycyAmJiBoZWFkZXJzWydyZXRyeS1hZnRlciddOwoKICBpZiAocmF0ZUxpbWl0SGVhZGVyKSB7CiAgICAvKioKICAgICAqIHJhdGUgbGltaXQgaGVhZGVycyBhcmUgb2YgdGhlIGZvcm0KICAgICAqICAgICA8aGVhZGVyPiw8aGVhZGVyPiwuLgogICAgICogd2hlcmUgZWFjaCA8aGVhZGVyPiBpcyBvZiB0aGUgZm9ybQogICAgICogICAgIDxyZXRyeV9hZnRlcj46IDxjYXRlZ29yaWVzPjogPHNjb3BlPjogPHJlYXNvbl9jb2RlPgogICAgICogd2hlcmUKICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+IGlzIGEgZGVsYXkgaW4gc2Vjb25kcwogICAgICogICAgIDxjYXRlZ29yaWVzPiBpcyB0aGUgZXZlbnQgdHlwZShzKSAoZXJyb3IsIHRyYW5zYWN0aW9uLCBldGMpIGJlaW5nIHJhdGUgbGltaXRlZCBhbmQgaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICAgICAgPGNhdGVnb3J5Pjs8Y2F0ZWdvcnk+Oy4uLgogICAgICogICAgIDxzY29wZT4gaXMgd2hhdCdzIGJlaW5nIGxpbWl0ZWQgKG9yZywgcHJvamVjdCwgb3Iga2V5KSAtIGlnbm9yZWQgYnkgU0RLCiAgICAgKiAgICAgPHJlYXNvbl9jb2RlPiBpcyBhbiBhcmJpdHJhcnkgc3RyaW5nIGxpa2UgIm9yZ19xdW90YSIgLSBpZ25vcmVkIGJ5IFNESwogICAgICovCiAgICBmb3IgKGNvbnN0IGxpbWl0IG9mIHJhdGVMaW1pdEhlYWRlci50cmltKCkuc3BsaXQoJywnKSkgewogICAgICBjb25zdCBbcmV0cnlBZnRlciwgY2F0ZWdvcmllc10gPSBsaW1pdC5zcGxpdCgnOicsIDIpOwogICAgICBjb25zdCBoZWFkZXJEZWxheSA9IHBhcnNlSW50KHJldHJ5QWZ0ZXIsIDEwKTsKICAgICAgY29uc3QgZGVsYXkgPSAoIWlzTmFOKGhlYWRlckRlbGF5KSA/IGhlYWRlckRlbGF5IDogNjApICogMTAwMDsgLy8gNjBzZWMgZGVmYXVsdAogICAgICBpZiAoIWNhdGVnb3JpZXMpIHsKICAgICAgICB1cGRhdGVkUmF0ZUxpbWl0cy5hbGwgPSBub3cgKyBkZWxheTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGNvbnN0IGNhdGVnb3J5IG9mIGNhdGVnb3JpZXMuc3BsaXQoJzsnKSkgewogICAgICAgICAgdXBkYXRlZFJhdGVMaW1pdHNbY2F0ZWdvcnldID0gbm93ICsgZGVsYXk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChyZXRyeUFmdGVySGVhZGVyKSB7CiAgICB1cGRhdGVkUmF0ZUxpbWl0cy5hbGwgPSBub3cgKyBwYXJzZVJldHJ5QWZ0ZXJIZWFkZXIocmV0cnlBZnRlckhlYWRlciwgbm93KTsKICB9IGVsc2UgaWYgKHN0YXR1c0NvZGUgPT09IDQyOSkgewogICAgdXBkYXRlZFJhdGVMaW1pdHMuYWxsID0gbm93ICsgNjAgKiAxMDAwOwogIH0KCiAgcmV0dXJuIHVwZGF0ZWRSYXRlTGltaXRzOwp9CgovKioKICogQSBub2RlLmpzIHdhdGNoZG9nIHRpbWVyCiAqIEBwYXJhbSBwb2xsSW50ZXJ2YWwgVGhlIGludGVydmFsIHRoYXQgd2UgZXhwZWN0IHRvIGdldCBwb2xsZWQgYXQKICogQHBhcmFtIGFuclRocmVzaG9sZCBUaGUgdGhyZXNob2xkIGZvciB3aGVuIHdlIGNvbnNpZGVyIEFOUgogKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIGNhbGwgZm9yIEFOUgogKiBAcmV0dXJucyBBbiBvYmplY3Qgd2l0aCBgcG9sbGAgYW5kIGBlbmFibGVkYCBmdW5jdGlvbnMge0BsaW5rIFdhdGNoZG9nUmV0dXJufQogKi8KZnVuY3Rpb24gd2F0Y2hkb2dUaW1lcigKICBjcmVhdGVUaW1lciwKICBwb2xsSW50ZXJ2YWwsCiAgYW5yVGhyZXNob2xkLAogIGNhbGxiYWNrLAopIHsKICBjb25zdCB0aW1lciA9IGNyZWF0ZVRpbWVyKCk7CiAgbGV0IHRyaWdnZXJlZCA9IGZhbHNlOwogIGxldCBlbmFibGVkID0gdHJ1ZTsKCiAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgY29uc3QgZGlmZk1zID0gdGltZXIuZ2V0VGltZU1zKCk7CgogICAgaWYgKHRyaWdnZXJlZCA9PT0gZmFsc2UgJiYgZGlmZk1zID4gcG9sbEludGVydmFsICsgYW5yVGhyZXNob2xkKSB7CiAgICAgIHRyaWdnZXJlZCA9IHRydWU7CiAgICAgIGlmIChlbmFibGVkKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfQoKICAgIGlmIChkaWZmTXMgPCBwb2xsSW50ZXJ2YWwgKyBhbnJUaHJlc2hvbGQpIHsKICAgICAgdHJpZ2dlcmVkID0gZmFsc2U7CiAgICB9CiAgfSwgMjApOwoKICByZXR1cm4gewogICAgcG9sbDogKCkgPT4gewogICAgICB0aW1lci5yZXNldCgpOwogICAgfSwKICAgIGVuYWJsZWQ6IChzdGF0ZSkgPT4gewogICAgICBlbmFibGVkID0gc3RhdGU7CiAgICB9LAogIH07Cn0KCi8vIHR5cGVzIGNvcGllZCBmcm9tIGluc3BlY3Rvci5kLnRzCgovKioKICogQ29udmVydHMgRGVidWdnZXIuQ2FsbEZyYW1lIHRvIFNlbnRyeSBTdGFja0ZyYW1lCiAqLwpmdW5jdGlvbiBjYWxsRnJhbWVUb1N0YWNrRnJhbWUoCiAgZnJhbWUsCiAgdXJsLAogIGdldE1vZHVsZUZyb21GaWxlbmFtZSwKKSB7CiAgY29uc3QgZmlsZW5hbWUgPSB1cmwgPyB1cmwucmVwbGFjZSgvXmZpbGU6XC9cLy8sICcnKSA6IHVuZGVmaW5lZDsKCiAgLy8gQ2FsbEZyYW1lIHJvdy9jb2wgYXJlIDAgYmFzZWQsIHdoZXJlYXMgU3RhY2tGcmFtZSBhcmUgMSBiYXNlZAogIGNvbnN0IGNvbG5vID0gZnJhbWUubG9jYXRpb24uY29sdW1uTnVtYmVyID8gZnJhbWUubG9jYXRpb24uY29sdW1uTnVtYmVyICsgMSA6IHVuZGVmaW5lZDsKICBjb25zdCBsaW5lbm8gPSBmcmFtZS5sb2NhdGlvbi5saW5lTnVtYmVyID8gZnJhbWUubG9jYXRpb24ubGluZU51bWJlciArIDEgOiB1bmRlZmluZWQ7CgogIHJldHVybiBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBmaWxlbmFtZSwKICAgIG1vZHVsZTogZ2V0TW9kdWxlRnJvbUZpbGVuYW1lKGZpbGVuYW1lKSwKICAgIGZ1bmN0aW9uOiBmcmFtZS5mdW5jdGlvbk5hbWUgfHwgJz8nLAogICAgY29sbm8sCiAgICBsaW5lbm8sCiAgICBpbl9hcHA6IGZpbGVuYW1lID8gZmlsZW5hbWVJc0luQXBwKGZpbGVuYW1lKSA6IHVuZGVmaW5lZCwKICB9KTsKfQoKLyoqCiAqIFRoaXMgc2VydmVzIGFzIGEgYnVpbGQgdGltZSBmbGFnIHRoYXQgd2lsbCBiZSB0cnVlIGJ5IGRlZmF1bHQsIGJ1dCBmYWxzZSBpbiBub24tZGVidWcgYnVpbGRzIG9yIGlmIHVzZXJzIHJlcGxhY2UgYF9fU0VOVFJZX0RFQlVHX19gIGluIHRoZWlyIGdlbmVyYXRlZCBjb2RlLgogKgogKiBBVFRFTlRJT046IFRoaXMgY29uc3RhbnQgbXVzdCBuZXZlciBjcm9zcyBwYWNrYWdlIGJvdW5kYXJpZXMgKGkuZS4gYmUgZXhwb3J0ZWQpIHRvIGd1YXJhbnRlZSB0aGF0IGl0IGNhbiBiZSB1c2VkIGZvciB0cmVlIHNoYWtpbmcuCiAqLwpjb25zdCBERUJVR19CVUlMRCA9ICh0eXBlb2YgX19TRU5UUllfREVCVUdfXyA9PT0gJ3VuZGVmaW5lZCcgfHwgX19TRU5UUllfREVCVUdfXyk7CgovKioKICogQ3JlYXRlcyBhIG5ldyBgU2Vzc2lvbmAgb2JqZWN0IGJ5IHNldHRpbmcgY2VydGFpbiBkZWZhdWx0IHBhcmFtZXRlcnMuIElmIG9wdGlvbmFsIEBwYXJhbSBjb250ZXh0CiAqIGlzIHBhc3NlZCwgdGhlIHBhc3NlZCBwcm9wZXJ0aWVzIGFyZSBhcHBsaWVkIHRvIHRoZSBzZXNzaW9uIG9iamVjdC4KICoKICogQHBhcmFtIGNvbnRleHQgKG9wdGlvbmFsKSBhZGRpdGlvbmFsIHByb3BlcnRpZXMgdG8gYmUgYXBwbGllZCB0byB0aGUgcmV0dXJuZWQgc2Vzc2lvbiBvYmplY3QKICoKICogQHJldHVybnMgYSBuZXcgYFNlc3Npb25gIG9iamVjdAogKi8KZnVuY3Rpb24gbWFrZVNlc3Npb24oY29udGV4dCkgewogIC8vIEJvdGggdGltZXN0YW1wIGFuZCBzdGFydGVkIGFyZSBpbiBzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoLgogIGNvbnN0IHN0YXJ0aW5nVGltZSA9IHRpbWVzdGFtcEluU2Vjb25kcygpOwoKICBjb25zdCBzZXNzaW9uID0gewogICAgc2lkOiB1dWlkNCgpLAogICAgaW5pdDogdHJ1ZSwKICAgIHRpbWVzdGFtcDogc3RhcnRpbmdUaW1lLAogICAgc3RhcnRlZDogc3RhcnRpbmdUaW1lLAogICAgZHVyYXRpb246IDAsCiAgICBzdGF0dXM6ICdvaycsCiAgICBlcnJvcnM6IDAsCiAgICBpZ25vcmVEdXJhdGlvbjogZmFsc2UsCiAgICB0b0pTT046ICgpID0+IHNlc3Npb25Ub0pTT04oc2Vzc2lvbiksCiAgfTsKCiAgaWYgKGNvbnRleHQpIHsKICAgIHVwZGF0ZVNlc3Npb24oc2Vzc2lvbiwgY29udGV4dCk7CiAgfQoKICByZXR1cm4gc2Vzc2lvbjsKfQoKLyoqCiAqIFVwZGF0ZXMgYSBzZXNzaW9uIG9iamVjdCB3aXRoIHRoZSBwcm9wZXJ0aWVzIHBhc3NlZCBpbiB0aGUgY29udGV4dC4KICoKICogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gbXV0YXRlcyB0aGUgcGFzc2VkIG9iamVjdCBhbmQgcmV0dXJucyB2b2lkLgogKiAoSGFkIHRvIGRvIHRoaXMgaW5zdGVhZCBvZiByZXR1cm5pbmcgYSBuZXcgYW5kIHVwZGF0ZWQgc2Vzc2lvbiBiZWNhdXNlIGNsb3NpbmcgYW5kIHNlbmRpbmcgYSBzZXNzaW9uCiAqIG1ha2VzIGFuIHVwZGF0ZSB0byB0aGUgc2Vzc2lvbiBhZnRlciBpdCB3YXMgcGFzc2VkIHRvIHRoZSBzZW5kaW5nIGxvZ2ljLgogKiBAc2VlIEJhc2VDbGllbnQuY2FwdHVyZVNlc3Npb24gKQogKgogKiBAcGFyYW0gc2Vzc2lvbiB0aGUgYFNlc3Npb25gIHRvIHVwZGF0ZQogKiBAcGFyYW0gY29udGV4dCB0aGUgYFNlc3Npb25Db250ZXh0YCBob2xkaW5nIHRoZSBwcm9wZXJ0aWVzIHRoYXQgc2hvdWxkIGJlIHVwZGF0ZWQgaW4gQHBhcmFtIHNlc3Npb24KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5CmZ1bmN0aW9uIHVwZGF0ZVNlc3Npb24oc2Vzc2lvbiwgY29udGV4dCA9IHt9KSB7CiAgaWYgKGNvbnRleHQudXNlcikgewogICAgaWYgKCFzZXNzaW9uLmlwQWRkcmVzcyAmJiBjb250ZXh0LnVzZXIuaXBfYWRkcmVzcykgewogICAgICBzZXNzaW9uLmlwQWRkcmVzcyA9IGNvbnRleHQudXNlci5pcF9hZGRyZXNzOwogICAgfQoKICAgIGlmICghc2Vzc2lvbi5kaWQgJiYgIWNvbnRleHQuZGlkKSB7CiAgICAgIHNlc3Npb24uZGlkID0gY29udGV4dC51c2VyLmlkIHx8IGNvbnRleHQudXNlci5lbWFpbCB8fCBjb250ZXh0LnVzZXIudXNlcm5hbWU7CiAgICB9CiAgfQoKICBzZXNzaW9uLnRpbWVzdGFtcCA9IGNvbnRleHQudGltZXN0YW1wIHx8IHRpbWVzdGFtcEluU2Vjb25kcygpOwoKICBpZiAoY29udGV4dC5hYm5vcm1hbF9tZWNoYW5pc20pIHsKICAgIHNlc3Npb24uYWJub3JtYWxfbWVjaGFuaXNtID0gY29udGV4dC5hYm5vcm1hbF9tZWNoYW5pc207CiAgfQoKICBpZiAoY29udGV4dC5pZ25vcmVEdXJhdGlvbikgewogICAgc2Vzc2lvbi5pZ25vcmVEdXJhdGlvbiA9IGNvbnRleHQuaWdub3JlRHVyYXRpb247CiAgfQogIGlmIChjb250ZXh0LnNpZCkgewogICAgLy8gR29vZCBlbm91Z2ggdXVpZCB2YWxpZGF0aW9uLiDigJQgS2FtaWwKICAgIHNlc3Npb24uc2lkID0gY29udGV4dC5zaWQubGVuZ3RoID09PSAzMiA/IGNvbnRleHQuc2lkIDogdXVpZDQoKTsKICB9CiAgaWYgKGNvbnRleHQuaW5pdCAhPT0gdW5kZWZpbmVkKSB7CiAgICBzZXNzaW9uLmluaXQgPSBjb250ZXh0LmluaXQ7CiAgfQogIGlmICghc2Vzc2lvbi5kaWQgJiYgY29udGV4dC5kaWQpIHsKICAgIHNlc3Npb24uZGlkID0gYCR7Y29udGV4dC5kaWR9YDsKICB9CiAgaWYgKHR5cGVvZiBjb250ZXh0LnN0YXJ0ZWQgPT09ICdudW1iZXInKSB7CiAgICBzZXNzaW9uLnN0YXJ0ZWQgPSBjb250ZXh0LnN0YXJ0ZWQ7CiAgfQogIGlmIChzZXNzaW9uLmlnbm9yZUR1cmF0aW9uKSB7CiAgICBzZXNzaW9uLmR1cmF0aW9uID0gdW5kZWZpbmVkOwogIH0gZWxzZSBpZiAodHlwZW9mIGNvbnRleHQuZHVyYXRpb24gPT09ICdudW1iZXInKSB7CiAgICBzZXNzaW9uLmR1cmF0aW9uID0gY29udGV4dC5kdXJhdGlvbjsKICB9IGVsc2UgewogICAgY29uc3QgZHVyYXRpb24gPSBzZXNzaW9uLnRpbWVzdGFtcCAtIHNlc3Npb24uc3RhcnRlZDsKICAgIHNlc3Npb24uZHVyYXRpb24gPSBkdXJhdGlvbiA+PSAwID8gZHVyYXRpb24gOiAwOwogIH0KICBpZiAoY29udGV4dC5yZWxlYXNlKSB7CiAgICBzZXNzaW9uLnJlbGVhc2UgPSBjb250ZXh0LnJlbGVhc2U7CiAgfQogIGlmIChjb250ZXh0LmVudmlyb25tZW50KSB7CiAgICBzZXNzaW9uLmVudmlyb25tZW50ID0gY29udGV4dC5lbnZpcm9ubWVudDsKICB9CiAgaWYgKCFzZXNzaW9uLmlwQWRkcmVzcyAmJiBjb250ZXh0LmlwQWRkcmVzcykgewogICAgc2Vzc2lvbi5pcEFkZHJlc3MgPSBjb250ZXh0LmlwQWRkcmVzczsKICB9CiAgaWYgKCFzZXNzaW9uLnVzZXJBZ2VudCAmJiBjb250ZXh0LnVzZXJBZ2VudCkgewogICAgc2Vzc2lvbi51c2VyQWdlbnQgPSBjb250ZXh0LnVzZXJBZ2VudDsKICB9CiAgaWYgKHR5cGVvZiBjb250ZXh0LmVycm9ycyA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uZXJyb3JzID0gY29udGV4dC5lcnJvcnM7CiAgfQogIGlmIChjb250ZXh0LnN0YXR1cykgewogICAgc2Vzc2lvbi5zdGF0dXMgPSBjb250ZXh0LnN0YXR1czsKICB9Cn0KCi8qKgogKiBTZXJpYWxpemVzIGEgcGFzc2VkIHNlc3Npb24gb2JqZWN0IHRvIGEgSlNPTiBvYmplY3Qgd2l0aCBhIHNsaWdodGx5IGRpZmZlcmVudCBzdHJ1Y3R1cmUuCiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2UgdGhlIFNlbnRyeSBiYWNrZW5kIHJlcXVpcmVzIGEgc2xpZ2h0bHkgZGlmZmVyZW50IHNjaGVtYSBvZiBhIHNlc3Npb24KICogdGhhbiB0aGUgb25lIHRoZSBKUyBTREtzIHVzZSBpbnRlcm5hbGx5LgogKgogKiBAcGFyYW0gc2Vzc2lvbiB0aGUgc2Vzc2lvbiB0byBiZSBjb252ZXJ0ZWQKICoKICogQHJldHVybnMgYSBKU09OIG9iamVjdCBvZiB0aGUgcGFzc2VkIHNlc3Npb24KICovCmZ1bmN0aW9uIHNlc3Npb25Ub0pTT04oc2Vzc2lvbikgewogIHJldHVybiBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBzaWQ6IGAke3Nlc3Npb24uc2lkfWAsCiAgICBpbml0OiBzZXNzaW9uLmluaXQsCiAgICAvLyBNYWtlIHN1cmUgdGhhdCBzZWMgaXMgY29udmVydGVkIHRvIG1zIGZvciBkYXRlIGNvbnN0cnVjdG9yCiAgICBzdGFydGVkOiBuZXcgRGF0ZShzZXNzaW9uLnN0YXJ0ZWQgKiAxMDAwKS50b0lTT1N0cmluZygpLAogICAgdGltZXN0YW1wOiBuZXcgRGF0ZShzZXNzaW9uLnRpbWVzdGFtcCAqIDEwMDApLnRvSVNPU3RyaW5nKCksCiAgICBzdGF0dXM6IHNlc3Npb24uc3RhdHVzLAogICAgZXJyb3JzOiBzZXNzaW9uLmVycm9ycywKICAgIGRpZDogdHlwZW9mIHNlc3Npb24uZGlkID09PSAnbnVtYmVyJyB8fCB0eXBlb2Ygc2Vzc2lvbi5kaWQgPT09ICdzdHJpbmcnID8gYCR7c2Vzc2lvbi5kaWR9YCA6IHVuZGVmaW5lZCwKICAgIGR1cmF0aW9uOiBzZXNzaW9uLmR1cmF0aW9uLAogICAgYWJub3JtYWxfbWVjaGFuaXNtOiBzZXNzaW9uLmFibm9ybWFsX21lY2hhbmlzbSwKICAgIGF0dHJzOiB7CiAgICAgIHJlbGVhc2U6IHNlc3Npb24ucmVsZWFzZSwKICAgICAgZW52aXJvbm1lbnQ6IHNlc3Npb24uZW52aXJvbm1lbnQsCiAgICAgIGlwX2FkZHJlc3M6IHNlc3Npb24uaXBBZGRyZXNzLAogICAgICB1c2VyX2FnZW50OiBzZXNzaW9uLnVzZXJBZ2VudCwKICAgIH0sCiAgfSk7Cn0KCi8qKgogKiBBcHBseSBTZGtJbmZvIChuYW1lLCB2ZXJzaW9uLCBwYWNrYWdlcywgaW50ZWdyYXRpb25zKSB0byB0aGUgY29ycmVzcG9uZGluZyBldmVudCBrZXkuCiAqIE1lcmdlIHdpdGggZXhpc3RpbmcgZGF0YSBpZiBhbnkuCiAqKi8KZnVuY3Rpb24gZW5oYW5jZUV2ZW50V2l0aFNka0luZm8oZXZlbnQsIHNka0luZm8pIHsKICBpZiAoIXNka0luZm8pIHsKICAgIHJldHVybiBldmVudDsKICB9CiAgZXZlbnQuc2RrID0gZXZlbnQuc2RrIHx8IHt9OwogIGV2ZW50LnNkay5uYW1lID0gZXZlbnQuc2RrLm5hbWUgfHwgc2RrSW5mby5uYW1lOwogIGV2ZW50LnNkay52ZXJzaW9uID0gZXZlbnQuc2RrLnZlcnNpb24gfHwgc2RrSW5mby52ZXJzaW9uOwogIGV2ZW50LnNkay5pbnRlZ3JhdGlvbnMgPSBbLi4uKGV2ZW50LnNkay5pbnRlZ3JhdGlvbnMgfHwgW10pLCAuLi4oc2RrSW5mby5pbnRlZ3JhdGlvbnMgfHwgW10pXTsKICBldmVudC5zZGsucGFja2FnZXMgPSBbLi4uKGV2ZW50LnNkay5wYWNrYWdlcyB8fCBbXSksIC4uLihzZGtJbmZvLnBhY2thZ2VzIHx8IFtdKV07CiAgcmV0dXJuIGV2ZW50Owp9CgovKiogQ3JlYXRlcyBhbiBlbnZlbG9wZSBmcm9tIGEgU2Vzc2lvbiAqLwpmdW5jdGlvbiBjcmVhdGVTZXNzaW9uRW52ZWxvcGUoCiAgc2Vzc2lvbiwKICBkc24sCiAgbWV0YWRhdGEsCiAgdHVubmVsLAopIHsKICBjb25zdCBzZGtJbmZvID0gZ2V0U2RrTWV0YWRhdGFGb3JFbnZlbG9wZUhlYWRlcihtZXRhZGF0YSk7CiAgY29uc3QgZW52ZWxvcGVIZWFkZXJzID0gewogICAgc2VudF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLAogICAgLi4uKHNka0luZm8gJiYgeyBzZGs6IHNka0luZm8gfSksCiAgICAuLi4oISF0dW5uZWwgJiYgZHNuICYmIHsgZHNuOiBkc25Ub1N0cmluZyhkc24pIH0pLAogIH07CgogIGNvbnN0IGVudmVsb3BlSXRlbSA9CiAgICAnYWdncmVnYXRlcycgaW4gc2Vzc2lvbiA/IFt7IHR5cGU6ICdzZXNzaW9ucycgfSwgc2Vzc2lvbl0gOiBbeyB0eXBlOiAnc2Vzc2lvbicgfSwgc2Vzc2lvbi50b0pTT04oKV07CgogIHJldHVybiBjcmVhdGVFbnZlbG9wZShlbnZlbG9wZUhlYWRlcnMsIFtlbnZlbG9wZUl0ZW1dKTsKfQoKLyoqCiAqIENyZWF0ZSBhbiBFbnZlbG9wZSBmcm9tIGFuIGV2ZW50LgogKi8KZnVuY3Rpb24gY3JlYXRlRXZlbnRFbnZlbG9wZSgKICBldmVudCwKICBkc24sCiAgbWV0YWRhdGEsCiAgdHVubmVsLAopIHsKICBjb25zdCBzZGtJbmZvID0gZ2V0U2RrTWV0YWRhdGFGb3JFbnZlbG9wZUhlYWRlcihtZXRhZGF0YSk7CgogIC8qCiAgICBOb3RlOiBEdWUgdG8gVFMsIGV2ZW50LnR5cGUgbWF5IGJlIGByZXBsYXlfZXZlbnRgLCB0aGVvcmV0aWNhbGx5LgogICAgSW4gcHJhY3RpY2UsIHdlIG5ldmVyIGNhbGwgYGNyZWF0ZUV2ZW50RW52ZWxvcGVgIHdpdGggYHJlcGxheV9ldmVudGAgdHlwZSwKICAgIGFuZCB3ZSdkIGhhdmUgdG8gYWRqdXQgYSBsb29vdCBvZiB0eXBlcyB0byBtYWtlIHRoaXMgd29yayBwcm9wZXJseS4KICAgIFdlIHdhbnQgdG8gYXZvaWQgY2FzdGluZyB0aGlzIGFyb3VuZCwgYXMgdGhhdCBjb3VsZCBsZWFkIHRvIGJ1Z3MgKGUuZy4gd2hlbiB3ZSBhZGQgYW5vdGhlciB0eXBlKQogICAgU28gdGhlIHNhZmUgY2hvaWNlIGlzIHRvIHJlYWxseSBndWFyZCBhZ2FpbnN0IHRoZSByZXBsYXlfZXZlbnQgdHlwZSBoZXJlLgogICovCiAgY29uc3QgZXZlbnRUeXBlID0gZXZlbnQudHlwZSAmJiBldmVudC50eXBlICE9PSAncmVwbGF5X2V2ZW50JyA/IGV2ZW50LnR5cGUgOiAnZXZlbnQnOwoKICBlbmhhbmNlRXZlbnRXaXRoU2RrSW5mbyhldmVudCwgbWV0YWRhdGEgJiYgbWV0YWRhdGEuc2RrKTsKCiAgY29uc3QgZW52ZWxvcGVIZWFkZXJzID0gY3JlYXRlRXZlbnRFbnZlbG9wZUhlYWRlcnMoZXZlbnQsIHNka0luZm8sIHR1bm5lbCwgZHNuKTsKCiAgLy8gUHJldmVudCB0aGlzIGRhdGEgKHdoaWNoLCBpZiBpdCBleGlzdHMsIHdhcyB1c2VkIGluIGVhcmxpZXIgc3RlcHMgaW4gdGhlIHByb2Nlc3NpbmcgcGlwZWxpbmUpIGZyb20gYmVpbmcgc2VudCB0bwogIC8vIHNlbnRyeS4gKE5vdGU6IE91ciB1c2Ugb2YgdGhpcyBwcm9wZXJ0eSBjb21lcyBhbmQgZ29lcyB3aXRoIHdoYXRldmVyIHdlIG1pZ2h0IGJlIGRlYnVnZ2luZywgd2hhdGV2ZXIgaGFja3Mgd2UgbWF5CiAgLy8gaGF2ZSB0ZW1wb3JhcmlseSBhZGRlZCwgZXRjLiBFdmVuIGlmIHdlIGRvbid0IGhhcHBlbiB0byBiZSB1c2luZyBpdCBhdCBzb21lIHBvaW50IGluIHRoZSBmdXR1cmUsIGxldCdzIG5vdCBnZXQgcmlkCiAgLy8gb2YgdGhpcyBgZGVsZXRlYCwgbGVzdCB3ZSBtaXNzIHB1dHRpbmcgaXQgYmFjayBpbiB0aGUgbmV4dCB0aW1lIHRoZSBwcm9wZXJ0eSBpcyBpbiB1c2UuKQogIGRlbGV0ZSBldmVudC5zZGtQcm9jZXNzaW5nTWV0YWRhdGE7CgogIGNvbnN0IGV2ZW50SXRlbSA9IFt7IHR5cGU6IGV2ZW50VHlwZSB9LCBldmVudF07CiAgcmV0dXJuIGNyZWF0ZUVudmVsb3BlKGVudmVsb3BlSGVhZGVycywgW2V2ZW50SXRlbV0pOwp9Cgpjb25zdCBTRU5UUllfQVBJX1ZFUlNJT04gPSAnNyc7CgovKiogUmV0dXJucyB0aGUgcHJlZml4IHRvIGNvbnN0cnVjdCBTZW50cnkgaW5nZXN0aW9uIEFQSSBlbmRwb2ludHMuICovCmZ1bmN0aW9uIGdldEJhc2VBcGlFbmRwb2ludChkc24pIHsKICBjb25zdCBwcm90b2NvbCA9IGRzbi5wcm90b2NvbCA/IGAke2Rzbi5wcm90b2NvbH06YCA6ICcnOwogIGNvbnN0IHBvcnQgPSBkc24ucG9ydCA/IGA6JHtkc24ucG9ydH1gIDogJyc7CiAgcmV0dXJuIGAke3Byb3RvY29sfS8vJHtkc24uaG9zdH0ke3BvcnR9JHtkc24ucGF0aCA/IGAvJHtkc24ucGF0aH1gIDogJyd9L2FwaS9gOwp9CgovKiogUmV0dXJucyB0aGUgaW5nZXN0IEFQSSBlbmRwb2ludCBmb3IgdGFyZ2V0LiAqLwpmdW5jdGlvbiBfZ2V0SW5nZXN0RW5kcG9pbnQoZHNuKSB7CiAgcmV0dXJuIGAke2dldEJhc2VBcGlFbmRwb2ludChkc24pfSR7ZHNuLnByb2plY3RJZH0vZW52ZWxvcGUvYDsKfQoKLyoqIFJldHVybnMgYSBVUkwtZW5jb2RlZCBzdHJpbmcgd2l0aCBhdXRoIGNvbmZpZyBzdWl0YWJsZSBmb3IgYSBxdWVyeSBzdHJpbmcuICovCmZ1bmN0aW9uIF9lbmNvZGVkQXV0aChkc24sIHNka0luZm8pIHsKICByZXR1cm4gdXJsRW5jb2RlKHsKICAgIC8vIFdlIHNlbmQgb25seSB0aGUgbWluaW11bSBzZXQgb2YgcmVxdWlyZWQgaW5mb3JtYXRpb24uIFNlZQogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9pc3N1ZXMvMjU3Mi4KICAgIHNlbnRyeV9rZXk6IGRzbi5wdWJsaWNLZXksCiAgICBzZW50cnlfdmVyc2lvbjogU0VOVFJZX0FQSV9WRVJTSU9OLAogICAgLi4uKHNka0luZm8gJiYgeyBzZW50cnlfY2xpZW50OiBgJHtzZGtJbmZvLm5hbWV9LyR7c2RrSW5mby52ZXJzaW9ufWAgfSksCiAgfSk7Cn0KCi8qKgogKiBSZXR1cm5zIHRoZSBlbnZlbG9wZSBlbmRwb2ludCBVUkwgd2l0aCBhdXRoIGluIHRoZSBxdWVyeSBzdHJpbmcuCiAqCiAqIFNlbmRpbmcgYXV0aCBhcyBwYXJ0IG9mIHRoZSBxdWVyeSBzdHJpbmcgYW5kIG5vdCBhcyBjdXN0b20gSFRUUCBoZWFkZXJzIGF2b2lkcyBDT1JTIHByZWZsaWdodCByZXF1ZXN0cy4KICovCmZ1bmN0aW9uIGdldEVudmVsb3BlRW5kcG9pbnRXaXRoVXJsRW5jb2RlZEF1dGgoCiAgZHNuLAogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIGB0dW5uZWxPck9wdGlvbnNgIGluIGZhdm9yIG9mIGBvcHRpb25zYCwgYW5kIHVzZSB0aGUgc3Vic3RpdHV0ZSBjb2RlIGJlbG93CiAgLy8gb3B0aW9uczogQ2xpZW50T3B0aW9ucyA9IHt9IGFzIENsaWVudE9wdGlvbnMsCiAgdHVubmVsT3JPcHRpb25zID0ge30gLAopIHsKICAvLyBUT0RPICh2OCk6IFVzZSB0aGlzIGNvZGUgaW5zdGVhZAogIC8vIGNvbnN0IHsgdHVubmVsLCBfbWV0YWRhdGEgPSB7fSB9ID0gb3B0aW9uczsKICAvLyByZXR1cm4gdHVubmVsID8gdHVubmVsIDogYCR7X2dldEluZ2VzdEVuZHBvaW50KGRzbil9PyR7X2VuY29kZWRBdXRoKGRzbiwgX21ldGFkYXRhLnNkayl9YDsKCiAgY29uc3QgdHVubmVsID0gdHlwZW9mIHR1bm5lbE9yT3B0aW9ucyA9PT0gJ3N0cmluZycgPyB0dW5uZWxPck9wdGlvbnMgOiB0dW5uZWxPck9wdGlvbnMudHVubmVsOwogIGNvbnN0IHNka0luZm8gPQogICAgdHlwZW9mIHR1bm5lbE9yT3B0aW9ucyA9PT0gJ3N0cmluZycgfHwgIXR1bm5lbE9yT3B0aW9ucy5fbWV0YWRhdGEgPyB1bmRlZmluZWQgOiB0dW5uZWxPck9wdGlvbnMuX21ldGFkYXRhLnNkazsKCiAgcmV0dXJuIHR1bm5lbCA/IHR1bm5lbCA6IGAke19nZXRJbmdlc3RFbmRwb2ludChkc24pfT8ke19lbmNvZGVkQXV0aChkc24sIHNka0luZm8pfWA7Cn0KCmNvbnN0IERFRkFVTFRfVFJBTlNQT1JUX0JVRkZFUl9TSVpFID0gMzA7CgovKioKICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIFNlbnRyeSBgVHJhbnNwb3J0YAogKgogKiBAcGFyYW0gb3B0aW9ucwogKiBAcGFyYW0gbWFrZVJlcXVlc3QKICovCmZ1bmN0aW9uIGNyZWF0ZVRyYW5zcG9ydCgKICBvcHRpb25zLAogIG1ha2VSZXF1ZXN0LAogIGJ1ZmZlciA9IG1ha2VQcm9taXNlQnVmZmVyKAogICAgb3B0aW9ucy5idWZmZXJTaXplIHx8IERFRkFVTFRfVFJBTlNQT1JUX0JVRkZFUl9TSVpFLAogICksCikgewogIGxldCByYXRlTGltaXRzID0ge307CiAgY29uc3QgZmx1c2ggPSAodGltZW91dCkgPT4gYnVmZmVyLmRyYWluKHRpbWVvdXQpOwoKICBmdW5jdGlvbiBzZW5kKGVudmVsb3BlKSB7CiAgICBjb25zdCBmaWx0ZXJlZEVudmVsb3BlSXRlbXMgPSBbXTsKCiAgICAvLyBEcm9wIHJhdGUgbGltaXRlZCBpdGVtcyBmcm9tIGVudmVsb3BlCiAgICBmb3JFYWNoRW52ZWxvcGVJdGVtKGVudmVsb3BlLCAoaXRlbSwgdHlwZSkgPT4gewogICAgICBjb25zdCBlbnZlbG9wZUl0ZW1EYXRhQ2F0ZWdvcnkgPSBlbnZlbG9wZUl0ZW1UeXBlVG9EYXRhQ2F0ZWdvcnkodHlwZSk7CiAgICAgIGlmIChpc1JhdGVMaW1pdGVkKHJhdGVMaW1pdHMsIGVudmVsb3BlSXRlbURhdGFDYXRlZ29yeSkpIHsKICAgICAgICBjb25zdCBldmVudCA9IGdldEV2ZW50Rm9yRW52ZWxvcGVJdGVtKGl0ZW0sIHR5cGUpOwogICAgICAgIG9wdGlvbnMucmVjb3JkRHJvcHBlZEV2ZW50KCdyYXRlbGltaXRfYmFja29mZicsIGVudmVsb3BlSXRlbURhdGFDYXRlZ29yeSwgZXZlbnQpOwogICAgICB9IGVsc2UgewogICAgICAgIGZpbHRlcmVkRW52ZWxvcGVJdGVtcy5wdXNoKGl0ZW0pOwogICAgICB9CiAgICB9KTsKCiAgICAvLyBTa2lwIHNlbmRpbmcgaWYgZW52ZWxvcGUgaXMgZW1wdHkgYWZ0ZXIgZmlsdGVyaW5nIG91dCByYXRlIGxpbWl0ZWQgZXZlbnRzCiAgICBpZiAoZmlsdGVyZWRFbnZlbG9wZUl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm4gcmVzb2x2ZWRTeW5jUHJvbWlzZSgpOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55CiAgICBjb25zdCBmaWx0ZXJlZEVudmVsb3BlID0gY3JlYXRlRW52ZWxvcGUoZW52ZWxvcGVbMF0sIGZpbHRlcmVkRW52ZWxvcGVJdGVtcyApOwoKICAgIC8vIENyZWF0ZXMgY2xpZW50IHJlcG9ydCBmb3IgZWFjaCBpdGVtIGluIGFuIGVudmVsb3BlCiAgICBjb25zdCByZWNvcmRFbnZlbG9wZUxvc3MgPSAocmVhc29uKSA9PiB7CiAgICAgIGZvckVhY2hFbnZlbG9wZUl0ZW0oZmlsdGVyZWRFbnZlbG9wZSwgKGl0ZW0sIHR5cGUpID0+IHsKICAgICAgICBjb25zdCBldmVudCA9IGdldEV2ZW50Rm9yRW52ZWxvcGVJdGVtKGl0ZW0sIHR5cGUpOwogICAgICAgIG9wdGlvbnMucmVjb3JkRHJvcHBlZEV2ZW50KHJlYXNvbiwgZW52ZWxvcGVJdGVtVHlwZVRvRGF0YUNhdGVnb3J5KHR5cGUpLCBldmVudCk7CiAgICAgIH0pOwogICAgfTsKCiAgICBjb25zdCByZXF1ZXN0VGFzayA9ICgpID0+CiAgICAgIG1ha2VSZXF1ZXN0KHsgYm9keTogc2VyaWFsaXplRW52ZWxvcGUoZmlsdGVyZWRFbnZlbG9wZSwgb3B0aW9ucy50ZXh0RW5jb2RlcikgfSkudGhlbigKICAgICAgICByZXNwb25zZSA9PiB7CiAgICAgICAgICAvLyBXZSBkb24ndCB3YW50IHRvIHRocm93IG9uIE5PSyByZXNwb25zZXMsIGJ1dCB3ZSB3YW50IHRvIGF0IGxlYXN0IGxvZyB0aGVtCiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSAhPT0gdW5kZWZpbmVkICYmIChyZXNwb25zZS5zdGF0dXNDb2RlIDwgMjAwIHx8IHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMzAwKSkgewogICAgICAgICAgICBERUJVR19CVUlMRCAmJiBsb2dnZXIud2FybihgU2VudHJ5IHJlc3BvbmRlZCB3aXRoIHN0YXR1cyBjb2RlICR7cmVzcG9uc2Uuc3RhdHVzQ29kZX0gdG8gc2VudCBldmVudC5gKTsKICAgICAgICAgIH0KCiAgICAgICAgICByYXRlTGltaXRzID0gdXBkYXRlUmF0ZUxpbWl0cyhyYXRlTGltaXRzLCByZXNwb25zZSk7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgfSwKICAgICAgICBlcnJvciA9PiB7CiAgICAgICAgICByZWNvcmRFbnZlbG9wZUxvc3MoJ25ldHdvcmtfZXJyb3InKTsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0sCiAgICAgICk7CgogICAgcmV0dXJuIGJ1ZmZlci5hZGQocmVxdWVzdFRhc2spLnRoZW4oCiAgICAgIHJlc3VsdCA9PiByZXN1bHQsCiAgICAgIGVycm9yID0+IHsKICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBTZW50cnlFcnJvcikgewogICAgICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLmVycm9yKCdTa2lwcGVkIHNlbmRpbmcgZXZlbnQgYmVjYXVzZSBidWZmZXIgaXMgZnVsbC4nKTsKICAgICAgICAgIHJlY29yZEVudmVsb3BlTG9zcygncXVldWVfb3ZlcmZsb3cnKTsKICAgICAgICAgIHJldHVybiByZXNvbHZlZFN5bmNQcm9taXNlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgICAgfSwKICAgICk7CiAgfQoKICAvLyBXZSB1c2UgdGhpcyB0byBpZGVudGlmaWZ5IGlmIHRoZSB0cmFuc3BvcnQgaXMgdGhlIGJhc2UgdHJhbnNwb3J0CiAgLy8gVE9ETyAodjgpOiBSZW1vdmUgdGhpcyBhZ2FpbiBhcyB3ZSdsbCBubyBsb25nZXIgbmVlZCBpdAogIHNlbmQuX19zZW50cnlfX2Jhc2VUcmFuc3BvcnRfXyA9IHRydWU7CgogIHJldHVybiB7CiAgICBzZW5kLAogICAgZmx1c2gsCiAgfTsKfQoKZnVuY3Rpb24gZ2V0RXZlbnRGb3JFbnZlbG9wZUl0ZW0oaXRlbSwgdHlwZSkgewogIGlmICh0eXBlICE9PSAnZXZlbnQnICYmIHR5cGUgIT09ICd0cmFuc2FjdGlvbicpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICByZXR1cm4gQXJyYXkuaXNBcnJheShpdGVtKSA/IChpdGVtIClbMV0gOiB1bmRlZmluZWQ7Cn0KCi8qKiBub3JtYWxpemVzIFdpbmRvd3MgcGF0aHMgKi8KZnVuY3Rpb24gbm9ybWFsaXplV2luZG93c1BhdGgocGF0aCkgewogIHJldHVybiBwYXRoCiAgICAucmVwbGFjZSgvXltBLVpdOi8sICcnKSAvLyByZW1vdmUgV2luZG93cy1zdHlsZSBwcmVmaXgKICAgIC5yZXBsYWNlKC9cXC9nLCAnLycpOyAvLyByZXBsYWNlIGFsbCBgXGAgaW5zdGFuY2VzIHdpdGggYC9gCn0KCi8qKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBnZXRzIHRoZSBtb2R1bGUgbmFtZSBmcm9tIGEgZmlsZW5hbWUgKi8KZnVuY3Rpb24gY3JlYXRlR2V0TW9kdWxlRnJvbUZpbGVuYW1lKAogIGJhc2VQYXRoID0gcHJvY2Vzcy5hcmd2WzFdID8gZGlybmFtZShwcm9jZXNzLmFyZ3ZbMV0pIDogcHJvY2Vzcy5jd2QoKSwKICBpc1dpbmRvd3MgPSBzZXAgPT09ICdcXCcsCikgewogIGNvbnN0IG5vcm1hbGl6ZWRCYXNlID0gaXNXaW5kb3dzID8gbm9ybWFsaXplV2luZG93c1BhdGgoYmFzZVBhdGgpIDogYmFzZVBhdGg7CgogIHJldHVybiAoZmlsZW5hbWUpID0+IHsKICAgIGlmICghZmlsZW5hbWUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IG5vcm1hbGl6ZWRGaWxlbmFtZSA9IGlzV2luZG93cyA/IG5vcm1hbGl6ZVdpbmRvd3NQYXRoKGZpbGVuYW1lKSA6IGZpbGVuYW1lOwoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3QKICAgIGxldCB7IGRpciwgYmFzZTogZmlsZSwgZXh0IH0gPSBwb3NpeC5wYXJzZShub3JtYWxpemVkRmlsZW5hbWUpOwoKICAgIGlmIChleHQgPT09ICcuanMnIHx8IGV4dCA9PT0gJy5tanMnIHx8IGV4dCA9PT0gJy5janMnKSB7CiAgICAgIGZpbGUgPSBmaWxlLnNsaWNlKDAsIGV4dC5sZW5ndGggKiAtMSk7CiAgICB9CgogICAgaWYgKCFkaXIpIHsKICAgICAgLy8gTm8gZGlybmFtZSB3aGF0c29ldmVyCiAgICAgIGRpciA9ICcuJzsKICAgIH0KCiAgICBjb25zdCBuID0gZGlyLmxhc3RJbmRleE9mKCcvbm9kZV9tb2R1bGVzJyk7CiAgICBpZiAobiA+IC0xKSB7CiAgICAgIHJldHVybiBgJHtkaXIuc2xpY2UobiArIDE0KS5yZXBsYWNlKC9cLy9nLCAnLicpfToke2ZpbGV9YDsKICAgIH0KCiAgICAvLyBMZXQncyBzZWUgaWYgaXQncyBhIHBhcnQgb2YgdGhlIG1haW4gbW9kdWxlCiAgICAvLyBUbyBiZSBhIHBhcnQgb2YgbWFpbiBtb2R1bGUsIGl0IGhhcyB0byBzaGFyZSB0aGUgc2FtZSBiYXNlCiAgICBpZiAoZGlyLnN0YXJ0c1dpdGgobm9ybWFsaXplZEJhc2UpKSB7CiAgICAgIGxldCBtb2R1bGVOYW1lID0gZGlyLnNsaWNlKG5vcm1hbGl6ZWRCYXNlLmxlbmd0aCArIDEpLnJlcGxhY2UoL1wvL2csICcuJyk7CgogICAgICBpZiAobW9kdWxlTmFtZSkgewogICAgICAgIG1vZHVsZU5hbWUgKz0gJzonOwogICAgICB9CiAgICAgIG1vZHVsZU5hbWUgKz0gZmlsZTsKCiAgICAgIHJldHVybiBtb2R1bGVOYW1lOwogICAgfQoKICAgIHJldHVybiBmaWxlOwogIH07Cn0KCmZ1bmN0aW9uIF9udWxsaXNoQ29hbGVzY2UkMihsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9LyoqCiAqIFRoaXMgY29kZSB3YXMgb3JpZ2luYWxseSBmb3JrZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vVG9vVGFsbE5hdGUvcHJveHktYWdlbnRzL3RyZWUvYjEzMzI5NWZkMTZmNjQ3NTU3OGI2YjE1YmQ5YjRlMzNlY2IwZDBiNwogKiBXaXRoIHRoZSBmb2xsb3dpbmcgbGljZW5jZToKICoKICogKFRoZSBNSVQgTGljZW5zZSkKICoKICogQ29weXJpZ2h0IChjKSAyMDEzIE5hdGhhbiBSYWpsaWNoIDxuYXRoYW5AdG9vdGFsbG5hdGUubmV0PioKICoKICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nCiAqIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQogKiAnU29mdHdhcmUnKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCiAqIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKICogZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvCiAqIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0bwogKiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6KgogKgogKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZQogKiBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4qCiAqCiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAnQVMgSVMnLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELAogKiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKICogTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULgogKiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWQogKiBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULAogKiBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRQogKiBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KICovCgpjb25zdCBJTlRFUk5BTCA9IFN5bWJvbCgnQWdlbnRCYXNlSW50ZXJuYWxTdGF0ZScpOwoKY2xhc3MgQWdlbnQgZXh0ZW5kcyBodHRwLkFnZW50IHsKCiAgLy8gU2V0IGJ5IGBodHRwLkFnZW50YCAtIG1pc3NpbmcgZnJvbSBgQHR5cGVzL25vZGVgCgogIGNvbnN0cnVjdG9yKG9wdHMpIHsKICAgIHN1cGVyKG9wdHMpOwogICAgdGhpc1tJTlRFUk5BTF0gPSB7fTsKICB9CgogIC8qKgogICAqIERldGVybWluZSB3aGV0aGVyIHRoaXMgaXMgYW4gYGh0dHBgIG9yIGBodHRwc2AgcmVxdWVzdC4KICAgKi8KICBpc1NlY3VyZUVuZHBvaW50KG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zKSB7CiAgICAgIC8vIEZpcnN0IGNoZWNrIHRoZSBgc2VjdXJlRW5kcG9pbnRgIHByb3BlcnR5IGV4cGxpY2l0bHksIHNpbmNlIHRoaXMKICAgICAgLy8gbWVhbnMgdGhhdCBhIHBhcmVudCBgQWdlbnRgIGlzICJwYXNzaW5nIHRocm91Z2giIHRvIHRoaXMgaW5zdGFuY2UuCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55LCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MKICAgICAgaWYgKHR5cGVvZiAob3B0aW9ucyApLnNlY3VyZUVuZHBvaW50ID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gb3B0aW9ucy5zZWN1cmVFbmRwb2ludDsKICAgICAgfQoKICAgICAgLy8gSWYgbm8gZXhwbGljaXQgYHNlY3VyZWAgZW5kcG9pbnQsIGNoZWNrIGlmIGBwcm90b2NvbGAgcHJvcGVydHkgaXMKICAgICAgLy8gc2V0LiBUaGlzIHdpbGwgdXN1YWxseSBiZSB0aGUgY2FzZSBzaW5jZSB1c2luZyBhIGZ1bGwgc3RyaW5nIFVSTAogICAgICAvLyBvciBgVVJMYCBpbnN0YW5jZSBzaG91bGQgYmUgdGhlIG1vc3QgY29tbW9uIHVzYWdlLgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMucHJvdG9jb2wgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMucHJvdG9jb2wgPT09ICdodHRwczonOwogICAgICB9CiAgICB9CgogICAgLy8gRmluYWxseSwgaWYgbm8gYHByb3RvY29sYCBwcm9wZXJ0eSB3YXMgc2V0LCB0aGVuIGZhbGwgYmFjayB0bwogICAgLy8gY2hlY2tpbmcgdGhlIHN0YWNrIHRyYWNlIG9mIHRoZSBjdXJyZW50IGNhbGwgc3RhY2ssIGFuZCB0cnkgdG8KICAgIC8vIGRldGVjdCB0aGUgImh0dHBzIiBtb2R1bGUuCiAgICBjb25zdCB7IHN0YWNrIH0gPSBuZXcgRXJyb3IoKTsKICAgIGlmICh0eXBlb2Ygc3RhY2sgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gc3RhY2suc3BsaXQoJ1xuJykuc29tZShsID0+IGwuaW5kZXhPZignKGh0dHBzLmpzOicpICE9PSAtMSB8fCBsLmluZGV4T2YoJ25vZGU6aHR0cHM6JykgIT09IC0xKTsKICB9CgogIGNyZWF0ZVNvY2tldChyZXEsIG9wdGlvbnMsIGNiKSB7CiAgICBjb25zdCBjb25uZWN0T3B0cyA9IHsKICAgICAgLi4ub3B0aW9ucywKICAgICAgc2VjdXJlRW5kcG9pbnQ6IHRoaXMuaXNTZWN1cmVFbmRwb2ludChvcHRpb25zKSwKICAgIH07CiAgICBQcm9taXNlLnJlc29sdmUoKQogICAgICAudGhlbigoKSA9PiB0aGlzLmNvbm5lY3QocmVxLCBjb25uZWN0T3B0cykpCiAgICAgIC50aGVuKHNvY2tldCA9PiB7CiAgICAgICAgaWYgKHNvY2tldCBpbnN0YW5jZW9mIGh0dHAuQWdlbnQpIHsKICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgYGFkZFJlcXVlc3QoKWAgaXNuJ3QgZGVmaW5lZCBpbiBgQHR5cGVzL25vZGVgCiAgICAgICAgICByZXR1cm4gc29ja2V0LmFkZFJlcXVlc3QocmVxLCBjb25uZWN0T3B0cyk7CiAgICAgICAgfQogICAgICAgIHRoaXNbSU5URVJOQUxdLmN1cnJlbnRTb2NrZXQgPSBzb2NrZXQ7CiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBgY3JlYXRlU29ja2V0KClgIGlzbid0IGRlZmluZWQgaW4gYEB0eXBlcy9ub2RlYAogICAgICAgIHN1cGVyLmNyZWF0ZVNvY2tldChyZXEsIG9wdGlvbnMsIGNiKTsKICAgICAgfSwgY2IpOwogIH0KCiAgY3JlYXRlQ29ubmVjdGlvbigpIHsKICAgIGNvbnN0IHNvY2tldCA9IHRoaXNbSU5URVJOQUxdLmN1cnJlbnRTb2NrZXQ7CiAgICB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0ID0gdW5kZWZpbmVkOwogICAgaWYgKCFzb2NrZXQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzb2NrZXQgd2FzIHJldHVybmVkIGluIHRoZSBgY29ubmVjdCgpYCBmdW5jdGlvbicpOwogICAgfQogICAgcmV0dXJuIHNvY2tldDsKICB9CgogIGdldCBkZWZhdWx0UG9ydCgpIHsKICAgIHJldHVybiBfbnVsbGlzaENvYWxlc2NlJDIodGhpc1tJTlRFUk5BTF0uZGVmYXVsdFBvcnQsICgpID0+ICggKHRoaXMucHJvdG9jb2wgPT09ICdodHRwczonID8gNDQzIDogODApKSk7CiAgfQoKICBzZXQgZGVmYXVsdFBvcnQodikgewogICAgaWYgKHRoaXNbSU5URVJOQUxdKSB7CiAgICAgIHRoaXNbSU5URVJOQUxdLmRlZmF1bHRQb3J0ID0gdjsKICAgIH0KICB9CgogIGdldCBwcm90b2NvbCgpIHsKICAgIHJldHVybiBfbnVsbGlzaENvYWxlc2NlJDIodGhpc1tJTlRFUk5BTF0ucHJvdG9jb2wsICgpID0+ICggKHRoaXMuaXNTZWN1cmVFbmRwb2ludCgpID8gJ2h0dHBzOicgOiAnaHR0cDonKSkpOwogIH0KCiAgc2V0IHByb3RvY29sKHYpIHsKICAgIGlmICh0aGlzW0lOVEVSTkFMXSkgewogICAgICB0aGlzW0lOVEVSTkFMXS5wcm90b2NvbCA9IHY7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBkZWJ1ZyQxKC4uLmFyZ3MpIHsKICBsb2dnZXIubG9nKCdbaHR0cHMtcHJveHktYWdlbnQ6cGFyc2UtcHJveHktcmVzcG9uc2VdJywgLi4uYXJncyk7Cn0KCmZ1bmN0aW9uIHBhcnNlUHJveHlSZXNwb25zZShzb2NrZXQpIHsKICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgLy8gd2UgbmVlZCB0byBidWZmZXIgYW55IEhUVFAgdHJhZmZpYyB0aGF0IGhhcHBlbnMgd2l0aCB0aGUgcHJveHkgYmVmb3JlIHdlIGdldAogICAgLy8gdGhlIENPTk5FQ1QgcmVzcG9uc2UsIHNvIHRoYXQgaWYgdGhlIHJlc3BvbnNlIGlzIGFueXRoaW5nIG90aGVyIHRoYW4gYW4gIjIwMCIKICAgIC8vIHJlc3BvbnNlIGNvZGUsIHRoZW4gd2UgY2FuIHJlLXBsYXkgdGhlICJkYXRhIiBldmVudHMgb24gdGhlIHNvY2tldCBvbmNlIHRoZQogICAgLy8gSFRUUCBwYXJzZXIgaXMgaG9va2VkIHVwLi4uCiAgICBsZXQgYnVmZmVyc0xlbmd0aCA9IDA7CiAgICBjb25zdCBidWZmZXJzID0gW107CgogICAgZnVuY3Rpb24gcmVhZCgpIHsKICAgICAgY29uc3QgYiA9IHNvY2tldC5yZWFkKCk7CiAgICAgIGlmIChiKSBvbmRhdGEoYik7CiAgICAgIGVsc2Ugc29ja2V0Lm9uY2UoJ3JlYWRhYmxlJywgcmVhZCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBvbmVuZCk7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdyZWFkYWJsZScsIHJlYWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uZW5kKCkgewogICAgICBjbGVhbnVwKCk7CiAgICAgIGRlYnVnJDEoJ29uZW5kJyk7CiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ1Byb3h5IGNvbm5lY3Rpb24gZW5kZWQgYmVmb3JlIHJlY2VpdmluZyBDT05ORUNUIHJlc3BvbnNlJykpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uZXJyb3IoZXJyKSB7CiAgICAgIGNsZWFudXAoKTsKICAgICAgZGVidWckMSgnb25lcnJvciAlbycsIGVycik7CiAgICAgIHJlamVjdChlcnIpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uZGF0YShiKSB7CiAgICAgIGJ1ZmZlcnMucHVzaChiKTsKICAgICAgYnVmZmVyc0xlbmd0aCArPSBiLmxlbmd0aDsKCiAgICAgIGNvbnN0IGJ1ZmZlcmVkID0gQnVmZmVyLmNvbmNhdChidWZmZXJzLCBidWZmZXJzTGVuZ3RoKTsKICAgICAgY29uc3QgZW5kT2ZIZWFkZXJzID0gYnVmZmVyZWQuaW5kZXhPZignXHJcblxyXG4nKTsKCiAgICAgIGlmIChlbmRPZkhlYWRlcnMgPT09IC0xKSB7CiAgICAgICAgLy8ga2VlcCBidWZmZXJpbmcKICAgICAgICBkZWJ1ZyQxKCdoYXZlIG5vdCByZWNlaXZlZCBlbmQgb2YgSFRUUCBoZWFkZXJzIHlldC4uLicpOwogICAgICAgIHJlYWQoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGhlYWRlclBhcnRzID0gYnVmZmVyZWQuc2xpY2UoMCwgZW5kT2ZIZWFkZXJzKS50b1N0cmluZygnYXNjaWknKS5zcGxpdCgnXHJcbicpOwogICAgICBjb25zdCBmaXJzdExpbmUgPSBoZWFkZXJQYXJ0cy5zaGlmdCgpOwogICAgICBpZiAoIWZpcnN0TGluZSkgewogICAgICAgIHNvY2tldC5kZXN0cm95KCk7CiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ05vIGhlYWRlciByZWNlaXZlZCBmcm9tIHByb3h5IENPTk5FQ1QgcmVzcG9uc2UnKSk7CiAgICAgIH0KICAgICAgY29uc3QgZmlyc3RMaW5lUGFydHMgPSBmaXJzdExpbmUuc3BsaXQoJyAnKTsKICAgICAgY29uc3Qgc3RhdHVzQ29kZSA9ICtmaXJzdExpbmVQYXJ0c1sxXTsKICAgICAgY29uc3Qgc3RhdHVzVGV4dCA9IGZpcnN0TGluZVBhcnRzLnNsaWNlKDIpLmpvaW4oJyAnKTsKICAgICAgY29uc3QgaGVhZGVycyA9IHt9OwogICAgICBmb3IgKGNvbnN0IGhlYWRlciBvZiBoZWFkZXJQYXJ0cykgewogICAgICAgIGlmICghaGVhZGVyKSBjb250aW51ZTsKICAgICAgICBjb25zdCBmaXJzdENvbG9uID0gaGVhZGVyLmluZGV4T2YoJzonKTsKICAgICAgICBpZiAoZmlyc3RDb2xvbiA9PT0gLTEpIHsKICAgICAgICAgIHNvY2tldC5kZXN0cm95KCk7CiAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihgSW52YWxpZCBoZWFkZXIgZnJvbSBwcm94eSBDT05ORUNUIHJlc3BvbnNlOiAiJHtoZWFkZXJ9ImApKTsKICAgICAgICB9CiAgICAgICAgY29uc3Qga2V5ID0gaGVhZGVyLnNsaWNlKDAsIGZpcnN0Q29sb24pLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgY29uc3QgdmFsdWUgPSBoZWFkZXIuc2xpY2UoZmlyc3RDb2xvbiArIDEpLnRyaW1TdGFydCgpOwogICAgICAgIGNvbnN0IGN1cnJlbnQgPSBoZWFkZXJzW2tleV07CiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnc3RyaW5nJykgewogICAgICAgICAgaGVhZGVyc1trZXldID0gW2N1cnJlbnQsIHZhbHVlXTsKICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY3VycmVudCkpIHsKICAgICAgICAgIGN1cnJlbnQucHVzaCh2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhlYWRlcnNba2V5XSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgICBkZWJ1ZyQxKCdnb3QgcHJveHkgc2VydmVyIHJlc3BvbnNlOiAlbyAlbycsIGZpcnN0TGluZSwgaGVhZGVycyk7CiAgICAgIGNsZWFudXAoKTsKICAgICAgcmVzb2x2ZSh7CiAgICAgICAgY29ubmVjdDogewogICAgICAgICAgc3RhdHVzQ29kZSwKICAgICAgICAgIHN0YXR1c1RleHQsCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgIH0sCiAgICAgICAgYnVmZmVyZWQsCiAgICAgIH0pOwogICAgfQoKICAgIHNvY2tldC5vbignZXJyb3InLCBvbmVycm9yKTsKICAgIHNvY2tldC5vbignZW5kJywgb25lbmQpOwoKICAgIHJlYWQoKTsKICB9KTsKfQoKZnVuY3Rpb24gX251bGxpc2hDb2FsZXNjZSQxKGxocywgcmhzRm4pIHsgaWYgKGxocyAhPSBudWxsKSB7IHJldHVybiBsaHM7IH0gZWxzZSB7IHJldHVybiByaHNGbigpOyB9IH0gZnVuY3Rpb24gX29wdGlvbmFsQ2hhaW4kMShvcHMpIHsgbGV0IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IGxldCB2YWx1ZSA9IG9wc1swXTsgbGV0IGkgPSAxOyB3aGlsZSAoaSA8IG9wcy5sZW5ndGgpIHsgY29uc3Qgb3AgPSBvcHNbaV07IGNvbnN0IGZuID0gb3BzW2kgKyAxXTsgaSArPSAyOyBpZiAoKG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxDYWxsJykgJiYgdmFsdWUgPT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGlmIChvcCA9PT0gJ2FjY2VzcycgfHwgb3AgPT09ICdvcHRpb25hbEFjY2VzcycpIHsgbGFzdEFjY2Vzc0xIUyA9IHZhbHVlOyB2YWx1ZSA9IGZuKHZhbHVlKTsgfSBlbHNlIGlmIChvcCA9PT0gJ2NhbGwnIHx8IG9wID09PSAnb3B0aW9uYWxDYWxsJykgeyB2YWx1ZSA9IGZuKCguLi5hcmdzKSA9PiB2YWx1ZS5jYWxsKGxhc3RBY2Nlc3NMSFMsIC4uLmFyZ3MpKTsgbGFzdEFjY2Vzc0xIUyA9IHVuZGVmaW5lZDsgfSB9IHJldHVybiB2YWx1ZTsgfS8qKgogKiBUaGlzIGNvZGUgd2FzIG9yaWdpbmFsbHkgZm9ya2VkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Rvb1RhbGxOYXRlL3Byb3h5LWFnZW50cy90cmVlL2IxMzMyOTVmZDE2ZjY0NzU1NzhiNmIxNWJkOWI0ZTMzZWNiMGQwYjcKICogV2l0aCB0aGUgZm9sbG93aW5nIGxpY2VuY2U6CiAqCiAqIChUaGUgTUlUIExpY2Vuc2UpCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMyBOYXRoYW4gUmFqbGljaCA8bmF0aGFuQHRvb3RhbGxuYXRlLm5ldD4qCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwogKiBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKICogJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwogKiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiAqIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwogKiBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KICogdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOioKICoKICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUKICogaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuKgogKgogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKICogRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCiAqIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4KICogSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkKICogQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwKICogVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUKICogU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiAqLwoKZnVuY3Rpb24gZGVidWcoLi4uYXJncykgewogIGxvZ2dlci5sb2coJ1todHRwcy1wcm94eS1hZ2VudF0nLCAuLi5hcmdzKTsKfQoKLyoqCiAqIFRoZSBgSHR0cHNQcm94eUFnZW50YCBpbXBsZW1lbnRzIGFuIEhUVFAgQWdlbnQgc3ViY2xhc3MgdGhhdCBjb25uZWN0cyB0bwogKiB0aGUgc3BlY2lmaWVkICJIVFRQKHMpIHByb3h5IHNlcnZlciIgaW4gb3JkZXIgdG8gcHJveHkgSFRUUFMgcmVxdWVzdHMuCiAqCiAqIE91dGdvaW5nIEhUVFAgcmVxdWVzdHMgYXJlIGZpcnN0IHR1bm5lbGVkIHRocm91Z2ggdGhlIHByb3h5IHNlcnZlciB1c2luZyB0aGUKICogYENPTk5FQ1RgIEhUVFAgcmVxdWVzdCBtZXRob2QgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiB0byB0aGUgcHJveHkgc2VydmVyLAogKiBhbmQgdGhlbiB0aGUgcHJveHkgc2VydmVyIGNvbm5lY3RzIHRvIHRoZSBkZXN0aW5hdGlvbiB0YXJnZXQgYW5kIGlzc3VlcyB0aGUKICogSFRUUCByZXF1ZXN0IGZyb20gdGhlIHByb3h5IHNlcnZlci4KICoKICogYGh0dHBzOmAgcmVxdWVzdHMgaGF2ZSB0aGVpciBzb2NrZXQgY29ubmVjdGlvbiB1cGdyYWRlZCB0byBUTFMgb25jZQogKiB0aGUgY29ubmVjdGlvbiB0byB0aGUgcHJveHkgc2VydmVyIGhhcyBiZWVuIGVzdGFibGlzaGVkLgogKi8KY2xhc3MgSHR0cHNQcm94eUFnZW50IGV4dGVuZHMgQWdlbnQgewogIHN0YXRpYyBfX2luaXRTdGF0aWMoKSB7dGhpcy5wcm90b2NvbHMgPSBbJ2h0dHAnLCAnaHR0cHMnXTsgfQoKICBjb25zdHJ1Y3Rvcihwcm94eSwgb3B0cykgewogICAgc3VwZXIob3B0cyk7CiAgICB0aGlzLm9wdGlvbnMgPSB7fTsKICAgIHRoaXMucHJveHkgPSB0eXBlb2YgcHJveHkgPT09ICdzdHJpbmcnID8gbmV3IFVSTChwcm94eSkgOiBwcm94eTsKICAgIHRoaXMucHJveHlIZWFkZXJzID0gX251bGxpc2hDb2FsZXNjZSQxKF9vcHRpb25hbENoYWluJDEoW29wdHMsICdvcHRpb25hbEFjY2VzcycsIF8yID0+IF8yLmhlYWRlcnNdKSwgKCkgPT4gKCB7fSkpOwogICAgZGVidWcoJ0NyZWF0aW5nIG5ldyBIdHRwc1Byb3h5QWdlbnQgaW5zdGFuY2U6ICVvJywgdGhpcy5wcm94eS5ocmVmKTsKCiAgICAvLyBUcmltIG9mZiB0aGUgYnJhY2tldHMgZnJvbSBJUHY2IGFkZHJlc3NlcwogICAgY29uc3QgaG9zdCA9ICh0aGlzLnByb3h5Lmhvc3RuYW1lIHx8IHRoaXMucHJveHkuaG9zdCkucmVwbGFjZSgvXlxbfFxdJC9nLCAnJyk7CiAgICBjb25zdCBwb3J0ID0gdGhpcy5wcm94eS5wb3J0ID8gcGFyc2VJbnQodGhpcy5wcm94eS5wb3J0LCAxMCkgOiB0aGlzLnByb3h5LnByb3RvY29sID09PSAnaHR0cHM6JyA/IDQ0MyA6IDgwOwogICAgdGhpcy5jb25uZWN0T3B0cyA9IHsKICAgICAgLy8gQXR0ZW1wdCB0byBuZWdvdGlhdGUgaHR0cC8xLjEgZm9yIHByb3h5IHNlcnZlcnMgdGhhdCBzdXBwb3J0IGh0dHAvMgogICAgICBBTFBOUHJvdG9jb2xzOiBbJ2h0dHAvMS4xJ10sCiAgICAgIC4uLihvcHRzID8gb21pdChvcHRzLCAnaGVhZGVycycpIDogbnVsbCksCiAgICAgIGhvc3QsCiAgICAgIHBvcnQsCiAgICB9OwogIH0KCiAgLyoqCiAgICogQ2FsbGVkIHdoZW4gdGhlIG5vZGUtY29yZSBIVFRQIGNsaWVudCBsaWJyYXJ5IGlzIGNyZWF0aW5nIGEKICAgKiBuZXcgSFRUUCByZXF1ZXN0LgogICAqLwogIGFzeW5jIGNvbm5lY3QocmVxLCBvcHRzKSB7CiAgICBjb25zdCB7IHByb3h5IH0gPSB0aGlzOwoKICAgIGlmICghb3B0cy5ob3N0KSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vICJob3N0IiBwcm92aWRlZCcpOwogICAgfQoKICAgIC8vIENyZWF0ZSBhIHNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBwcm94eSBzZXJ2ZXIuCiAgICBsZXQgc29ja2V0OwogICAgaWYgKHByb3h5LnByb3RvY29sID09PSAnaHR0cHM6JykgewogICAgICBkZWJ1ZygnQ3JlYXRpbmcgYHRscy5Tb2NrZXRgOiAlbycsIHRoaXMuY29ubmVjdE9wdHMpOwogICAgICBjb25zdCBzZXJ2ZXJuYW1lID0gdGhpcy5jb25uZWN0T3B0cy5zZXJ2ZXJuYW1lIHx8IHRoaXMuY29ubmVjdE9wdHMuaG9zdDsKICAgICAgc29ja2V0ID0gdGxzLmNvbm5lY3QoewogICAgICAgIC4uLnRoaXMuY29ubmVjdE9wdHMsCiAgICAgICAgc2VydmVybmFtZTogc2VydmVybmFtZSAmJiBuZXQuaXNJUChzZXJ2ZXJuYW1lKSA/IHVuZGVmaW5lZCA6IHNlcnZlcm5hbWUsCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgZGVidWcoJ0NyZWF0aW5nIGBuZXQuU29ja2V0YDogJW8nLCB0aGlzLmNvbm5lY3RPcHRzKTsKICAgICAgc29ja2V0ID0gbmV0LmNvbm5lY3QodGhpcy5jb25uZWN0T3B0cyk7CiAgICB9CgogICAgY29uc3QgaGVhZGVycyA9CiAgICAgIHR5cGVvZiB0aGlzLnByb3h5SGVhZGVycyA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMucHJveHlIZWFkZXJzKCkgOiB7IC4uLnRoaXMucHJveHlIZWFkZXJzIH07CiAgICBjb25zdCBob3N0ID0gbmV0LmlzSVB2NihvcHRzLmhvc3QpID8gYFske29wdHMuaG9zdH1dYCA6IG9wdHMuaG9zdDsKICAgIGxldCBwYXlsb2FkID0gYENPTk5FQ1QgJHtob3N0fToke29wdHMucG9ydH0gSFRUUC8xLjFcclxuYDsKCiAgICAvLyBJbmplY3QgdGhlIGBQcm94eS1BdXRob3JpemF0aW9uYCBoZWFkZXIgaWYgbmVjZXNzYXJ5LgogICAgaWYgKHByb3h5LnVzZXJuYW1lIHx8IHByb3h5LnBhc3N3b3JkKSB7CiAgICAgIGNvbnN0IGF1dGggPSBgJHtkZWNvZGVVUklDb21wb25lbnQocHJveHkudXNlcm5hbWUpfToke2RlY29kZVVSSUNvbXBvbmVudChwcm94eS5wYXNzd29yZCl9YDsKICAgICAgaGVhZGVyc1snUHJveHktQXV0aG9yaXphdGlvbiddID0gYEJhc2ljICR7QnVmZmVyLmZyb20oYXV0aCkudG9TdHJpbmcoJ2Jhc2U2NCcpfWA7CiAgICB9CgogICAgaGVhZGVycy5Ib3N0ID0gYCR7aG9zdH06JHtvcHRzLnBvcnR9YDsKCiAgICBpZiAoIWhlYWRlcnNbJ1Byb3h5LUNvbm5lY3Rpb24nXSkgewogICAgICBoZWFkZXJzWydQcm94eS1Db25uZWN0aW9uJ10gPSB0aGlzLmtlZXBBbGl2ZSA/ICdLZWVwLUFsaXZlJyA6ICdjbG9zZSc7CiAgICB9CiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmtleXMoaGVhZGVycykpIHsKICAgICAgcGF5bG9hZCArPSBgJHtuYW1lfTogJHtoZWFkZXJzW25hbWVdfVxyXG5gOwogICAgfQoKICAgIGNvbnN0IHByb3h5UmVzcG9uc2VQcm9taXNlID0gcGFyc2VQcm94eVJlc3BvbnNlKHNvY2tldCk7CgogICAgc29ja2V0LndyaXRlKGAke3BheWxvYWR9XHJcbmApOwoKICAgIGNvbnN0IHsgY29ubmVjdCwgYnVmZmVyZWQgfSA9IGF3YWl0IHByb3h5UmVzcG9uc2VQcm9taXNlOwogICAgcmVxLmVtaXQoJ3Byb3h5Q29ubmVjdCcsIGNvbm5lY3QpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudAogICAgLy8gQHRzLWlnbm9yZSBOb3QgRXZlbnRFbWl0dGVyIGluIE5vZGUgdHlwZXMKICAgIHRoaXMuZW1pdCgncHJveHlDb25uZWN0JywgY29ubmVjdCwgcmVxKTsKCiAgICBpZiAoY29ubmVjdC5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgcmVxLm9uY2UoJ3NvY2tldCcsIHJlc3VtZSk7CgogICAgICBpZiAob3B0cy5zZWN1cmVFbmRwb2ludCkgewogICAgICAgIC8vIFRoZSBwcm94eSBpcyBjb25uZWN0aW5nIHRvIGEgVExTIHNlcnZlciwgc28gdXBncmFkZQogICAgICAgIC8vIHRoaXMgc29ja2V0IGNvbm5lY3Rpb24gdG8gYSBUTFMgY29ubmVjdGlvbi4KICAgICAgICBkZWJ1ZygnVXBncmFkaW5nIHNvY2tldCBjb25uZWN0aW9uIHRvIFRMUycpOwogICAgICAgIGNvbnN0IHNlcnZlcm5hbWUgPSBvcHRzLnNlcnZlcm5hbWUgfHwgb3B0cy5ob3N0OwogICAgICAgIHJldHVybiB0bHMuY29ubmVjdCh7CiAgICAgICAgICAuLi5vbWl0KG9wdHMsICdob3N0JywgJ3BhdGgnLCAncG9ydCcpLAogICAgICAgICAgc29ja2V0LAogICAgICAgICAgc2VydmVybmFtZTogbmV0LmlzSVAoc2VydmVybmFtZSkgPyB1bmRlZmluZWQgOiBzZXJ2ZXJuYW1lLAogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gc29ja2V0OwogICAgfQoKICAgIC8vIFNvbWUgb3RoZXIgc3RhdHVzIGNvZGUgdGhhdCdzIG5vdCAyMDAuLi4gbmVlZCB0byByZS1wbGF5IHRoZSBIVFRQCiAgICAvLyBoZWFkZXIgImRhdGEiIGV2ZW50cyBvbnRvIHRoZSBzb2NrZXQgb25jZSB0aGUgSFRUUCBtYWNoaW5lcnkgaXMKICAgIC8vIGF0dGFjaGVkIHNvIHRoYXQgdGhlIG5vZGUgY29yZSBgaHR0cGAgY2FuIHBhcnNlIGFuZCBoYW5kbGUgdGhlCiAgICAvLyBlcnJvciBzdGF0dXMgY29kZS4KCiAgICAvLyBDbG9zZSB0aGUgb3JpZ2luYWwgc29ja2V0LCBhbmQgYSBuZXcgImZha2UiIHNvY2tldCBpcyByZXR1cm5lZAogICAgLy8gaW5zdGVhZCwgc28gdGhhdCB0aGUgcHJveHkgZG9lc24ndCBnZXQgdGhlIEhUVFAgcmVxdWVzdAogICAgLy8gd3JpdHRlbiB0byBpdCAod2hpY2ggbWF5IGNvbnRhaW4gYEF1dGhvcml6YXRpb25gIGhlYWRlcnMgb3Igb3RoZXIKICAgIC8vIHNlbnNpdGl2ZSBkYXRhKS4KICAgIC8vCiAgICAvLyBTZWU6IGh0dHBzOi8vaGFja2Vyb25lLmNvbS9yZXBvcnRzLzU0MTUwMgogICAgc29ja2V0LmRlc3Ryb3koKTsKCiAgICBjb25zdCBmYWtlU29ja2V0ID0gbmV3IG5ldC5Tb2NrZXQoeyB3cml0YWJsZTogZmFsc2UgfSk7CiAgICBmYWtlU29ja2V0LnJlYWRhYmxlID0gdHJ1ZTsKCiAgICAvLyBOZWVkIHRvIHdhaXQgZm9yIHRoZSAic29ja2V0IiBldmVudCB0byByZS1wbGF5IHRoZSAiZGF0YSIgZXZlbnRzLgogICAgcmVxLm9uY2UoJ3NvY2tldCcsIChzKSA9PiB7CiAgICAgIGRlYnVnKCdSZXBsYXlpbmcgcHJveHkgYnVmZmVyIGZvciBmYWlsZWQgcmVxdWVzdCcpOwogICAgICBhc3NlcnQocy5saXN0ZW5lckNvdW50KCdkYXRhJykgPiAwKTsKCiAgICAgIC8vIFJlcGxheSB0aGUgImJ1ZmZlcmVkIiBCdWZmZXIgb250byB0aGUgZmFrZSBgc29ja2V0YCwgc2luY2UgYXQKICAgICAgLy8gdGhpcyBwb2ludCB0aGUgSFRUUCBtb2R1bGUgbWFjaGluZXJ5IGhhcyBiZWVuIGhvb2tlZCB1cCBmb3IKICAgICAgLy8gdGhlIHVzZXIuCiAgICAgIHMucHVzaChidWZmZXJlZCk7CiAgICAgIHMucHVzaChudWxsKTsKICAgIH0pOwoKICAgIHJldHVybiBmYWtlU29ja2V0OwogIH0KfSBIdHRwc1Byb3h5QWdlbnQuX19pbml0U3RhdGljKCk7CgpmdW5jdGlvbiByZXN1bWUoc29ja2V0KSB7CiAgc29ja2V0LnJlc3VtZSgpOwp9CgpmdW5jdGlvbiBvbWl0KAogIG9iaiwKICAuLi5rZXlzCikKCiB7CiAgY29uc3QgcmV0ID0ge30KCjsKICBsZXQga2V5OwogIGZvciAoa2V5IGluIG9iaikgewogICAgaWYgKCFrZXlzLmluY2x1ZGVzKGtleSkpIHsKICAgICAgcmV0W2tleV0gPSBvYmpba2V5XTsKICAgIH0KICB9CiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gX251bGxpc2hDb2FsZXNjZShsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9Ci8vIEVzdGltYXRlZCBtYXhpbXVtIHNpemUgZm9yIHJlYXNvbmFibGUgc3RhbmRhbG9uZSBldmVudApjb25zdCBHWklQX1RIUkVTSE9MRCA9IDEwMjQgKiAzMjsKCi8qKgogKiBHZXRzIGEgc3RyZWFtIGZyb20gYSBVaW50OEFycmF5IG9yIHN0cmluZwogKiBSZWFkYWJsZS5mcm9tIGlzIGlkZWFsIGJ1dCB3YXMgYWRkZWQgaW4gbm9kZS5qcyB2MTIuMy4wIGFuZCB2MTAuMTcuMAogKi8KZnVuY3Rpb24gc3RyZWFtRnJvbUJvZHkoYm9keSkgewogIHJldHVybiBuZXcgUmVhZGFibGUoewogICAgcmVhZCgpIHsKICAgICAgdGhpcy5wdXNoKGJvZHkpOwogICAgICB0aGlzLnB1c2gobnVsbCk7CiAgICB9LAogIH0pOwp9CgovKioKICogQ3JlYXRlcyBhIFRyYW5zcG9ydCB0aGF0IHVzZXMgbmF0aXZlIHRoZSBuYXRpdmUgJ2h0dHAnIGFuZCAnaHR0cHMnIG1vZHVsZXMgdG8gc2VuZCBldmVudHMgdG8gU2VudHJ5LgogKi8KZnVuY3Rpb24gbWFrZU5vZGVUcmFuc3BvcnQob3B0aW9ucykgewogIGxldCB1cmxTZWdtZW50czsKCiAgdHJ5IHsKICAgIHVybFNlZ21lbnRzID0gbmV3IFVSTChvcHRpb25zLnVybCk7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZVNhbmRib3goKCkgPT4gewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICBjb25zb2xlLndhcm4oCiAgICAgICAgJ1tAc2VudHJ5L25vZGVdOiBJbnZhbGlkIGRzbiBvciB0dW5uZWwgb3B0aW9uLCB3aWxsIG5vdCBzZW5kIGFueSBldmVudHMuIFRoZSB0dW5uZWwgb3B0aW9uIG11c3QgYmUgYSBmdWxsIFVSTCB3aGVuIHVzZWQuJywKICAgICAgKTsKICAgIH0pOwogICAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydChvcHRpb25zLCAoKSA9PiBQcm9taXNlLnJlc29sdmUoe30pKTsKICB9CgogIGNvbnN0IGlzSHR0cHMgPSB1cmxTZWdtZW50cy5wcm90b2NvbCA9PT0gJ2h0dHBzOic7CgogIC8vIFByb3h5IHByaW9yaXRpemF0aW9uOiBodHRwID0+IGBvcHRpb25zLnByb3h5YCB8IGBwcm9jZXNzLmVudi5odHRwX3Byb3h5YAogIC8vIFByb3h5IHByaW9yaXRpemF0aW9uOiBodHRwcyA9PiBgb3B0aW9ucy5wcm94eWAgfCBgcHJvY2Vzcy5lbnYuaHR0cHNfcHJveHlgIHwgYHByb2Nlc3MuZW52Lmh0dHBfcHJveHlgCiAgY29uc3QgcHJveHkgPSBhcHBseU5vUHJveHlPcHRpb24oCiAgICB1cmxTZWdtZW50cywKICAgIG9wdGlvbnMucHJveHkgfHwgKGlzSHR0cHMgPyBwcm9jZXNzLmVudi5odHRwc19wcm94eSA6IHVuZGVmaW5lZCkgfHwgcHJvY2Vzcy5lbnYuaHR0cF9wcm94eSwKICApOwoKICBjb25zdCBuYXRpdmVIdHRwTW9kdWxlID0gaXNIdHRwcyA/IGh0dHBzIDogaHR0cDsKICBjb25zdCBrZWVwQWxpdmUgPSBvcHRpb25zLmtlZXBBbGl2ZSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBvcHRpb25zLmtlZXBBbGl2ZTsKCiAgLy8gVE9ETyh2Nyk6IEV2YWx1YXRlIGlmIHdlIGNhbiBzZXQga2VlcEFsaXZlIHRvIHRydWUuIFRoaXMgd291bGQgaW52b2x2ZSB0ZXN0aW5nIGZvciBtZW1vcnkgbGVha3MgaW4gb2xkZXIgbm9kZQogIC8vIHZlcnNpb25zKD49IDgpIGFzIHRoZXkgaGFkIG1lbW9yeSBsZWFrcyB3aGVuIHVzaW5nIGl0OiAjMjU1NQogIGNvbnN0IGFnZW50ID0gcHJveHkKICAgID8gKG5ldyBIdHRwc1Byb3h5QWdlbnQocHJveHkpICkKICAgIDogbmV3IG5hdGl2ZUh0dHBNb2R1bGUuQWdlbnQoeyBrZWVwQWxpdmUsIG1heFNvY2tldHM6IDMwLCB0aW1lb3V0OiAyMDAwIH0pOwoKICBjb25zdCByZXF1ZXN0RXhlY3V0b3IgPSBjcmVhdGVSZXF1ZXN0RXhlY3V0b3Iob3B0aW9ucywgX251bGxpc2hDb2FsZXNjZShvcHRpb25zLmh0dHBNb2R1bGUsICgpID0+ICggbmF0aXZlSHR0cE1vZHVsZSkpLCBhZ2VudCk7CiAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydChvcHRpb25zLCByZXF1ZXN0RXhlY3V0b3IpOwp9CgovKioKICogSG9ub3JzIHRoZSBgbm9fcHJveHlgIGVudiB2YXJpYWJsZSB3aXRoIHRoZSBoaWdoZXN0IHByaW9yaXR5IHRvIGFsbG93IGZvciBob3N0cyBleGNsdXNpb24uCiAqCiAqIEBwYXJhbSB0cmFuc3BvcnRVcmwgVGhlIFVSTCB0aGUgdHJhbnNwb3J0IGludGVuZHMgdG8gc2VuZCBldmVudHMgdG8uCiAqIEBwYXJhbSBwcm94eSBUaGUgY2xpZW50IGNvbmZpZ3VyZWQgcHJveHkuCiAqIEByZXR1cm5zIEEgcHJveHkgdGhlIHRyYW5zcG9ydCBzaG91bGQgdXNlLgogKi8KZnVuY3Rpb24gYXBwbHlOb1Byb3h5T3B0aW9uKHRyYW5zcG9ydFVybFNlZ21lbnRzLCBwcm94eSkgewogIGNvbnN0IHsgbm9fcHJveHkgfSA9IHByb2Nlc3MuZW52OwoKICBjb25zdCB1cmxJc0V4ZW1wdEZyb21Qcm94eSA9CiAgICBub19wcm94eSAmJgogICAgbm9fcHJveHkKICAgICAgLnNwbGl0KCcsJykKICAgICAgLnNvbWUoCiAgICAgICAgZXhlbXB0aW9uID0+IHRyYW5zcG9ydFVybFNlZ21lbnRzLmhvc3QuZW5kc1dpdGgoZXhlbXB0aW9uKSB8fCB0cmFuc3BvcnRVcmxTZWdtZW50cy5ob3N0bmFtZS5lbmRzV2l0aChleGVtcHRpb24pLAogICAgICApOwoKICBpZiAodXJsSXNFeGVtcHRGcm9tUHJveHkpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfSBlbHNlIHsKICAgIHJldHVybiBwcm94eTsKICB9Cn0KCi8qKgogKiBDcmVhdGVzIGEgUmVxdWVzdEV4ZWN1dG9yIHRvIGJlIHVzZWQgd2l0aCBgY3JlYXRlVHJhbnNwb3J0YC4KICovCmZ1bmN0aW9uIGNyZWF0ZVJlcXVlc3RFeGVjdXRvcigKICBvcHRpb25zLAogIGh0dHBNb2R1bGUsCiAgYWdlbnQsCikgewogIGNvbnN0IHsgaG9zdG5hbWUsIHBhdGhuYW1lLCBwb3J0LCBwcm90b2NvbCwgc2VhcmNoIH0gPSBuZXcgVVJMKG9wdGlvbnMudXJsKTsKICByZXR1cm4gZnVuY3Rpb24gbWFrZVJlcXVlc3QocmVxdWVzdCkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbGV0IGJvZHkgPSBzdHJlYW1Gcm9tQm9keShyZXF1ZXN0LmJvZHkpOwoKICAgICAgY29uc3QgaGVhZGVycyA9IHsgLi4ub3B0aW9ucy5oZWFkZXJzIH07CgogICAgICBpZiAocmVxdWVzdC5ib2R5Lmxlbmd0aCA+IEdaSVBfVEhSRVNIT0xEKSB7CiAgICAgICAgaGVhZGVyc1snY29udGVudC1lbmNvZGluZyddID0gJ2d6aXAnOwogICAgICAgIGJvZHkgPSBib2R5LnBpcGUoY3JlYXRlR3ppcCgpKTsKICAgICAgfQoKICAgICAgY29uc3QgcmVxID0gaHR0cE1vZHVsZS5yZXF1ZXN0KAogICAgICAgIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgYWdlbnQsCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgaG9zdG5hbWUsCiAgICAgICAgICBwYXRoOiBgJHtwYXRobmFtZX0ke3NlYXJjaH1gLAogICAgICAgICAgcG9ydCwKICAgICAgICAgIHByb3RvY29sLAogICAgICAgICAgY2E6IG9wdGlvbnMuY2FDZXJ0cywKICAgICAgICB9LAogICAgICAgIHJlcyA9PiB7CiAgICAgICAgICByZXMub24oJ2RhdGEnLCAoKSA9PiB7CiAgICAgICAgICAgIC8vIERyYWluIHNvY2tldAogICAgICAgICAgfSk7CgogICAgICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7CiAgICAgICAgICAgIC8vIERyYWluIHNvY2tldAogICAgICAgICAgfSk7CgogICAgICAgICAgcmVzLnNldEVuY29kaW5nKCd1dGY4Jyk7CgogICAgICAgICAgLy8gIktleS12YWx1ZSBwYWlycyBvZiBoZWFkZXIgbmFtZXMgYW5kIHZhbHVlcy4gSGVhZGVyIG5hbWVzIGFyZSBsb3dlci1jYXNlZC4iCiAgICAgICAgICAvLyBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX21lc3NhZ2VfaGVhZGVycwogICAgICAgICAgY29uc3QgcmV0cnlBZnRlckhlYWRlciA9IF9udWxsaXNoQ29hbGVzY2UocmVzLmhlYWRlcnNbJ3JldHJ5LWFmdGVyJ10sICgpID0+ICggbnVsbCkpOwogICAgICAgICAgY29uc3QgcmF0ZUxpbWl0c0hlYWRlciA9IF9udWxsaXNoQ29hbGVzY2UocmVzLmhlYWRlcnNbJ3gtc2VudHJ5LXJhdGUtbGltaXRzJ10sICgpID0+ICggbnVsbCkpOwoKICAgICAgICAgIHJlc29sdmUoewogICAgICAgICAgICBzdGF0dXNDb2RlOiByZXMuc3RhdHVzQ29kZSwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICdyZXRyeS1hZnRlcic6IHJldHJ5QWZ0ZXJIZWFkZXIsCiAgICAgICAgICAgICAgJ3gtc2VudHJ5LXJhdGUtbGltaXRzJzogQXJyYXkuaXNBcnJheShyYXRlTGltaXRzSGVhZGVyKSA/IHJhdGVMaW1pdHNIZWFkZXJbMF0gOiByYXRlTGltaXRzSGVhZGVyLAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgKTsKCiAgICAgIHJlcS5vbignZXJyb3InLCByZWplY3QpOwogICAgICBib2R5LnBpcGUocmVxKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9vcHRpb25hbENoYWluKG9wcykgeyBsZXQgbGFzdEFjY2Vzc0xIUyA9IHVuZGVmaW5lZDsgbGV0IHZhbHVlID0gb3BzWzBdOyBsZXQgaSA9IDE7IHdoaWxlIChpIDwgb3BzLmxlbmd0aCkgeyBjb25zdCBvcCA9IG9wc1tpXTsgY29uc3QgZm4gPSBvcHNbaSArIDFdOyBpICs9IDI7IGlmICgob3AgPT09ICdvcHRpb25hbEFjY2VzcycgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSAmJiB2YWx1ZSA9PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gaWYgKG9wID09PSAnYWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJykgeyBsYXN0QWNjZXNzTEhTID0gdmFsdWU7IHZhbHVlID0gZm4odmFsdWUpOyB9IGVsc2UgaWYgKG9wID09PSAnY2FsbCcgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSB7IHZhbHVlID0gZm4oKC4uLmFyZ3MpID0+IHZhbHVlLmNhbGwobGFzdEFjY2Vzc0xIUywgLi4uYXJncykpOyBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyB9IH0gcmV0dXJuIHZhbHVlOyB9CmNvbnN0IG9wdGlvbnMgPSB3b3JrZXJEYXRhOwpsZXQgc2Vzc2lvbjsKbGV0IGhhc1NlbnRBbnJFdmVudCA9IGZhbHNlOwoKZnVuY3Rpb24gbG9nKG1zZykgewogIGlmIChvcHRpb25zLmRlYnVnKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgY29uc29sZS5sb2coYFtBTlIgV29ya2VyXSAke21zZ31gKTsKICB9Cn0KCmNvbnN0IHVybCA9IGdldEVudmVsb3BlRW5kcG9pbnRXaXRoVXJsRW5jb2RlZEF1dGgob3B0aW9ucy5kc24pOwpjb25zdCB0cmFuc3BvcnQgPSBtYWtlTm9kZVRyYW5zcG9ydCh7CiAgdXJsLAogIHJlY29yZERyb3BwZWRFdmVudDogKCkgPT4gewogICAgLy8KICB9LAp9KTsKCmFzeW5jIGZ1bmN0aW9uIHNlbmRBYm5vcm1hbFNlc3Npb24oKSB7CiAgLy8gb2Ygd2UgaGF2ZSBhbiBleGlzdGluZyBzZXNzaW9uIHBhc3NlZCBmcm9tIHRoZSBtYWluIHRocmVhZCwgc2VuZCBpdCBhcyBhYm5vcm1hbAogIGlmIChzZXNzaW9uKSB7CiAgICBsb2coJ1NlbmRpbmcgYWJub3JtYWwgc2Vzc2lvbicpOwogICAgdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCB7IHN0YXR1czogJ2Fibm9ybWFsJywgYWJub3JtYWxfbWVjaGFuaXNtOiAnYW5yX2ZvcmVncm91bmQnIH0pOwoKICAgIGNvbnN0IGVudmVsb3BlID0gY3JlYXRlU2Vzc2lvbkVudmVsb3BlKHNlc3Npb24sIG9wdGlvbnMuZHNuLCBvcHRpb25zLnNka01ldGFkYXRhKTsKICAgIC8vIExvZyB0aGUgZW52ZWxvcGUgc28gdG8gYWlkIGluIHRlc3RpbmcKICAgIGxvZyhKU09OLnN0cmluZ2lmeShlbnZlbG9wZSkpOwoKICAgIGF3YWl0IHRyYW5zcG9ydC5zZW5kKGVudmVsb3BlKTsKCiAgICB0cnkgewogICAgICAvLyBOb3RpZnkgdGhlIG1haW4gcHJvY2VzcyB0aGF0IHRoZSBzZXNzaW9uIGhhcyBlbmRlZCBzbyB0aGUgc2Vzc2lvbiBjYW4gYmUgY2xlYXJlZCBmcm9tIHRoZSBzY29wZQogICAgICBfb3B0aW9uYWxDaGFpbihbcGFyZW50UG9ydCwgJ29wdGlvbmFsQWNjZXNzJywgXzIgPT4gXzIucG9zdE1lc3NhZ2UsICdjYWxsJywgXzMgPT4gXzMoJ3Nlc3Npb24tZW5kZWQnKV0pOwogICAgfSBjYXRjaCAoXykgewogICAgICAvLyBpZ25vcmUKICAgIH0KICB9Cn0KCmxvZygnU3RhcnRlZCcpOwoKZnVuY3Rpb24gcHJlcGFyZVN0YWNrRnJhbWVzKHN0YWNrRnJhbWVzKSB7CiAgaWYgKCFzdGFja0ZyYW1lcykgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIC8vIFN0cmlwIFNlbnRyeSBmcmFtZXMgYW5kIHJldmVyc2UgdGhlIHN0YWNrIGZyYW1lcyBzbyB0aGV5IGFyZSBpbiB0aGUgY29ycmVjdCBvcmRlcgogIGNvbnN0IHN0cmlwcGVkRnJhbWVzID0gc3RyaXBTZW50cnlGcmFtZXNBbmRSZXZlcnNlKHN0YWNrRnJhbWVzKTsKCiAgLy8gSWYgd2UgaGF2ZSBhbiBhcHAgcm9vdCBwYXRoLCByZXdyaXRlIHRoZSBmaWxlbmFtZXMgdG8gYmUgcmVsYXRpdmUgdG8gdGhlIGFwcCByb290CiAgaWYgKG9wdGlvbnMuYXBwUm9vdFBhdGgpIHsKICAgIGZvciAoY29uc3QgZnJhbWUgb2Ygc3RyaXBwZWRGcmFtZXMpIHsKICAgICAgaWYgKCFmcmFtZS5maWxlbmFtZSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmcmFtZS5maWxlbmFtZSA9IG5vcm1hbGl6ZVVybFRvQmFzZShmcmFtZS5maWxlbmFtZSwgb3B0aW9ucy5hcHBSb290UGF0aCk7CiAgICB9CiAgfQoKICByZXR1cm4gc3RyaXBwZWRGcmFtZXM7Cn0KCmFzeW5jIGZ1bmN0aW9uIHNlbmRBbnJFdmVudChmcmFtZXMsIHRyYWNlQ29udGV4dCkgewogIGlmIChoYXNTZW50QW5yRXZlbnQpIHsKICAgIHJldHVybjsKICB9CgogIGhhc1NlbnRBbnJFdmVudCA9IHRydWU7CgogIGF3YWl0IHNlbmRBYm5vcm1hbFNlc3Npb24oKTsKCiAgbG9nKCdTZW5kaW5nIGV2ZW50Jyk7CgogIGNvbnN0IGV2ZW50ID0gewogICAgZXZlbnRfaWQ6IHV1aWQ0KCksCiAgICBjb250ZXh0czogeyAuLi5vcHRpb25zLmNvbnRleHRzLCB0cmFjZTogdHJhY2VDb250ZXh0IH0sCiAgICByZWxlYXNlOiBvcHRpb25zLnJlbGVhc2UsCiAgICBlbnZpcm9ubWVudDogb3B0aW9ucy5lbnZpcm9ubWVudCwKICAgIGRpc3Q6IG9wdGlvbnMuZGlzdCwKICAgIHBsYXRmb3JtOiAnbm9kZScsCiAgICBsZXZlbDogJ2Vycm9yJywKICAgIGV4Y2VwdGlvbjogewogICAgICB2YWx1ZXM6IFsKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAnQXBwbGljYXRpb25Ob3RSZXNwb25kaW5nJywKICAgICAgICAgIHZhbHVlOiBgQXBwbGljYXRpb24gTm90IFJlc3BvbmRpbmcgZm9yIGF0IGxlYXN0ICR7b3B0aW9ucy5hbnJUaHJlc2hvbGR9IG1zYCwKICAgICAgICAgIHN0YWNrdHJhY2U6IHsgZnJhbWVzOiBwcmVwYXJlU3RhY2tGcmFtZXMoZnJhbWVzKSB9LAogICAgICAgICAgLy8gVGhpcyBlbnN1cmVzIHRoZSBVSSBkb2Vzbid0IHNheSAnQ3Jhc2hlZCBpbicgZm9yIHRoZSBzdGFjayB0cmFjZQogICAgICAgICAgbWVjaGFuaXNtOiB7IHR5cGU6ICdBTlInIH0sCiAgICAgICAgfSwKICAgICAgXSwKICAgIH0sCiAgICB0YWdzOiBvcHRpb25zLnN0YXRpY1RhZ3MsCiAgfTsKCiAgY29uc3QgZW52ZWxvcGUgPSBjcmVhdGVFdmVudEVudmVsb3BlKGV2ZW50LCBvcHRpb25zLmRzbiwgb3B0aW9ucy5zZGtNZXRhZGF0YSk7CiAgLy8gTG9nIHRoZSBlbnZlbG9wZSBzbyB0byBhaWQgaW4gdGVzdGluZwogIGxvZyhKU09OLnN0cmluZ2lmeShlbnZlbG9wZSkpOwoKICBhd2FpdCB0cmFuc3BvcnQuc2VuZChlbnZlbG9wZSk7CiAgYXdhaXQgdHJhbnNwb3J0LmZsdXNoKDIwMDApOwoKICAvLyBEZWxheSBmb3IgNSBzZWNvbmRzIHNvIHRoYXQgc3RkaW8gY2FuIGZsdXNoIGluIHRoZSBtYWluIGV2ZW50IGxvb3AgZXZlciByZXN0YXJ0cy4KICAvLyBUaGlzIGlzIG1haW5seSBmb3IgdGhlIGJlbmVmaXQgb2YgbG9nZ2luZy9kZWJ1Z2dpbmcgaXNzdWVzLgogIHNldFRpbWVvdXQoKCkgPT4gewogICAgcHJvY2Vzcy5leGl0KDApOwogIH0sIDUwMDApOwp9CgpsZXQgZGVidWdnZXJQYXVzZTsKCmlmIChvcHRpb25zLmNhcHR1cmVTdGFja1RyYWNlKSB7CiAgbG9nKCdDb25uZWN0aW5nIHRvIGRlYnVnZ2VyJyk7CgogIGNvbnN0IHNlc3Npb24gPSBuZXcgU2Vzc2lvbigpIDsKICBzZXNzaW9uLmNvbm5lY3RUb01haW5UaHJlYWQoKTsKCiAgbG9nKCdDb25uZWN0ZWQgdG8gZGVidWdnZXInKTsKCiAgLy8gQ29sbGVjdCBzY3JpcHRJZCAtPiB1cmwgbWFwIHNvIHdlIGNhbiBsb29rIHVwIHRoZSBmaWxlbmFtZXMgbGF0ZXIKICBjb25zdCBzY3JpcHRzID0gbmV3IE1hcCgpOwoKICBzZXNzaW9uLm9uKCdEZWJ1Z2dlci5zY3JpcHRQYXJzZWQnLCBldmVudCA9PiB7CiAgICBzY3JpcHRzLnNldChldmVudC5wYXJhbXMuc2NyaXB0SWQsIGV2ZW50LnBhcmFtcy51cmwpOwogIH0pOwoKICBzZXNzaW9uLm9uKCdEZWJ1Z2dlci5wYXVzZWQnLCBldmVudCA9PiB7CiAgICBpZiAoZXZlbnQucGFyYW1zLnJlYXNvbiAhPT0gJ290aGVyJykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdHJ5IHsKICAgICAgbG9nKCdEZWJ1Z2dlciBwYXVzZWQnKTsKCiAgICAgIC8vIGNvcHkgdGhlIGZyYW1lcwogICAgICBjb25zdCBjYWxsRnJhbWVzID0gWy4uLmV2ZW50LnBhcmFtcy5jYWxsRnJhbWVzXTsKCiAgICAgIGNvbnN0IGdldE1vZHVsZU5hbWUgPSBvcHRpb25zLmFwcFJvb3RQYXRoID8gY3JlYXRlR2V0TW9kdWxlRnJvbUZpbGVuYW1lKG9wdGlvbnMuYXBwUm9vdFBhdGgpIDogKCkgPT4gdW5kZWZpbmVkOwogICAgICBjb25zdCBzdGFja0ZyYW1lcyA9IGNhbGxGcmFtZXMubWFwKGZyYW1lID0+CiAgICAgICAgY2FsbEZyYW1lVG9TdGFja0ZyYW1lKGZyYW1lLCBzY3JpcHRzLmdldChmcmFtZS5sb2NhdGlvbi5zY3JpcHRJZCksIGdldE1vZHVsZU5hbWUpLAogICAgICApOwoKICAgICAgLy8gRXZhbHVhdGUgYSBzY3JpcHQgaW4gdGhlIGN1cnJlbnRseSBwYXVzZWQgY29udGV4dAogICAgICBzZXNzaW9uLnBvc3QoCiAgICAgICAgJ1J1bnRpbWUuZXZhbHVhdGUnLAogICAgICAgIHsKICAgICAgICAgIC8vIEdyYWIgdGhlIHRyYWNlIGNvbnRleHQgZnJvbSB0aGUgY3VycmVudCBzY29wZQogICAgICAgICAgZXhwcmVzc2lvbjoKICAgICAgICAgICAgJ2NvbnN0IGN0eCA9IF9fU0VOVFJZX18uaHViLmdldFNjb3BlKCkuZ2V0UHJvcGFnYXRpb25Db250ZXh0KCk7IGN0eC50cmFjZUlkICsgIi0iICsgY3R4LnNwYW5JZCArICItIiArIGN0eC5wYXJlbnRTcGFuSWQnLAogICAgICAgICAgLy8gRG9uJ3QgcmUtdHJpZ2dlciB0aGUgZGVidWdnZXIgaWYgdGhpcyBjYXVzZXMgYW4gZXJyb3IKICAgICAgICAgIHNpbGVudDogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIChfLCBwYXJhbSkgPT4gewogICAgICAgICAgY29uc3QgdHJhY2VJZCA9IHBhcmFtICYmIHBhcmFtLnJlc3VsdCA/IChwYXJhbS5yZXN1bHQudmFsdWUgKSA6ICctLSc7CiAgICAgICAgICBjb25zdCBbdHJhY2VfaWQsIHNwYW5faWQsIHBhcmVudF9zcGFuX2lkXSA9IHRyYWNlSWQuc3BsaXQoJy0nKSA7CgogICAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5yZXN1bWUnKTsKICAgICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwoKICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBfb3B0aW9uYWxDaGFpbihbdHJhY2VfaWQsICdvcHRpb25hbEFjY2VzcycsIF80ID0+IF80Lmxlbmd0aF0pICYmIF9vcHRpb25hbENoYWluKFtzcGFuX2lkLCAnb3B0aW9uYWxBY2Nlc3MnLCBfNSA9PiBfNS5sZW5ndGhdKSA/IHsgdHJhY2VfaWQsIHNwYW5faWQsIHBhcmVudF9zcGFuX2lkIH0gOiB1bmRlZmluZWQ7CiAgICAgICAgICBzZW5kQW5yRXZlbnQoc3RhY2tGcmFtZXMsIGNvbnRleHQpLnRoZW4obnVsbCwgKCkgPT4gewogICAgICAgICAgICBsb2coJ1NlbmRpbmcgQU5SIGV2ZW50IGZhaWxlZC4nKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucmVzdW1lJyk7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwogICAgICB0aHJvdyBlOwogICAgfQogIH0pOwoKICBkZWJ1Z2dlclBhdXNlID0gKCkgPT4gewogICAgdHJ5IHsKICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5lbmFibGUnLCAoKSA9PiB7CiAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5wYXVzZScpOwogICAgICB9KTsKICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgLy8KICAgIH0KICB9Owp9CgpmdW5jdGlvbiBjcmVhdGVIclRpbWVyKCkgewogIC8vIFRPRE8gKHY4KTogV2UgY2FuIHVzZSBwcm9jZXNzLmhydGltZS5iaWdpbnQoKSBhZnRlciB3ZSBkcm9wIG5vZGUgdjgKICBsZXQgbGFzdFBvbGwgPSBwcm9jZXNzLmhydGltZSgpOwoKICByZXR1cm4gewogICAgZ2V0VGltZU1zOiAoKSA9PiB7CiAgICAgIGNvbnN0IFtzZWNvbmRzLCBuYW5vU2Vjb25kc10gPSBwcm9jZXNzLmhydGltZShsYXN0UG9sbCk7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKHNlY29uZHMgKiAxZTMgKyBuYW5vU2Vjb25kcyAvIDFlNik7CiAgICB9LAogICAgcmVzZXQ6ICgpID0+IHsKICAgICAgbGFzdFBvbGwgPSBwcm9jZXNzLmhydGltZSgpOwogICAgfSwKICB9Owp9CgpmdW5jdGlvbiB3YXRjaGRvZ1RpbWVvdXQoKSB7CiAgbG9nKCdXYXRjaGRvZyB0aW1lb3V0Jyk7CgogIGlmIChkZWJ1Z2dlclBhdXNlKSB7CiAgICBsb2coJ1BhdXNpbmcgZGVidWdnZXIgdG8gY2FwdHVyZSBzdGFjayB0cmFjZScpOwogICAgZGVidWdnZXJQYXVzZSgpOwogIH0gZWxzZSB7CiAgICBsb2coJ0NhcHR1cmluZyBldmVudCB3aXRob3V0IGEgc3RhY2sgdHJhY2UnKTsKICAgIHNlbmRBbnJFdmVudCgpLnRoZW4obnVsbCwgKCkgPT4gewogICAgICBsb2coJ1NlbmRpbmcgQU5SIGV2ZW50IGZhaWxlZCBvbiB3YXRjaGRvZyB0aW1lb3V0LicpOwogICAgfSk7CiAgfQp9Cgpjb25zdCB7IHBvbGwgfSA9IHdhdGNoZG9nVGltZXIoY3JlYXRlSHJUaW1lciwgb3B0aW9ucy5wb2xsSW50ZXJ2YWwsIG9wdGlvbnMuYW5yVGhyZXNob2xkLCB3YXRjaGRvZ1RpbWVvdXQpOwoKX29wdGlvbmFsQ2hhaW4oW3BhcmVudFBvcnQsICdvcHRpb25hbEFjY2VzcycsIF82ID0+IF82Lm9uLCAnY2FsbCcsIF83ID0+IF83KCdtZXNzYWdlJywgKG1zZykgPT4gewogIGlmIChtc2cuc2Vzc2lvbikgewogICAgc2Vzc2lvbiA9IG1ha2VTZXNzaW9uKG1zZy5zZXNzaW9uKTsKICB9CgogIHBvbGwoKTsKfSldKTs="});var ry=h((bw,Cj)=>{var{_optionalChain:SRe,_optionalChainDelete:Ij}=O();Object.defineProperty(bw,"__esModule",{value:!0});var vRe=require("url"),yw=ge(),Iw=O(),hw=Vo(),_Re=yj(),ARe=50,RRe=5e3;function mw(t,...e){Iw.logger.log(`[ANR] ${t}`,...e)}function ERe(){return Iw.dynamicRequire(Cj,"worker_threads")}async function wRe(t){let e={message:"ANR"},r={};for(let n of t.getEventProcessors()){if(e===null)break;e=await n(e,r)}return SRe([e,"optionalAccess",n=>n.contexts])||{}}var bj="Anr",BRe=(t={})=>({name:bj,setupOnce(){},setup(e){if(hw.NODE_VERSION.major<16||hw.NODE_VERSION.major===16&&hw.NODE_VERSION.minor<17)throw new Error("ANR detection requires Node 16.17.0 or later");setImmediate(()=>GRe(e,t))}}),TRe=yw.convertIntegrationFnToClass(bj,BRe);async function GRe(t,e){let r=await wRe(t),n=t.getDsn();if(!n)return;Ij([r,"access",u=>u.app,"optionalAccess",u=>delete u.app_memory]),Ij([r,"access",u=>u.device,"optionalAccess",u=>delete u.free_memory]);let s=t.getOptions(),i=t.getSdkMetadata()||{};i.sdk&&(i.sdk.integrations=s.integrations.map(u=>u.name));let o={debug:Iw.logger.isEnabled(),dsn:n,environment:s.environment||"production",release:s.release,dist:s.dist,sdkMetadata:i,appRootPath:e.appRootPath,pollInterval:e.pollInterval||ARe,anrThreshold:e.anrThreshold||RRe,captureStackTrace:!!e.captureStackTrace,staticTags:e.staticTags||{},contexts:r};if(o.captureStackTrace){let u=require("inspector");u.url()||u.open(0)}let{Worker:a}=ERe(),c=new a(new vRe.URL(`data:application/javascript;base64,${_Re.base64WorkerScript}`),{workerData:o});process.on("exit",()=>{c.terminate()});let l=setInterval(()=>{try{let u=yw.getCurrentScope().getSession(),d=u?{...u,toJSON:void 0}:void 0;c.postMessage({session:d})}catch{}},o.pollInterval);l.unref(),c.on("message",u=>{u==="session-ended"&&(mw("ANR event sent from ANR worker. Clearing session in this thread."),yw.getCurrentScope().setSession(void 0))}),c.once("error",u=>{clearInterval(l),mw("ANR worker error",u)}),c.once("exit",u=>{clearInterval(l),mw("ANR worker exit",u)}),c.unref()}bw.Anr=TRe});var ny=h(Hd=>{Object.defineProperty(Hd,"__esModule",{value:!0});var Mr=ge(),_j=O();function Sj(t){return t&&t.statusCode!==void 0}function ZRe(t){return t&&t.isBoom!==void 0}function NRe(t){return t&&t.error!==void 0}function vj(t){Mr.captureException(t,{mechanism:{type:"hapi",handled:!1,data:{function:"hapiErrorPlugin"}}})}var Aj={name:"SentryHapiErrorPlugin",version:Mr.SDK_VERSION,register:async function(t){t.events.on("request",(r,n)=>{let s=Mr.getActiveTransaction();r.response&&ZRe(r.response)?vj(r.response):NRe(n)&&vj(n.error),s&&(s.setStatus("internal_error"),s.end())})}},Rj={name:"SentryHapiTracingPlugin",version:Mr.SDK_VERSION,register:async function(t){let e=t;e.ext("onPreHandler",(r,n)=>{let s=Mr.continueTrace({sentryTrace:r.headers["sentry-trace"]||void 0,baggage:r.headers.baggage||void 0},i=>Mr.startTransaction({...i,op:"hapi.request",name:r.route.path,description:`${r.route.method} ${r.path}`}));return Mr.getCurrentScope().setSpan(s),n.continue}),e.ext("onPreResponse",(r,n)=>{let s=Mr.getActiveTransaction();if(r.response&&Sj(r.response)&&s){let i=r.response;i.header("sentry-trace",Mr.spanToTraceHeader(s));let o=_j.dynamicSamplingContextToSentryBaggageHeader(Mr.getDynamicSamplingContextFromSpan(s));o&&i.header("baggage",o)}return n.continue}),e.ext("onPostHandler",(r,n)=>{let s=Mr.getActiveTransaction();return r.response&&Sj(r.response)&&s&&s.setHttpStatus(r.response.statusCode),s&&s.end(),n.continue})}},Ej="Hapi",VRe=(t={})=>{let e=t.server;return{name:Ej,setupOnce(){e&&_j.fill(e,"start",r=>async function(){return await this.register(Rj),await this.register(Aj),r.apply(this)})}}},HRe=Mr.convertIntegrationFnToClass(Ej,VRe);Hd.Hapi=HRe;Hd.hapiErrorPlugin=Aj;Hd.hapiTracingPlugin=Rj});var Sw=h(Cw=>{Object.defineProperty(Cw,"__esModule",{value:!0});var wj=require("path"),WRe=O();function Bj(t){return t.replace(/^[A-Z]:/,"").replace(/\\/g,"/")}function ORe(t=process.argv[1]?WRe.dirname(process.argv[1]):process.cwd(),e=wj.sep==="\\"){let r=e?Bj(t):t;return n=>{if(!n)return;let s=e?Bj(n):n,{dir:i,base:o,ext:a}=wj.posix.parse(s);(a===".js"||a===".mjs"||a===".cjs")&&(o=o.slice(0,a.length*-1)),i||(i=".");let c=i.lastIndexOf("/node_modules");if(c>-1)return`${i.slice(c+14).replace(/\//g,".")}:${o}`;if(i.startsWith(r)){let l=i.slice(r.length+1).replace(/\//g,".");return l&&(l+=":"),l+=o,l}return o}}Cw.createGetModuleFromFilename=ORe});var vw=h(Fo=>{var{_optionalChain:PRe}=O();Object.defineProperty(Fo,"__esModule",{value:!0});var Kr=ge(),ko=O(),kRe=P$(),FRe=RE(),xRe=xE(),LRe=$E(),URe=zE(),YRe=QE(),DRe=rw(),XRe=iw(),$Re=ow(),jRe=dw(),qRe=fw(),MRe=pw();ry();ny();var KRe=Sw(),zRe=NE(),Tj=[new Kr.InboundFilters,new Kr.FunctionToString,new Kr.LinkedErrors,new xRe.Console,new LRe.Http,new qRe.Undici,new URe.OnUncaughtException,new YRe.OnUnhandledRejection,new XRe.ContextLines,new jRe.LocalVariables,new $Re.Context,new DRe.Modules,new Kr.RequestData];function JRe(t={}){let e=Kr.getMainCarrier();kRe.setNodeAsyncContextStrategy();let r=PRe([e,"access",i=>i.__SENTRY__,"optionalAccess",i=>i.integrations])||[];t.defaultIntegrations=t.defaultIntegrations===!1?[]:[...Array.isArray(t.defaultIntegrations)?t.defaultIntegrations:Tj,...r],t.dsn===void 0&&process.env.SENTRY_DSN&&(t.dsn=process.env.SENTRY_DSN);let n=process.env.SENTRY_TRACES_SAMPLE_RATE;if(t.tracesSampleRate===void 0&&n){let i=parseFloat(n);isFinite(i)&&(t.tracesSampleRate=i)}if(t.release===void 0){let i=Gj();i!==void 0?t.release=i:t.autoSessionTracking=!1}t.environment===void 0&&process.env.SENTRY_ENVIRONMENT&&(t.environment=process.env.SENTRY_ENVIRONMENT),t.autoSessionTracking===void 0&&t.dsn!==void 0&&(t.autoSessionTracking=!0),t.instrumenter===void 0&&(t.instrumenter="sentry");let s={...t,stackParser:ko.stackParserFromStackParserOptions(t.stackParser||Zj),integrations:Kr.getIntegrationsToSetup(t),transport:t.transport||zRe.makeNodeTransport};if(Kr.initAndBind(t.clientClass||FRe.NodeClient,s),t.autoSessionTracking&&eEe(),tEe(),t.spotlight){let i=Kr.getClient();if(i&&i.addIntegration){let o=i.getOptions().integrations;for(let a of o)i.addIntegration(a);i.addIntegration(new MRe.Spotlight({sidecarUrl:typeof t.spotlight=="string"?t.spotlight:void 0}))}}}function QRe(t){if(t===void 0)return!1;let e=t&&t.getOptions();return e&&e.autoSessionTracking!==void 0?e.autoSessionTracking:!1}function Gj(t){return process.env.SENTRY_RELEASE?process.env.SENTRY_RELEASE:ko.GLOBAL_OBJ.SENTRY_RELEASE&&ko.GLOBAL_OBJ.SENTRY_RELEASE.id?ko.GLOBAL_OBJ.SENTRY_RELEASE.id:process.env.GITHUB_SHA||process.env.COMMIT_REF||process.env.VERCEL_GIT_COMMIT_SHA||process.env.VERCEL_GITHUB_COMMIT_SHA||process.env.VERCEL_GITLAB_COMMIT_SHA||process.env.VERCEL_BITBUCKET_COMMIT_SHA||process.env.ZEIT_GITHUB_COMMIT_SHA||process.env.ZEIT_GITLAB_COMMIT_SHA||process.env.ZEIT_BITBUCKET_COMMIT_SHA||process.env.CF_PAGES_COMMIT_SHA||t}var Zj=ko.createStackParser(ko.nodeStackLineParser(KRe.createGetModuleFromFilename()));function eEe(){Kr.startSession(),process.on("beforeExit",()=>{let t=Kr.getIsolationScope().getSession();t&&!["exited","crashed"].includes(t.status)&&Kr.endSession()})}function tEe(){let t=(process.env.SENTRY_USE_ENVIRONMENT||"").toLowerCase();if(!["false","n","no","off","0"].includes(t)){let e=process.env.SENTRY_TRACE,r=process.env.SENTRY_BAGGAGE,{propagationContext:n}=ko.tracingContextFromHeaders(e,r);Kr.getCurrentScope().setPropagationContext(n)}}Fo.defaultIntegrations=Tj;Fo.defaultStackParser=Zj;Fo.getSentryRelease=Gj;Fo.init=JRe;Fo.isAutoSessionTrackingEnabled=QRe});var Nj=h(Aw=>{Object.defineProperty(Aw,"__esModule",{value:!0});var sy=require("fs"),_w=require("path");function rEe(t){let e=_w.resolve(t);if(!sy.existsSync(e))throw new Error(`Cannot read contents of ${e}. Directory does not exist.`);if(!sy.statSync(e).isDirectory())throw new Error(`Cannot read contents of ${e}, because it is not a directory.`);let r=n=>sy.readdirSync(n).reduce((s,i)=>{let o=_w.join(n,i);return sy.statSync(o).isDirectory()?s.concat(r(o)):(s.push(o),s)},[]);return r(e).map(n=>_w.relative(e,n))}Aw.deepReadDirSync=rEe});var Vj=h(Rw=>{Object.defineProperty(Rw,"__esModule",{value:!0});var nEe=ge(),sEe=ry();function iEe(t){let e=nEe.getClient();return new sEe.Anr(t).setup(e),Promise.resolve()}Rw.enableAnrDetection=iEe});var Wj=h(iy=>{Object.defineProperty(iy,"__esModule",{value:!0});var Hj=O();function oEe(t,e){return Hj.extractRequestData(t,{include:e})}function aEe(t,e,r={}){return Hj.addRequestDataToEvent(t,e,{include:r})}iy.extractRequestData=oEe;iy.parseRequest=aEe});var Pj=h(ki=>{var{_optionalChain:Hc}=O();Object.defineProperty(ki,"__esModule",{value:!0});var it=ge(),Pi=O(),cEe=Zd(),oy=vw(),Oj=Wj();function lEe(){return function(e,r,n){let s=Hc([it.getClient,"call",u=>u(),"optionalAccess",u=>u.getOptions,"call",u=>u()]);if(!s||s.instrumenter!=="sentry"||Hc([e,"access",u=>u.method,"optionalAccess",u=>u.toUpperCase,"call",u=>u()])==="OPTIONS"||Hc([e,"access",u=>u.method,"optionalAccess",u=>u.toUpperCase,"call",u=>u()])==="HEAD")return n();let i=e.headers&&Pi.isString(e.headers["sentry-trace"])?e.headers["sentry-trace"]:void 0,o=Hc([e,"access",u=>u.headers,"optionalAccess",u=>u.baggage]);if(!it.hasTracingEnabled(s))return n();let[a,c]=Pi.extractPathForTransaction(e,{path:!0,method:!0}),l=it.continueTrace({sentryTrace:i,baggage:o},u=>it.startTransaction({name:a,op:"http.server",origin:"auto.http.node.tracingHandler",...u,data:{[it.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:c},metadata:{...u.metadata,request:e}},{request:Pi.extractRequestData(e)}));it.getCurrentScope().setSpan(l),r.__sentry_transaction=l,r.once("finish",()=>{setImmediate(()=>{Pi.addRequestDataToTransaction(l,e),l.setHttpStatus(r.statusCode),l.end()})}),n()}}function uEe(t={}){let e;if("include"in t)e={include:t.include};else{let{ip:r,request:n,transaction:s,user:i}=t;(r||n||s||i)&&(e={include:Pi.dropUndefinedKeys({ip:r,request:n,transaction:s,user:i})})}return e}function dEe(t){let e=uEe(t),r=it.getClient();if(r&&oy.isAutoSessionTrackingEnabled(r)){r.initSessionFlusher();let n=it.getCurrentScope();n.getSession()&&n.setSession()}return function(s,i,o){if(t&&t.flushTimeout&&t.flushTimeout>0){let a=i.end;i.end=function(c,l,u){it.flush(t.flushTimeout).then(()=>{a.call(this,c,l,u)}).then(null,d=>{cEe.DEBUG_BUILD&&Pi.logger.error(d),a.call(this,c,l,u)})}}it.runWithAsyncContext(()=>{let a=it.getCurrentScope();a.setSDKProcessingMetadata({request:s,requestDataOptionsFromExpressHandler:e});let c=it.getClient();oy.isAutoSessionTrackingEnabled(c)&&a.setRequestSession({status:"ok"}),i.once("finish",()=>{let l=it.getClient();oy.isAutoSessionTrackingEnabled(l)&&setImmediate(()=>{l&&l._captureRequestSession&&l._captureRequestSession()})}),o()})}}function fEe(t){let e=t.status||t.statusCode||t.status_code||t.output&&t.output.statusCode;return e?parseInt(e,10):500}function gEe(t){return fEe(t)>=500}function pEe(t){return function(r,n,s,i){if((t&&t.shouldHandleError||gEe)(r)){it.withScope(a=>{a.setSDKProcessingMetadata({request:n});let c=s.__sentry_transaction;c&&!it.getActiveSpan()&&a.setSpan(c);let l=it.getClient();if(l&&oy.isAutoSessionTrackingEnabled(l)&&l._sessionFlusher!==void 0){let f=a.getRequestSession();f&&f.status!==void 0&&(f.status="crashed")}let u=it.captureException(r,{mechanism:{type:"middleware",handled:!1}});s.sentry=u,i(r)});return}i(r)}}function hEe(t={}){return function({path:e,type:r,next:n,rawInput:s}){let i=Hc([it.getClient,"call",l=>l(),"optionalAccess",l=>l.getOptions,"call",l=>l()]),o=it.getCurrentScope().getTransaction();if(o){o.updateName(`trpc/${e}`),o.setAttribute(it.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,"route"),o.op="rpc.server";let l={procedure_type:r};(t.attachRpcInput!==void 0?t.attachRpcInput:Hc([i,"optionalAccess",u=>u.sendDefaultPii]))&&(l.input=Pi.normalize(s)),o.setContext("trpc",l)}function a(l){l.ok||it.captureException(l.error,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}let c;try{c=n()}catch(l){throw it.captureException(l,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}}),l}return Pi.isThenable(c)?Promise.resolve(c).then(l=>{a(l)},l=>{it.captureException(l,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}):a(c),c}}ki.extractRequestData=Oj.extractRequestData;ki.parseRequest=Oj.parseRequest;ki.errorHandler=pEe;ki.requestHandler=dEe;ki.tracingHandler=lEe;ki.trpcMiddleware=hEe});var kj=h(cr=>{Object.defineProperty(cr,"__esModule",{value:!0});var mEe=xE(),yEe=$E(),IEe=zE(),bEe=QE(),CEe=rw(),SEe=iw(),vEe=ow(),_Ee=ge(),AEe=dw(),REe=fw(),EEe=pw(),wEe=ry(),BEe=ny();cr.Console=mEe.Console;cr.Http=yEe.Http;cr.OnUncaughtException=IEe.OnUncaughtException;cr.OnUnhandledRejection=bEe.OnUnhandledRejection;cr.Modules=CEe.Modules;cr.ContextLines=SEe.ContextLines;cr.Context=vEe.Context;cr.RequestData=_Ee.RequestData;cr.LocalVariables=AEe.LocalVariables;cr.Undici=REe.Undici;cr.Spotlight=EEe.Spotlight;cr.Anr=wEe.Anr;cr.Hapi=BEe.Hapi});var Fj=h(Ls=>{Object.defineProperty(Ls,"__esModule",{value:!0});var xo=CE();Ls.Apollo=xo.Apollo;Ls.Express=xo.Express;Ls.GraphQL=xo.GraphQL;Ls.Mongo=xo.Mongo;Ls.Mysql=xo.Mysql;Ls.Postgres=xo.Postgres;Ls.Prisma=xo.Prisma});var ay=h(Ew=>{Object.defineProperty(Ew,"__esModule",{value:!0});var TEe=[["january","1"],["february","2"],["march","3"],["april","4"],["may","5"],["june","6"],["july","7"],["august","8"],["september","9"],["october","10"],["november","11"],["december","12"],["jan","1"],["feb","2"],["mar","3"],["apr","4"],["may","5"],["jun","6"],["jul","7"],["aug","8"],["sep","9"],["oct","10"],["nov","11"],["dec","12"],["sunday","0"],["monday","1"],["tuesday","2"],["wednesday","3"],["thursday","4"],["friday","5"],["saturday","6"],["sun","0"],["mon","1"],["tue","2"],["wed","3"],["thu","4"],["fri","5"],["sat","6"]];function GEe(t){return TEe.reduce((e,[r,n])=>e.replace(new RegExp(r,"gi"),n),t)}Ew.replaceCronNames=GEe});var Yj=h(ww=>{Object.defineProperty(ww,"__esModule",{value:!0});var xj=ge(),Lj=ay(),Uj="Automatic instrumentation of CronJob only supports crontab string";function ZEe(t,e){let r=!1;return new Proxy(t,{construct(n,s){let[i,o,a,c,l,...u]=s;if(typeof i!="string")throw new Error(Uj);if(r)throw new Error(`A job named '${e}' has already been scheduled`);r=!0;let d=Lj.replaceCronNames(i);function f(g,p){return xj.withMonitor(e,()=>o(g,p),{schedule:{type:"crontab",value:d},...l?{timeZone:l}:{}})}return new n(i,f,a,c,l,...u)},get(n,s){return s==="from"?i=>{let{cronTime:o,onTick:a,timeZone:c}=i;if(typeof o!="string")throw new Error(Uj);if(r)throw new Error(`A job named '${e}' has already been scheduled`);r=!0;let l=Lj.replaceCronNames(o);return i.onTick=(u,d)=>xj.withMonitor(e,()=>a(u,d),{schedule:{type:"crontab",value:l},...c?{timeZone:c}:{}}),n.from(i)}:n[s]}})}ww.instrumentCron=ZEe});var Xj=h(Bw=>{var{_optionalChain:Dj}=O();Object.defineProperty(Bw,"__esModule",{value:!0});var NEe=ge(),VEe=ay();function HEe(t){return new Proxy(t,{get(e,r){return r==="schedule"&&e.schedule?new Proxy(e.schedule,{apply(n,s,i){let[o,,a]=i;if(!Dj([a,"optionalAccess",c=>c.name]))throw new Error('Missing "name" for scheduled job. A name is required for Sentry check-in monitoring.');return NEe.withMonitor(a.name,()=>n.apply(s,i),{schedule:{type:"crontab",value:VEe.replaceCronNames(o)},timezone:Dj([a,"optionalAccess",c=>c.timezone])})}}):e[r]}})}Bw.instrumentNodeCron=HEe});var $j=h(Tw=>{Object.defineProperty(Tw,"__esModule",{value:!0});var WEe=ge(),OEe=ay();function PEe(t){return new Proxy(t,{get(e,r){return r==="scheduleJob"?new Proxy(e.scheduleJob,{apply(n,s,i){let[o,a]=i;if(typeof o!="string"||typeof a!="string")throw new Error("Automatic instrumentation of 'node-schedule' requires the first parameter of 'scheduleJob' to be a job name string and the second parameter to be a crontab string");let c=o,l=a;return WEe.withMonitor(c,()=>n.apply(s,i),{schedule:{type:"crontab",value:OEe.replaceCronNames(l)}})}}):e[r]}})}Tw.instrumentNodeSchedule=PEe});var Jn=h(X=>{Object.defineProperty(X,"__esModule",{value:!0});var se=ge(),kEe=_$(),FEe=RE(),xEe=NE(),cy=vw(),Gw=O(),LEe=Nj(),jj=Sw(),UEe=Vj(),YEe=Pj(),DEe=kj(),XEe=Fj(),$Ee=ny(),jEe=Yj(),qEe=Xj(),MEe=$j(),KEe=jj.createGetModuleFromFilename(),zEe={...se.Integrations,...DEe,...XEe},JEe={instrumentCron:jEe.instrumentCron,instrumentNodeCron:qEe.instrumentNodeCron,instrumentNodeSchedule:MEe.instrumentNodeSchedule};X.Hub=se.Hub;X.SDK_VERSION=se.SDK_VERSION;X.Scope=se.Scope;X.addBreadcrumb=se.addBreadcrumb;X.addEventProcessor=se.addEventProcessor;X.addGlobalEventProcessor=se.addGlobalEventProcessor;X.addIntegration=se.addIntegration;X.captureCheckIn=se.captureCheckIn;X.captureEvent=se.captureEvent;X.captureException=se.captureException;X.captureMessage=se.captureMessage;X.close=se.close;X.configureScope=se.configureScope;X.continueTrace=se.continueTrace;X.createTransport=se.createTransport;X.extractTraceparentData=se.extractTraceparentData;X.flush=se.flush;X.functionToStringIntegration=se.functionToStringIntegration;X.getActiveSpan=se.getActiveSpan;X.getActiveTransaction=se.getActiveTransaction;X.getClient=se.getClient;X.getCurrentHub=se.getCurrentHub;X.getCurrentScope=se.getCurrentScope;X.getGlobalScope=se.getGlobalScope;X.getHubFromCarrier=se.getHubFromCarrier;X.getIsolationScope=se.getIsolationScope;X.inboundFiltersIntegration=se.inboundFiltersIntegration;X.lastEventId=se.lastEventId;X.linkedErrorsIntegration=se.linkedErrorsIntegration;X.makeMain=se.makeMain;X.metrics=se.metrics;X.requestDataIntegration=se.requestDataIntegration;X.runWithAsyncContext=se.runWithAsyncContext;X.setContext=se.setContext;X.setCurrentClient=se.setCurrentClient;X.setExtra=se.setExtra;X.setExtras=se.setExtras;X.setMeasurement=se.setMeasurement;X.setTag=se.setTag;X.setTags=se.setTags;X.setUser=se.setUser;X.spanStatusfromHttpCode=se.spanStatusfromHttpCode;X.startActiveSpan=se.startActiveSpan;X.startInactiveSpan=se.startInactiveSpan;X.startSpan=se.startSpan;X.startSpanManual=se.startSpanManual;X.startTransaction=se.startTransaction;X.trace=se.trace;X.withIsolationScope=se.withIsolationScope;X.withMonitor=se.withMonitor;X.withScope=se.withScope;X.autoDiscoverNodePerformanceMonitoringIntegrations=kEe.autoDiscoverNodePerformanceMonitoringIntegrations;X.NodeClient=FEe.NodeClient;X.makeNodeTransport=xEe.makeNodeTransport;X.defaultIntegrations=cy.defaultIntegrations;X.defaultStackParser=cy.defaultStackParser;X.getSentryRelease=cy.getSentryRelease;X.init=cy.init;X.DEFAULT_USER_INCLUDES=Gw.DEFAULT_USER_INCLUDES;X.addRequestDataToEvent=Gw.addRequestDataToEvent;X.extractRequestData=Gw.extractRequestData;X.deepReadDirSync=LEe.deepReadDirSync;X.createGetModuleFromFilename=jj.createGetModuleFromFilename;X.enableAnrDetection=UEe.enableAnrDetection;X.Handlers=YEe;X.hapiErrorPlugin=$Ee.hapiErrorPlugin;X.Integrations=zEe;X.cron=JEe;X.getModuleFromFilename=KEe});var Nw=h(Zw=>{Object.defineProperty(Zw,"__esModule",{value:!0});var QEe=Jn(),ewe=O(),ly=class t{static __initStatic(){this.id="AWSServices"}constructor(e={}){this.name=t.id,this._optional=e.optional||!1}setupOnce(){try{let e=require("aws-sdk/global");ewe.fill(e.Service.prototype,"makeRequest",twe)}catch(e){if(!this._optional)throw e}}};ly.__initStatic();function twe(t){return function(e,r,n){let s,i=t.call(this,e,r);return i.on("afterBuild",()=>{s=QEe.startInactiveSpan({name:rwe(this,e,r),op:"http.client",origin:"auto.http.serverless"})}),i.on("complete",()=>{s&&s.end()}),n&&i.send(n),i}}function rwe(t,e,r){let n=`aws.${t.serviceIdentifier}.${e}`;if(r===void 0)return n;switch(t.serviceIdentifier){case"s3":n+=swe(e,r);break;case"lambda":n+=nwe(e,r);break}return n}function nwe(t,e){let r="";return"FunctionName"in e&&(r+=` ${e.FunctionName}`),r}function swe(t,e){let r="";return"Bucket"in e&&(r+=` ${e.Bucket}`),r}Zw.AWSServices=ly});var Wd=h(Vw=>{Object.defineProperty(Vw,"__esModule",{value:!0});var iwe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;Vw.DEBUG_BUILD=iwe});var Pd=h(Od=>{Object.defineProperty(Od,"__esModule",{value:!0});var owe=ge(),awe=O();function cwe(t){return(...e)=>owe.runWithAsyncContext(()=>t(...e),{reuseExisting:!0})}function lwe(t,e,r){let n=e(t),s={apply:(i,o,a)=>n.apply(o,a)};return r&&(s.get=(i,o)=>Object.prototype.hasOwnProperty.call(r,o)?r[o]:i[o]),new Proxy(t,s)}function uwe(t){return t.addEventProcessor(e=>(awe.addExceptionMechanism(e,{handled:!1}),e)),t}Od.domainify=cwe;Od.markEventUnhandled=uwe;Od.proxyFunction=lwe});var tq=h(Fi=>{var{_optionalChain:qj}=O();Object.defineProperty(Fi,"__esModule",{value:!0});var Mj=require("fs"),dwe=require("os"),zj=require("path"),fwe=require("util"),Qt=Jn(),Wc=O(),Jj=require("perf_hooks"),gwe=ge(),pwe=Nw(),kd=Wd(),Kj=Pd(),{isPromise:hwe}=fwe.types,Qj=[...Qt.defaultIntegrations,new pwe.AWSServices({optional:!0})];function mwe(t={}){let e={_metadata:{},defaultIntegrations:Qj,...t};e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.serverless",integrations:["AWSLambda"],packages:[{name:"npm:@sentry/serverless",version:Qt.SDK_VERSION}],version:Qt.SDK_VERSION},Qt.init(e)}function ywe(t,e,r){let n=zj.resolve(t,e,r);return Mj.existsSync(n)||Mj.existsSync(`${n}.js`)?require(n):require(require.resolve(r,{paths:[t,e]}))}function Iwe(t){return t.every(e=>Object.prototype.hasOwnProperty.call(e,"status")&&(Object.prototype.hasOwnProperty.call(e,"value")||Object.prototype.hasOwnProperty.call(e,"reason")))}function bwe(t){return t.reduce((e,r)=>(r.status==="rejected"&&r.reason&&e.push(r.reason),e),[])}function Cwe(t,e){let r=zj.basename(e),n=r.match(/^([^.]*)\.(.*)$/);if(!n){kd.DEBUG_BUILD&&Wc.logger.error(`Bad handler ${r}`);return}let[,s,i]=n,o;try{let l=e.substring(0,e.indexOf(r));o=ywe(t,l,s)}catch(l){kd.DEBUG_BUILD&&Wc.logger.error(`Cannot require ${e} in ${t}`,l);return}let a,c;if(i.split(".").forEach(l=>{a=o,o=o&&o[l],c=l}),!o){kd.DEBUG_BUILD&&Wc.logger.error(`${e} is undefined or not exported`);return}if(typeof o!="function"){kd.DEBUG_BUILD&&Wc.logger.error(`${e} is not a function`);return}a[c]=eq(o)}function Hw(t){return typeof t.getRemainingTimeInMillis=="function"?t.getRemainingTimeInMillis():0}function Swe(t,e,r){t.setContext("aws.lambda",{aws_request_id:e.awsRequestId,function_name:e.functionName,function_version:e.functionVersion,invoked_function_arn:e.invokedFunctionArn,execution_duration_in_millis:Jj.performance.now()-r,remaining_time_in_millis:Hw(e),"sys.argv":process.argv}),t.setContext("aws.cloudwatch.logs",{log_group:e.logGroupName,log_stream:e.logStreamName,url:`https://console.aws.amazon.com/cloudwatch/home?region=${process.env.AWS_REGION}#logsV2:log-groups/log-group/${encodeURIComponent(e.logGroupName)}/log-events/${encodeURIComponent(e.logStreamName)}?filterPattern="${e.awsRequestId}"`})}function vwe(t,e){t.addEventProcessor(r=>(r.transaction=e.functionName,r)),t.setTag("server_name",process.env._AWS_XRAY_DAEMON_ADDRESS||process.env.SENTRY_NAME||dwe.hostname()),t.setTag("url",`awslambda:///${e.functionName}`)}function eq(t,e={}){let r=Jj.performance.now(),n={flushTimeout:2e3,callbackWaitsForEmptyEventLoop:!1,captureTimeoutWarning:!0,timeoutWarningLimit:500,captureAllSettledReasons:!1,startTrace:!0,...e},s,i=t.length>2?(o,a)=>new Promise((c,l)=>{let u=t(o,a,(d,f)=>{d==null?c(f):l(d)});hwe(u)&&u.then(c,l)}):t;return async(o,a)=>{a.callbackWaitsForEmptyEventLoop=n.callbackWaitsForEmptyEventLoop;let c=Math.ceil(Hw(a)/1e3),l=Math.floor(c/60),u=c%60,d=l>0?`${l}m${u}s`:`${u}s`;if(n.captureTimeoutWarning){let g=Hw(a)-n.timeoutWarningLimit;s=setTimeout(()=>{Qt.withScope(p=>{p.setTag("timeout",d),Qt.captureMessage(`Possible function timeout: ${a.functionName}`,"warning")})},g)}async function f(g){let p=Qt.getCurrentScope(),m;try{Swe(p,a,r),m=await i(o,a),n.captureAllSettledReasons&&Array.isArray(m)&&Iwe(m)&&bwe(m).forEach(C=>{Qt.captureException(C,S=>Kj.markEventUnhandled(S))})}catch(I){throw Qt.captureException(I,C=>Kj.markEventUnhandled(C)),I}finally{clearTimeout(s),qj([g,"optionalAccess",I=>I.end,"call",I=>I()]),await Qt.flush(n.flushTimeout).catch(I=>{kd.DEBUG_BUILD&&Wc.logger.error(I)})}return m}if(n.startTrace){let g=o,p=g.headers&&Wc.isString(g.headers["sentry-trace"])?g.headers["sentry-trace"]:void 0,m=qj([g,"access",C=>C.headers,"optionalAccess",C=>C.baggage]),I=Qt.continueTrace({sentryTrace:p,baggage:m});return Qt.startSpanManual({name:a.functionName,op:"function.aws.lambda",origin:"auto.function.serverless",...I,attributes:{[gwe.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"component"}},C=>(vwe(Qt.getCurrentScope(),a),f(C)))}return Qt.withScope(async()=>f(void 0))}}Fi.defaultIntegrations=Qj;Fi.init=mwe;Fi.tryPatchHandler=Cwe;Fi.wrapHandler=eq;for(let t in Qt)t!=="default"&&!Fi.hasOwnProperty(t)&&(Fi[t]=Qt[t])});var sq=h(Ww=>{var{_optionalChain:rq}=O();Object.defineProperty(Ww,"__esModule",{value:!0});var _we=Jn(),nq=O(),uy=class t{static __initStatic(){this.id="GoogleCloudGrpc"}constructor(e={}){this.name=t.id,this._optional=e.optional||!1}setupOnce(){try{let e=require("google-gax");nq.fill(e.GrpcClient.prototype,"createStub",Awe)}catch(e){if(!this._optional)throw e}}};uy.__initStatic();function Awe(t){return async function(...e){let r=rq([e,"access",i=>i[1],"optionalAccess",i=>i.servicePath]);if(r==null||r==null)return t.apply(this,e);let n=Ewe(r),s=await t.apply(this,e);for(let i of Object.keys(Object.getPrototypeOf(s)))Rwe(s,n,i);return s}}function Rwe(t,e,r){let n=t[r];if(typeof n!="function")return;let s=!n.requestStream&&!n.responseStream?"unary call":n.requestStream&&!n.responseStream?"client stream":!n.requestStream&&n.responseStream?"server stream":"bidi stream";s=="unary call"&&nq.fill(t,r,i=>(...o)=>{let a=i.apply(t,o);if(typeof rq([a,"optionalAccess",l=>l.on])!="function")return a;let c=_we.startInactiveSpan({name:`${s} ${r}`,op:`grpc.${e}`,origin:"auto.grpc.serverless"});return a.on("status",()=>{c&&c.end()}),a})}function Ewe(t){let e=t.match(/^(\w+)\.googleapis.com$/);return e?e[1]:t}Ww.GoogleCloudGrpc=uy});var iq=h(Ow=>{Object.defineProperty(Ow,"__esModule",{value:!0});var wwe=Jn(),Bwe=O(),dy=class t{static __initStatic(){this.id="GoogleCloudHttp"}constructor(e={}){this.name=t.id,this._optional=e.optional||!1}setupOnce(){try{let e=require("@google-cloud/common");Bwe.fill(e.Service.prototype,"request",Twe)}catch(e){if(!this._optional)throw e}}};dy.__initStatic();function Twe(t){return function(e,r){let n=e.method||"GET",s=wwe.startInactiveSpan({name:`${n} ${e.uri}`,op:`http.client.${Gwe(this.apiEndpoint)}`,origin:"auto.http.serverless"});t.call(this,e,(...i)=>{s&&s.end(),r(...i)})}}function Gwe(t){let e=t.match(/^https:\/\/(\w+)\.googleapis.com$/);return e?e[1]:t.replace(/^(http|https)?:\/\//,"")}Ow.GoogleCloudHttp=dy});var oq=h(xw=>{var{_optionalChain:Pw}=O();Object.defineProperty(xw,"__esModule",{value:!0});var kw=ge(),Fd=Jn(),Fw=O(),Zwe=Wd(),fy=Pd();function Nwe(t,e={}){let r=i=>fy.domainify(Vwe(i,e)),n,s=t.__emulator_func;return s&&(n={__emulator_func:fy.proxyFunction(s,r)}),fy.proxyFunction(t,r,n)}function Vwe(t,e={}){let{parseRequestOptions:r}=e,n={flushTimeout:2e3,addRequestDataToEventOptions:r?{include:r}:{},...e};return(s,i)=>{let o=(s.method||"").toUpperCase(),a=Fw.stripUrlQueryAndFragment(s.originalUrl||s.url||""),c=s.headers&&Fw.isString(s.headers["sentry-trace"])?s.headers["sentry-trace"]:void 0,l=Pw([s,"access",d=>d.headers,"optionalAccess",d=>d.baggage]),u=Fd.continueTrace({sentryTrace:c,baggage:l});return Fd.startSpanManual({...u,name:`${o} ${a}`,op:"function.gcp.http",origin:"auto.function.serverless.gcp_http",attributes:{[kw.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route"}},d=>{Fd.getCurrentScope().setSDKProcessingMetadata({request:s,requestDataOptionsFromGCPWrapper:n.addRequestDataToEventOptions}),d instanceof kw.Transaction&&(i.__sentry_transaction=d);let f=i.end;return i.end=function(g,p,m){Pw([d,"optionalAccess",I=>I.setHttpStatus,"call",I=>I(i.statusCode)]),Pw([d,"optionalAccess",I=>I.end,"call",I=>I()]),Fd.flush(n.flushTimeout).then(null,I=>{Zwe.DEBUG_BUILD&&Fw.logger.error(I)}).then(()=>{f.call(this,g,p,m)})},kw.handleCallbackErrors(()=>t(s,i),g=>{Fd.captureException(g,p=>fy.markEventUnhandled(p))})})}}xw.wrapHttpFunction=Nwe});var cq=h(Lw=>{var{_optionalChain:Hwe}=O();Object.defineProperty(Lw,"__esModule",{value:!0});var aq=ge(),xd=Jn(),Wwe=O(),Owe=Wd(),Ld=Pd();function Pwe(t,e={}){return Ld.proxyFunction(t,r=>Ld.domainify(kwe(r,e)))}function kwe(t,e={}){let r={flushTimeout:2e3,...e};return(...n)=>{let[s,i,o]=n;return xd.startSpanManual({name:i.eventType,op:"function.gcp.event",origin:"auto.function.serverless.gcp_event",attributes:{[aq.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"component"}},a=>{xd.getCurrentScope().setContext("gcp.function.context",{...i});let l=Ld.domainify((...u)=>{u[0]!==null&&u[0]!==void 0&&xd.captureException(u[0],d=>Ld.markEventUnhandled(d)),Hwe([a,"optionalAccess",d=>d.end,"call",d=>d()]),xd.flush(r.flushTimeout).then(null,d=>{Owe.DEBUG_BUILD&&Wwe.logger.error(d)}).then(()=>{typeof o=="function"&&o(...u)})});return t.length>2?aq.handleCallbackErrors(()=>t(s,i,l),u=>{xd.captureException(u,d=>Ld.markEventUnhandled(d))}):Promise.resolve().then(()=>t(s,i)).then(u=>l(null,u),u=>l(u,void 0))})}}Lw.wrapEventFunction=Pwe});var uq=h(Uw=>{var{_optionalChain:Fwe}=O();Object.defineProperty(Uw,"__esModule",{value:!0});var lq=ge(),Ud=Jn(),xwe=O(),Lwe=Wd(),Yd=Pd();function Uwe(t,e={}){return Yd.proxyFunction(t,r=>Yd.domainify(Ywe(r,e)))}function Ywe(t,e={}){let r={flushTimeout:2e3,...e};return(n,s)=>Ud.startSpanManual({name:n.type||"<unknown>",op:"function.gcp.cloud_event",origin:"auto.function.serverless.gcp_cloud_event",attributes:{[lq.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"component"}},i=>{Ud.getCurrentScope().setContext("gcp.function.context",{...n});let a=Yd.domainify((...c)=>{c[0]!==null&&c[0]!==void 0&&Ud.captureException(c[0],l=>Yd.markEventUnhandled(l)),Fwe([i,"optionalAccess",l=>l.end,"call",l=>l()]),Ud.flush(r.flushTimeout).then(null,l=>{Lwe.DEBUG_BUILD&&xwe.logger.error(l)}).then(()=>{s(...c)})});return t.length>1?lq.handleCallbackErrors(()=>t(n,a),c=>{Ud.captureException(c,l=>Yd.markEventUnhandled(l))}):Promise.resolve().then(()=>t(n)).then(c=>a(null,c),c=>a(c,void 0))})}Uw.wrapCloudEventFunction=Uwe});var fq=h(Lo=>{Object.defineProperty(Lo,"__esModule",{value:!0});var gy=Jn(),Dwe=sq(),Xwe=iq(),$we=oq(),jwe=cq(),qwe=uq(),dq=[...gy.defaultIntegrations,new Xwe.GoogleCloudHttp({optional:!0}),new Dwe.GoogleCloudGrpc({optional:!0})];function Mwe(t={}){let e={_metadata:{},defaultIntegrations:dq,...t};e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.serverless",integrations:["GCPFunction"],packages:[{name:"npm:@sentry/serverless",version:gy.SDK_VERSION}],version:gy.SDK_VERSION},gy.init(e)}Lo.wrapHttpFunction=$we.wrapHttpFunction;Lo.wrapEventFunction=jwe.wrapEventFunction;Lo.wrapCloudEventFunction=qwe.wrapCloudEventFunction;Lo.defaultIntegrations=dq;Lo.init=Mwe});var gq=h(J=>{Object.defineProperty(J,"__esModule",{value:!0});var Kwe=tq(),zwe=fq(),Jwe=Nw(),re=Jn();J.AWSLambda=Kwe;J.GCPFunction=zwe;J.AWSServices=Jwe.AWSServices;J.DEFAULT_USER_INCLUDES=re.DEFAULT_USER_INCLUDES;J.Handlers=re.Handlers;J.Hub=re.Hub;J.Integrations=re.Integrations;J.NodeClient=re.NodeClient;J.SDK_VERSION=re.SDK_VERSION;J.Scope=re.Scope;J.addBreadcrumb=re.addBreadcrumb;J.addEventProcessor=re.addEventProcessor;J.addGlobalEventProcessor=re.addGlobalEventProcessor;J.addIntegration=re.addIntegration;J.addRequestDataToEvent=re.addRequestDataToEvent;J.autoDiscoverNodePerformanceMonitoringIntegrations=re.autoDiscoverNodePerformanceMonitoringIntegrations;J.captureCheckIn=re.captureCheckIn;J.captureEvent=re.captureEvent;J.captureException=re.captureException;J.captureMessage=re.captureMessage;J.close=re.close;J.configureScope=re.configureScope;J.continueTrace=re.continueTrace;J.createTransport=re.createTransport;J.deepReadDirSync=re.deepReadDirSync;J.defaultIntegrations=re.defaultIntegrations;J.defaultStackParser=re.defaultStackParser;J.extractRequestData=re.extractRequestData;J.flush=re.flush;J.getActiveSpan=re.getActiveSpan;J.getActiveTransaction=re.getActiveTransaction;J.getClient=re.getClient;J.getCurrentHub=re.getCurrentHub;J.getCurrentScope=re.getCurrentScope;J.getGlobalScope=re.getGlobalScope;J.getHubFromCarrier=re.getHubFromCarrier;J.getIsolationScope=re.getIsolationScope;J.getSentryRelease=re.getSentryRelease;J.init=re.init;J.lastEventId=re.lastEventId;J.makeMain=re.makeMain;J.makeNodeTransport=re.makeNodeTransport;J.setContext=re.setContext;J.setCurrentClient=re.setCurrentClient;J.setExtra=re.setExtra;J.setExtras=re.setExtras;J.setMeasurement=re.setMeasurement;J.setTag=re.setTag;J.setTags=re.setTags;J.setUser=re.setUser;J.startActiveSpan=re.startActiveSpan;J.startInactiveSpan=re.startInactiveSpan;J.startSpan=re.startSpan;J.startSpanManual=re.startSpanManual;J.startTransaction=re.startTransaction;J.withIsolationScope=re.withIsolationScope;J.withMonitor=re.withMonitor;J.withScope=re.withScope});var nBe={};Oq(nBe,{default:()=>rBe});module.exports=Pq(nBe);(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="3b31f4c7-c17f-4204-9df9-a12b8c7b6570",t._sentryDebugIdIdentifier="sentry-dbid-3b31f4c7-c17f-4204-9df9-a12b8c7b6570")}catch{}})();var hq=$s(Jw());var tx=$s(CB()),rx=$s(qF());var ex=$s(QF());ex.default.config({path:`${__dirname}/../../../.env`});var Ufe=["NODE_ENV","LOG_LEVEL","MONGO_URL","AWS_REGION","AWS_COGNITO_CLIENT_ID","AWS_COGNITO_USER_POOL_ID","PUBLIC_IMAGES_BUCKET_NAME","TOPIC_ARN"],yi=class{configValues={};constructor(){Ufe.forEach(e=>{let r=process.env[e];if(!r)throw new Error(`ENV_NOT_DEFINED_OR_MISSING: ${e}`);this.configValues[e]=r})}getValue(e){let r=this.configValues[e];if(!r)throw new Error(`ENV_NOT_DEFINED_OR_MISSING: ${e}`);return r}isLocal(){let e=this.getValue("NODE_ENV");return["LOCAL"].includes(e.toUpperCase())}isProduction(){let e=this.getValue("NODE_ENV");return["PRD","PROD","PRODUCTION"].includes(e.toUpperCase())}};var Wn=class t extends Error{constructor(r,n,s,i=500){super(r);this.message=r;this.data=n;this.stack=s;this.statusCode=i;this.name="HttpError",Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}},Ii=class t extends Wn{constructor(r,n="HttpBadRequestError",s,i="BAD_REQUEST",o=400){super(i,r,s,o);this.data=r;this.name=n;this.stack=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}},Zp=class t extends Wn{constructor(r,n,s="HttpConflictError",i="CONFLICT",o=409){super(i,r,n,o);this.data=r;this.stack=n;this.name=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}};var Np=class t extends Wn{constructor(r,n,s="HttpNotFoundError",i="NOT_FOUND",o=404){super(i,r,n,o);this.data=r;this.stack=n;this.name=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}},Vp=class t extends Wn{constructor(r,n,s="HttpInternalServerError",i="INTERNAL_SERVER_ERROR",o=500){super(i,r,n,o);this.data=r;this.stack=n;this.name=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}},Au=class t extends Wn{constructor(r="User must be authenticated",n,s="HttpUnauthorizedError",i="UNAUTHORIZED",o=401){super(i,r,n,o);this.data=r;this.stack=n;this.name=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}},Hp=class t extends Wn{constructor(r,n,s="HttpUnprocessableEntityError",i="UNPROCESSABLE_ENTITY",o=422){super(i,r,n,o);this.data=r;this.stack=n;this.name=s;this.message=i;this.statusCode=o;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}};var Wp=class{app;appConfig;constructor(){this.app=(0,rx.default)(),this.app.register(tx.default),this.appConfig=new yi}route(e,r,n){this.app.route({method:e,url:r,handler:async(s,i)=>{let o={status:204},a={headers:s.headers||{},body:s.body||{},query:s.query||{},params:s.params||{}},c=await n.handle(a);return o.status=c.statusCode,c instanceof Wn?o.error={name:c.name,message:c.message,code:c.data,stack:this.appConfig.isLocal()?c.stack:void 0}:o.data=c.body,i.code(o.status),o}})}async run(e){try{return await this.app.listen({port:e,listenTextResolver:()=>`server is running on port: ${e}`}),this.app}catch(r){this.app.log.error(r),process.exit(1)}}async close(){try{await this.app.close(),this.app.log.info("server was closed")}catch(e){this.app.log.error(e),process.exit(1)}}getInstance(){return this.app}};var nx=require("events");var Ru=class{logManager;minLevel;module;levels={trace:1,debug:2,info:3,warn:4,error:5};constructor(e,r,n="info"){this.logManager=e,this.module=r,this.minLevel=this.levelToInt(n)}getChild(e){let r=new this.constructor;return r.logManager=this.logManager,r.minLevel=this.minLevel,r.module=`${this.module} | ${e}`,r}log(e,r,n){if(this.levelToInt(e)<this.minLevel)return;let i={level:e,module:this.module,message:r,data:n};this.logManager.emit("log",i)}trace(e,r){this.log("trace",e,r)}debug(e,r){this.log("debug",e,r)}info(e,r){this.log("info",e,r)}warn(e,r){this.log("warn",e,r)}error(e,r){this.log("error",e,r)}levelToInt(e){return e.toLowerCase()in this.levels?this.levels[e.toLowerCase()]:99}};var Wv=class t extends nx.EventEmitter{constructor(r="info"){super();this.minLevel=r}static minLevel;consoleLoggerRegistered=!1;getLogger(r){return t.minLevel?new Ru(this,r,t.minLevel):new Ru(this,r,this.minLevel)}onLogEntry(r){return this.on("log",r),this}registerConsoleLogger(){return this.consoleLoggerRegistered?this:(this.onLogEntry(r=>{let n=`[${r.level.toUpperCase()}] [${r.module}]: ${r.message}`;switch(r.level){case"trace":r.data?console.trace(n," :: ",r.data):console.trace(n);break;case"debug":r.data?console.debug(n," :: ",r.data):console.debug(n);break;case"info":r.data?console.info(n," :: ",r.data):console.info(n);break;case"warn":r.data?console.warn(n," :: ",r.data):console.warn(n);break;case"error":r.data?console.error(n," :: ",r.data):console.error(n);break;default:r.data?console.log(`{${r.level}} ${n}`,r.data):console.log(n)}}),this.consoleLoggerRegistered=!0,this)}},Op=t=>new Wv(t).registerConsoleLogger();var Ov=class{constructor(e,r){this.body=e;this.statusCode=r}},bi=class t extends Ov{constructor(r){super(r,200);this.body=r;Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace(this,t)}};var Ci=class{async createUser(e){return console.log(e),{userName:e.user_id,userEmail:e.email}}async getUser(e){return console.log(e),{userName:"User Name",userEmail:"user@fanzo.com"}}async deleteUser(e){console.log(e)}async setPhoneNumber(e){console.log(e)}async setUserPassword(e){console.log(e)}async setEmailVerified(e){console.log(e)}async initiateAuth(e){return console.log(e),{access_token:"access_token",refresh_token:"refresh_token",expires_in:30}}async revalidateAuth(e){return console.log(e),{access_token:"access_token",expires_in:30}}};var Eu=class{constructor(e){this.entityModel=e;this.clientSession=e}clientSession;start(){return this.clientSession=[],!!this.clientSession}getSession(){if(this.clientSession)return this.clientSession;throw new Error("START_DATABASE_ERROR")}updateSession(e){return this.clientSession=e,this.clientSession}},Pp=new Eu([]);var Si=class{async execute(e){return Pp.getSession().find(n=>n.user_id===e.user_id||n.auth_token===e.user_id||n.email===e.user_id)||null}};var kp=class{constructor(e,r=new Ci,n=new Si){this.logger=e;this.identityServiceProvider=r;this.getUserRepository=n;this.logger=this.logger.getChild("SignInUserUseCase")}async execute(e){this.logger.debug("execute input",JSON.stringify(e));let r=e.email.toLowerCase(),n=await this.getUserRepository.execute({user_id:r});if(this.logger.debug("get user repository response",n),!n)throw new Error("USER_NOT_FOUND");if(!n.email_verified)throw new Error("USER_NOT_CONFIRMED");let s=await this.identityServiceProvider.initiateAuth({email:r,password:e.password});if(this.logger.debug("identityServiceProvider initiateAuth",s),!s)throw new Error("USER_NOT_FOUND");return this.logger.debug("execute output",s),{...s,user_id:n.user_id}}};var sx=({optional:t=!1})=>({type:"uuid",version:4,optional:t}),Fp=({optional:t=!1})=>({type:"string",optional:t}),ix=({optional:t=!1})=>({type:"email",optional:t}),za=({optional:t=!1})=>({type:"string",pattern:"^(?=.*[A-Z])(?=.*[!#@$%&])(?=.*[0-9])(?=.*[a-z]).{6,99}$",optional:t}),ox=({optional:t=!1})=>({type:"string",enum:["fan","influencer","internal"],optional:t}),ax=({optional:t=!1})=>({type:"string",max:150,convert:!0,optional:t});var cx=({optional:t=!1})=>({type:"array",items:{type:"string",enum:["pt-BR","es-ES","en-US"],convert:!0},convert:!0,optional:t});var mL=$s(hL()),_i=class{async validate(e,r){let s=await new mL.default({useNewCustomCheckerFunction:!0}).validate(e,r);return s===!0?{isValid:s,errors:[]}:{isValid:!1,errors:s.map(i=>i.message||`${i.field} - ${i.type}`)}}};var Lp=class{constructor(e,r=new _i,n=new kp(e)){this.logger=e;this.requestValidator=r;this.signInUserUseCase=n;this.logger=this.logger.getChild("SignInUserController")}async handle(e){let{email:r,password:n}=e.body,s=await this.requestValidator.validate({email:r,password:n},{email:Fp({optional:!1}),password:za({optional:!1})});if(!s.isValid)return new Ii(s.errors);let i=await this.signInUserUseCase.execute({email:r,password:n});return new bi(i)}};var yL=t=>({user_id:t.user_id,name:t.name,email:t.email,email_verified:t.email_verified,role:t.role,languages:t.languages,created_at:t.created_at,bio:t.bio||void 0,photo_url:t.photo_url||void 0,deleted_at:t.deleted_at||void 0,approved_at:t.approved_at});var IL=$s(require("crypto")),Yp=new Uint8Array(256),Up=Yp.length;function Lv(){return Up>Yp.length-16&&(IL.default.randomFillSync(Yp),Up=0),Yp.slice(Up,Up+=16)}var xt=[];for(let t=0;t<256;++t)xt.push((t+256).toString(16).slice(1));function bL(t,e=0){return xt[t[e+0]]+xt[t[e+1]]+xt[t[e+2]]+xt[t[e+3]]+"-"+xt[t[e+4]]+xt[t[e+5]]+"-"+xt[t[e+6]]+xt[t[e+7]]+"-"+xt[t[e+8]]+xt[t[e+9]]+"-"+xt[t[e+10]]+xt[t[e+11]]+xt[t[e+12]]+xt[t[e+13]]+xt[t[e+14]]+xt[t[e+15]]}var CL=$s(require("crypto")),Uv={randomUUID:CL.default.randomUUID};function dge(t,e,r){if(Uv.randomUUID&&!e&&!t)return Uv.randomUUID();t=t||{};let n=t.random||(t.rng||Lv)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let s=0;s<16;++s)e[r+s]=n[s];return e}return bL(n)}var Yv=dge;var Dp=class{uuidV4(){return Yv()}};var Xp=class{async execute(e){let r=Pp.getSession();return r.push(e),r.find(n=>n.user_id===e.user_id)||e}};var $p=class{constructor(e,r,n=new Ci,s=new Dp,i=new Si,o=new Xp){this.logger=e;this.appConfig=r;this.identityServiceProvider=n;this.guidGenerator=s;this.getUserRepository=i;this.createRepository=o;this.logger=this.logger.getChild("SignUpUseCase")}async execute(e){this.logger.debug("execute input",JSON.stringify(e));let r=e.email.toLowerCase();try{let n=await this.getUserRepository.execute({user_id:r});if(this.logger.debug("users repository response",n),n)throw new Error("USER_ALREADY_EXISTS");let s=e.role!=="Admin"?new Date:void 0,i={user_id:this.guidGenerator.uuidV4(),auth_token:this.guidGenerator.uuidV4(),email:e.email,email_verified:!1,name:e.name,role:e.role,bio:e.bio,languages:e.languages,approved_at:s,created_at:new Date,photo_url:void 0,deleted_at:void 0},o=await this.createRepository.execute(i);this.logger.debug("create user repository response",o);let a=await this.identityServiceProvider.createUser({email:r,user_id:i.user_id});return this.logger.debug("identityServiceProvider createUser",a),await this.identityServiceProvider.setUserPassword({email:r,password:e.password}),this.logger.debug("identityServiceProvider confirmUser"),this.logger.debug("execute output",o),o}catch(n){throw this.logger.error("error",n),n}}};var jp=class{constructor(e,r,n=new _i,s=new $p(e,r)){this.logger=e;this.appConfig=r;this.requestValidator=n;this.signUpUserUseCase=s;this.logger=this.logger.getChild("SignUpUserController")}async handle(e){let{name:r,email:n,password:s,bio:i,role:o,languages:a}=e.body,c=await this.requestValidator.validate({name:r,email:n,password:s,role:o,languages:a,bio:i},{name:Fp({optional:!1}),email:ix({optional:!1}),password:za({optional:!1}),role:ox({optional:!1}),languages:cx({optional:!1}),bio:ax({optional:!0})});if(!c.isValid)return new Ii(c.errors);let l=await this.signUpUserUseCase.execute({name:r,email:n,password:s,role:o,languages:a,bio:i});return new bi(yL(l))}};var pq=$s(gq());var Oc=class{constructor(e,r){this.logger=e;this.controller=r;this.logger=this.logger.getChild("ControllerErrorHandlerDecorator")}async handle(e){try{return await this.controller.handle(e)}catch(r){return["USER_NOT_CONFIRMED","NotAuthorizedException","NotAuthorizedException: Invalid Refresh Token","USER_NOT_AUTHORIZED","ADMIN_USER_NOT_AUTHORIZED"].includes(r.message)?new Au(r.message):r.message==="NotAuthorizedException: Invalid Refresh Token"?new Au("Invalid Refresh Token"):["USER_NOT_FOUND","ADMIN_USER_NOT_FOUND"].includes(r.message)?new Np(r.message):["USER_ALREADY_EXISTS"].includes(r.message)?new Zp(r.message):["SIGNUP_ALREADY_VALIDATED","USER_WITHOUT_PHOTO"].includes(r.message)?new Hp(r.message):(this.logger.error("Internal Server Error",r),pq.captureException(r),new Vp(r))}}};var py=class{constructor(e,r=new Si,n=new Ci){this.logger=e;this.getUserRepository=r;this.identityServiceProvider=n;this.logger=this.logger.getChild("ChangePasswordUseCase")}async execute(e){this.logger.debug("execute input",JSON.stringify(e));try{let r=await this.getUserRepository.execute({user_id:e.auth_token});if(this.logger.debug("user repository response",r),!r)throw new Error("USER_NOT_FOUND");if(r.auth_token!==e.auth_token)throw new Error("USER_NOT_AUTHORIZED");return await this.identityServiceProvider.setUserPassword({password:e.new_password,email:r.email}),this.logger.debug("identityServiceProvider setUserPassword"),r}catch(r){throw this.logger.error("execute error",r),r}}};var hy=class{constructor(e,r=new _i,n=new py(e)){this.logger=e;this.requestValidator=r;this.changePasswordUseCase=n;this.logger=this.logger.getChild("ChangePasswordController")}async handle(e){let{auth_token:r,new_password:n}=e.body,s=await this.requestValidator.validate({auth_token:r,new_password:n},{auth_token:sx({optional:!1}),new_password:za({optional:!1})});if(!s.isValid)return new Ii(s.errors);let i=await this.changePasswordUseCase.execute({auth_token:r,new_password:n});return new bi(i)}};var Dd=new Wp,mq=new yi,Pc=Op(mq.getValue("LOG_LEVEL")).getLogger("ControllerFactory"),rPe=(0,hq.default)(Dd.getInstance()),Qwe=new Lp(Pc),eBe=new jp(Pc,mq),tBe=new hy(Pc);Dd.route("post","/auth/sign-up",new Oc(Pc,eBe));Dd.route("post","/auth/sign-in",new Oc(Pc,Qwe));Dd.route("patch","/auth/password/change",new Oc(Pc,tBe));var yq=Dd;(async()=>{let e=new yi,r=Op(e.getValue("LOG_LEVEL")).getLogger("publicServer");try{let n=new Eu([]).getSession();console.log("Database running",!!n),await yq.run(30022),console.log("server running on port: 30022")}catch(n){r.error("application not started",n),process.exit(1)}})();var rBe=void 0;
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

forwarded/index.js:
  (*!
   * forwarded
   * Copyright(c) 2014-2017 Douglas Christopher Wilson
   * MIT Licensed
   *)

proxy-addr/index.js:
  (*!
   * proxy-addr
   * Copyright(c) 2014-2016 Douglas Christopher Wilson
   * MIT Licensed
   *)

toad-cache/dist/toad-cache.cjs:
  (**
   * toad-cache
   *
   * @copyright 2023 Igor Savin <kibertoad@gmail.com>
   * @license MIT
   * @version 3.4.1
   *)

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

@sentry/node/cjs/integrations/anr/worker-script.js:
  (*! @sentry/node 7.94.1 (cf062ba) | https://github.com/getsentry/sentry-javascript *)
*/
//# sourceMappingURL=local.js.map
